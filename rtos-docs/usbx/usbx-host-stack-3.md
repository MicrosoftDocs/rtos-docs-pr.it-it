---
title: Capitolo 3-componenti funzionali dello stack host USBX
description: Questo capitolo contiene una descrizione dello stack host USB incorporato USBX a prestazioni elevate dal punto di vista funzionale.
author: philmea
ms.author: philmea
ms.date: 5/19/2020
ms.service: rtos
ms.topic: article
ms.openlocfilehash: 17b8d884dd2c71d60e91f5fcec40c360060f4fe8
ms.sourcegitcommit: e3d42e1f2920ec9cb002634b542bc20754f9544e
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/22/2021
ms.locfileid: "104824272"
---
# <a name="chapter-3---functional-components-of-usbx-host-stack"></a><span data-ttu-id="4580a-103">Capitolo 3-componenti funzionali dello stack host USBX</span><span class="sxs-lookup"><span data-stu-id="4580a-103">Chapter 3 - Functional Components of USBX Host Stack</span></span>

<span data-ttu-id="4580a-104">Questo capitolo contiene una descrizione dello stack host USB incorporato USBX a prestazioni elevate dal punto di vista funzionale.</span><span class="sxs-lookup"><span data-stu-id="4580a-104">This chapter contains a description of the high performance USBX embedded USB host stack from a functional perspective.</span></span>

## <a name="execution-overview"></a><span data-ttu-id="4580a-105">Panoramica dell'esecuzione</span><span class="sxs-lookup"><span data-stu-id="4580a-105">Execution Overview</span></span>

<span data-ttu-id="4580a-106">USBX è costituito da diversi componenti:</span><span class="sxs-lookup"><span data-stu-id="4580a-106">USBX is composed of several components:</span></span>

- <span data-ttu-id="4580a-107">Inizializzazione</span><span class="sxs-lookup"><span data-stu-id="4580a-107">Initialization</span></span>
- <span data-ttu-id="4580a-108">Chiamate dell'interfaccia dell'applicazione</span><span class="sxs-lookup"><span data-stu-id="4580a-108">Application interface calls</span></span>
- <span data-ttu-id="4580a-109">Hub radice</span><span class="sxs-lookup"><span data-stu-id="4580a-109">Root Hub</span></span>
- <span data-ttu-id="4580a-110">Classe Hub</span><span class="sxs-lookup"><span data-stu-id="4580a-110">Hub Class</span></span>
- <span data-ttu-id="4580a-111">Classi host</span><span class="sxs-lookup"><span data-stu-id="4580a-111">Host Classes</span></span>
- <span data-ttu-id="4580a-112">Stack host USB</span><span class="sxs-lookup"><span data-stu-id="4580a-112">USB Host Stack</span></span>
- <span data-ttu-id="4580a-113">Controller host</span><span class="sxs-lookup"><span data-stu-id="4580a-113">Host controller</span></span>

<span data-ttu-id="4580a-114">Il diagramma seguente illustra lo stack host USBX.</span><span class="sxs-lookup"><span data-stu-id="4580a-114">The following diagram illustrates the USBX host stack.</span></span>

![Stack host USBX](./media/usbx-host-stack/usbx-host-stack.png)

### <a name="initialization"></a><span data-ttu-id="4580a-116">Inizializzazione</span><span class="sxs-lookup"><span data-stu-id="4580a-116">Initialization</span></span>

<span data-ttu-id="4580a-117">Per attivare USBX, è necessario chiamare la funzione ***ux_system_initialize*** .</span><span class="sxs-lookup"><span data-stu-id="4580a-117">In order to activate USBX, the function ***ux_system_initialize*** must be called.</span></span> <span data-ttu-id="4580a-118">Questa funzione Inizializza le risorse di memoria di USBX.</span><span class="sxs-lookup"><span data-stu-id="4580a-118">This function initializes the memory resources of USBX.</span></span>

<span data-ttu-id="4580a-119">Per attivare le funzionalità host USBX, è necessario chiamare la funzione ***ux_host_stack_initialize*** .</span><span class="sxs-lookup"><span data-stu-id="4580a-119">In order to activate USBX host facilities, the function ***ux_host_stack_initialize*** must be called.</span></span> <span data-ttu-id="4580a-120">Questa funzione inizializza a sua volta tutte le risorse usate dallo stack host USBX, ad esempio thread ThreadX, mutex e semafori.</span><span class="sxs-lookup"><span data-stu-id="4580a-120">This function will in turn initialize all the resources used by the USBX host stack such as ThreadX threads, mutexes, and semaphores.</span></span>

<span data-ttu-id="4580a-121">L'inizializzazione dell'applicazione consente di attivare almeno un controller host USB e una o più classi USB.</span><span class="sxs-lookup"><span data-stu-id="4580a-121">It is up to the application initialization to activate at least one USB host controller and one or more USB classes.</span></span> <span data-ttu-id="4580a-122">Quando le classi sono state registrate nello stack e la funzione di inizializzazione dei controller host è stata chiamata, il bus è attivo e l'individuazione del dispositivo può essere avviata.</span><span class="sxs-lookup"><span data-stu-id="4580a-122">When the classes have been registered to the stack and the host controller(s) initialization function has been called the bus is active and device discovery can start.</span></span> <span data-ttu-id="4580a-123">Se l'hub radice del controller host rileva un dispositivo collegato, il thread di enumerazione USB, responsabile della topologia USB, verrà riattivato e continuerà a enumerare i dispositivi.</span><span class="sxs-lookup"><span data-stu-id="4580a-123">If the root hub of the host controller detects an attached device, the USB enumeration thread, in charge of the USB topology, will be wake up and proceed to enumerate the device(s).</span></span>

<span data-ttu-id="4580a-124">È possibile, a causa della natura dell'hub radice e degli hub downstream, che tutti i dispositivi USB collegati potrebbero non essere stati configurati completamente quando la funzione di inizializzazione del controller host restituisce.</span><span class="sxs-lookup"><span data-stu-id="4580a-124">It is possible, due to the nature of the root hub and downstream hubs, that all attached USB devices may not have been configured completely when the host controller initialization function returns.</span></span> <span data-ttu-id="4580a-125">L'enumerazione di tutti i dispositivi USB può richiedere alcuni secondi, soprattutto se sono presenti uno o più hub tra l'hub radice e i dispositivi USB.</span><span class="sxs-lookup"><span data-stu-id="4580a-125">It can take several seconds to enumerate all USB devices, especially if there are one or more hubs between the root hub and USB devices.</span></span>

### <a name="application-interface-calls"></a><span data-ttu-id="4580a-126">Chiamate dell'interfaccia dell'applicazione</span><span class="sxs-lookup"><span data-stu-id="4580a-126">Application Interface Calls</span></span>

<span data-ttu-id="4580a-127">In USBX sono disponibili due livelli di API.</span><span class="sxs-lookup"><span data-stu-id="4580a-127">There are two levels of APIs in USBX.</span></span>

- <span data-ttu-id="4580a-128">API dello stack host USB</span><span class="sxs-lookup"><span data-stu-id="4580a-128">USB Host Stack APIs</span></span>
- <span data-ttu-id="4580a-129">API della classe host USB</span><span class="sxs-lookup"><span data-stu-id="4580a-129">USB Host Class APIs</span></span>

<span data-ttu-id="4580a-130">In genere, un'applicazione USBX non deve chiamare alcuna delle funzioni API dello stack host USB.</span><span class="sxs-lookup"><span data-stu-id="4580a-130">Normally, a USBX application should not have to call any of the USB host stack API functions.</span></span> <span data-ttu-id="4580a-131">La maggior parte delle applicazioni accederà solo alle funzioni API della classe USB.</span><span class="sxs-lookup"><span data-stu-id="4580a-131">Most applications will only access the USB Class API functions.</span></span>

### <a name="usb-host-stack-apis"></a><span data-ttu-id="4580a-132">API dello stack host USB</span><span class="sxs-lookup"><span data-stu-id="4580a-132">USB Host Stack APIs</span></span>

<span data-ttu-id="4580a-133">Le funzioni API dello stack host sono responsabili della registrazione dei componenti USBX (classi host e controller host), della configurazione dei dispositivi e delle richieste di trasferimento per gli endpoint di dispositivo disponibili.</span><span class="sxs-lookup"><span data-stu-id="4580a-133">The host stack API functions are responsible for the registration of USBX components (host classes and host controllers), configuration of devices, and the transfer requests for available device endpoints.</span></span>

### <a name="usb-host-class-api"></a><span data-ttu-id="4580a-134">API della classe host USB</span><span class="sxs-lookup"><span data-stu-id="4580a-134">USB Host Class API</span></span>

<span data-ttu-id="4580a-135">Le API della classe sono molto specifiche per ogni classe USB.</span><span class="sxs-lookup"><span data-stu-id="4580a-135">The Class APIs are very specific to each USB class.</span></span> <span data-ttu-id="4580a-136">La maggior parte delle funzioni API comuni per le classi USB fornisce servizi quali l'apertura e la chiusura di un dispositivo, la lettura e la scrittura in un dispositivo.</span><span class="sxs-lookup"><span data-stu-id="4580a-136">Most of the common API functions for USB classes provide services such as opening/closing a device and reading from and writing to a device.</span></span>

### <a name="root-hub"></a><span data-ttu-id="4580a-137">Hub radice</span><span class="sxs-lookup"><span data-stu-id="4580a-137">Root Hub</span></span>

<span data-ttu-id="4580a-138">Ogni istanza del controller host ha uno o più hub radice USB.</span><span class="sxs-lookup"><span data-stu-id="4580a-138">Each host controller instance has one or more USB root hubs.</span></span> <span data-ttu-id="4580a-139">Il numero di hub radice è determinato dalla natura del controller oppure può essere recuperato leggendo registri specifici dal controller.</span><span class="sxs-lookup"><span data-stu-id="4580a-139">The number of root hubs is either determined by the nature of the controller or can be retrieved by reading specific registers from the controller.</span></span>

### <a name="hub-class"></a><span data-ttu-id="4580a-140">Classe Hub</span><span class="sxs-lookup"><span data-stu-id="4580a-140">Hub Class</span></span>

<span data-ttu-id="4580a-141">La classe Hub è responsabile della Guida degli hub USB.</span><span class="sxs-lookup"><span data-stu-id="4580a-141">The hub class is in charge of driving USB hubs.</span></span> <span data-ttu-id="4580a-142">Un hub USB può essere un hub autonomo o come parte di un dispositivo composto, ad esempio una tastiera o un monitor.</span><span class="sxs-lookup"><span data-stu-id="4580a-142">A USB hub can either be a stand-alone hub or as part of a compound device such as a keyboard or a monitor.</span></span> <span data-ttu-id="4580a-143">Un hub può essere autoalimentato o alimentato da bus.</span><span class="sxs-lookup"><span data-stu-id="4580a-143">A hub can be self-powered or bus-powered.</span></span> <span data-ttu-id="4580a-144">Gli hub basati su bus hanno un massimo di quattro porte a valle e possono consentire solo la connessione di dispositivi che sono dispositivi autonomi o basati su bus che usano meno di 100.</span><span class="sxs-lookup"><span data-stu-id="4580a-144">Bus-powered hubs have a maximum of four downstream ports and can only allow for the connection of devices that are either self-powered or bus-powered devices that use less than 100mA of power.</span></span> <span data-ttu-id="4580a-145">Gli hub possono essere a cascata.</span><span class="sxs-lookup"><span data-stu-id="4580a-145">Hubs can be cascaded.</span></span> <span data-ttu-id="4580a-146">Fino a cinque hub possono essere connessi tra loro.</span><span class="sxs-lookup"><span data-stu-id="4580a-146">Up to five hubs can be connected to one another.</span></span>

### <a name="usb-host-stack"></a><span data-ttu-id="4580a-147">Stack host USB</span><span class="sxs-lookup"><span data-stu-id="4580a-147">USB Host Stack</span></span>

<span data-ttu-id="4580a-148">Lo stack host USB è il fulcro di USBX.</span><span class="sxs-lookup"><span data-stu-id="4580a-148">The USB host stack is the centerpiece of USBX.</span></span> <span data-ttu-id="4580a-149">Sono disponibili tre funzioni principali.</span><span class="sxs-lookup"><span data-stu-id="4580a-149">It has three main functions.</span></span>

- <span data-ttu-id="4580a-150">Gestire la topologia del dispositivo USB.</span><span class="sxs-lookup"><span data-stu-id="4580a-150">Manage the topology of the USB.</span></span>
- <span data-ttu-id="4580a-151">Associare un dispositivo USB a una o più classi.</span><span class="sxs-lookup"><span data-stu-id="4580a-151">Bind a USB device to one or more classes.</span></span>
- <span data-ttu-id="4580a-152">Fornire un'API alle classi per eseguire l'interrogazione del descrittore del dispositivo e i trasferimenti USB.</span><span class="sxs-lookup"><span data-stu-id="4580a-152">Provide an API to classes to perform device descriptor interrogation and USB transfers.</span></span>

### <a name="topology-manager"></a><span data-ttu-id="4580a-153">Gestione topologia</span><span class="sxs-lookup"><span data-stu-id="4580a-153">Topology Manager</span></span>

<span data-ttu-id="4580a-154">Il thread della topologia dello stack USB viene riattivato quando si connette un nuovo dispositivo o quando un dispositivo è stato disconnesso.</span><span class="sxs-lookup"><span data-stu-id="4580a-154">The USB stack topology thread is awakened when a new device is connected or when a device has been disconnected.</span></span> <span data-ttu-id="4580a-155">L'hub radice o un hub normale può accettare le connessioni del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="4580a-155">Either the root hub or a regular hub can accept device connections.</span></span> <span data-ttu-id="4580a-156">Dopo che un dispositivo è stato connesso al dispositivo USB, il descrittore del dispositivo viene recuperato da Gestione topologia.</span><span class="sxs-lookup"><span data-stu-id="4580a-156">Once a device has been connected to the USB, the topology manager will retrieve the device descriptor.</span></span> <span data-ttu-id="4580a-157">Questo descrittore conterrà il numero di configurazioni possibili disponibili per questo dispositivo.</span><span class="sxs-lookup"><span data-stu-id="4580a-157">This descriptor will contain the number of possible configurations available for this device.</span></span> <span data-ttu-id="4580a-158">La maggior parte dei dispositivi ha una sola configurazione.</span><span class="sxs-lookup"><span data-stu-id="4580a-158">Most devices have one configuration only.</span></span> <span data-ttu-id="4580a-159">Alcuni dispositivi possono funzionare in modo diverso in base alla potenza disponibile disponibile sulla porta in cui è connessa.</span><span class="sxs-lookup"><span data-stu-id="4580a-159">Some devices can operate differently according to the available power available on the port where it is connected.</span></span> <span data-ttu-id="4580a-160">In tal caso, il dispositivo disporrà di più configurazioni che possono essere selezionate a seconda della potenza disponibile.</span><span class="sxs-lookup"><span data-stu-id="4580a-160">If this is the case, the device will have multiple configurations that can be selected depending on the available power.</span></span> <span data-ttu-id="4580a-161">Quando il dispositivo è configurato da Gestione topologia, può quindi creare la quantità di energia specificata nel descrittore di configurazione.</span><span class="sxs-lookup"><span data-stu-id="4580a-161">When the device is configured by the topology manager, it is then allowed to draw the amount of power specified in its configuration descriptor.</span></span>

## <a name="usb-class-binding"></a><span data-ttu-id="4580a-162">Associazione di classe USB</span><span class="sxs-lookup"><span data-stu-id="4580a-162">USB Class Binding</span></span>

<span data-ttu-id="4580a-163">Quando il dispositivo è configurato, Gestione topologia consente a gestione classi di continuare l'individuazione del dispositivo esaminando i descrittori di interfaccia del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="4580a-163">When the device is configured, the topology manager will let the class manager continue the device discovery by looking at the device interface descriptors.</span></span> <span data-ttu-id="4580a-164">Un dispositivo può avere uno o più descrittori di interfaccia.</span><span class="sxs-lookup"><span data-stu-id="4580a-164">A device can have one or more interface descriptors.</span></span>

<span data-ttu-id="4580a-165">Un'interfaccia rappresenta una funzione in un dispositivo.</span><span class="sxs-lookup"><span data-stu-id="4580a-165">An interface represents a function in a device.</span></span> <span data-ttu-id="4580a-166">Un altoparlante USB, ad esempio, dispone di tre interfacce, una per lo streaming audio, una per il controllo audio e una per la gestione dei diversi pulsanti del altoparlante.</span><span class="sxs-lookup"><span data-stu-id="4580a-166">For instance, a USB speaker has three interfaces, one for audio streaming, one for audio control, and one to manage the various speaker buttons.</span></span>

<span data-ttu-id="4580a-167">Gestione classi dispone di due meccanismi per unire le interfacce del dispositivo a una o più classi.</span><span class="sxs-lookup"><span data-stu-id="4580a-167">The class manager has two mechanisms to join the device interface(s) to one or more classes.</span></span> <span data-ttu-id="4580a-168">Può usare la combinazione di un PID/VID (ID prodotto e ID fornitore) trovato nel descrittore di interfaccia o nella combinazione di classe/sottoclasse/protocollo.</span><span class="sxs-lookup"><span data-stu-id="4580a-168">It can either use the combination of a PID/VID (product ID and vendor ID) found in the interface descriptor or the combination of Class/Subclass/Protocol.</span></span>

<span data-ttu-id="4580a-169">La combinazione PID/VID è valida per le interfacce che non possono essere gestite da una classe generica.</span><span class="sxs-lookup"><span data-stu-id="4580a-169">The PID/VID combination is valid for interfaces that cannot be driven by a generic class.</span></span> <span data-ttu-id="4580a-170">La combinazione classe/sottoclasse/protocollo viene usata dalle interfacce che appartengono a una classe certificata USB-IF, ad esempio una stampante, un hub, un'archiviazione, un audio o una HID.</span><span class="sxs-lookup"><span data-stu-id="4580a-170">The Class/Subclass/Protocol combination is used by interfaces that belong to a USB-IF certified class such as a printer, hub, storage, audio, or HID.</span></span>

<span data-ttu-id="4580a-171">Gestione classi contiene un elenco di classi registrate dall'inizializzazione di USBX.</span><span class="sxs-lookup"><span data-stu-id="4580a-171">The class manager contains a list of registered classes from the initialization of USBX.</span></span> <span data-ttu-id="4580a-172">Gestione classi chiamerà ogni classe uno alla volta finché una classe non accetta di gestire l'interfaccia per il dispositivo.</span><span class="sxs-lookup"><span data-stu-id="4580a-172">The class manager will call each class one at a time until one class accepts to manage the interface for that device.</span></span> <span data-ttu-id="4580a-173">Una classe può gestire solo un'interfaccia.</span><span class="sxs-lookup"><span data-stu-id="4580a-173">A class can only manage one interface.</span></span> <span data-ttu-id="4580a-174">Per l'esempio dell'altoparlante audio USB, gestione classi chiamerà tutte le classi per ciascuna interfaccia.</span><span class="sxs-lookup"><span data-stu-id="4580a-174">For the example of the USB audio speaker, the class manager will call all the classes for each of the interfaces.</span></span>

<span data-ttu-id="4580a-175">Una volta che una classe accetta un'interfaccia, viene creata una nuova istanza di tale classe.</span><span class="sxs-lookup"><span data-stu-id="4580a-175">Once a class accepts an interface, a new instance of that class is created.</span></span> <span data-ttu-id="4580a-176">Gestione classi eseguirà quindi la ricerca dell'impostazione alternativa predefinita per l'interfaccia.</span><span class="sxs-lookup"><span data-stu-id="4580a-176">The class manager will then search for the default alternate setting for the interface.</span></span> <span data-ttu-id="4580a-177">Un dispositivo può avere una o più impostazioni alternative per ogni interfaccia.</span><span class="sxs-lookup"><span data-stu-id="4580a-177">A device may have one or more alternate settings for each interface.</span></span> <span data-ttu-id="4580a-178">L'impostazione alternativa 0 sarà on utilizzata per impostazione predefinita fino a quando una classe non decide di modificarla.</span><span class="sxs-lookup"><span data-stu-id="4580a-178">The alternate setting 0 will be the on used by default until a class decides to change it.</span></span>

<span data-ttu-id="4580a-179">Per l'impostazione alternativa predefinita, gestione classi monta tutti gli endpoint contenuti nell'impostazione alternativa.</span><span class="sxs-lookup"><span data-stu-id="4580a-179">For the default alternate setting, the class manager will mount all the endpoints contained in the alternate setting.</span></span> <span data-ttu-id="4580a-180">Se il montaggio di ogni endpoint ha esito positivo, il gestore delle classi completerà il processo restituendo alla classe che terminerà l'inizializzazione dell'interfaccia.</span><span class="sxs-lookup"><span data-stu-id="4580a-180">If the mounting of each endpoint is successful, the class manager will complete its job by returning to the class that will finish the initialization of the interface.</span></span>

### <a name="usbx-apis"></a><span data-ttu-id="4580a-181">API USBX</span><span class="sxs-lookup"><span data-stu-id="4580a-181">USBX APIs</span></span>

<span data-ttu-id="4580a-182">Lo stack USB esporta un certo numero di API per le classi USB per eseguire l'interrogazione sul dispositivo e sui trasferimenti USB su endpoint specifici.</span><span class="sxs-lookup"><span data-stu-id="4580a-182">The USB stack exports a certain number of APIs for the USB classes to perform interrogation on the device and USB transfers on specific endpoints.</span></span> <span data-ttu-id="4580a-183">Queste funzioni API sono descritte in dettaglio in questo manuale di riferimento.</span><span class="sxs-lookup"><span data-stu-id="4580a-183">These API functions are described in detail in this reference manual.</span></span>

### <a name="host-controller"></a><span data-ttu-id="4580a-184">Controller host</span><span class="sxs-lookup"><span data-stu-id="4580a-184">Host Controller</span></span>

<span data-ttu-id="4580a-185">Il driver del controller host è responsabile della Guida di un tipo specifico di controller USB.</span><span class="sxs-lookup"><span data-stu-id="4580a-185">The host controller driver is responsible for driving a specific type of USB controller.</span></span> <span data-ttu-id="4580a-186">Un controller host USB può avere più controller all'interno di.</span><span class="sxs-lookup"><span data-stu-id="4580a-186">A USB host controller can have multiple controllers inside.</span></span> <span data-ttu-id="4580a-187">Ad esempio, alcuni chipset Intel PC contengono due controller UHCI.</span><span class="sxs-lookup"><span data-stu-id="4580a-187">For instance, certain Intel PC chipset contain two UHCI controllers.</span></span> <span data-ttu-id="4580a-188">Alcuni controller USB 2,0 contengono più istanze di un controller OHCI, oltre a un'istanza del controller EHCI.</span><span class="sxs-lookup"><span data-stu-id="4580a-188">Some USB 2.0 controllers contain multiple instances of an OHCI controller in addition to one instance of the EHCI controller.</span></span>

<span data-ttu-id="4580a-189">Il controller host gestirà più istanze dello stesso controller.</span><span class="sxs-lookup"><span data-stu-id="4580a-189">The Host controller will manage multiple instance of the same controller only.</span></span> <span data-ttu-id="4580a-190">Per poter gestire la maggior parte dei controller host USB 2,0, sarà necessario inizializzare sia il controller OCHI che il controller EHCI durante l'inizializzazione di USBX.</span><span class="sxs-lookup"><span data-stu-id="4580a-190">In order to drive most USB 2.0 host controllers, it will be required to initialize both the OCHI controller and the EHCI controller during the initialization of USBX.</span></span>

<span data-ttu-id="4580a-191">Il controller host è responsabile della gestione dei seguenti elementi.</span><span class="sxs-lookup"><span data-stu-id="4580a-191">The host controller is responsible for managing the following.</span></span>

- <span data-ttu-id="4580a-192">Hub radice</span><span class="sxs-lookup"><span data-stu-id="4580a-192">Root Hub</span></span>
- <span data-ttu-id="4580a-193">Risparmio energia</span><span class="sxs-lookup"><span data-stu-id="4580a-193">Power Management</span></span>
- <span data-ttu-id="4580a-194">Endpoint</span><span class="sxs-lookup"><span data-stu-id="4580a-194">Endpoints</span></span>
- <span data-ttu-id="4580a-195">Trasferimenti</span><span class="sxs-lookup"><span data-stu-id="4580a-195">Transfers</span></span>

### <a name="root-hub"></a><span data-ttu-id="4580a-196">Hub radice</span><span class="sxs-lookup"><span data-stu-id="4580a-196">Root Hub</span></span>

<span data-ttu-id="4580a-197">La gestione dell'hub radice è responsabile della potenza di ogni porta del controller e dell'eventuale inserimento di un dispositivo.</span><span class="sxs-lookup"><span data-stu-id="4580a-197">The root hub management is responsible for the powering up of each controller port and determining if there is a device inserted or not.</span></span> <span data-ttu-id="4580a-198">Questa funzionalità viene usata dall'hub radice generico USBX per interrogare le porte downstream del controller.</span><span class="sxs-lookup"><span data-stu-id="4580a-198">This functionality is used by the USBX generic root hub to interrogate the controller downstream ports.</span></span>

### <a name="power-management"></a><span data-ttu-id="4580a-199">Risparmio energia</span><span class="sxs-lookup"><span data-stu-id="4580a-199">Power Management</span></span>

<span data-ttu-id="4580a-200">L'elaborazione del risparmio energia consente di gestire i segnali di sospensione/ripresa in modalità Gang, interessando quindi tutte le porte downstream del controller allo stesso tempo oppure singolarmente se il controller offre questa funzionalità.</span><span class="sxs-lookup"><span data-stu-id="4580a-200">The power management processing provides for the handling of suspend/resume signals either in gang mode, therefore affecting all controller downstream ports at the same time, or individually if the controller offers this functionality.</span></span>

### <a name="endpoints"></a><span data-ttu-id="4580a-201">Endpoint</span><span class="sxs-lookup"><span data-stu-id="4580a-201">Endpoints</span></span>

<span data-ttu-id="4580a-202">La gestione degli endpoint consente la creazione o l'eliminazione di endpoint fisici nel controller.</span><span class="sxs-lookup"><span data-stu-id="4580a-202">The endpoint management provides for the creation or destruction of physical endpoints to the controller.</span></span> <span data-ttu-id="4580a-203">Gli endpoint fisici sono entità di memoria analizzate dal controller se il controller supporta il DMA master o scritti nel controller.</span><span class="sxs-lookup"><span data-stu-id="4580a-203">The physical endpoints are memory entities that are parsed by the controller if the controller supports master DMA or that are written in the controller.</span></span> <span data-ttu-id="4580a-204">Gli endpoint fisici contengono informazioni sulle transazioni che devono essere eseguite dal controller.</span><span class="sxs-lookup"><span data-stu-id="4580a-204">The physical endpoints contain transactions information to be performed by the controller.</span></span>

### <a name="transfers"></a><span data-ttu-id="4580a-205">Trasferimenti</span><span class="sxs-lookup"><span data-stu-id="4580a-205">Transfers</span></span>

<span data-ttu-id="4580a-206">Gestione trasferimento consente a una classe di eseguire una transazione in ogni endpoint creato.</span><span class="sxs-lookup"><span data-stu-id="4580a-206">Transfer management provides for a class to perform a transaction on each of the endpoints that have been created.</span></span> <span data-ttu-id="4580a-207">Ogni endpoint logico contiene un componente denominato richiesta di trasferimento per le richieste di trasferimento USB.</span><span class="sxs-lookup"><span data-stu-id="4580a-207">Each logical endpoint contains a component called TRANSFER REQUEST for USB transfer requests.</span></span> <span data-ttu-id="4580a-208">La richiesta di trasferimento viene utilizzata dallo stack per descrivere la transazione.</span><span class="sxs-lookup"><span data-stu-id="4580a-208">The TRANSFER REQUEST is used by the stack to describe the transaction.</span></span> <span data-ttu-id="4580a-209">Questa richiesta di trasferimento viene quindi passata allo stack e al controller, che può suddividerla in diverse transazioni secondarie a seconda delle funzionalità del controller.</span><span class="sxs-lookup"><span data-stu-id="4580a-209">This TRANSFER REQUEST is then passed to the stack and to the controller, which may divide it into several sub transactions depending on the capabilities of the controller.</span></span>

## <a name="usb-device-framework"></a><span data-ttu-id="4580a-210">Framework del dispositivo USB</span><span class="sxs-lookup"><span data-stu-id="4580a-210">USB Device Framework</span></span>

<span data-ttu-id="4580a-211">Un dispositivo USB è rappresentato da un albero di descrittori.</span><span class="sxs-lookup"><span data-stu-id="4580a-211">A USB device is represented by a tree of descriptors.</span></span> <span data-ttu-id="4580a-212">Sono disponibili sei tipi principali di descrittori.</span><span class="sxs-lookup"><span data-stu-id="4580a-212">There are six main types of descriptors.</span></span>

- <span data-ttu-id="4580a-213">Descrittori del dispositivo</span><span class="sxs-lookup"><span data-stu-id="4580a-213">Device descriptors</span></span>
- <span data-ttu-id="4580a-214">Descrittori di configurazione</span><span class="sxs-lookup"><span data-stu-id="4580a-214">Configuration descriptors</span></span>
- <span data-ttu-id="4580a-215">Descrittori di interfaccia</span><span class="sxs-lookup"><span data-stu-id="4580a-215">Interface descriptors</span></span>
- <span data-ttu-id="4580a-216">Descrittori di endpoint</span><span class="sxs-lookup"><span data-stu-id="4580a-216">Endpoint descriptors</span></span>
- <span data-ttu-id="4580a-217">Descrittori di stringa</span><span class="sxs-lookup"><span data-stu-id="4580a-217">String descriptors</span></span>
- <span data-ttu-id="4580a-218">Descrittori funzionali</span><span class="sxs-lookup"><span data-stu-id="4580a-218">Functional descriptors</span></span>

<span data-ttu-id="4580a-219">Un dispositivo USB può avere una descrizione molto semplice e ha un aspetto simile al seguente.</span><span class="sxs-lookup"><span data-stu-id="4580a-219">A USB device may have a very simple description and looks like this.</span></span>
<span data-ttu-id="4580a-220">![Dispositivo USB semplice](./media/usbx-host-stack/usb-device-simple.png)</span><span class="sxs-lookup"><span data-stu-id="4580a-220">![Simple USB device](./media/usbx-host-stack/usb-device-simple.png)</span></span>

<span data-ttu-id="4580a-221">Nella figura precedente, il dispositivo ha una sola configurazione.</span><span class="sxs-lookup"><span data-stu-id="4580a-221">In the above illustration, the device has only one configuration.</span></span> <span data-ttu-id="4580a-222">Una singola interfaccia è associata a questa configurazione, a indicare che il dispositivo ha una sola funzione e ha un solo endpoint.</span><span class="sxs-lookup"><span data-stu-id="4580a-222">A single interface is attached to this configuration, indicating that the device has only one function, and it has one endpoint only.</span></span> <span data-ttu-id="4580a-223">Il descrittore del dispositivo è associato a un descrittore di stringa che fornisce un'identificazione visibile del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="4580a-223">Attached to the device descriptor is a string descriptor providing a visible identification of the device.</span></span>

<span data-ttu-id="4580a-224">Tuttavia, un dispositivo può essere più complesso e può apparire come segue.</span><span class="sxs-lookup"><span data-stu-id="4580a-224">However, a device may be more complex and may appear as follows.</span></span>

![Dispositivo USB complesso](./media/usbx-host-stack/usb-device-complex.png)

<span data-ttu-id="4580a-226">Nella figura precedente, il dispositivo dispone di due descrittori di configurazione collegati al descrittore del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="4580a-226">In the above illustration, the device has two configuration descriptors attached to the device descriptor.</span></span> <span data-ttu-id="4580a-227">Questo dispositivo può indicare che dispone di due modalità di risparmio energia o può essere gestito da classi standard o classi proprietarie.</span><span class="sxs-lookup"><span data-stu-id="4580a-227">This device may indicate that it has two power modes or can be driven by either standard classes or proprietary classes.</span></span>

<span data-ttu-id="4580a-228">Collegato alla prima configurazione sono disponibili due interfacce che indicano che il dispositivo ha due funzioni logiche.</span><span class="sxs-lookup"><span data-stu-id="4580a-228">Attached to the first configuration are two interfaces indicating that the device has two logical functions.</span></span> <span data-ttu-id="4580a-229">La prima funzione ha 3 descrittori di endpoint e un descrittore funzionale.</span><span class="sxs-lookup"><span data-stu-id="4580a-229">The first function has 3 endpoint descriptors and a functional descriptor.</span></span> <span data-ttu-id="4580a-230">Il descrittore funzionale può essere usato dalla classe responsabile dell'azionamento dell'interfaccia per ottenere ulteriori informazioni su questa interfaccia normalmente non trovata da un descrittore generico.</span><span class="sxs-lookup"><span data-stu-id="4580a-230">The functional descriptor may be used by the class responsible to drive the interface to obtain further information about this interface normally not found by a generic descriptor.</span></span>

### <a name="device-descriptors"></a><span data-ttu-id="4580a-231">Descrittori del dispositivo</span><span class="sxs-lookup"><span data-stu-id="4580a-231">Device Descriptors</span></span>

<span data-ttu-id="4580a-232">Ogni dispositivo USB ha un singolo descrittore di dispositivo.</span><span class="sxs-lookup"><span data-stu-id="4580a-232">Each USB device has one single device descriptor.</span></span> <span data-ttu-id="4580a-233">Questo descrittore contiene l'identificazione del dispositivo, il numero di configurazioni supportate e le caratteristiche dell'endpoint di controllo predefinito usato per la configurazione del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="4580a-233">This descriptor contains the device identification, the number of configurations supported, and the characteristics of the default control endpoint used for configuring the device.</span></span>

| <span data-ttu-id="4580a-234">Offset</span><span class="sxs-lookup"><span data-stu-id="4580a-234">Offset</span></span> | <span data-ttu-id="4580a-235">Campo</span><span class="sxs-lookup"><span data-stu-id="4580a-235">Field</span></span>              | <span data-ttu-id="4580a-236">Dimensione</span><span class="sxs-lookup"><span data-stu-id="4580a-236">Size</span></span> | <span data-ttu-id="4580a-237">Valore</span><span class="sxs-lookup"><span data-stu-id="4580a-237">Value</span></span>    | <span data-ttu-id="4580a-238">Descrizione</span><span class="sxs-lookup"><span data-stu-id="4580a-238">Description</span></span>                             |
| ------ | ------------------ | ---- | -------- | --------------------------------------- |
| <span data-ttu-id="4580a-239">0</span><span class="sxs-lookup"><span data-stu-id="4580a-239">0</span></span>      | <span data-ttu-id="4580a-240">BLength</span><span class="sxs-lookup"><span data-stu-id="4580a-240">BLength</span></span>            | <span data-ttu-id="4580a-241">1</span><span class="sxs-lookup"><span data-stu-id="4580a-241">1</span></span>    | <span data-ttu-id="4580a-242">Number</span><span class="sxs-lookup"><span data-stu-id="4580a-242">Number</span></span>   | <span data-ttu-id="4580a-243">Dimensioni del descrittore in byte</span><span class="sxs-lookup"><span data-stu-id="4580a-243">Size of this descriptor in bytes</span></span> |
| <span data-ttu-id="4580a-244">1</span><span class="sxs-lookup"><span data-stu-id="4580a-244">1</span></span>      | <span data-ttu-id="4580a-245">bDescriptorType</span><span class="sxs-lookup"><span data-stu-id="4580a-245">bDescriptorType</span></span>    | <span data-ttu-id="4580a-246">1</span><span class="sxs-lookup"><span data-stu-id="4580a-246">1</span></span>    | <span data-ttu-id="4580a-247">Costante</span><span class="sxs-lookup"><span data-stu-id="4580a-247">Constant</span></span> | <span data-ttu-id="4580a-248">Tipo di descrittore del dispositivo</span><span class="sxs-lookup"><span data-stu-id="4580a-248">DEVICE Descriptor Type</span></span> |
| <span data-ttu-id="4580a-249">2</span><span class="sxs-lookup"><span data-stu-id="4580a-249">2</span></span>      | <span data-ttu-id="4580a-250">bcdUSB</span><span class="sxs-lookup"><span data-stu-id="4580a-250">bcdUSB</span></span>             | <span data-ttu-id="4580a-251">2</span><span class="sxs-lookup"><span data-stu-id="4580a-251">2</span></span>    | <span data-ttu-id="4580a-252">BCD</span><span class="sxs-lookup"><span data-stu-id="4580a-252">BCD</span></span>      | <span data-ttu-id="4580a-253">Numero di versione delle specifiche USB in BinaryCoded Dec</span><span class="sxs-lookup"><span data-stu-id="4580a-253">USB Specification Release Number in BinaryCoded Dec</span></span><br /><span data-ttu-id="4580a-254">Esempio: 2,10 è equivalente a 0x210.</span><span class="sxs-lookup"><span data-stu-id="4580a-254">Example: 2.10 is equivalent to 0x210.</span></span> <span data-ttu-id="4580a-255">Questo campo identifica la versione della specifica USB per cui il dispositivo e i relativi descrittori sono conformi.</span><span class="sxs-lookup"><span data-stu-id="4580a-255">This field identifies the release of the USB Specification that the device and its descriptors are compliant with.</span></span> |
| <span data-ttu-id="4580a-256">4</span><span class="sxs-lookup"><span data-stu-id="4580a-256">4</span></span>      | <span data-ttu-id="4580a-257">bDeviceClass</span><span class="sxs-lookup"><span data-stu-id="4580a-257">bDeviceClass</span></span>       | <span data-ttu-id="4580a-258">1</span><span class="sxs-lookup"><span data-stu-id="4580a-258">1</span></span>    | <span data-ttu-id="4580a-259">Classe</span><span class="sxs-lookup"><span data-stu-id="4580a-259">Class</span></span>    | <span data-ttu-id="4580a-260">Codice di classe (assegnato da USB-IF).</span><span class="sxs-lookup"><span data-stu-id="4580a-260">Class code (assigned by USB-IF).</span></span><br /><span data-ttu-id="4580a-261">Se questo campo viene reimpostato su 0, ogni interfaccia all'interno di una configurazione specifica le proprie informazioni sulla classe e le varie interfacce operano in modo indipendente.</span><span class="sxs-lookup"><span data-stu-id="4580a-261">If this field is reset to 0, each interface within a configuration specifies its own class information and the various interfaces operate independently.</span></span><br /><span data-ttu-id="4580a-262">Se questo campo è impostato su un valore compreso tra 1 e 0xFE, il dispositivo supporta specifiche di classe diverse su interfacce diverse e le interfacce potrebbero non funzionare in modo indipendente.</span><span class="sxs-lookup"><span data-stu-id="4580a-262">If this field is set to a value between 1 and 0xFE, the device supports different class specifications on different interfaces and the interfaces may not operate independently.</span></span> <span data-ttu-id="4580a-263">Questo valore identifica la definizione della classe utilizzata per le interfacce di aggregazione.</span><span class="sxs-lookup"><span data-stu-id="4580a-263">This value identifies the class definition used for the aggregate interfaces.</span></span><br /><span data-ttu-id="4580a-264">Se questo campo è impostato su 0xFF, la classe Device è specifica del fornitore.</span><span class="sxs-lookup"><span data-stu-id="4580a-264">If this field is set to 0xFF, the device class is vendor specific.</span></span> |
| <span data-ttu-id="4580a-265">5</span><span class="sxs-lookup"><span data-stu-id="4580a-265">5</span></span>      | <span data-ttu-id="4580a-266">bDeviceSubClass</span><span class="sxs-lookup"><span data-stu-id="4580a-266">bDeviceSubClass</span></span>    | <span data-ttu-id="4580a-267">1</span><span class="sxs-lookup"><span data-stu-id="4580a-267">1</span></span>    | <span data-ttu-id="4580a-268">Sottoclasse</span><span class="sxs-lookup"><span data-stu-id="4580a-268">SubClass</span></span> | <span data-ttu-id="4580a-269">Codice di sottoclasse (assegnato da USB-IF).</span><span class="sxs-lookup"><span data-stu-id="4580a-269">Subclass code (assigned by USB-IF).</span></span><br /><span data-ttu-id="4580a-270">Questi codici sono qualificati dal valore del campo bDeviceClass.</span><span class="sxs-lookup"><span data-stu-id="4580a-270">These codes are qualified by the value of the bDeviceClass field.</span></span> <span data-ttu-id="4580a-271">Se il campo bDeviceClass viene reimpostato su 0, è necessario reimpostare anche questo campo su 0.</span><span class="sxs-lookup"><span data-stu-id="4580a-271">If the bDeviceClass field is reset to 0, this field must also be reset to 0.</span></span> <span data-ttu-id="4580a-272">Se il campo bDeviceClass non è impostato su 0xFF, tutti i valori sono riservati per l'assegnazione tramite USB.</span><span class="sxs-lookup"><span data-stu-id="4580a-272">If the bDeviceClass field is not set to 0xFF, all values are reserved for assignment by USB.</span></span> |
| <span data-ttu-id="4580a-273">6</span><span class="sxs-lookup"><span data-stu-id="4580a-273">6</span></span>      | <span data-ttu-id="4580a-274">bDeviceProtocol</span><span class="sxs-lookup"><span data-stu-id="4580a-274">bDeviceProtocol</span></span>    | <span data-ttu-id="4580a-275">1</span><span class="sxs-lookup"><span data-stu-id="4580a-275">1</span></span>    | <span data-ttu-id="4580a-276">Protocollo</span><span class="sxs-lookup"><span data-stu-id="4580a-276">Protocol</span></span> | <span data-ttu-id="4580a-277">Codice del protocollo (assegnato da USB-IF).</span><span class="sxs-lookup"><span data-stu-id="4580a-277">Protocol code (assigned by USB-IF).</span></span><br /><span data-ttu-id="4580a-278">Questi codici sono qualificati dal valore dei campi bDeviceClass e bDeviceSubClass.</span><span class="sxs-lookup"><span data-stu-id="4580a-278">These codes are qualified by the value of the bDeviceClass and the bDeviceSubClass fields.</span></span> <span data-ttu-id="4580a-279">Se un dispositivo supporta i protocolli specifici della classe su un dispositivo, anziché un'interfaccia, questo codice identifica i protocolli usati dal dispositivo come definito dalla specifica della classe del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="4580a-279">If a device supports class-specific protocols on a device basis as opposed to an interface basis, this code identifies the protocols that the device uses as defined by the specification of the device class.</span></span> <span data-ttu-id="4580a-280">Se questo campo viene reimpostato su 0, il dispositivo non usa protocolli specifici di classe in base a un dispositivo.</span><span class="sxs-lookup"><span data-stu-id="4580a-280">If this field is reset to 0, the device does not use class specific protocols on a device basis.</span></span><br /><span data-ttu-id="4580a-281">Tuttavia, può usare protocolli specifici di classe in base a un'interfaccia.</span><span class="sxs-lookup"><span data-stu-id="4580a-281">However, it may use class specific protocols on an interface basis.</span></span><br /><span data-ttu-id="4580a-282">Se questo campo è impostato su 0xFF, il dispositivo utilizza un protocollo specifico del fornitore in base a un dispositivo.</span><span class="sxs-lookup"><span data-stu-id="4580a-282">If this field is set to 0xFF, the device uses a vendor specific protocol on a device basis.</span></span> |
| <span data-ttu-id="4580a-283">7</span><span class="sxs-lookup"><span data-stu-id="4580a-283">7</span></span>      | <span data-ttu-id="4580a-284">bMaxPacketSize0</span><span class="sxs-lookup"><span data-stu-id="4580a-284">bMaxPacketSize0</span></span>    | <span data-ttu-id="4580a-285">1</span><span class="sxs-lookup"><span data-stu-id="4580a-285">1</span></span>    | <span data-ttu-id="4580a-286">Number</span><span class="sxs-lookup"><span data-stu-id="4580a-286">Number</span></span>   | <span data-ttu-id="4580a-287">Dimensioni massime del pacchetto per l'endpoint zero (sono valide solo le dimensioni in byte di 8, 16, 32 o 64)</span><span class="sxs-lookup"><span data-stu-id="4580a-287">Maximum packet size for endpoint zero (only byte sizes of 8, 16, 32, or 64 are valid)</span></span> |
| <span data-ttu-id="4580a-288">8</span><span class="sxs-lookup"><span data-stu-id="4580a-288">8</span></span>      | <span data-ttu-id="4580a-289">idVendor</span><span class="sxs-lookup"><span data-stu-id="4580a-289">idVendor</span></span>           | <span data-ttu-id="4580a-290">2</span><span class="sxs-lookup"><span data-stu-id="4580a-290">2</span></span>    | <span data-ttu-id="4580a-291">ID</span><span class="sxs-lookup"><span data-stu-id="4580a-291">ID</span></span>       | <span data-ttu-id="4580a-292">ID fornitore (assegnato da USB-IF)</span><span class="sxs-lookup"><span data-stu-id="4580a-292">Vendor ID (assigned by USB-IF)</span></span> |
| <span data-ttu-id="4580a-293">10</span><span class="sxs-lookup"><span data-stu-id="4580a-293">10</span></span>     | <span data-ttu-id="4580a-294">idProduct</span><span class="sxs-lookup"><span data-stu-id="4580a-294">idProduct</span></span>          | <span data-ttu-id="4580a-295">2</span><span class="sxs-lookup"><span data-stu-id="4580a-295">2</span></span>    | <span data-ttu-id="4580a-296">ID</span><span class="sxs-lookup"><span data-stu-id="4580a-296">ID</span></span>       | <span data-ttu-id="4580a-297">ID prodotto (assegnato dal produttore)</span><span class="sxs-lookup"><span data-stu-id="4580a-297">Product ID (assigned by the Manufacturer)</span></span> |
| <span data-ttu-id="4580a-298">12</span><span class="sxs-lookup"><span data-stu-id="4580a-298">12</span></span>     | <span data-ttu-id="4580a-299">bcdDevice</span><span class="sxs-lookup"><span data-stu-id="4580a-299">bcdDevice</span></span>          | <span data-ttu-id="4580a-300">2</span><span class="sxs-lookup"><span data-stu-id="4580a-300">2</span></span>    | <span data-ttu-id="4580a-301">BCD</span><span class="sxs-lookup"><span data-stu-id="4580a-301">BCD</span></span>      | <span data-ttu-id="4580a-302">Numero di rilascio del dispositivo in formato decimale con codifica binaria</span><span class="sxs-lookup"><span data-stu-id="4580a-302">Device release number in binary-coded decimal</span></span> |
| <span data-ttu-id="4580a-303">14</span><span class="sxs-lookup"><span data-stu-id="4580a-303">14</span></span>     | <span data-ttu-id="4580a-304">iManufacturer</span><span class="sxs-lookup"><span data-stu-id="4580a-304">iManufacturer</span></span>      | <span data-ttu-id="4580a-305">1</span><span class="sxs-lookup"><span data-stu-id="4580a-305">1</span></span>    | <span data-ttu-id="4580a-306">Indice</span><span class="sxs-lookup"><span data-stu-id="4580a-306">Index</span></span>    | <span data-ttu-id="4580a-307">Indice del descrittore di stringa che descrive il produttore</span><span class="sxs-lookup"><span data-stu-id="4580a-307">Index of string descriptor describing manufacturer</span></span> |
| <span data-ttu-id="4580a-308">15</span><span class="sxs-lookup"><span data-stu-id="4580a-308">15</span></span>     | <span data-ttu-id="4580a-309">iProduct</span><span class="sxs-lookup"><span data-stu-id="4580a-309">iProduct</span></span>           | <span data-ttu-id="4580a-310">1</span><span class="sxs-lookup"><span data-stu-id="4580a-310">1</span></span>    | <span data-ttu-id="4580a-311">Indice</span><span class="sxs-lookup"><span data-stu-id="4580a-311">Index</span></span>    | <span data-ttu-id="4580a-312">Indice del descrittore di stringa che descrive il prodotto</span><span class="sxs-lookup"><span data-stu-id="4580a-312">Index of string descriptor describing product</span></span> |
| <span data-ttu-id="4580a-313">16</span><span class="sxs-lookup"><span data-stu-id="4580a-313">16</span></span>     | <span data-ttu-id="4580a-314">iSerialNumbe</span><span class="sxs-lookup"><span data-stu-id="4580a-314">iSerialNumbe</span></span>       | <span data-ttu-id="4580a-315">1</span><span class="sxs-lookup"><span data-stu-id="4580a-315">1</span></span>    | <span data-ttu-id="4580a-316">Indice</span><span class="sxs-lookup"><span data-stu-id="4580a-316">Index</span></span>    | <span data-ttu-id="4580a-317">Indice del descrittore di stringa che descrive il numero di serie del dispositivo</span><span class="sxs-lookup"><span data-stu-id="4580a-317">Index of string descriptor describing the device's serial number</span></span> |
| <span data-ttu-id="4580a-318">17</span><span class="sxs-lookup"><span data-stu-id="4580a-318">17</span></span>     | <span data-ttu-id="4580a-319">bNumConfigurations</span><span class="sxs-lookup"><span data-stu-id="4580a-319">bNumConfigurations</span></span> | <span data-ttu-id="4580a-320">1</span><span class="sxs-lookup"><span data-stu-id="4580a-320">1</span></span>    | <span data-ttu-id="4580a-321">Number</span><span class="sxs-lookup"><span data-stu-id="4580a-321">Number</span></span>   | <span data-ttu-id="4580a-322">Numero di configurazioni possibili</span><span class="sxs-lookup"><span data-stu-id="4580a-322">Number of possible configurations</span></span> |

<span data-ttu-id="4580a-323">USBX definisce un descrittore di dispositivo USB nel modo seguente:</span><span class="sxs-lookup"><span data-stu-id="4580a-323">USBX defines a USB device descriptor as follows:</span></span>

```c
typedef struct UX_DEVICE_DESCRIPTOR_STRUCT
{
    UINT      bLength;
    UINT      bDescriptorType;
    USHORT    bcdUSB;
    UINT      bDeviceClass;
    UINT      bDeviceSubClass;
    UINT      bDeviceProtocol;
    UINT      bMaxPacketSize0;
    USHORT    idVendor;
    USHORT    idProduct;
    USHORT    bcdDevice;
    UINT      iManufacturer;
    UINT      iProduct;
    UINT      iSerialNumber;
    UINT      bNumConfigurations;
} UX_DEVICE_DESCRIPTOR;
```

<span data-ttu-id="4580a-324">Il descrittore di dispositivo USB fa parte di un contenitore di dispositivi descritto di seguito:</span><span class="sxs-lookup"><span data-stu-id="4580a-324">The USB device descriptor is part of a device container described as:</span></span>

```c
typedef struct UX_DEVICE_STRUCT
{
    ULONG ux_device_handle;
    ULONG ux_device_type;
    ULONG ux_device_state;
    ULONG ux_device_address;
    ULONG ux_device_speed;
    ULONG ux_device_port_location;
    ULONG ux_device_max_power;
    ULONG ux_device_power_source;
    UINT ux_device_current_configuration;

    TX_SEMAPHORE ux_device_protection_semaphore;
    struct UX_DEVICE_STRUCT *ux_device_parent; 
    struct UX_HOST_CLASS_STRUCT *ux_device_class; 
    VOID *ux_device_class_instance;
    struct UX_HCD_STRUCT *ux_device_hcd;
    struct UX_CONFIGURATION_STRUCT *ux_device_first_configuration; 
    struct UX_DEVICE_STRUCT *ux_device_next_device;
    struct UX_DEVICE_DESCRIPTOR_STRUCT ux_device_descriptor;
    struct UX_ENDPOINT_STRUCT ux_device_control_endpoint;
    struct UX_HUB_TT_STRUCT ux_device_hub_tt[UX_MAX_TT];
} UX_DEVICE;
```

- <span data-ttu-id="4580a-325">**ux_device_handle**: handle del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="4580a-325">**ux_device_handle**: Handle of the device.</span></span> <span data-ttu-id="4580a-326">Si tratta in genere dell'indirizzo dell'istanza di questa struttura per il dispositivo.</span><span class="sxs-lookup"><span data-stu-id="4580a-326">This is typically the address of the instance of this structure for the device.</span></span>
- <span data-ttu-id="4580a-327">**ux_device_type**: valore obsoleto.</span><span class="sxs-lookup"><span data-stu-id="4580a-327">**ux_device_type**: Obsolete value.</span></span> <span data-ttu-id="4580a-328">Non utilizzato.</span><span class="sxs-lookup"><span data-stu-id="4580a-328">Unused.</span></span>
- <span data-ttu-id="4580a-329">**ux_device_state**: stato del dispositivo, che può avere uno dei valori seguenti:</span><span class="sxs-lookup"><span data-stu-id="4580a-329">**ux_device_state**: Device State, which can have one of the following values:</span></span>
    - <span data-ttu-id="4580a-330">**UX_DEVICE_RESET**                0</span><span class="sxs-lookup"><span data-stu-id="4580a-330">**UX_DEVICE_RESET**                0</span></span>
    - <span data-ttu-id="4580a-331">**UX_DEVICE_ATTACHED**             1</span><span class="sxs-lookup"><span data-stu-id="4580a-331">**UX_DEVICE_ATTACHED**             1</span></span>
    - <span data-ttu-id="4580a-332">**UX_DEVICE_ADDRESSED**            2</span><span class="sxs-lookup"><span data-stu-id="4580a-332">**UX_DEVICE_ADDRESSED**            2</span></span>
    - <span data-ttu-id="4580a-333">**UX_DEVICE_CONFIGURED**           3</span><span class="sxs-lookup"><span data-stu-id="4580a-333">**UX_DEVICE_CONFIGURED**           3</span></span>
    - <span data-ttu-id="4580a-334">**UX_DEVICE_SUSPENDED**            4</span><span class="sxs-lookup"><span data-stu-id="4580a-334">**UX_DEVICE_SUSPENDED**            4</span></span>
    - <span data-ttu-id="4580a-335">**UX_DEVICE_RESUMED**              5</span><span class="sxs-lookup"><span data-stu-id="4580a-335">**UX_DEVICE_RESUMED**              5</span></span>
    - <span data-ttu-id="4580a-336">**UX_DEVICE_SELF_POWERED_STATE**   6</span><span class="sxs-lookup"><span data-stu-id="4580a-336">**UX_DEVICE_SELF_POWERED_STATE**   6</span></span>
    - <span data-ttu-id="4580a-337">**UX_DEVICE_SELF_POWERED_STATE**   7</span><span class="sxs-lookup"><span data-stu-id="4580a-337">**UX_DEVICE_SELF_POWERED_STATE**   7</span></span>
    - <span data-ttu-id="4580a-338">**UX_DEVICE_REMOTE_WAKEUP**        8</span><span class="sxs-lookup"><span data-stu-id="4580a-338">**UX_DEVICE_REMOTE_WAKEUP**        8</span></span>
    - <span data-ttu-id="4580a-339">**UX_DEVICE_BUS_RESET_COMPLETED**  9</span><span class="sxs-lookup"><span data-stu-id="4580a-339">**UX_DEVICE_BUS_RESET_COMPLETED**  9</span></span>
    - <span data-ttu-id="4580a-340">**UX_DEVICE_REMOVED**              10</span><span class="sxs-lookup"><span data-stu-id="4580a-340">**UX_DEVICE_REMOVED**              10</span></span>
    - <span data-ttu-id="4580a-341">**UX_DEVICE_FORCE_DISCONNECT**     11</span><span class="sxs-lookup"><span data-stu-id="4580a-341">**UX_DEVICE_FORCE_DISCONNECT**     11</span></span>
- <span data-ttu-id="4580a-342">**ux_device_address**: indirizzo del dispositivo dopo l'accettazione del comando **SET_ADDRESS** (da 1 a 127).</span><span class="sxs-lookup"><span data-stu-id="4580a-342">**ux_device_address**: Address of the device after the **SET_ADDRESS** command has been accepted (from 1 to 127).</span></span>
- <span data-ttu-id="4580a-343">**ux_device_speed**: velocità del dispositivo:</span><span class="sxs-lookup"><span data-stu-id="4580a-343">**ux_device_speed**: Speed of the device:</span></span>
    - <span data-ttu-id="4580a-344">**UX_LOW_SPEED_DEVICE**      0</span><span class="sxs-lookup"><span data-stu-id="4580a-344">**UX_LOW_SPEED_DEVICE**      0</span></span>
    - <span data-ttu-id="4580a-345">**UX_FULL_SPEED_DEVICE**     1</span><span class="sxs-lookup"><span data-stu-id="4580a-345">**UX_FULL_SPEED_DEVICE**     1</span></span>
    - <span data-ttu-id="4580a-346">**UX_HIGH_SPEED_DEVICE**     2</span><span class="sxs-lookup"><span data-stu-id="4580a-346">**UX_HIGH_SPEED_DEVICE**     2</span></span>
- <span data-ttu-id="4580a-347">**ux_device_port_location**: indice della porta del dispositivo padre (hub radice o hub).</span><span class="sxs-lookup"><span data-stu-id="4580a-347">**ux_device_port_location**: Index of the port of the parent device (root hub or hub).</span></span>
- <span data-ttu-id="4580a-348">**ux_device_max_power**: potenza massima in ma che il dispositivo può assumere nella configurazione selezionata.</span><span class="sxs-lookup"><span data-stu-id="4580a-348">**ux_device_max_power**: Maximum power in mA that the device may take in the selected configuration.</span></span>
- <span data-ttu-id="4580a-349">**ux_device_power_source**: può essere uno dei due valori seguenti:</span><span class="sxs-lookup"><span data-stu-id="4580a-349">**ux_device_power_source**: Can be one of the two following values:</span></span>
    - <span data-ttu-id="4580a-350">**UX_DEVICE_BUS_POWERED**     1</span><span class="sxs-lookup"><span data-stu-id="4580a-350">**UX_DEVICE_BUS_POWERED**     1</span></span>
    - <span data-ttu-id="4580a-351">**UX_DEVICE_SELF_POWERED**    2</span><span class="sxs-lookup"><span data-stu-id="4580a-351">**UX_DEVICE_SELF_POWERED**    2</span></span>
- <span data-ttu-id="4580a-352">**ux_device_current_configuration**: indice della configurazione corrente usata dal dispositivo.</span><span class="sxs-lookup"><span data-stu-id="4580a-352">**ux_device_current_configuration**: Index of the current configuration being used by this device.</span></span>
- <span data-ttu-id="4580a-353">**ux_device_parent**: puntatore del contenitore del dispositivo dell'elemento padre del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="4580a-353">**ux_device_parent**: Device container pointer of the parent of this device.</span></span> <span data-ttu-id="4580a-354">Se il puntatore è null, l'elemento padre è l'hub radice del controller.</span><span class="sxs-lookup"><span data-stu-id="4580a-354">If the pointer is null, the parent is the root hub of the controller.</span></span>
- <span data-ttu-id="4580a-355">**ux_device_class**: puntatore al tipo di classe proprietario del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="4580a-355">**ux_device_class**: Pointer to the class type that owns this device.</span></span>
- <span data-ttu-id="4580a-356">**ux_device_class_instance**: puntatore all'istanza della classe proprietaria del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="4580a-356">**ux_device_class_instance**: Pointer to the instance of the class that owns this device.</span></span>
- <span data-ttu-id="4580a-357">**ux_device_hcd**: istanza del controller host USB a cui è collegato il dispositivo.</span><span class="sxs-lookup"><span data-stu-id="4580a-357">**ux_device_hcd**: USB Host Controller Instance where this device is attached.</span></span>
- <span data-ttu-id="4580a-358">**ux_device_first_configuration**: puntatore al primo contenitore di configurazione per il dispositivo.</span><span class="sxs-lookup"><span data-stu-id="4580a-358">**ux_device_first_configuration**: Pointer to the first configuration container for this device.</span></span>
- <span data-ttu-id="4580a-359">**ux_device_next_device**: puntatore al dispositivo successivo nell'elenco del dispositivo su uno dei bus rilevati da USBX.</span><span class="sxs-lookup"><span data-stu-id="4580a-359">**ux_device_next_device**: Pointer to the next device in the list of device on any of the buses detected by USBX.</span></span>
- <span data-ttu-id="4580a-360">**ux_device_descriptor**: descrittore dispositivo USB.</span><span class="sxs-lookup"><span data-stu-id="4580a-360">**ux_device_descriptor**: USB device descriptor.</span></span>
- <span data-ttu-id="4580a-361">**ux_device_control_endpoint**: descrittore dell'endpoint di controllo predefinito usato dal dispositivo.</span><span class="sxs-lookup"><span data-stu-id="4580a-361">**ux_device_control_endpoint**: Descriptor of the default control endpoint used by this device.</span></span>
- <span data-ttu-id="4580a-362">**ux_device_hub_tt**: matrice di TTs dell'hub per il dispositivo</span><span class="sxs-lookup"><span data-stu-id="4580a-362">**ux_device_hub_tt**: Array of Hub TTs for the device</span></span>

### <a name="configuration-descriptors"></a><span data-ttu-id="4580a-363">Descrittori di configurazione</span><span class="sxs-lookup"><span data-stu-id="4580a-363">Configuration Descriptors</span></span>

<span data-ttu-id="4580a-364">Il descrittore di configurazione descrive le informazioni sulla configurazione di un dispositivo specifico.</span><span class="sxs-lookup"><span data-stu-id="4580a-364">The configuration descriptor describes information about a specific device configuration.</span></span> <span data-ttu-id="4580a-365">Un dispositivo USB può contenere uno o più descrittori di configurazione.</span><span class="sxs-lookup"><span data-stu-id="4580a-365">A USB device may contain one or more configuration descriptors.</span></span> <span data-ttu-id="4580a-366">Il campo **bNumConfigurations** nel descrittore del dispositivo indica il numero di descrittori di configurazione.</span><span class="sxs-lookup"><span data-stu-id="4580a-366">The **bNumConfigurations** field in the device descriptor indicates the number of configuration descriptors.</span></span> <span data-ttu-id="4580a-367">Il descrittore contiene un campo **bConfigurationValue** con un valore che, se usato come parametro della richiesta di configurazione set, fa in modo che il dispositivo assuma la configurazione descritta.</span><span class="sxs-lookup"><span data-stu-id="4580a-367">The descriptor contains a **bConfigurationValue** field with a value that, when used as a parameter to the Set Configuration request, causes the device to assume the described configuration.</span></span>

<span data-ttu-id="4580a-368">Il descrittore descrive il numero di interfacce fornite dalla configurazione.</span><span class="sxs-lookup"><span data-stu-id="4580a-368">The descriptor describes the number of interfaces provided by the configuration.</span></span> <span data-ttu-id="4580a-369">Ogni interfaccia rappresenta una funzione logica all'interno del dispositivo e può funzionare in modo indipendente.</span><span class="sxs-lookup"><span data-stu-id="4580a-369">Each interface represents a logical function within the device and may operate independently.</span></span> <span data-ttu-id="4580a-370">Ad esempio, un altoparlante audio USB può avere tre interfacce, una per lo streaming audio, una per il controllo audio e un'interfaccia nascosta per gestire i pulsanti dell'altoparlante.</span><span class="sxs-lookup"><span data-stu-id="4580a-370">For instance a USB audio speaker may have three interfaces, one for audio streaming, one for audio control, and one HID interface to manage the speaker's buttons.</span></span>

<span data-ttu-id="4580a-371">Quando l'host emette una richiesta GET_DESCRIPTOR per il descrittore della configurazione, vengono restituiti tutti i descrittori di interfaccia e di endpoint correlati.</span><span class="sxs-lookup"><span data-stu-id="4580a-371">When the host issues a GET_DESCRIPTOR request for the configuration descriptor, all related interface and endpoint descriptors are returned.</span></span>

| <span data-ttu-id="4580a-372">Offset</span><span class="sxs-lookup"><span data-stu-id="4580a-372">Offset</span></span> | <span data-ttu-id="4580a-373">Campo</span><span class="sxs-lookup"><span data-stu-id="4580a-373">Field</span></span>               | <span data-ttu-id="4580a-374">Dimensione</span><span class="sxs-lookup"><span data-stu-id="4580a-374">Size</span></span> | <span data-ttu-id="4580a-375">Valore</span><span class="sxs-lookup"><span data-stu-id="4580a-375">Value</span></span>    | <span data-ttu-id="4580a-376">Descrizione</span><span class="sxs-lookup"><span data-stu-id="4580a-376">Description</span></span>                       |
| ------ | ------------------- | ---- | -------- | --------------------------------- |
| <span data-ttu-id="4580a-377">0</span><span class="sxs-lookup"><span data-stu-id="4580a-377">0</span></span>      | <span data-ttu-id="4580a-378">bLength</span><span class="sxs-lookup"><span data-stu-id="4580a-378">bLength</span></span>             | <span data-ttu-id="4580a-379">1</span><span class="sxs-lookup"><span data-stu-id="4580a-379">1</span></span>    | <span data-ttu-id="4580a-380">Number</span><span class="sxs-lookup"><span data-stu-id="4580a-380">Number</span></span>   | <span data-ttu-id="4580a-381">Dimensioni in byte del descrittore.</span><span class="sxs-lookup"><span data-stu-id="4580a-381">Size of this descriptor in bytes.</span></span> |
| <span data-ttu-id="4580a-382">1</span><span class="sxs-lookup"><span data-stu-id="4580a-382">1</span></span>      | <span data-ttu-id="4580a-383">bDescriptorType</span><span class="sxs-lookup"><span data-stu-id="4580a-383">bDescriptorType</span></span>     | <span data-ttu-id="4580a-384">1</span><span class="sxs-lookup"><span data-stu-id="4580a-384">1</span></span>    | <span data-ttu-id="4580a-385">Costante</span><span class="sxs-lookup"><span data-stu-id="4580a-385">Constant</span></span> | <span data-ttu-id="4580a-386">CONFIGURATION</span><span class="sxs-lookup"><span data-stu-id="4580a-386">CONFIGURATION</span></span>                     |
| <span data-ttu-id="4580a-387">2</span><span class="sxs-lookup"><span data-stu-id="4580a-387">2</span></span>      | <span data-ttu-id="4580a-388">wTotalLength</span><span class="sxs-lookup"><span data-stu-id="4580a-388">wTotalLength</span></span>        | <span data-ttu-id="4580a-389">2</span><span class="sxs-lookup"><span data-stu-id="4580a-389">2</span></span>    | <span data-ttu-id="4580a-390">Number</span><span class="sxs-lookup"><span data-stu-id="4580a-390">Number</span></span>   | <span data-ttu-id="4580a-391">Lunghezza totale dei dati restituiti per questa configurazione.</span><span class="sxs-lookup"><span data-stu-id="4580a-391">Total length of data returned for this configuration.</span></span> <span data-ttu-id="4580a-392">Include la lunghezza combinata di tutti i descrittori (configurazione, interfaccia, endpoint e classe o specifico del fornitore) restituiti per questa configurazione.</span><span class="sxs-lookup"><span data-stu-id="4580a-392">Includes the combined length of all descriptors (configuration, interface, endpoint, and class or vendor specific) returned for this configuration.</span></span> |
| <span data-ttu-id="4580a-393">4</span><span class="sxs-lookup"><span data-stu-id="4580a-393">4</span></span>      | <span data-ttu-id="4580a-394">bNumInterfaces</span><span class="sxs-lookup"><span data-stu-id="4580a-394">bNumInterfaces</span></span>      | <span data-ttu-id="4580a-395">1</span><span class="sxs-lookup"><span data-stu-id="4580a-395">1</span></span>    | <span data-ttu-id="4580a-396">Number</span><span class="sxs-lookup"><span data-stu-id="4580a-396">Number</span></span>   | <span data-ttu-id="4580a-397">Numero di interfacce supportate da questa configurazione.</span><span class="sxs-lookup"><span data-stu-id="4580a-397">Number of interfaces supported by this configuration.</span></span> |
| <span data-ttu-id="4580a-398">5</span><span class="sxs-lookup"><span data-stu-id="4580a-398">5</span></span>      | <span data-ttu-id="4580a-399">bConfigurationValue</span><span class="sxs-lookup"><span data-stu-id="4580a-399">bConfigurationValue</span></span> | <span data-ttu-id="4580a-400">1</span><span class="sxs-lookup"><span data-stu-id="4580a-400">1</span></span>    | <span data-ttu-id="4580a-401">Number</span><span class="sxs-lookup"><span data-stu-id="4580a-401">Number</span></span>   | <span data-ttu-id="4580a-402">Valore da usare come argomento da impostare</span><span class="sxs-lookup"><span data-stu-id="4580a-402">Value to use as an argument to Set</span></span><br/><span data-ttu-id="4580a-403">Configurazione per selezionare questa configurazione.</span><span class="sxs-lookup"><span data-stu-id="4580a-403">Configuration to select this configuration.</span></span> |
| <span data-ttu-id="4580a-404">6</span><span class="sxs-lookup"><span data-stu-id="4580a-404">6</span></span>      | <span data-ttu-id="4580a-405">iConfiguration</span><span class="sxs-lookup"><span data-stu-id="4580a-405">iConfiguration</span></span>      | <span data-ttu-id="4580a-406">1</span><span class="sxs-lookup"><span data-stu-id="4580a-406">1</span></span>    | <span data-ttu-id="4580a-407">Indice</span><span class="sxs-lookup"><span data-stu-id="4580a-407">Index</span></span>    | <span data-ttu-id="4580a-408">Indice del descrittore di stringa che descrive questa configurazione.</span><span class="sxs-lookup"><span data-stu-id="4580a-408">Index of string descriptor describing this configuration.</span></span> |
| <span data-ttu-id="4580a-409">7</span><span class="sxs-lookup"><span data-stu-id="4580a-409">7</span></span>      | <span data-ttu-id="4580a-410">bMAttributes</span><span class="sxs-lookup"><span data-stu-id="4580a-410">bMAttributes</span></span>        | <span data-ttu-id="4580a-411">1</span><span class="sxs-lookup"><span data-stu-id="4580a-411">1</span></span>    | <span data-ttu-id="4580a-412">Bitmap</span><span class="sxs-lookup"><span data-stu-id="4580a-412">Bitmap</span></span>   | <span data-ttu-id="4580a-413">Caratteristiche di configurazione del bus D7 con tecnologia</span><span class="sxs-lookup"><span data-stu-id="4580a-413">Configuration characteristics D7 Bus Powered</span></span><br /><span data-ttu-id="4580a-414">D6 auto alimentato</span><span class="sxs-lookup"><span data-stu-id="4580a-414">D6 Self Powered</span></span><br /><span data-ttu-id="4580a-415">Riattivazione remota D5</span><span class="sxs-lookup"><span data-stu-id="4580a-415">D5 Remote Wakeup</span></span><br /><span data-ttu-id="4580a-416">D4.. 0 riservato (Reimposta su 0)</span><span class="sxs-lookup"><span data-stu-id="4580a-416">D4..0 Reserved (reset to 0)</span></span><br /><span data-ttu-id="4580a-417">Una configurazione del dispositivo che usa l'alimentazione dal bus e un'origine locale imposta sia D7 che D6.</span><span class="sxs-lookup"><span data-stu-id="4580a-417">A device configuration that uses power from the bus and a local source sets both D7 and D6.</span></span> <span data-ttu-id="4580a-418">La fonte di alimentazione effettiva in fase di esecuzione può essere determinata usando la richiesta Get status Device.</span><span class="sxs-lookup"><span data-stu-id="4580a-418">The actual power source at runtime may be determined using the Get Status device request.</span></span><br /><span data-ttu-id="4580a-419">Se una configurazione del dispositivo supporta la riattivazione remota, D5 è impostato su 1.</span><span class="sxs-lookup"><span data-stu-id="4580a-419">If a device configuration supports remote wakeup, D5 is set to 1.</span></span> |
| <span data-ttu-id="4580a-420">8</span><span class="sxs-lookup"><span data-stu-id="4580a-420">8</span></span>      | <span data-ttu-id="4580a-421">MaxPower</span><span class="sxs-lookup"><span data-stu-id="4580a-421">MaxPower</span></span>            | <span data-ttu-id="4580a-422">1</span><span class="sxs-lookup"><span data-stu-id="4580a-422">1</span></span>    | <span data-ttu-id="4580a-423">mA</span><span class="sxs-lookup"><span data-stu-id="4580a-423">mA</span></span>       | <span data-ttu-id="4580a-424">Consumo di energia massimo del dispositivo USB dal bus in questa configurazione specifica quando il dispositivo è completamente operativo.</span><span class="sxs-lookup"><span data-stu-id="4580a-424">Maximum power consumption of USB device from the bus in this specific configuration when the device is fully operational.</span></span><br /><span data-ttu-id="4580a-425">Espressa in unità di 2 mA (ad esempio, 50 = 100 mA).</span><span class="sxs-lookup"><span data-stu-id="4580a-425">Expressed in 2 mA units (e.g., 50 = 100 mA).</span></span><br /><span data-ttu-id="4580a-426">Nota: una configurazione del dispositivo segnala se la configurazione è basata su bus o auto-alimentato.</span><span class="sxs-lookup"><span data-stu-id="4580a-426">Note: A device configuration reports whether the configuration is bus-powered or self-powered.</span></span><br /><span data-ttu-id="4580a-427">Lo stato del dispositivo segnala se il dispositivo è attualmente autoalimentato.</span><span class="sxs-lookup"><span data-stu-id="4580a-427">Device status reports whether the device is currently self-powered.</span></span> <span data-ttu-id="4580a-428">Se un dispositivo è disconnesso dalla fonte di alimentazione esterna, aggiorna lo stato del dispositivo per indicare che non è più autoalimentato.</span><span class="sxs-lookup"><span data-stu-id="4580a-428">If a device is disconnected from its external power source, it updates device status to indicate that it is no longer self-powered.</span></span> |

<span data-ttu-id="4580a-429">USBX definisce un descrittore di configurazione USB come indicato di seguito.</span><span class="sxs-lookup"><span data-stu-id="4580a-429">USBX defines a USB configuration descriptor as follows.</span></span>

```c
typedef struct UX_CONFIGURATION_DESCRIPTOR_STRUCT
{
    UINT bLength;
    UINT bDescriptorType;
    USHORT wTotalLength;
    UINT bNumInterfaces;
    UINT bConfigurationValue;
    UINT iConfiguration;
    UINT bmAttributes;
    UINT MaxPower;
} UX_CONFIGURATION_DESCRIPTOR;
```

<span data-ttu-id="4580a-430">Il descrittore di configurazione USB fa parte di un contenitore di configurazione descritto come illustrato di seguito.</span><span class="sxs-lookup"><span data-stu-id="4580a-430">The USB configuration descriptor is part of a configuration container described as shown below.</span></span>

```c
typedef struct UX_CONFIGURATION_STRUCT
{
    ULONG ux_configuration_handle;
    ULONG ux_configuration_state;
    struct UX_CONFIGURATION_DESCRIPTOR_STRUCT ux_configuration_descriptor;
    struct UX_INTERFACE_STRUCT *ux_configuration_first_interface;
    struct UX_CONFIGURATION_STRUCT *ux_configuration_next_configuration;
    struct UX_DEVICE_STRUCT *ux_configuration_device;
} UX_CONFIGURATION;
```

- <span data-ttu-id="4580a-431">**ux_configuration_handle**: handle della configurazione.</span><span class="sxs-lookup"><span data-stu-id="4580a-431">**ux_configuration_handle**: Handle of the configuration.</span></span> <span data-ttu-id="4580a-432">Si tratta in genere dell'indirizzo dell'istanza di questa struttura per la configurazione.</span><span class="sxs-lookup"><span data-stu-id="4580a-432">This is typically the address of the instance of this structure for the configuration.</span></span>
- <span data-ttu-id="4580a-433">**ux_configuration_state**: stato della configurazione.</span><span class="sxs-lookup"><span data-stu-id="4580a-433">**ux_configuration_state**: State of the configuration.</span></span>
- <span data-ttu-id="4580a-434">**ux_configuration_descriptor**: descrittore dispositivo USB.</span><span class="sxs-lookup"><span data-stu-id="4580a-434">**ux_configuration_descriptor**: USB device descriptor.</span></span>
- <span data-ttu-id="4580a-435">**ux_configuration_first_interface**: puntatore alla prima interfaccia per questa configurazione.</span><span class="sxs-lookup"><span data-stu-id="4580a-435">**ux_configuration_first_interface**: Pointer to the first interface for this configuration.</span></span>
- <span data-ttu-id="4580a-436">**ux_configuration_next_configuration**: puntatore alla configurazione successiva per lo stesso dispositivo.</span><span class="sxs-lookup"><span data-stu-id="4580a-436">**ux_configuration_next_configuration**: Pointer to the next configuration for the same device.</span></span>
- <span data-ttu-id="4580a-437">**ux_configuration_device**: puntatore al proprietario del dispositivo di questa configurazione.</span><span class="sxs-lookup"><span data-stu-id="4580a-437">**ux_configuration_device**: Pointer to the device owner of this configuration.</span></span>

### <a name="interface-descriptors"></a><span data-ttu-id="4580a-438">Descrittori di interfaccia</span><span class="sxs-lookup"><span data-stu-id="4580a-438">Interface Descriptors</span></span>

<span data-ttu-id="4580a-439">Il descrittore di interfaccia descrive un'interfaccia specifica all'interno di una configurazione.</span><span class="sxs-lookup"><span data-stu-id="4580a-439">The interface descriptor describes a specific interface within a configuration.</span></span> <span data-ttu-id="4580a-440">Un'interfaccia è una funzione logica all'interno di un dispositivo USB.</span><span class="sxs-lookup"><span data-stu-id="4580a-440">An interface is a logical function within a USB device.</span></span> <span data-ttu-id="4580a-441">Una configurazione fornisce una o più interfacce, ognuna con zero o più descrittori di endpoint che descrivono un set univoco di endpoint all'interno della configurazione.</span><span class="sxs-lookup"><span data-stu-id="4580a-441">A configuration provides one or more interfaces, each with zero or more endpoint descriptors describing a unique set of endpoints within the configuration.</span></span> <span data-ttu-id="4580a-442">Quando una configurazione supporta più interfacce, i descrittori di endpoint per una determinata interfaccia seguono il descrittore di interfaccia nei dati restituiti dalla richiesta **GET_DESCRIPTOR** per la configurazione specificata.</span><span class="sxs-lookup"><span data-stu-id="4580a-442">When a configuration supports more than one interface, the endpoint descriptors for a particular interface follow the interface descriptor in the data returned by the **GET_DESCRIPTOR** request for the specified configuration.</span></span>

<span data-ttu-id="4580a-443">Un descrittore di interfaccia viene sempre restituito come parte di un descrittore di configurazione.</span><span class="sxs-lookup"><span data-stu-id="4580a-443">An interface descriptor is always returned as part of a configuration descriptor.</span></span> <span data-ttu-id="4580a-444">Non è possibile accedere direttamente a un descrittore di interfaccia tramite una richiesta GET_DESCRIPTOR.</span><span class="sxs-lookup"><span data-stu-id="4580a-444">An interface descriptor cannot be directly access by a GET_DESCRIPTOR request.</span></span>

<span data-ttu-id="4580a-445">Un'interfaccia può includere impostazioni alternative che consentono di variare gli endpoint e/o le relative caratteristiche dopo la configurazione del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="4580a-445">An interface may include alternate settings that allow the endpoints and/or their characteristics to be varied after the device has been configured.</span></span> <span data-ttu-id="4580a-446">L'impostazione predefinita per un'interfaccia è sempre un'impostazione alternativa zero.</span><span class="sxs-lookup"><span data-stu-id="4580a-446">The default setting for an interface is always alternate setting zero.</span></span> <span data-ttu-id="4580a-447">Una classe può scegliere di modificare l'impostazione alternativa corrente per modificare il comportamento dell'interfaccia e le caratteristiche degli endpoint associati.</span><span class="sxs-lookup"><span data-stu-id="4580a-447">A class can select to change the current alternate setting to change the interface behavior and the characteristics of the associated endpoints.</span></span> <span data-ttu-id="4580a-448">La richiesta SET_INTERFACE viene utilizzata per selezionare un'impostazione alternativa o per tornare all'impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="4580a-448">The SET_INTERFACE request is used to select an alternate setting or to return to the default setting.</span></span>

<span data-ttu-id="4580a-449">Le impostazioni alternative consentono di variare una parte della configurazione del dispositivo mentre le altre interfacce restano in funzione.</span><span class="sxs-lookup"><span data-stu-id="4580a-449">Alternate settings allow a portion of the device configuration to be varied while other interfaces remain in operation.</span></span> <span data-ttu-id="4580a-450">Se una configurazione presenta impostazioni alternative per una o più delle relative interfacce, per ogni impostazione viene incluso un descrittore di interfaccia separato e gli endpoint associati.</span><span class="sxs-lookup"><span data-stu-id="4580a-450">If a configuration has alternate settings for one or more of its interfaces, a separate interface descriptor and its associated endpoints are included for each setting.</span></span>

<span data-ttu-id="4580a-451">Se una configurazione del dispositivo contiene una singola interfaccia con due impostazioni alternative, la richiesta GET_DESCRIPTOR per la configurazione restituisce il descrittore di configurazione, quindi il descrittore di interfaccia con i campi **bInterfaceNumber** e **bAlternateSetting** impostati su zero e quindi i descrittori dell'endpoint per tale impostazione, seguiti da un altro descrittore di interfaccia e i descrittori di endpoint associati.</span><span class="sxs-lookup"><span data-stu-id="4580a-451">If a device configuration contains a single interface with two alternate settings, the GET_DESCRIPTOR request for the configuration would return the configuration descriptor, then the interface descriptor with the **bInterfaceNumber** and **bAlternateSetting** fields set to zero and then the endpoint descriptors for that setting, followed by another interface descriptor and its associated endpoint descriptors.</span></span> <span data-ttu-id="4580a-452">Anche il campo **bInterfaceNumber** del secondo descrittore di interfaccia verrà impostato su zero, ma il campo **bAlternateSetting** del secondo descrittore di interfaccia verrà impostato su 1 per indicare che questa impostazione alternativa appartiene alla prima interfaccia.</span><span class="sxs-lookup"><span data-stu-id="4580a-452">The second interface descriptor's **bInterfaceNumber** field would also be set to zero, but the **bAlternateSetting** field of the second interface descriptor would be set to 1 indicating that this alternate setting belongs to the first interface.</span></span>

<span data-ttu-id="4580a-453">A un'interfaccia non possono essere associati endpoint, nel qual caso solo l'endpoint di controllo predefinito è valido per tale interfaccia.</span><span class="sxs-lookup"><span data-stu-id="4580a-453">An interface may not have any endpoints associated with it, in which case only the default control endpoint is valid for that interface.</span></span>

<span data-ttu-id="4580a-454">Le impostazioni alternative vengono utilizzate principalmente per modificare la larghezza di banda richiesta per gli endpoint periodici associati all'interfaccia.</span><span class="sxs-lookup"><span data-stu-id="4580a-454">Alternate settings are used mainly to change the requested bandwidth for periodic endpoints associated with the interface.</span></span> <span data-ttu-id="4580a-455">Ad esempio, un'interfaccia di streaming di altoparlanti USB deve avere la prima impostazione alternativa con una richiesta di larghezza di banda 0 sul relativo endpoint isocrono.</span><span class="sxs-lookup"><span data-stu-id="4580a-455">For example, a USB speaker streaming interface should have the first alternate setting with a 0 bandwidth demand on its isochronous endpoint.</span></span> <span data-ttu-id="4580a-456">Altre impostazioni alternative possono selezionare requisiti di larghezza di banda diversi a seconda della frequenza di streaming audio.</span><span class="sxs-lookup"><span data-stu-id="4580a-456">Other alternate settings may select different bandwidth requirements depending on the audio streaming frequency.</span></span>

<span data-ttu-id="4580a-457">Il descrittore USB per l'interfaccia è il seguente:</span><span class="sxs-lookup"><span data-stu-id="4580a-457">The USB descriptor for the interface is as follows:</span></span>

| <span data-ttu-id="4580a-458">Offset</span><span class="sxs-lookup"><span data-stu-id="4580a-458">Offset</span></span> | <span data-ttu-id="4580a-459">Campo</span><span class="sxs-lookup"><span data-stu-id="4580a-459">Field</span></span>              | <span data-ttu-id="4580a-460">Dimensione</span><span class="sxs-lookup"><span data-stu-id="4580a-460">Size</span></span> | <span data-ttu-id="4580a-461">Valore</span><span class="sxs-lookup"><span data-stu-id="4580a-461">Value</span></span>     | <span data-ttu-id="4580a-462">Descrittore</span><span class="sxs-lookup"><span data-stu-id="4580a-462">Descriptor</span></span>                              |
| ------ | ------------------ | ---- | --------- | --------------------------------------- |
| <span data-ttu-id="4580a-463">0</span><span class="sxs-lookup"><span data-stu-id="4580a-463">0</span></span>      | <span data-ttu-id="4580a-464">bLength</span><span class="sxs-lookup"><span data-stu-id="4580a-464">bLength</span></span>            | <span data-ttu-id="4580a-465">1</span><span class="sxs-lookup"><span data-stu-id="4580a-465">1</span></span>    | <span data-ttu-id="4580a-466">Number</span><span class="sxs-lookup"><span data-stu-id="4580a-466">Number</span></span>    | <span data-ttu-id="4580a-467">Dimensioni in byte del descrittore.</span><span class="sxs-lookup"><span data-stu-id="4580a-467">Size of this descriptor in bytes.</span></span>       |
| <span data-ttu-id="4580a-468">1</span><span class="sxs-lookup"><span data-stu-id="4580a-468">1</span></span>      | <span data-ttu-id="4580a-469">bDescriptorType</span><span class="sxs-lookup"><span data-stu-id="4580a-469">bDescriptorType</span></span>    | <span data-ttu-id="4580a-470">1</span><span class="sxs-lookup"><span data-stu-id="4580a-470">1</span></span>    | <span data-ttu-id="4580a-471">Costante</span><span class="sxs-lookup"><span data-stu-id="4580a-471">Constant</span></span>  | <span data-ttu-id="4580a-472">Tipo di descrittore di interfaccia</span><span class="sxs-lookup"><span data-stu-id="4580a-472">INTERFACE Descriptor Type</span></span>               |
| <span data-ttu-id="4580a-473">2</span><span class="sxs-lookup"><span data-stu-id="4580a-473">2</span></span>      | <span data-ttu-id="4580a-474">bInterfaceNumber</span><span class="sxs-lookup"><span data-stu-id="4580a-474">bInterfaceNumber</span></span>   | <span data-ttu-id="4580a-475">1</span><span class="sxs-lookup"><span data-stu-id="4580a-475">1</span></span>    | <span data-ttu-id="4580a-476">Number</span><span class="sxs-lookup"><span data-stu-id="4580a-476">Number</span></span>    | <span data-ttu-id="4580a-477">Numero di interfaccia.</span><span class="sxs-lookup"><span data-stu-id="4580a-477">Number of interface.</span></span> <span data-ttu-id="4580a-478">Valore in base zero che identifica l'indice nella matrice di interfacce simultanee supportate da questa configurazione.</span><span class="sxs-lookup"><span data-stu-id="4580a-478">Zero-based value identifying the index in the array of concurrent interfaces supported by this configuration.</span></span> |
| <span data-ttu-id="4580a-479">3</span><span class="sxs-lookup"><span data-stu-id="4580a-479">3</span></span>      | <span data-ttu-id="4580a-480">bAltenateSetting</span><span class="sxs-lookup"><span data-stu-id="4580a-480">bAltenateSetting</span></span>   | <span data-ttu-id="4580a-481">1</span><span class="sxs-lookup"><span data-stu-id="4580a-481">1</span></span>    | <span data-ttu-id="4580a-482">Number</span><span class="sxs-lookup"><span data-stu-id="4580a-482">Number</span></span>    | <span data-ttu-id="4580a-483">Valore utilizzato per selezionare l'impostazione alternativa per l'interfaccia identificata nel campo precedente.</span><span class="sxs-lookup"><span data-stu-id="4580a-483">Value used to select alternate setting for the interface identified in the prior field.</span></span> |
| <span data-ttu-id="4580a-484">4</span><span class="sxs-lookup"><span data-stu-id="4580a-484">4</span></span>      | <span data-ttu-id="4580a-485">bNumEndpoints</span><span class="sxs-lookup"><span data-stu-id="4580a-485">bNumEndpoints</span></span>      | <span data-ttu-id="4580a-486">1</span><span class="sxs-lookup"><span data-stu-id="4580a-486">1</span></span>    | <span data-ttu-id="4580a-487">Number</span><span class="sxs-lookup"><span data-stu-id="4580a-487">Number</span></span>    | <span data-ttu-id="4580a-488">Numero di endpoint utilizzati da questa interfaccia (escluso l'endpoint zero).</span><span class="sxs-lookup"><span data-stu-id="4580a-488">Number of endpoints used by this interface (excluding endpoint zero).</span></span> <span data-ttu-id="4580a-489">Se questo valore è 0, questa interfaccia usa solo l'endpoint zero.</span><span class="sxs-lookup"><span data-stu-id="4580a-489">If this value is 0, this interface only uses endpoint zero.</span></span> |
| <span data-ttu-id="4580a-490">5</span><span class="sxs-lookup"><span data-stu-id="4580a-490">5</span></span>      | <span data-ttu-id="4580a-491">bInterfaceClass</span><span class="sxs-lookup"><span data-stu-id="4580a-491">bInterfaceClass</span></span>    | <span data-ttu-id="4580a-492">1</span><span class="sxs-lookup"><span data-stu-id="4580a-492">1</span></span>    | <span data-ttu-id="4580a-493">Classe</span><span class="sxs-lookup"><span data-stu-id="4580a-493">Class</span></span>     | <span data-ttu-id="4580a-494">Codice di classe (assegnato da USB)</span><span class="sxs-lookup"><span data-stu-id="4580a-494">Class code (assigned by USB)</span></span><br /><span data-ttu-id="4580a-495">Se questo campo viene reimpostato su 0, l'interfaccia non appartiene ad alcuna classe di dispositivo USB specificata.</span><span class="sxs-lookup"><span data-stu-id="4580a-495">If this field is reset to 0, the interface does not belong to any USB specified device class.</span></span><br /><span data-ttu-id="4580a-496">Se questo campo è impostato su 0xFF, la classe di interfaccia è specifica del fornitore.</span><span class="sxs-lookup"><span data-stu-id="4580a-496">If this field is set to 0xFF, the interface class is vendor specific.</span></span><br /><span data-ttu-id="4580a-497">Tutti gli altri valori sono riservati per l'assegnazione tramite USB.</span><span class="sxs-lookup"><span data-stu-id="4580a-497">All other values are reserved for assignment by USB.</span></span> |
| <span data-ttu-id="4580a-498">6</span><span class="sxs-lookup"><span data-stu-id="4580a-498">6</span></span>      | <span data-ttu-id="4580a-499">bInterfaceSubClass</span><span class="sxs-lookup"><span data-stu-id="4580a-499">bInterfaceSubClass</span></span> | <span data-ttu-id="4580a-500">1</span><span class="sxs-lookup"><span data-stu-id="4580a-500">1</span></span>    | <span data-ttu-id="4580a-501">Sottoclasse</span><span class="sxs-lookup"><span data-stu-id="4580a-501">SubClass</span></span>  | <span data-ttu-id="4580a-502">Codice di sottoclasse (assegnato da USB).</span><span class="sxs-lookup"><span data-stu-id="4580a-502">Subclass code (assigned by USB).</span></span><br /><span data-ttu-id="4580a-503">Questi codici sono qualificati dal valore del campo bInterfaceClass.</span><span class="sxs-lookup"><span data-stu-id="4580a-503">These codes are qualified by the value of the bInterfaceClass field.</span></span> <span data-ttu-id="4580a-504">Se il campo bInterfaceClass viene reimpostato su 0, è necessario reimpostare anche questo campo su 0.</span><span class="sxs-lookup"><span data-stu-id="4580a-504">If the bInterfaceClass field is reset to 0, this field must also be reset to 0.</span></span> <span data-ttu-id="4580a-505">Se il campo bInterfaceClass non è impostato su 0xFF, tutti i valori sono riservati per l'assegnazione tramite USB.</span><span class="sxs-lookup"><span data-stu-id="4580a-505">If the bInterfaceClass field is not set to 0xFF, all values are reserved for assignment by USB.</span></span> |
| <span data-ttu-id="4580a-506">7</span><span class="sxs-lookup"><span data-stu-id="4580a-506">7</span></span>      | <span data-ttu-id="4580a-507">bInterfaceProtocol</span><span class="sxs-lookup"><span data-stu-id="4580a-507">bInterfaceProtocol</span></span> | <span data-ttu-id="4580a-508">1</span><span class="sxs-lookup"><span data-stu-id="4580a-508">1</span></span>    | <span data-ttu-id="4580a-509">Protocollo</span><span class="sxs-lookup"><span data-stu-id="4580a-509">Protocol</span></span>  | <span data-ttu-id="4580a-510">Codice del protocollo (assegnato da USB).</span><span class="sxs-lookup"><span data-stu-id="4580a-510">Protocol code (assigned by USB).</span></span> <span data-ttu-id="4580a-511">Questi codici sono qualificati dal valore dei campi bInterfaceClass e bInterfaceSubClass.</span><span class="sxs-lookup"><span data-stu-id="4580a-511">These codes are qualified by the value of the bInterfaceClass and the bInterfaceSubClass fields.</span></span> <span data-ttu-id="4580a-512">Se un'interfaccia supporta richieste specifiche della classe, questo codice identifica i protocolli usati dal dispositivo come definito dalla specifica della classe del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="4580a-512">If an interface supports class-specific requests, this code identifies the protocols that the device uses as defined by the specification of the device class.</span></span><br /><span data-ttu-id="4580a-513">Se questo campo viene reimpostato su 0, il dispositivo non usa un protocollo specifico della classe su questa interfaccia.</span><span class="sxs-lookup"><span data-stu-id="4580a-513">If this field is reset to 0, the device does not use a class specific protocol on this interface.</span></span> <span data-ttu-id="4580a-514">Se questo campo è impostato su 0xFF, il dispositivo utilizza un protocollo specifico del fornitore per questa interfaccia.</span><span class="sxs-lookup"><span data-stu-id="4580a-514">If this field is set to 0xFF, the device uses a vendor specific protocol for this interface.</span></span> |
| <span data-ttu-id="4580a-515">8</span><span class="sxs-lookup"><span data-stu-id="4580a-515">8</span></span>      | <span data-ttu-id="4580a-516">iInterface</span><span class="sxs-lookup"><span data-stu-id="4580a-516">iInterface</span></span>         | <span data-ttu-id="4580a-517">1</span><span class="sxs-lookup"><span data-stu-id="4580a-517">1</span></span>    | <span data-ttu-id="4580a-518">Indice</span><span class="sxs-lookup"><span data-stu-id="4580a-518">Index</span></span>     | <span data-ttu-id="4580a-519">Indice del descrittore di stringa che descrive questa interfaccia.</span><span class="sxs-lookup"><span data-stu-id="4580a-519">Index of string descriptor describing this interface.</span></span> |

<span data-ttu-id="4580a-520">USBX definisce un descrittore di interfaccia USB come indicato di seguito.</span><span class="sxs-lookup"><span data-stu-id="4580a-520">USBX defines a USB interface descriptor as follows.</span></span>

```c
typedef struct UX_INTERFACE_DESCRIPTOR_STRUCT
{
    UINT bLength;
    UINT bDescriptorType;
    UINT bInterfaceNumber;
    UINT bAlternateSetting;
    UINT bNumEndpoints;
    UINT bInterfaceClass
    UINT bInterfaceSubClass;
    UINT bInterfaceProtocol;
    UINT iInterface;
} UX_INTERFACE_DESCRIPTOR;
```

<span data-ttu-id="4580a-521">Il descrittore dell'interfaccia USB fa parte di un contenitore di interfaccia descritto di seguito.</span><span class="sxs-lookup"><span data-stu-id="4580a-521">The USB interface descriptor is part of an interface container described as follows.</span></span>

```c
typedef struct UX_INTERFACE_STRUCT
{
    ULONG ux_interface_handle;
    ULONG ux_interface_state;
    ULONG ux_interface_current_alternate_setting;
    struct UX_INTERFACE_DESCRIPTOR_STRUCT ux_interface_descriptor;
    struct UX_HOST_CLASS_STRUCT    *ux_interface_class;
    VOID    *ux_interface_class_instance;
    struct UX_ENDPOINT_STRUCT    *ux_interface_first_endpoint;
    struct UX_INTERFACE_STRUCT    *ux_interface_next_interface;
    struct UX_CONFIGURATION_STRUCT    *ux_interface_configuration;
} UX_INTERFACE;
```

- <span data-ttu-id="4580a-522">**ux_interface_handle**: handle dell'interfaccia.</span><span class="sxs-lookup"><span data-stu-id="4580a-522">**ux_interface_handle**: Handle of the interface.</span></span> <span data-ttu-id="4580a-523">Si tratta in genere dell'indirizzo dell'istanza di questa struttura per l'interfaccia.</span><span class="sxs-lookup"><span data-stu-id="4580a-523">This is typically the address of the instance of this structure for the interface.</span></span>
- <span data-ttu-id="4580a-524">**ux_interface_state**: stato dell'interfaccia.</span><span class="sxs-lookup"><span data-stu-id="4580a-524">**ux_interface_state**: State of the interface.</span></span>
- <span data-ttu-id="4580a-525">**ux_interface_descriptor**: descrittore dell'interfaccia USB.</span><span class="sxs-lookup"><span data-stu-id="4580a-525">**ux_interface_descriptor**: USB interface descriptor.</span></span>
- <span data-ttu-id="4580a-526">**ux_interface_class**: puntatore al tipo di classe a cui appartiene questa interfaccia.</span><span class="sxs-lookup"><span data-stu-id="4580a-526">**ux_interface_class**: Pointer to the class type that owns this interface.</span></span>
- <span data-ttu-id="4580a-527">**ux_interface_class_instance**: puntatore all'istanza della classe a cui appartiene questa interfaccia.</span><span class="sxs-lookup"><span data-stu-id="4580a-527">**ux_interface_class_instance**: Pointer to the instance of the class that owns this interface.</span></span>
- <span data-ttu-id="4580a-528">**ux_interface_first_endpoint**: puntatore al primo endpoint registrato con questa interfaccia.</span><span class="sxs-lookup"><span data-stu-id="4580a-528">**ux_interface_first_endpoint**: Pointer to the first endpoint registered with this interface.</span></span>
- <span data-ttu-id="4580a-529">**ux_interface_next_interface**: puntatore alla successiva interfaccia associata alla configurazione.</span><span class="sxs-lookup"><span data-stu-id="4580a-529">**ux_interface_next_interface**: Pointer to the next interface associated with the configuration.</span></span>
- <span data-ttu-id="4580a-530">**ux_interface_configuration**: puntatore al proprietario della configurazione di questa interfaccia.</span><span class="sxs-lookup"><span data-stu-id="4580a-530">**ux_interface_configuration**: Pointer to the configuration owner of this interface.</span></span>

### <a name="endpoint-descriptors"></a><span data-ttu-id="4580a-531">Descrittori di endpoint</span><span class="sxs-lookup"><span data-stu-id="4580a-531">Endpoint Descriptors</span></span>

<span data-ttu-id="4580a-532">Ogni endpoint associato a un'interfaccia ha il proprio descrittore dell'endpoint.</span><span class="sxs-lookup"><span data-stu-id="4580a-532">Each endpoint associated with an interface has its own endpoint descriptor.</span></span> <span data-ttu-id="4580a-533">Questo descrittore contiene le informazioni richieste dallo stack host per determinare i requisiti di larghezza di banda di ogni endpoint, il payload massimo associato all'endpoint, la periodicità e la direzione.</span><span class="sxs-lookup"><span data-stu-id="4580a-533">This descriptor contains the information required by the host stack to determine the bandwidth requirements of each endpoint, the maximum payload associated with the endpoint, its periodicity, and its direction.</span></span> <span data-ttu-id="4580a-534">Un descrittore dell'endpoint viene sempre restituito da un GET_DESCRIPTOR comando per la configurazione.</span><span class="sxs-lookup"><span data-stu-id="4580a-534">An endpoint descriptor is always returned by a GET_DESCRIPTOR command for the configuration.</span></span>

<span data-ttu-id="4580a-535">L'endpoint di controllo predefinito associato al descrittore del dispositivo non viene conteggiato come parte degli endpoint associati all'interfaccia e pertanto non viene restituito in questo descrittore.</span><span class="sxs-lookup"><span data-stu-id="4580a-535">The default control endpoint associated with the device descriptor is not counted as part of the endpoint(s) associated with the interface and therefore not returned in this descriptor.</span></span>

<span data-ttu-id="4580a-536">Quando il software host richiede una modifica dell'impostazione alternativa per un'interfaccia, tutti gli endpoint associati e le relative risorse USB vengono modificati in base alla nuova impostazione alternativa.</span><span class="sxs-lookup"><span data-stu-id="4580a-536">When the host software requests a change of the alternate setting for an interface, all the associated endpoints and their USB resources are modified according to the new alternate setting.</span></span>

<span data-ttu-id="4580a-537">Ad eccezione degli endpoint di controllo predefiniti, gli endpoint non possono essere condivisi tra le interfacce.</span><span class="sxs-lookup"><span data-stu-id="4580a-537">Except for the default control endpoints, endpoints cannot be share between interfaces.</span></span>

| <span data-ttu-id="4580a-538">Offset</span><span class="sxs-lookup"><span data-stu-id="4580a-538">Offset</span></span> | <span data-ttu-id="4580a-539">Campo</span><span class="sxs-lookup"><span data-stu-id="4580a-539">Field</span></span>            | <span data-ttu-id="4580a-540">Dimensione</span><span class="sxs-lookup"><span data-stu-id="4580a-540">Size</span></span> | <span data-ttu-id="4580a-541">Valore</span><span class="sxs-lookup"><span data-stu-id="4580a-541">Value</span></span>    | <span data-ttu-id="4580a-542">Descrizione</span><span class="sxs-lookup"><span data-stu-id="4580a-542">Description</span></span>                       |
| ------ | ---------------- | ---- | -------- | --------------------------------- |
| <span data-ttu-id="4580a-543">0</span><span class="sxs-lookup"><span data-stu-id="4580a-543">0</span></span>      | <span data-ttu-id="4580a-544">bLength</span><span class="sxs-lookup"><span data-stu-id="4580a-544">bLength</span></span>          | <span data-ttu-id="4580a-545">1</span><span class="sxs-lookup"><span data-stu-id="4580a-545">1</span></span>    | <span data-ttu-id="4580a-546">Number</span><span class="sxs-lookup"><span data-stu-id="4580a-546">Number</span></span>   | <span data-ttu-id="4580a-547">Dimensioni in byte del descrittore.</span><span class="sxs-lookup"><span data-stu-id="4580a-547">Size of this descriptor in bytes.</span></span> |
| <span data-ttu-id="4580a-548">1</span><span class="sxs-lookup"><span data-stu-id="4580a-548">1</span></span>      | <span data-ttu-id="4580a-549">bDescriptorType</span><span class="sxs-lookup"><span data-stu-id="4580a-549">bDescriptorType</span></span>  | <span data-ttu-id="4580a-550">1</span><span class="sxs-lookup"><span data-stu-id="4580a-550">1</span></span>    | <span data-ttu-id="4580a-551">Costante</span><span class="sxs-lookup"><span data-stu-id="4580a-551">Constant</span></span> | <span data-ttu-id="4580a-552">Tipo di descrittore dell'ENDPOINT.</span><span class="sxs-lookup"><span data-stu-id="4580a-552">ENDPOINT Descriptor Type.</span></span> |
| <span data-ttu-id="4580a-553">2</span><span class="sxs-lookup"><span data-stu-id="4580a-553">2</span></span>      | <span data-ttu-id="4580a-554">bEndpointAddress</span><span class="sxs-lookup"><span data-stu-id="4580a-554">bEndpointAddress</span></span> | <span data-ttu-id="4580a-555">1</span><span class="sxs-lookup"><span data-stu-id="4580a-555">1</span></span>    | <span data-ttu-id="4580a-556">Endpoint</span><span class="sxs-lookup"><span data-stu-id="4580a-556">Endpoint</span></span> | <span data-ttu-id="4580a-557">Indirizzo dell'endpoint sul dispositivo USB descritto da questo descrittore.</span><span class="sxs-lookup"><span data-stu-id="4580a-557">The address of the endpoint on the USB device described by this descriptor.</span></span> <span data-ttu-id="4580a-558">L'indirizzo è codificato come indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="4580a-558">The address is encoded as follows:</span></span><br /><span data-ttu-id="4580a-559">Bit 3... 0: numero di endpoint</span><span class="sxs-lookup"><span data-stu-id="4580a-559">Bit 3...0: The endpoint number</span></span><br /><span data-ttu-id="4580a-560">Bit 6... 4: riservato, reimpostazione a zero</span><span class="sxs-lookup"><span data-stu-id="4580a-560">Bit 6...4: Reserved, reset to zero</span></span><br /><span data-ttu-id="4580a-561">Bit 7: direzione, ignorato per gli endpoint di controllo</span><span class="sxs-lookup"><span data-stu-id="4580a-561">Bit 7: Direction, ignored for control endpoints</span></span><br /><span data-ttu-id="4580a-562">0 = endpoint OUT</span><span class="sxs-lookup"><span data-stu-id="4580a-562">0 = OUT endpoint</span></span><br /><span data-ttu-id="4580a-563">1 = IN endpoint</span><span class="sxs-lookup"><span data-stu-id="4580a-563">1 = IN endpoint</span></span> |
| <span data-ttu-id="4580a-564">3</span><span class="sxs-lookup"><span data-stu-id="4580a-564">3</span></span>      | <span data-ttu-id="4580a-565">bmAttributes</span><span class="sxs-lookup"><span data-stu-id="4580a-565">bmAttributes</span></span>     | <span data-ttu-id="4580a-566">1</span><span class="sxs-lookup"><span data-stu-id="4580a-566">1</span></span>    | <span data-ttu-id="4580a-567">Bitmap</span><span class="sxs-lookup"><span data-stu-id="4580a-567">Bitmap</span></span>   | <span data-ttu-id="4580a-568">Questo campo descrive gli attributi dell'endpoint quando viene configurato usando il campo **bConfigurationValue** .</span><span class="sxs-lookup"><span data-stu-id="4580a-568">This field describes the endpoint's attributes when it is configured using the **bConfigurationValue** field.</span></span> <span data-ttu-id="4580a-569">BITS 1.. 0: tipo di trasferimento</span><span class="sxs-lookup"><span data-stu-id="4580a-569">Bits 1..0: Transfer Type</span></span><br /><span data-ttu-id="4580a-570">00 = controllo</span><span class="sxs-lookup"><span data-stu-id="4580a-570">00 = Control</span></span><br /><span data-ttu-id="4580a-571">01 = isocrono</span><span class="sxs-lookup"><span data-stu-id="4580a-571">01 = Isochronous</span></span><br /><span data-ttu-id="4580a-572">10 = bulk</span><span class="sxs-lookup"><span data-stu-id="4580a-572">10 = Bulk</span></span><br /><span data-ttu-id="4580a-573">11 = interrupt</span><span class="sxs-lookup"><span data-stu-id="4580a-573">11 = Interrupt</span></span><br /><span data-ttu-id="4580a-574">Se non si tratta di un endpoint isocrono, i bit 5.. 2 sono riservati e devono essere impostati su zero.</span><span class="sxs-lookup"><span data-stu-id="4580a-574">If not an isochronous endpoint, bits 5..2 are reserved and must be set to zero.</span></span> <span data-ttu-id="4580a-575">Se isocrone, vengono definiti come segue:</span><span class="sxs-lookup"><span data-stu-id="4580a-575">If isochronous, they are defined as follows:</span></span><br /><span data-ttu-id="4580a-576">BITS 3.. 2: tipo di sincronizzazione</span><span class="sxs-lookup"><span data-stu-id="4580a-576">Bits 3..2: Synchronization Type</span></span><br /><span data-ttu-id="4580a-577">00 = nessuna sincronizzazione</span><span class="sxs-lookup"><span data-stu-id="4580a-577">00 = No Synchronization</span></span><br /><span data-ttu-id="4580a-578">01 = asincrono</span><span class="sxs-lookup"><span data-stu-id="4580a-578">01 = Asynchronous</span></span><br /><span data-ttu-id="4580a-579">10 = adattivo</span><span class="sxs-lookup"><span data-stu-id="4580a-579">10 = Adaptive</span></span><br /><span data-ttu-id="4580a-580">11 = sincrono</span><span class="sxs-lookup"><span data-stu-id="4580a-580">11 = Synchronous</span></span><br /><span data-ttu-id="4580a-581">BITS 5.. 4: tipo di utilizzo</span><span class="sxs-lookup"><span data-stu-id="4580a-581">Bits 5..4: Usage Type</span></span><br /><span data-ttu-id="4580a-582">00 = endpoint dati</span><span class="sxs-lookup"><span data-stu-id="4580a-582">00 = Data endpoint</span></span><br /><span data-ttu-id="4580a-583">01 = endpoint feedback</span><span class="sxs-lookup"><span data-stu-id="4580a-583">01 = Feedback endpoint</span></span><br /><span data-ttu-id="4580a-584">10 = endpoint dati di commenti impliciti</span><span class="sxs-lookup"><span data-stu-id="4580a-584">10 = Implicit feedback data endpoint</span></span><br /><span data-ttu-id="4580a-585">11 = riservato</span><span class="sxs-lookup"><span data-stu-id="4580a-585">11 = Reserved</span></span> |
| <span data-ttu-id="4580a-586">4</span><span class="sxs-lookup"><span data-stu-id="4580a-586">4</span></span>      | <span data-ttu-id="4580a-587">wMaxPacketSize</span><span class="sxs-lookup"><span data-stu-id="4580a-587">wMaxPacketSize</span></span>   | <span data-ttu-id="4580a-588">2</span><span class="sxs-lookup"><span data-stu-id="4580a-588">2</span></span>    | <span data-ttu-id="4580a-589">Number</span><span class="sxs-lookup"><span data-stu-id="4580a-589">Number</span></span>   | <span data-ttu-id="4580a-590">Dimensioni massime pacchetti questo endpoint è in grado di inviare o ricevere quando viene selezionata questa configurazione.</span><span class="sxs-lookup"><span data-stu-id="4580a-590">Maximum packet size this endpoint is capable of sending or receiving when this configuration is selected.</span></span><br /><span data-ttu-id="4580a-591">Per gli endpoint isocroni, questo valore viene usato per riservare il tempo del bus nella pianificazione, necessario per i payload dei dati del frame per (micro).</span><span class="sxs-lookup"><span data-stu-id="4580a-591">For isochronous endpoints, this value is used to reserve the bus time in the schedule, required for the per-(micro)frame data payloads.</span></span> <span data-ttu-id="4580a-592">La pipe può, su base continuativa, usare effettivamente una larghezza di banda inferiore rispetto a quella riservata.</span><span class="sxs-lookup"><span data-stu-id="4580a-592">The pipe may, on an ongoing basis, actually use less bandwidth than that reserved.</span></span> <span data-ttu-id="4580a-593">Il dispositivo segnala, se necessario, la larghezza di banda effettiva utilizzata tramite i normali meccanismi non USB definiti.</span><span class="sxs-lookup"><span data-stu-id="4580a-593">The device reports, if necessary, the actual bandwidth used via its normal, non-USB defined mechanisms.</span></span><br /><span data-ttu-id="4580a-594">Per tutti gli endpoint, bits 10.. 0 specifica la dimensione massima del pacchetto (in byte).</span><span class="sxs-lookup"><span data-stu-id="4580a-594">For all endpoints, bits 10..0 specify the maximum packet size (in bytes).</span></span><br /><span data-ttu-id="4580a-595">Per gli endpoint di interrupt e isocroni ad alta velocità:</span><span class="sxs-lookup"><span data-stu-id="4580a-595">For high-speed isochronous and interrupt endpoints:</span></span><br /><span data-ttu-id="4580a-596">BITS 12.. 11 specificare il numero di opportunità di transazione aggiuntive per microframe: 00 = None (1 transazione per microframe)</span><span class="sxs-lookup"><span data-stu-id="4580a-596">Bits 12..11 specify the number of additional transaction opportunities per microframe: 00 = None (1 transaction per microframe)</span></span><br /><span data-ttu-id="4580a-597">01 = 1 aggiuntivo (2 per microframe)</span><span class="sxs-lookup"><span data-stu-id="4580a-597">01 = 1 additional (2 per microframe)</span></span><br /><span data-ttu-id="4580a-598">10 = 2 aggiuntivi (3 per microframe)</span><span class="sxs-lookup"><span data-stu-id="4580a-598">10 = 2 additional (3 per microframe)</span></span><br /><span data-ttu-id="4580a-599">11 = riservato</span><span class="sxs-lookup"><span data-stu-id="4580a-599">11 = Reserved</span></span><br /><span data-ttu-id="4580a-600">Bits 15.. 13 sono riservati e devono essere impostati su zero.</span><span class="sxs-lookup"><span data-stu-id="4580a-600">Bits 15..13 are reserved and must be set to zero.</span></span> |
| <span data-ttu-id="4580a-601">6</span><span class="sxs-lookup"><span data-stu-id="4580a-601">6</span></span>      | <span data-ttu-id="4580a-602">bInterval</span><span class="sxs-lookup"><span data-stu-id="4580a-602">bInterval</span></span>        | <span data-ttu-id="4580a-603">1</span><span class="sxs-lookup"><span data-stu-id="4580a-603">1</span></span>     | <span data-ttu-id="4580a-604">Number</span><span class="sxs-lookup"><span data-stu-id="4580a-604">Number</span></span>   | <span data-ttu-id="4580a-605">Intervallo numerico per l'endpoint di polling per i trasferimenti di dati.</span><span class="sxs-lookup"><span data-stu-id="4580a-605">Number interval for polling endpoint for data transfers.</span></span><br /><span data-ttu-id="4580a-606">Espressa in frame o microframe, a seconda della velocità operativa del dispositivo (ad esempio, 1 millisecondo o 125 μs).</span><span class="sxs-lookup"><span data-stu-id="4580a-606">Expressed in frames or microframes depending on the device operating speed (i.e., either 1 millisecond or 125 µs units).</span></span><br /><span data-ttu-id="4580a-607">Per gli endpoint isocroni/High-Speed completi, questo valore deve essere compreso tra 1 e 16.</span><span class="sxs-lookup"><span data-stu-id="4580a-607">For full-/high-speed isochronous endpoints, this value must be in the range from 1 to 16.</span></span> <span data-ttu-id="4580a-608">**BInterval** viene usato come esponente per un valore 2bInterval-1; ad esempio, un **bInterval** 4 indica un periodo di 8 (24-1).</span><span class="sxs-lookup"><span data-stu-id="4580a-608">The **bInterval** is used as the exponent for a 2bInterval-1 value; e.g., a **bInterval** 4 means a period of 8 (24-1).</span></span><br /><span data-ttu-id="4580a-609">Per gli endpoint di interrupt/Low-Speed completi, il valore di questo campo può essere compreso tra 1 e 255.</span><span class="sxs-lookup"><span data-stu-id="4580a-609">For full-/low-speed interrupt endpoints, the value of this field may be from 1 to 255.</span></span><br /><span data-ttu-id="4580a-610">Per gli endpoint di interrupt ad alta velocità, **bInterval** viene usato come esponente per un valore 2bInterval-1; ad esempio, un **bInterval** 4 indica un periodo di 8 (24-1).</span><span class="sxs-lookup"><span data-stu-id="4580a-610">For high-speed interrupt endpoints, the **bInterval** is used as the exponent for a 2bInterval-1 value; e.g., a **bInterval** 4 means a period of 8 (24-1).</span></span> <span data-ttu-id="4580a-611">Questo valore deve essere compreso tra 1 e 16.</span><span class="sxs-lookup"><span data-stu-id="4580a-611">This value must be from 1 to 16.</span></span><br /><span data-ttu-id="4580a-612">Per gli endpoint ad alta velocità in blocco o di controllo, **bInterval** specifica la frequenza massima di NAK dell'endpoint.</span><span class="sxs-lookup"><span data-stu-id="4580a-612">For high-speed bulk/control OUT endpoints, the **bInterval** specify the maximum NAK rate of the endpoint.</span></span> <span data-ttu-id="4580a-613">Il valore 0 indica che l'endpoint non è mai NAKs.</span><span class="sxs-lookup"><span data-stu-id="4580a-613">A value of 0 indicates the endpoint never NAKs.</span></span> <span data-ttu-id="4580a-614">Altri valori indicano al massimo un NAK ogni **bInterval** di microframe.</span><span class="sxs-lookup"><span data-stu-id="4580a-614">Other values indicate at most one NAK each **bInterval** of microframes.</span></span><br /><span data-ttu-id="4580a-615">Questo valore deve essere compreso tra 0 e 255.</span><span class="sxs-lookup"><span data-stu-id="4580a-615">This value must be in the range from 0 to 255.</span></span> |

<span data-ttu-id="4580a-616">USBX definisce un descrittore dell'endpoint USB nel modo seguente:</span><span class="sxs-lookup"><span data-stu-id="4580a-616">USBX defines a USB endpoint descriptor as follows:</span></span>

```c
typedef struct UX_ENDPOINT_DESCRIPTOR_STRUCT
{
    UINT bLength;
    UINT bDescriptorType;
    UINT bEndpointAddress;
    UINT bmAttributes;
    USHORT wMaxPacketSize;
    UINT bInterval;
} UX_ENDPOINT_DESCRIPTOR;
```

<span data-ttu-id="4580a-617">Il descrittore dell'endpoint USB fa parte di un contenitore di endpoint, descritto di seguito.</span><span class="sxs-lookup"><span data-stu-id="4580a-617">The USB endpoint descriptor is part of an endpoint container, which is described as follows.</span></span>

```c
typedef struct UX_ENDPOINT_STRUCT {
    ULONG    ux_endpoint_handle;
    ULONG    ux_endpoint_state;
    VOID    *ux_endpoint_ed;
    struct UX_ENDPOINT_DESCRIPTOR_STRUCT    ux_endpoint_descriptor;
    struct UX_ENDPOINT_STRUCT    *ux_endpoint_next_endpoint;
    struct UX_INTERFACE_STRUCT    *ux_endpoint_interface;
    struct UX_DEVICE_STRUCT    *ux_endpoint_device;
    struct UX_TRANSFER REQUEST_STRUCT    ux_endpoint_transfer request;
} UX_ENDPOINT;

```

- <span data-ttu-id="4580a-618">**ux_endpoint_handle**: handle dell'endpoint.</span><span class="sxs-lookup"><span data-stu-id="4580a-618">**ux_endpoint_handle**: Handle of the endpoint.</span></span> <span data-ttu-id="4580a-619">Si tratta in genere dell'indirizzo dell'istanza di questa struttura per l'endpoint.</span><span class="sxs-lookup"><span data-stu-id="4580a-619">This is typically the address of the instance of this structure for the endpoint.</span></span>
- <span data-ttu-id="4580a-620">**ux_endpoint_state**: stato dell'endpoint.</span><span class="sxs-lookup"><span data-stu-id="4580a-620">**ux_endpoint_state**: State of the endpoint.</span></span>
- <span data-ttu-id="4580a-621">**ux_endpoint_ed**: puntatore all'endpoint fisico a livello del controller host.</span><span class="sxs-lookup"><span data-stu-id="4580a-621">**ux_endpoint_ed**: Pointer to the physical endpoint at the host controller layer.</span></span>
- <span data-ttu-id="4580a-622">**ux_endpoint_descriptor**: descrittore dell'endpoint USB.</span><span class="sxs-lookup"><span data-stu-id="4580a-622">**ux_endpoint_descriptor**: USB endpoint descriptor.</span></span>
- <span data-ttu-id="4580a-623">**ux_endpoint_next_endpoint**: puntatore all'endpoint successivo che appartiene alla stessa interfaccia.</span><span class="sxs-lookup"><span data-stu-id="4580a-623">**ux_endpoint_next_endpoint**: Pointer to the next endpoint that belongs to the same interface.</span></span>
- <span data-ttu-id="4580a-624">**ux_endpoint_interface**: puntatore all'interfaccia a cui appartiene questa interfaccia endpoint.</span><span class="sxs-lookup"><span data-stu-id="4580a-624">**ux_endpoint_interface**: Pointer to the interface that owns this endpoint interface.</span></span>
- <span data-ttu-id="4580a-625">**ux_endpoint_device**: puntatore al contenitore del dispositivo padre.</span><span class="sxs-lookup"><span data-stu-id="4580a-625">**ux_endpoint_device**: Pointer to the parent device container.</span></span>
- <span data-ttu-id="4580a-626">**ux_endpoint_transfer request**: richiesta di trasferimento USB usata per inviare/ricevere dati da e verso il dispositivo.</span><span class="sxs-lookup"><span data-stu-id="4580a-626">**ux_endpoint_transfer request**: USB transfer request used to send/receive data from to/from the device.</span></span>

### <a name="string-descriptors"></a><span data-ttu-id="4580a-627">Descrittori di stringa</span><span class="sxs-lookup"><span data-stu-id="4580a-627">String descriptors</span></span>

<span data-ttu-id="4580a-628">I descrittori di stringa sono facoltativi.</span><span class="sxs-lookup"><span data-stu-id="4580a-628">String descriptors are optional.</span></span> <span data-ttu-id="4580a-629">Se un dispositivo non supporta descrittori di stringa, tutti i riferimenti a descrittori di stringa nei descrittori di dispositivo, configurazione e interfaccia devono essere reimpostati su zero.</span><span class="sxs-lookup"><span data-stu-id="4580a-629">If a device does not support string descriptors, all references to string descriptors within device, configuration, and interface descriptors must be reset to zero.</span></span>

<span data-ttu-id="4580a-630">I descrittori di stringa utilizzano la codifica UNICODE, consentendo così il supporto di diversi set di caratteri.</span><span class="sxs-lookup"><span data-stu-id="4580a-630">String descriptors use UNICODE encoding, thus allowing the support for several character sets.</span></span> <span data-ttu-id="4580a-631">Le stringhe in un dispositivo USB possono supportare più lingue.</span><span class="sxs-lookup"><span data-stu-id="4580a-631">The strings in a USB device may support multiple languages.</span></span> <span data-ttu-id="4580a-632">Quando si richiede un descrittore di stringa, il richiedente specifica la lingua desiderata usando un ID lingua definito da USB-IF.</span><span class="sxs-lookup"><span data-stu-id="4580a-632">When requesting a string descriptor, the requester specifies the desired language using a language ID defined by the USB-IF.</span></span> <span data-ttu-id="4580a-633">L'elenco dei LANGIDs USB attualmente definiti è disponibile nell'appendice USBX??.</span><span class="sxs-lookup"><span data-stu-id="4580a-633">The list of currently defined USB LANGIDs can be found in the USBX appendix ??.</span></span>
<span data-ttu-id="4580a-634">L'indice stringa zero per tutti i linguaggi restituisce un descrittore di stringa che contiene una matrice di codici LANGID a due byte supportati dal dispositivo.</span><span class="sxs-lookup"><span data-stu-id="4580a-634">String index zero for all languages returns a string descriptor that contains an array of two-byte LANGID codes supported by the device.</span></span> <span data-ttu-id="4580a-635">Si noti che la stringa UNICODE non è terminata con 0.</span><span class="sxs-lookup"><span data-stu-id="4580a-635">It should be noted that the UNICODE string is not 0 terminated.</span></span> <span data-ttu-id="4580a-636">Al contrario, le dimensioni della matrice di stringhe vengono calcolate sottraendo due dalla dimensione della matrice contenuta nel primo byte del descrittore.</span><span class="sxs-lookup"><span data-stu-id="4580a-636">Instead, the size of the string array is computed by subtracting two from the size of the array contained in the first byte of the descriptor.</span></span>

<span data-ttu-id="4580a-637">Il descrittore di stringa USB 0 è codificato come indicato di seguito.</span><span class="sxs-lookup"><span data-stu-id="4580a-637">The USB string descriptor 0 is encoded as follows.</span></span>

| <span data-ttu-id="4580a-638">Offset</span><span class="sxs-lookup"><span data-stu-id="4580a-638">Offset</span></span> | <span data-ttu-id="4580a-639">Campo</span><span class="sxs-lookup"><span data-stu-id="4580a-639">Field</span></span>           | <span data-ttu-id="4580a-640">Dimensione</span><span class="sxs-lookup"><span data-stu-id="4580a-640">Size</span></span> | <span data-ttu-id="4580a-641">Valore</span><span class="sxs-lookup"><span data-stu-id="4580a-641">Value</span></span>    | <span data-ttu-id="4580a-642">Descrizione</span><span class="sxs-lookup"><span data-stu-id="4580a-642">Description</span></span>                      |
| ------ | --------------- | ---- | -------- | -------------------------------- |
| <span data-ttu-id="4580a-643">0</span><span class="sxs-lookup"><span data-stu-id="4580a-643">0</span></span>      | <span data-ttu-id="4580a-644">bLength</span><span class="sxs-lookup"><span data-stu-id="4580a-644">bLength</span></span>         | <span data-ttu-id="4580a-645">1</span><span class="sxs-lookup"><span data-stu-id="4580a-645">1</span></span>    | <span data-ttu-id="4580a-646">N + 2</span><span class="sxs-lookup"><span data-stu-id="4580a-646">N+2</span></span>      | <span data-ttu-id="4580a-647">Dimensioni del descrittore in byte</span><span class="sxs-lookup"><span data-stu-id="4580a-647">Size of this descriptor in bytes</span></span> |
| <span data-ttu-id="4580a-648">1</span><span class="sxs-lookup"><span data-stu-id="4580a-648">1</span></span>      | <span data-ttu-id="4580a-649">bDescriptorType</span><span class="sxs-lookup"><span data-stu-id="4580a-649">bDescriptorType</span></span> | <span data-ttu-id="4580a-650">1</span><span class="sxs-lookup"><span data-stu-id="4580a-650">1</span></span>    | <span data-ttu-id="4580a-651">Costante</span><span class="sxs-lookup"><span data-stu-id="4580a-651">Constant</span></span> | <span data-ttu-id="4580a-652">Tipo di descrittore di stringa</span><span class="sxs-lookup"><span data-stu-id="4580a-652">STRING Descriptor Type</span></span>           |
| <span data-ttu-id="4580a-653">2</span><span class="sxs-lookup"><span data-stu-id="4580a-653">2</span></span>      | <span data-ttu-id="4580a-654">wLANGID [0]</span><span class="sxs-lookup"><span data-stu-id="4580a-654">wLANGID[0]</span></span>      | <span data-ttu-id="4580a-655">2</span><span class="sxs-lookup"><span data-stu-id="4580a-655">2</span></span>    | <span data-ttu-id="4580a-656">Number</span><span class="sxs-lookup"><span data-stu-id="4580a-656">Number</span></span>   | <span data-ttu-id="4580a-657">Codice LANGID 0</span><span class="sxs-lookup"><span data-stu-id="4580a-657">LANGID code 0</span></span>                    |
| <span data-ttu-id="4580a-658">...</span><span class="sxs-lookup"><span data-stu-id="4580a-658">...</span></span>    | <span data-ttu-id="4580a-659">...]</span><span class="sxs-lookup"><span data-stu-id="4580a-659">...]</span></span>            | <span data-ttu-id="4580a-660">...</span><span class="sxs-lookup"><span data-stu-id="4580a-660">...</span></span>  | <span data-ttu-id="4580a-661">...</span><span class="sxs-lookup"><span data-stu-id="4580a-661">...</span></span>      | <span data-ttu-id="4580a-662">...</span><span class="sxs-lookup"><span data-stu-id="4580a-662">...</span></span>                              |
| <span data-ttu-id="4580a-663">N</span><span class="sxs-lookup"><span data-stu-id="4580a-663">N</span></span>      | <span data-ttu-id="4580a-664">wLANGID [n]</span><span class="sxs-lookup"><span data-stu-id="4580a-664">wLANGID[n]</span></span>      | <span data-ttu-id="4580a-665">2</span><span class="sxs-lookup"><span data-stu-id="4580a-665">2</span></span>    | <span data-ttu-id="4580a-666">Number</span><span class="sxs-lookup"><span data-stu-id="4580a-666">Number</span></span>   | <span data-ttu-id="4580a-667">Codice LANGID n</span><span class="sxs-lookup"><span data-stu-id="4580a-667">LANGID code n</span></span>                    |

<span data-ttu-id="4580a-668">Gli altri descrittori di stringa USB sono codificati come indicato di seguito.</span><span class="sxs-lookup"><span data-stu-id="4580a-668">Other USB string descriptors are encoded as follows.</span></span>

| <span data-ttu-id="4580a-669">Offset</span><span class="sxs-lookup"><span data-stu-id="4580a-669">Offset</span></span> | <span data-ttu-id="4580a-670">Campo</span><span class="sxs-lookup"><span data-stu-id="4580a-670">Field</span></span>           | <span data-ttu-id="4580a-671">Dimensione</span><span class="sxs-lookup"><span data-stu-id="4580a-671">Size</span></span> | <span data-ttu-id="4580a-672">Valore</span><span class="sxs-lookup"><span data-stu-id="4580a-672">Value</span></span>    | <span data-ttu-id="4580a-673">Descrizione</span><span class="sxs-lookup"><span data-stu-id="4580a-673">Description</span></span>                      |
| ------ | --------------- | ---- | -------- | -------------------------------- |
| <span data-ttu-id="4580a-674">0</span><span class="sxs-lookup"><span data-stu-id="4580a-674">0</span></span>      | <span data-ttu-id="4580a-675">bLength</span><span class="sxs-lookup"><span data-stu-id="4580a-675">bLength</span></span>         | <span data-ttu-id="4580a-676">1</span><span class="sxs-lookup"><span data-stu-id="4580a-676">1</span></span>    | <span data-ttu-id="4580a-677">Number</span><span class="sxs-lookup"><span data-stu-id="4580a-677">Number</span></span>   | <span data-ttu-id="4580a-678">Dimensioni del descrittore in byte</span><span class="sxs-lookup"><span data-stu-id="4580a-678">Size of this descriptor in bytes</span></span> |
| <span data-ttu-id="4580a-679">1</span><span class="sxs-lookup"><span data-stu-id="4580a-679">1</span></span>      | <span data-ttu-id="4580a-680">bDescriptorType</span><span class="sxs-lookup"><span data-stu-id="4580a-680">bDescriptorType</span></span> | <span data-ttu-id="4580a-681">1</span><span class="sxs-lookup"><span data-stu-id="4580a-681">1</span></span>    | <span data-ttu-id="4580a-682">Costante</span><span class="sxs-lookup"><span data-stu-id="4580a-682">Constant</span></span> | <span data-ttu-id="4580a-683">Tipo di descrittore di stringa</span><span class="sxs-lookup"><span data-stu-id="4580a-683">STRING Descriptor Type</span></span>           |
| <span data-ttu-id="4580a-684">2</span><span class="sxs-lookup"><span data-stu-id="4580a-684">2</span></span>      | <span data-ttu-id="4580a-685">bString</span><span class="sxs-lookup"><span data-stu-id="4580a-685">bString</span></span>         | <span data-ttu-id="4580a-686">n</span><span class="sxs-lookup"><span data-stu-id="4580a-686">n</span></span>    | <span data-ttu-id="4580a-687">Number</span><span class="sxs-lookup"><span data-stu-id="4580a-687">Number</span></span>   | <span data-ttu-id="4580a-688">Stringa con codifica UNICODE</span><span class="sxs-lookup"><span data-stu-id="4580a-688">UNICODE encoded string</span></span>           |

<span data-ttu-id="4580a-689">USBX definisce un descrittore di stringa USB di lunghezza diversa da zero, come indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="4580a-689">USBX defines a non-zero length USB string descriptor as follows:</span></span>

```c
typedef struct UX_STRING_DESCRIPTOR_STRUCT
{
    UINT bLength;
    UINT bDescriptorType;
    USHORT bString[1];
} UX_STRING_DESCRIPTOR;
```

### <a name="functional-descriptors"></a><span data-ttu-id="4580a-690">Descrittori funzionali</span><span class="sxs-lookup"><span data-stu-id="4580a-690">Functional Descriptors</span></span>

<span data-ttu-id="4580a-691">I descrittori funzionali sono noti anche come descrittori specifici della classe.</span><span class="sxs-lookup"><span data-stu-id="4580a-691">Functional descriptors are also known as class-specific descriptors.</span></span> <span data-ttu-id="4580a-692">Usano normalmente le stesse strutture di base dei descrittori generici e consentono di rendere disponibili informazioni aggiuntive per la classe.</span><span class="sxs-lookup"><span data-stu-id="4580a-692">They normally use the same basic structures as generic descriptors and allow for additional information to be available to the class.</span></span> <span data-ttu-id="4580a-693">Ad esempio, nel caso dell'altoparlante audio USB, i descrittori specifici della classe consentono alla classe audio di recuperare per ogni impostazione alternativa il tipo di frequenza audio supportata.</span><span class="sxs-lookup"><span data-stu-id="4580a-693">For example, in the case of the USB audio speaker, class specific descriptors allow the audio class to retrieve for each alternate setting the type of audio frequency supported.</span></span>

### <a name="usbx-device-descriptor-framework-in-memory"></a><span data-ttu-id="4580a-694">USBX Framework descrittore dispositivi in memoria</span><span class="sxs-lookup"><span data-stu-id="4580a-694">USBX Device Descriptor Framework in Memory</span></span>

<span data-ttu-id="4580a-695">USBX gestisce la maggior parte dei descrittori di dispositivo in memoria, ovvero tutti i descrittori ad eccezione dei descrittori di stringa e funzionali.</span><span class="sxs-lookup"><span data-stu-id="4580a-695">USBX maintains most device descriptors in memory, that is, all descriptors except the string and functional descriptors.</span></span> <span data-ttu-id="4580a-696">Il diagramma seguente illustra come vengono archiviati e correlati tali descrittori.</span><span class="sxs-lookup"><span data-stu-id="4580a-696">The following diagram shows how these descriptors are stored and related.</span></span>

![USBX Framework descrittore dispositivi in memoria](./media/usbx-host-stack/usbx-device-descriptor-framework.png)
