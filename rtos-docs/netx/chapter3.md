---
title: Capitolo 3-componenti funzionali di Azure RTO NetX
description: Questo capitolo contiene una descrizione dello stack TCP/IP di Azure RTO NetX a prestazioni elevate dal punto di vista funzionale.
author: philmea
ms.author: philmea
ms.date: 05/19/2020
ms.topic: article
ms.service: rtos
ms.openlocfilehash: db23aa152b2765ac7cc9be098723fc5df0947484
ms.sourcegitcommit: e3d42e1f2920ec9cb002634b542bc20754f9544e
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/22/2021
ms.locfileid: "104822790"
---
# <a name="chapter-3---functional-components-of-azure-rtos-netx"></a><span data-ttu-id="228cd-103">Capitolo 3-componenti funzionali di Azure RTO NetX</span><span class="sxs-lookup"><span data-stu-id="228cd-103">Chapter 3 - Functional Components of Azure RTOS NetX</span></span>

<span data-ttu-id="228cd-104">Questo capitolo contiene una descrizione dello stack TCP/IP di Azure RTO NetX a prestazioni elevate dal punto di vista funzionale.</span><span class="sxs-lookup"><span data-stu-id="228cd-104">This chapter contains a description of the high-performance Azure RTOS NetX TCP/IP stack from a functional perspective.</span></span> 

## <a name="execution-overview"></a><span data-ttu-id="228cd-105">Panoramica dell'esecuzione</span><span class="sxs-lookup"><span data-stu-id="228cd-105">Execution Overview</span></span>

<span data-ttu-id="228cd-106">Esistono cinque tipi di esecuzione del programma all'interno di un'applicazione NetX: inizializzazione, chiamate dell'interfaccia dell'applicazione, thread IP interno, timer periodici IP e driver di rete.</span><span class="sxs-lookup"><span data-stu-id="228cd-106">There are five types of program execution within a NetX application: initialization, application interface calls, internal IP thread, IP periodic timers, and the network driver.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="228cd-107">NetX richiede l'installazione di ThreadX e dipende dall'esecuzione del thread, dalla sospensione, dai timer periodici e dalle strutture di esclusione reciproca.</span><span class="sxs-lookup"><span data-stu-id="228cd-107">NetX requires the installation of ThreadX and depends on its thread execution, suspension, periodic timers, and mutual exclusion facilities.</span></span>

### <a name="initialization"></a><span data-ttu-id="228cd-108">Inizializzazione</span><span class="sxs-lookup"><span data-stu-id="228cd-108">Initialization</span></span>

<span data-ttu-id="228cd-109">Il servizio \***nx_system_initialize** _ deve essere chiamato prima di chiamare qualsiasi altro servizio NETX.</span><span class="sxs-lookup"><span data-stu-id="228cd-109">The service \***nx_system_initialize** _ must be called before any other NetX service is called.</span></span> <span data-ttu-id="228cd-110">L'inizializzazione del sistema può essere chiamata dalla routine ThreadX _ *_tx_application_define_*\* o dai thread dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="228cd-110">System initialization can be called either from the ThreadX _ *_tx_application_define_*\* routine or from application threads.</span></span>

<span data-ttu-id="228cd-111">Dopo che \***nx_system_initialize** _ restituisce, il sistema è pronto per la creazione di pool di pacchetti e istanze IP.</span><span class="sxs-lookup"><span data-stu-id="228cd-111">After \***nx_system_initialize** _ returns, the system is ready to create packet pools and IP instances.</span></span> <span data-ttu-id="228cd-112">Poiché la creazione di un'istanza IP richiede un pool di pacchetti predefinito, è necessario che esista almeno un pool di pacchetti NetX prima di creare un'istanza IP.</span><span class="sxs-lookup"><span data-stu-id="228cd-112">Because creating an IP instance requires a default packet pool, at least one NetX packet pool must exist prior to creating an IP instance.</span></span> <span data-ttu-id="228cd-113">La creazione di pool di pacchetti e istanze IP è consentita dalla funzione di inizializzazione ThreadX _ *_tx_application_define_*\* e dai thread dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="228cd-113">Creating packet pools and IP instances are allowed from the ThreadX initialization function _ *_tx_application_define_*\* and from application threads.</span></span>

<span data-ttu-id="228cd-114">Internamente, la creazione di un'istanza IP viene eseguita in due parti.</span><span class="sxs-lookup"><span data-stu-id="228cd-114">Internally, creating an IP instance is accomplished in two parts.</span></span> <span data-ttu-id="228cd-115">La prima parte viene eseguita nel contesto del chiamante, dal ***tx_application_define*** o dal contesto del thread di un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="228cd-115">The first part is done within the context of the caller, either from ***tx_application_define*** or from an application thread's context.</span></span> <span data-ttu-id="228cd-116">Ciò include la configurazione della struttura dei dati IP e la creazione di varie risorse IP, incluso il thread IP interno.</span><span class="sxs-lookup"><span data-stu-id="228cd-116">This includes setting up the IP data structure and creating various IP resources, including the internal IP thread.</span></span> <span data-ttu-id="228cd-117">La seconda parte viene eseguita durante l'esecuzione iniziale dal thread IP interno.</span><span class="sxs-lookup"><span data-stu-id="228cd-117">The second part is performed during the initial execution from the internal IP thread.</span></span> <span data-ttu-id="228cd-118">Questo è il punto in cui il driver di rete, fornito durante la prima parte della creazione dell'IP, viene chiamato per la prima volta.</span><span class="sxs-lookup"><span data-stu-id="228cd-118">This is where the network driver, supplied during the first part of IP creation, is first called.</span></span> <span data-ttu-id="228cd-119">La chiamata del driver di rete dal thread IP interno consente al driver di eseguire operazioni di I/O e di sospendere durante l'elaborazione dell'inizializzazione.</span><span class="sxs-lookup"><span data-stu-id="228cd-119">Calling the network driver from the internal IP thread enables the driver to perform I/O and suspend during its initialization processing.</span></span> <span data-ttu-id="228cd-120">Quando il driver di rete viene restituito dalla relativa elaborazione di inizializzazione, la creazione dell'indirizzo IP è stata completata.</span><span class="sxs-lookup"><span data-stu-id="228cd-120">When the network driver returns from its initialization processing, the IP creation is complete.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="228cd-121">Il **nx_ip_status_check** del servizio NETX è disponibile per ottenere informazioni sull'istanza IP e lo stato dell'interfaccia principale.</span><span class="sxs-lookup"><span data-stu-id="228cd-121">The NetX service **nx_ip_status_check** is available to obtain information on the IP instance and its primary interface status.</span></span> <span data-ttu-id="228cd-122">Tali informazioni di stato includono il fatto che il collegamento sia inizializzato, abilitato e che l'indirizzo IP venga risolto.</span><span class="sxs-lookup"><span data-stu-id="228cd-122">Such status information includes whether or not the link is initialized, enabled, and IP address is resolved.</span></span> <span data-ttu-id="228cd-123">Queste informazioni vengono usate per sincronizzare i thread dell'applicazione che richiedono l'uso di un'istanza IP appena creata.</span><span class="sxs-lookup"><span data-stu-id="228cd-123">This information is used to synchronize application threads needing to use a newly created IP instance.</span></span> <span data-ttu-id="228cd-124">Per i sistemi multihome, vedere "supporto multihome" di seguito.</span><span class="sxs-lookup"><span data-stu-id="228cd-124">For multihome systems, see "Multihome Support" below.</span></span> <span data-ttu-id="228cd-125">**nx_ip_interface_status_check** è disponibile per ottenere informazioni sull'interfaccia specificata.</span><span class="sxs-lookup"><span data-stu-id="228cd-125">**nx_ip_interface_status_check** is available to obtain information on the specified interface.</span></span>

### <a name="application-interface-calls"></a><span data-ttu-id="228cd-126">Chiamate dell'interfaccia dell'applicazione</span><span class="sxs-lookup"><span data-stu-id="228cd-126">Application Interface Calls</span></span>

<span data-ttu-id="228cd-127">Le chiamate dall'applicazione vengono eseguite in gran parte dai thread dell'applicazione in esecuzione in ThreadX RTO.</span><span class="sxs-lookup"><span data-stu-id="228cd-127">Calls from the application are largely made from application threads running under the ThreadX RTOS.</span></span> <span data-ttu-id="228cd-128">Tuttavia, alcuni servizi di inizializzazione, creazione e abilitazione possono essere chiamati da ***tx_application_define***.</span><span class="sxs-lookup"><span data-stu-id="228cd-128">However, some initialization, create, and enable services may be called from ***tx_application_define***.</span></span> <span data-ttu-id="228cd-129">Le sezioni "consentito da" del capitolo 4 indicano da quale servizio NetX è possibile chiamare.</span><span class="sxs-lookup"><span data-stu-id="228cd-129">The "Allowed From" sections in Chapter 4 indicate from which each NetX service can be called.</span></span>

<span data-ttu-id="228cd-130">Nella maggior parte dei casi, l'elaborazione di attività intensive, ad esempio il calcolo dei checksum, viene eseguita nel contesto del thread chiamante, senza bloccare l'accesso di altri thread all'istanza IP.</span><span class="sxs-lookup"><span data-stu-id="228cd-130">For the most part, processing intensive activities such as computing checksums is done within the calling thread's context—without blocking the access of other threads to the IP instance.</span></span> <span data-ttu-id="228cd-131">Ad esempio, sulla trasmissione, il calcolo del checksum UDP viene eseguito all'interno del servizio ***nx_udp_socket_send*** , prima di chiamare la funzione di invio IP sottostante.</span><span class="sxs-lookup"><span data-stu-id="228cd-131">For example, on transmission, the UDP checksum calculation is performed inside the ***nx_udp_socket_send*** service, prior to calling the underlying IP send function.</span></span> <span data-ttu-id="228cd-132">In un pacchetto ricevuto, il checksum UDP viene calcolato nel servizio ***nx_udp_socket_receive*** , eseguito nel contesto del thread dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="228cd-132">On a received packet, the UDP checksum is calculated in the ***nx_udp_socket_receive*** service, executed in the context of the application thread.</span></span> <span data-ttu-id="228cd-133">Ciò consente di impedire il blocco delle richieste di rete di thread con priorità più alta a causa dell'elaborazione di calcoli di checksum intensivi nei thread con priorità più bassa.</span><span class="sxs-lookup"><span data-stu-id="228cd-133">This helps prevent stalling network requests of higher-priority threads because of processing intensive checksum computation in lower-priority threads.</span></span>

<span data-ttu-id="228cd-134">I valori, ad esempio gli indirizzi IP e i numeri di porta, vengono passati alle funzioni API nell'ordine dei byte dell'host.</span><span class="sxs-lookup"><span data-stu-id="228cd-134">Values, such as IP addresses and port numbers, are passed to API functions in host byte order.</span></span> <span data-ttu-id="228cd-135">Internamente, questi valori vengono archiviati anche nell'ordine dei byte dell'host.</span><span class="sxs-lookup"><span data-stu-id="228cd-135">Internally these values are stored in host byte order as well.</span></span> <span data-ttu-id="228cd-136">Ciò consente agli sviluppatori di visualizzare facilmente i valori tramite un debugger.</span><span class="sxs-lookup"><span data-stu-id="228cd-136">This enables developers to easily view the values via a debugger.</span></span> <span data-ttu-id="228cd-137">Quando questi valori vengono programmati in un frame per la trasmissione, vengono convertiti in ordine byte di rete.</span><span class="sxs-lookup"><span data-stu-id="228cd-137">When these values are programmed into a frame for transmission, they are converted to network byte order.</span></span>

### <a name="internal-ip-thread"></a><span data-ttu-id="228cd-138">Thread IP interno</span><span class="sxs-lookup"><span data-stu-id="228cd-138">Internal IP Thread</span></span>

<span data-ttu-id="228cd-139">Come indicato in precedenza, ogni istanza IP in NetX ha il proprio thread.</span><span class="sxs-lookup"><span data-stu-id="228cd-139">As mentioned, each IP instance in NetX has its own thread.</span></span> <span data-ttu-id="228cd-140">La priorità e le dimensioni dello stack del thread IP interno sono definite nel servizio ***nx_ip_create*** .</span><span class="sxs-lookup"><span data-stu-id="228cd-140">The priority and stack size of the internal IP thread is defined in the ***nx_ip_create*** service.</span></span> <span data-ttu-id="228cd-141">Il thread IP interno viene creato in modalità pronta per l'esecuzione.</span><span class="sxs-lookup"><span data-stu-id="228cd-141">The internal IP thread is created in a ready-to-execute mode.</span></span> <span data-ttu-id="228cd-142">Se il thread IP ha una priorità più elevata rispetto al thread chiamante, è possibile che si verifichi la precedenza all'interno della chiamata di creazione IP.</span><span class="sxs-lookup"><span data-stu-id="228cd-142">If the IP thread has a higher priority than the calling thread, preemption may occur inside the IP create call.</span></span>

<span data-ttu-id="228cd-143">Il punto di ingresso del thread IP interno si trova nella funzione interna ***_nx_ip_thread_entry***.</span><span class="sxs-lookup"><span data-stu-id="228cd-143">The entry point of the internal IP thread is at the internal function ***_nx_ip_thread_entry***.</span></span> <span data-ttu-id="228cd-144">Quando viene avviato, il thread IP interno completa innanzitutto l'inizializzazione del driver di rete, che consiste nell'effettuare tre chiamate al driver di rete specifico dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="228cd-144">When started, the internal IP thread first completes network driver initialization, which consists of making three calls to the application-specific network driver.</span></span> <span data-ttu-id="228cd-145">La prima chiamata consiste nel connettersi al driver di rete all'istanza IP, seguita da una chiamata di inizializzazione, che consente al driver di rete di passare attraverso il processo di inizializzazione.</span><span class="sxs-lookup"><span data-stu-id="228cd-145">The first call is to attach the network driver to the IP instance, followed by an initialization call, which allows the network driver to go through the initialization process.</span></span> <span data-ttu-id="228cd-146">Dopo che il driver di rete è stato restituito dall'inizializzazione (potrebbe sospendere in attesa della corretta configurazione dell'hardware), il thread IP interno chiama di nuovo il driver di rete per abilitare il collegamento.</span><span class="sxs-lookup"><span data-stu-id="228cd-146">After the network driver returns from initialization (it may suspend while waiting for the hardware to be properly set up), the internal IP thread calls the network driver again to enable the link.</span></span> 

<span data-ttu-id="228cd-147">Quando il driver di rete viene restituito dalla chiamata di Abilita collegamento, il thread IP interno entra in un ciclo infinito verificando la presenza di diversi eventi che necessitano di elaborazione per questa istanza IP.</span><span class="sxs-lookup"><span data-stu-id="228cd-147">After the network driver returns from the link enable call, the internal IP thread enters an endless loop checking for various events that need processing for this IP instance.</span></span> <span data-ttu-id="228cd-148">Gli eventi elaborati in questo ciclo includono la ricezione di pacchetti IP posticipati, l'assembly dei frammenti di pacchetti IP, l'elaborazione dei ping ICMP, l'elaborazione IGMP, l'elaborazione della coda di pacchetti TCP, l'elaborazione periodica TCP, i timeout degli assembly dei frammenti IP e l'elaborazione periodica di IGMP.</span><span class="sxs-lookup"><span data-stu-id="228cd-148">Events processed in this loop include deferred IP packet reception, IP packet fragment assembly, ICMP ping processing, IGMP processing, TCP packet queue processing, TCP periodic processing, IP fragment assembly timeouts, and IGMP periodic processing.</span></span> <span data-ttu-id="228cd-149">Gli eventi includono inoltre le attività di risoluzione degli indirizzi: elaborazione dei pacchetti ARP e elaborazione periodica ARP nella rete IP.</span><span class="sxs-lookup"><span data-stu-id="228cd-149">Events also include address resolution activities: ARP packet processing and ARP periodic processing in the IP network.</span></span>

> [!NOTE]
> <span data-ttu-id="228cd-150">*Le funzioni di callback NetX, inclusi i callback di ascolto e disconnessione, vengono chiamate dal thread IP interno, non dal thread chiamante originale. È necessario che l'applicazione non venga sospesa all'interno di una funzione di callback NetX.*</span><span class="sxs-lookup"><span data-stu-id="228cd-150">*The NetX callback functions, including listen and disconnect callbacks, are called from the internal IP thread—not the original calling thread. The application must take care not to suspend inside any NetX callback function.*</span></span>

### <a name="ip-periodic-timers"></a><span data-ttu-id="228cd-151">Timer periodici IP</span><span class="sxs-lookup"><span data-stu-id="228cd-151">IP Periodic Timers</span></span>
<span data-ttu-id="228cd-152">Per ogni istanza IP sono usati due timer periodici ThreadX.</span><span class="sxs-lookup"><span data-stu-id="228cd-152">There are two ThreadX periodic timers used for each IP instance.</span></span> <span data-ttu-id="228cd-153">Il primo è un timer di un secondo per ARP, IGMP, TCP timeout e anche l'elaborazione del frammento IP del riassemblaggio.</span><span class="sxs-lookup"><span data-stu-id="228cd-153">The first one is a one-second timer for ARP, IGMP, TCP timeout, and it also drives IP fragment reassemble processing.</span></span> <span data-ttu-id="228cd-154">Il secondo timer è un timer 100 ms per guidare il timeout di ritrasmissione TCP.</span><span class="sxs-lookup"><span data-stu-id="228cd-154">The second timer is a 100ms timer to drive the TCP retransmission timeout.</span></span>

### <a name="network-driver"></a><span data-ttu-id="228cd-155">Driver di rete</span><span class="sxs-lookup"><span data-stu-id="228cd-155">Network Driver</span></span>
<span data-ttu-id="228cd-156">Ogni istanza IP in NetX ha un'interfaccia primaria, identificata dal relativo driver di dispositivo specificato nel servizio ***nx_ip_create*** .</span><span class="sxs-lookup"><span data-stu-id="228cd-156">Each IP instance in NetX has a primary interface, which is identified by its device driver specified in the ***nx_ip_create*** service.</span></span> <span data-ttu-id="228cd-157">Il driver di rete è responsabile della gestione di varie richieste NetX, tra cui la trasmissione di pacchetti, la ricezione di pacchetti e le richieste di stato e controllo.</span><span class="sxs-lookup"><span data-stu-id="228cd-157">The network driver is responsible for handling various NetX requests, including packet transmission, packet reception, and requests for status and control.</span></span>

<span data-ttu-id="228cd-158">Per un sistema multi-Home, l'istanza IP dispone di più interfacce, ciascuna con un driver di rete associato che esegue queste attività per la rispettiva interfaccia.</span><span class="sxs-lookup"><span data-stu-id="228cd-158">For a multi-home system, the IP instance has multiple interfaces, each with an associated network driver that performs these tasks for the respective interface.</span></span>

<span data-ttu-id="228cd-159">Il driver di rete deve inoltre gestire gli eventi asincroni che si verificano sui supporti.</span><span class="sxs-lookup"><span data-stu-id="228cd-159">The network driver must also handle asynchronous events occurring on the media.</span></span> <span data-ttu-id="228cd-160">Gli eventi asincroni dai supporti includono la ricezione di pacchetti, il completamento della trasmissione del pacchetto e le modifiche dello stato.</span><span class="sxs-lookup"><span data-stu-id="228cd-160">Asynchronous events from the media include packet reception, packet transmission completion, and status changes.</span></span> <span data-ttu-id="228cd-161">NetX fornisce al driver di rete numerose funzioni di accesso per gestire vari eventi.</span><span class="sxs-lookup"><span data-stu-id="228cd-161">NetX provides the network driver with several access functions to handle various events.</span></span> <span data-ttu-id="228cd-162">Queste funzioni sono progettate per essere chiamate dalla parte di routine del servizio di interrupt del driver di rete.</span><span class="sxs-lookup"><span data-stu-id="228cd-162">These functions are designed to be called from the interrupt service routine portion of the network driver.</span></span> <span data-ttu-id="228cd-163">Per le reti IP, il driver di rete deve inoltrare tutti i pacchetti ARP ricevuti alla funzione interna \***_nx_arp_packet_deferred_receive** _.</span><span class="sxs-lookup"><span data-stu-id="228cd-163">For IP networks, the network driver should forward all ARP packets received to the \***_nx_arp_packet_deferred_receive** _ internal function.</span></span> <span data-ttu-id="228cd-164">Tutti i pacchetti RARP devono essere inoltrati a _ *_ _nx_rarp_packet_deferred_receive_* _ funzione interna.</span><span class="sxs-lookup"><span data-stu-id="228cd-164">All RARP packets should be forwarded to _ *_ _nx_rarp_packet_deferred_receive_* _ internal function.</span></span> <span data-ttu-id="228cd-165">Sono disponibili due opzioni per i pacchetti IP.</span><span class="sxs-lookup"><span data-stu-id="228cd-165">There are two options for IP packets.</span></span> <span data-ttu-id="228cd-166">Se è necessario inviare rapidamente i pacchetti IP, i pacchetti IP in ingresso devono essere inoltrati a _ *_ _nx_ip_packet_receive_* _ per l'elaborazione immediata.</span><span class="sxs-lookup"><span data-stu-id="228cd-166">If fast dispatch of IP packets is required, incoming IP packets should be forwarded to _ *_ _nx_ip_packet_receive_* _ for immediate processing.</span></span> <span data-ttu-id="228cd-167">Ciò migliora notevolmente le prestazioni di NetX nella gestione dei pacchetti IP.</span><span class="sxs-lookup"><span data-stu-id="228cd-167">This greatly improves NetX performance in handling IP packets.</span></span> <span data-ttu-id="228cd-168">In caso contrario, il driver di rete deve inoltrare i pacchetti IP a _ \* _ _nx_ip_packet_deferred_receive_\* \*.</span><span class="sxs-lookup"><span data-stu-id="228cd-168">Otherwise, the network driver should forward IP packets to _\*_ _nx_ip_packet_deferred_receive_\*\*.</span></span> <span data-ttu-id="228cd-169">Questo servizio posiziona il pacchetto IP nella coda di elaborazione posticipata, dove viene quindi gestito dal thread IP interno, che comporta la quantità minima di tempo di elaborazione ISR.</span><span class="sxs-lookup"><span data-stu-id="228cd-169">This service places the IP packet in the deferred processing queue where it is then handled by the internal IP thread, which results in the least amount of ISR processing time.</span></span>

<span data-ttu-id="228cd-170">Il driver di rete può anche rinviare l'elaborazione di interrupt per esaurire il contesto del thread IP.</span><span class="sxs-lookup"><span data-stu-id="228cd-170">The network driver can also defer interrupt processing to run out of the context of the IP thread.</span></span> <span data-ttu-id="228cd-171">In questa modalità, l'ISR deve salvare le informazioni necessarie, chiamare la funzione interna ***_nx_ip_driver_deferred_processing*** e confermare il controller di interrupt.</span><span class="sxs-lookup"><span data-stu-id="228cd-171">In this mode, the ISR shall save the necessary information, call the internal function ***_nx_ip_driver_deferred_processing***, and acknowledge the interrupt controller.</span></span> <span data-ttu-id="228cd-172">Questo servizio invia una notifica al thread IP per pianificare un callback al driver di dispositivo per completare l'elaborazione dell'evento che provoca l'interruzione.</span><span class="sxs-lookup"><span data-stu-id="228cd-172">This service notifies IP thread to schedule a callback to the device driver to complete the processing of the event that causes the interrupt.</span></span>

<span data-ttu-id="228cd-173">Alcuni controller di rete sono in grado di eseguire il calcolo e la convalida del checksum dell'intestazione TCP/IP nell'hardware, senza occupare risorse di CPU utili.</span><span class="sxs-lookup"><span data-stu-id="228cd-173">Some network controllers are capable of performing TCP/IP header checksum computation and validation in hardware, without taking up valuable CPU resources.</span></span> <span data-ttu-id="228cd-174">Per sfruttare i vantaggi della funzionalità hardware funzionalità, NetX fornisce opzioni per abilitare o disabilitare diversi calcoli di checksum software in fase di compilazione, nonché per attivare o disattivare il calcolo dei checksum in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="228cd-174">To take advantage of the hardware capability feature, NetX provides options to enable or disable various software checksum computation at compilation time, as well as turning on or off checksum computation at run time.</span></span> <span data-ttu-id="228cd-175">Per informazioni più dettagliate sulla scrittura di driver di rete NetX, vedere "[capitolo 5 driver di rete NETX](chapter5.md)".</span><span class="sxs-lookup"><span data-stu-id="228cd-175">See "[Chapter 5 NetX Network Drivers](chapter5.md)" for more detailed information on writing NetX network drivers.</span></span>

### <a name="multihome-support"></a><span data-ttu-id="228cd-176">Supporto multihome</span><span class="sxs-lookup"><span data-stu-id="228cd-176">Multihome Support</span></span>
<span data-ttu-id="228cd-177">NetX supporta i sistemi connessi a più dispositivi fisici usando una singola istanza IP.</span><span class="sxs-lookup"><span data-stu-id="228cd-177">NetX supports systems connected to multiple physical devices using a single IP instance.</span></span> <span data-ttu-id="228cd-178">Ogni interfaccia fisica viene assegnata a un blocco di controllo dell'interfaccia nell'istanza IP.</span><span class="sxs-lookup"><span data-stu-id="228cd-178">Each physical interface is assigned to an interface control block in the IP instance.</span></span> <span data-ttu-id="228cd-179">Le applicazioni che desiderano utilizzare un sistema multihome devono definire il valore per **NX_MAX_PHSYCIAL_INTERFACES** al numero di dispositivi fisici collegati al sistema e ricompilare la libreria NETX.</span><span class="sxs-lookup"><span data-stu-id="228cd-179">Applications wishing to use a multihome system must define the value for **NX_MAX_PHSYCIAL_INTERFACES** to the number of physical devices attached to the system, and rebuild NetX library.</span></span> <span data-ttu-id="228cd-180">Per impostazione predefinita **NX_MAX_PHYSICAL_INTERFACES** è impostato su uno, creando un blocco di controllo dell'interfaccia nell'istanza IP.</span><span class="sxs-lookup"><span data-stu-id="228cd-180">By default **NX_MAX_PHYSICAL_INTERFACES** is set to one, creating one interface control block in the IP instance.</span></span>

<span data-ttu-id="228cd-181">L'applicazione NetX crea una singola istanza IP per il dispositivo primario usando il servizio \***nx_ip_create** _.</span><span class="sxs-lookup"><span data-stu-id="228cd-181">The NetX application creates a single IP instance for the primary device using the \***nx_ip_create** _ service.</span></span> <span data-ttu-id="228cd-182">Per ogni dispositivo di rete aggiuntivo, l'applicazione connette il dispositivo all'istanza IP usando il servizio _ \*_nx_ip_interface_attach_\*\*.</span><span class="sxs-lookup"><span data-stu-id="228cd-182">For each additional network devices, the application attaches the device to the IP instance using the _ *_nx_ip_interface_attach_*\* service.</span></span>

<span data-ttu-id="228cd-183">Ogni struttura di interfaccia di rete contiene un subset di informazioni di rete sull'interfaccia di rete contenuta nel blocco di controllo IP, tra cui indirizzo IP dell'interfaccia, subnet mask, dimensioni MTU IP e informazioni sugli indirizzi del livello MAC.</span><span class="sxs-lookup"><span data-stu-id="228cd-183">Each network interface structure contains a subset of network information about the network interface that is contained in the IP control block, including interface IP address, subnet mask, IP MTU size, and MAC-layer address information.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="228cd-184">*NetX con supporto multihome è compatibile con le versioni precedenti di NetX. I servizi che non accettano informazioni esplicite sull'interfaccia vengono predefiniti per il dispositivo di rete primario.*</span><span class="sxs-lookup"><span data-stu-id="228cd-184">*NetX with multihome support is backward compatible with earlier versions of NetX. Services that do not take explicit interface information default to the primary network device.*</span></span>

<span data-ttu-id="228cd-185">L'interfaccia primaria ha indice zero nell'elenco di istanze IP.</span><span class="sxs-lookup"><span data-stu-id="228cd-185">The primary interface has index zero in the IP instance list.</span></span> <span data-ttu-id="228cd-186">A ogni dispositivo successivo collegato all'istanza IP viene assegnato l'indice successivo.</span><span class="sxs-lookup"><span data-stu-id="228cd-186">Each subsequent device attached to the IP instance is assigned the next index.</span></span>

<span data-ttu-id="228cd-187">Tutti i servizi del protocollo di livello superiore per i quali è abilitata l'istanza IP, inclusi TCP, UDP, ICMP e IGMP, sono disponibili per tutti i dispositivi collegati.</span><span class="sxs-lookup"><span data-stu-id="228cd-187">All upper layer protocol services for which the IP instance is enabled, including TCP, UDP, ICMP, and IGMP, are available to all the attached devices.</span></span>

<span data-ttu-id="228cd-188">Nella maggior parte dei casi, NetX è in grado di determinare l'indirizzo di origine migliore da usare durante la trasmissione di un pacchetto.</span><span class="sxs-lookup"><span data-stu-id="228cd-188">In most cases, NetX can determine the best source address to use when transmitting a packet.</span></span> <span data-ttu-id="228cd-189">La selezione dell'indirizzo di origine è basata sull'indirizzo di destinazione.</span><span class="sxs-lookup"><span data-stu-id="228cd-189">The source address selection is based on the destination address.</span></span> <span data-ttu-id="228cd-190">I servizi NetX vengono forniti per consentire alle applicazioni di specificare un indirizzo di origine specifico da usare, nei casi in cui l'indirizzo di destinazione non può essere determinato da quello più adatto.</span><span class="sxs-lookup"><span data-stu-id="228cd-190">NetX services are provided to allow applications to specify a specific source address to use, in cases where the most suitable one cannot be determined by the destination address.</span></span> <span data-ttu-id="228cd-191">Un esempio è costituito da un sistema multihome, un'applicazione deve inviare un pacchetto a un indirizzo di trasmissione IP o di destinazione multicast.</span><span class="sxs-lookup"><span data-stu-id="228cd-191">An example would be in a multihome system, an application needs to send a packet to an IP broadcast or multicast destination addresses.</span></span>

<span data-ttu-id="228cd-192">I servizi specifici per lo sviluppo di applicazioni multihome includono quanto segue:</span><span class="sxs-lookup"><span data-stu-id="228cd-192">Services specifically for developing multihome applications include the following:</span></span>

<span data-ttu-id="228cd-193">*nx_igmp_multicast_interface_join nx_ip_driver_interface_direct_command nx_ip_interface_address_get nx_ip_interface_address_set nx_ip_interface_attach nx_ip_interface_info_get nx_ip_interface_status_check nx_ip_raw_packet_interface_send nx_udp_socket_interface_send*</span><span class="sxs-lookup"><span data-stu-id="228cd-193">*nx_igmp_multicast_interface_join nx_ip_driver_interface_direct_command nx_ip_interface_address_get nx_ip_interface_address_set nx_ip_interface_attach nx_ip_interface_info_get nx_ip_interface_status_check nx_ip_raw_packet_interface_send nx_udp_socket_interface_send*</span></span>

<span data-ttu-id="228cd-194">Questi servizi sono descritti in modo più dettagliato in "[capitolo 4-Descrizione dei servizi NETX di Azure RTO](chapter4.md)".</span><span class="sxs-lookup"><span data-stu-id="228cd-194">These services are explained in greater detail in "[Chapter 4 - Description of Azure RTOS NetX Services](chapter4.md)".</span></span>

### <a name="loopback-interface"></a><span data-ttu-id="228cd-195">Interfaccia loopback</span><span class="sxs-lookup"><span data-stu-id="228cd-195">Loopback Interface</span></span>
<span data-ttu-id="228cd-196">L'interfaccia di loopback è un'interfaccia di rete speciale senza collegamento fisico associato a.</span><span class="sxs-lookup"><span data-stu-id="228cd-196">The loopback interface is a special network interface without an physical link attached to.</span></span> <span data-ttu-id="228cd-197">L'interfaccia di loopback consente alle applicazioni di comunicare utilizzando l'indirizzo IP di loopback 127.0.0.1</span><span class="sxs-lookup"><span data-stu-id="228cd-197">The loopback interface allows applications to communicate using the IP loopback address 127.0.0.1</span></span>

<span data-ttu-id="228cd-198">Per utilizzare un'interfaccia di loopback logica, assicurarsi che l'opzione configurabile ***NX_DISABLE_LOOPBACK_INTERFACE*** non sia impostata.</span><span class="sxs-lookup"><span data-stu-id="228cd-198">To utilize a logical loopback interface, ensure the configurable option ***NX_DISABLE_LOOPBACK_INTERFACE*** is not set.</span></span>

### <a name="interface-control-blocks"></a><span data-ttu-id="228cd-199">Blocchi di controllo dell'interfaccia</span><span class="sxs-lookup"><span data-stu-id="228cd-199">Interface Control Blocks</span></span>
<span data-ttu-id="228cd-200">Il numero di blocchi di controllo dell'interfaccia nell'istanza IP è il numero di interfacce fisiche (definite da \***NX_MAX_PHYSICAL_INTERFACES** _) più l'interfaccia di loopback se abilitata.</span><span class="sxs-lookup"><span data-stu-id="228cd-200">The number of interface control blocks in the IP instance is the number of physical interfaces (defined by \***NX_MAX_PHYSICAL_INTERFACES** _) plus the loopback interface if it is enabled.</span></span> <span data-ttu-id="228cd-201">Il numero totale di interfacce è definito in _ *_NX_MAX_IP_INTERFACES_* \*.</span><span class="sxs-lookup"><span data-stu-id="228cd-201">The total number of interfaces is defined in _\*_NX_MAX_IP_INTERFACES_\*\*.</span></span>

## <a name="protocol-layering"></a><span data-ttu-id="228cd-202">Layering del protocollo</span><span class="sxs-lookup"><span data-stu-id="228cd-202">Protocol Layering</span></span>

<span data-ttu-id="228cd-203">Il protocollo TCP/IP implementato da NetX è un protocollo sovrapposto, che significa che i protocolli più complessi sono basati su protocolli sottostanti più semplici.</span><span class="sxs-lookup"><span data-stu-id="228cd-203">The TCP/IP implemented by NetX is a layered protocol, which means more complex protocols are built on top of simpler underlying protocols.</span></span> <span data-ttu-id="228cd-204">In TCP/IP, il protocollo di livello più basso si trova a *livello di collegamento* e viene gestito dal driver di rete.</span><span class="sxs-lookup"><span data-stu-id="228cd-204">In TCP/ IP, the lowest layer protocol is at the *link Layer* and is handled by the network driver.</span></span> <span data-ttu-id="228cd-205">Questo livello è in genere destinato a Ethernet, ma può anche essere Fiber, seriale o praticamente qualsiasi supporto fisico.</span><span class="sxs-lookup"><span data-stu-id="228cd-205">This level is typically targeted towards Ethernet, but it could also be fiber, serial, or virtually any physical media.</span></span>

<span data-ttu-id="228cd-206">Sopra il livello di collegamento è il *livello di rete*.</span><span class="sxs-lookup"><span data-stu-id="228cd-206">On top of the link layer is the *Network layer*.</span></span> <span data-ttu-id="228cd-207">In TCP/IP, questo è l'indirizzo IP, che è essenzialmente responsabile dell'invio e della ricezione di pacchetti semplici, in modo ottimale, attraverso la rete.</span><span class="sxs-lookup"><span data-stu-id="228cd-207">In TCP/IP, this is the IP, which is basically responsible for sending and receiving simple packets, in a best-effort manner, across the network.</span></span> <span data-ttu-id="228cd-208">I protocolli di tipo di gestione come ICMP e IGMP vengono in genere categorizzati anche come livelli di rete, anche se si basano su IP per l'invio e la ricezione.</span><span class="sxs-lookup"><span data-stu-id="228cd-208">Management type protocols like ICMP and IGMP are typically also categorized as network layers, even though they rely on IP for sending and receiving.</span></span>

<span data-ttu-id="228cd-209">Il *livello di trasporto* è posizionato sopra il livello di rete.</span><span class="sxs-lookup"><span data-stu-id="228cd-209">The *Transport layer* rests on top of the network layer.</span></span> <span data-ttu-id="228cd-210">Questo livello è responsabile della gestione del flusso di dati tra gli host nella rete.</span><span class="sxs-lookup"><span data-stu-id="228cd-210">This layer is responsible for managing the flow of data between hosts on the network.</span></span> <span data-ttu-id="228cd-211">Sono disponibili due tipi di servizi di trasporto supportati da NetX: UDP e TCP.</span><span class="sxs-lookup"><span data-stu-id="228cd-211">There are two types of transport services supported by NetX: UDP and TCP.</span></span> <span data-ttu-id="228cd-212">I servizi UDP garantiscono l'invio e la ricezione dei dati tra due host senza connessione, mentre TCP fornisce un servizio affidabile orientato alla connessione tra due entità host.</span><span class="sxs-lookup"><span data-stu-id="228cd-212">UDP services provide best-effort sending and receiving of data between two hosts in a connectionless manner, while TCP provides reliable connection-oriented service between two host entities.</span></span>

<span data-ttu-id="228cd-213">Questo livello viene riflesso nei pacchetti di dati di rete effettivi.</span><span class="sxs-lookup"><span data-stu-id="228cd-213">This layering is reflected in the actual network data packets.</span></span> <span data-ttu-id="228cd-214">Ogni livello in TCP/IP contiene un blocco di informazioni denominato intestazione.</span><span class="sxs-lookup"><span data-stu-id="228cd-214">Each layer in TCP/IP contains a block of information called a header.</span></span> <span data-ttu-id="228cd-215">Questa tecnica relativa ai dati circostanti (e possibilmente alle informazioni sul protocollo) con un'intestazione viene in genere chiamata incapsulamento dei dati.</span><span class="sxs-lookup"><span data-stu-id="228cd-215">This technique of surrounding data (and possibly protocol information) with a header is typically called data encapsulation.</span></span> <span data-ttu-id="228cd-216">Nella figura 1 viene illustrato un esempio di NetX layering e la figura 2 Mostra l'incapsulamento dei dati risultante per i dati UDP inviati.</span><span class="sxs-lookup"><span data-stu-id="228cd-216">Figure 1 shows an example of NetX layering and Figure 2 shows the resulting data encapsulation for UDP data being sent.</span></span>

![Layering del protocollo](./media/user-guide/protocol-layering.png)

<span data-ttu-id="228cd-218">**FIGURA 1. Layering del protocollo**</span><span class="sxs-lookup"><span data-stu-id="228cd-218">**FIGURE 1. Protocol Layering**</span></span>

![Incapsulamento dei dati UDP](./media/user-guide/udp-data-encapsulation.png)

<span data-ttu-id="228cd-220">**FIGURA 2. Incapsulamento dei dati UDP**</span><span class="sxs-lookup"><span data-stu-id="228cd-220">**FIGURE 2. UDP Data Encapsulation**</span></span>

## <a name="packet-pools"></a><span data-ttu-id="228cd-221">Pool di pacchetti</span><span class="sxs-lookup"><span data-stu-id="228cd-221">Packet Pools</span></span>

<span data-ttu-id="228cd-222">L'allocazione di pacchetti in modo rapido e deterministico è sempre una sfida nelle applicazioni di rete in tempo reale.</span><span class="sxs-lookup"><span data-stu-id="228cd-222">Allocating packets in a fast and deterministic manner is always a challenge in real-time networking applications.</span></span> <span data-ttu-id="228cd-223">Tenendo presente questo aspetto, NetX offre la possibilità di creare e gestire più pool di pacchetti di rete a dimensione fissa.</span><span class="sxs-lookup"><span data-stu-id="228cd-223">With this in mind, NetX provides the ability to create and manage multiple pools of fixed-size network packets.</span></span>

<span data-ttu-id="228cd-224">Poiché i pool di pacchetti NetX sono costituiti da blocchi di memoria a dimensione fissa, non si verificano mai problemi di frammentazione interna.</span><span class="sxs-lookup"><span data-stu-id="228cd-224">Because NetX packet pools consist of fixed-size memory blocks, there are never any internal fragmentation problems.</span></span> <span data-ttu-id="228cd-225">Naturalmente, la frammentazione causa comportamenti intrinsecamente non deterministici.</span><span class="sxs-lookup"><span data-stu-id="228cd-225">Of course, fragmentation causes behavior that is inherently nondeterministic.</span></span>

<span data-ttu-id="228cd-226">Inoltre, il tempo necessario per allocare e liberare un pacchetto NetX equivale a una semplice manipolazione di elenchi collegati.</span><span class="sxs-lookup"><span data-stu-id="228cd-226">In addition, the time required to allocate and free a NetX packet amounts to simple linked-list manipulation.</span></span> <span data-ttu-id="228cd-227">Inoltre, l'allocazione e la deallocazione dei pacchetti vengono eseguite all'inizio dell'elenco disponibile.</span><span class="sxs-lookup"><span data-stu-id="228cd-227">Furthermore, packet allocation and deallocation is done at the head of the available list.</span></span> <span data-ttu-id="228cd-228">In questo modo si fornisce l'elaborazione dell'elenco collegato più veloce possibile.</span><span class="sxs-lookup"><span data-stu-id="228cd-228">This provides the fastest possible linked list processing.</span></span>

<span data-ttu-id="228cd-229">La mancanza di flessibilità è in genere lo svantaggio principale dei pool di pacchetti a dimensione fissa.</span><span class="sxs-lookup"><span data-stu-id="228cd-229">Lack of flexibility is typically the main drawback of fixed-size packet pools.</span></span> <span data-ttu-id="228cd-230">Determinare le dimensioni del payload dei pacchetti ottimali che gestiscono anche il pacchetto in ingresso peggiore è un'attività difficile.</span><span class="sxs-lookup"><span data-stu-id="228cd-230">Determining the optimal packet payload size that also handles the worst-case incoming packet is a difficult task.</span></span> <span data-ttu-id="228cd-231">I pacchetti NetX affrontano questo problema con una funzionalità facoltativa denominata *concatenamento dei pacchetti*.</span><span class="sxs-lookup"><span data-stu-id="228cd-231">NetX packets address this problem with an optional feature called *packet chaining*.</span></span> <span data-ttu-id="228cd-232">Un pacchetto di rete effettivo può essere composto da uno o più pacchetti NetX collegati tra loro.</span><span class="sxs-lookup"><span data-stu-id="228cd-232">An actual network packet can be made of one or more NetX packets linked together.</span></span> <span data-ttu-id="228cd-233">Inoltre, l'intestazione del pacchetto mantiene un puntatore all'inizio del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="228cd-233">In addition, the packet header maintains a pointer to the top of the packet.</span></span> <span data-ttu-id="228cd-234">Quando vengono aggiunti altri protocolli, questo puntatore viene semplicemente spostato all'indietro e la nuova intestazione viene scritta direttamente davanti ai dati.</span><span class="sxs-lookup"><span data-stu-id="228cd-234">As additional protocols are added, this pointer is simply moved backwards and the new header is written directly in front of the data.</span></span> <span data-ttu-id="228cd-235">Senza la tecnologia flessibile dei pacchetti, lo stack dovrebbe allocare un altro buffer e copiare i dati in un nuovo buffer con la nuova intestazione, che sta elaborando in modo intensivo.</span><span class="sxs-lookup"><span data-stu-id="228cd-235">Without the flexible packet technology, the stack would have to allocate another buffer and copy the data into a new buffer with the new header, which is processing intensive.</span></span>

<span data-ttu-id="228cd-236">Poiché le dimensioni del payload del pacchetto sono fisse per un determinato pool di pacchetti, i dati dell'applicazione di dimensioni maggiori rispetto alle dimensioni del payload richiedono la concatenazione di più pacchetti.</span><span class="sxs-lookup"><span data-stu-id="228cd-236">Since each packet payload size is fixed for a given packet pool, application data larger than the payload size  requires multiple packets chained together.</span></span> <span data-ttu-id="228cd-237">Quando si compila un pacchetto con dati utente, l'applicazione deve utilizzare il servizio ***nx_packet_data_append***.</span><span class="sxs-lookup"><span data-stu-id="228cd-237">When filling a packet with user data, the application must use the service ***nx_packet_data_append***.</span></span> <span data-ttu-id="228cd-238">Questo servizio sposta i dati dell'applicazione in un pacchetto.</span><span class="sxs-lookup"><span data-stu-id="228cd-238">This service moves application data into a packet.</span></span> <span data-ttu-id="228cd-239">Nei casi in cui un pacchetto non è sufficiente per contenere i dati utente, vengono allocati pacchetti aggiuntivi per archiviare i dati utente.</span><span class="sxs-lookup"><span data-stu-id="228cd-239">In situations where a packet is not enough to hold user data, additional packets are allocated to store user data.</span></span> <span data-ttu-id="228cd-240">Per utilizzare il concatenamento dei pacchetti, il driver deve essere in grado di ricevere o trasmettere da pacchetti concatenati.</span><span class="sxs-lookup"><span data-stu-id="228cd-240">To use packet chaining, the driver must be able to receive into or transmit from chained packets.</span></span>

<span data-ttu-id="228cd-241">Ogni pool di memoria del pacchetto NetX è una risorsa pubblica.</span><span class="sxs-lookup"><span data-stu-id="228cd-241">Each NetX packet memory pool is a public resource.</span></span> <span data-ttu-id="228cd-242">NetX non impone vincoli sul modo in cui vengono utilizzati i pool di pacchetti.</span><span class="sxs-lookup"><span data-stu-id="228cd-242">NetX places no constraints on how packet pools are used.</span></span>

### <a name="packet-pool-memory-area"></a><span data-ttu-id="228cd-243">Area memoria pool di pacchetti</span><span class="sxs-lookup"><span data-stu-id="228cd-243">Packet Pool Memory Area</span></span>
<span data-ttu-id="228cd-244">L'area di memoria per il pool di pacchetti viene specificata durante la creazione.</span><span class="sxs-lookup"><span data-stu-id="228cd-244">The memory area for the packet pool is specified during creation.</span></span> <span data-ttu-id="228cd-245">Analogamente ad altre aree di memoria per gli oggetti ThreadX e NetX, può trovarsi in qualsiasi punto dello spazio degli indirizzi della destinazione.</span><span class="sxs-lookup"><span data-stu-id="228cd-245">Like other memory areas for ThreadX and NetX objects, it can be located anywhere in the target's address space.</span></span> <span data-ttu-id="228cd-246">Si tratta di una funzionalità importante grazie alla notevole flessibilità offerta dall'applicazione.</span><span class="sxs-lookup"><span data-stu-id="228cd-246">This is an important feature because of the considerable flexibility it gives the application.</span></span> <span data-ttu-id="228cd-247">Si supponga, ad esempio, che un prodotto di comunicazione disponga di un'area di memoria ad alta velocità per i buffer di rete.</span><span class="sxs-lookup"><span data-stu-id="228cd-247">For example, suppose that a communication product has a high-speed memory area for network buffers.</span></span> <span data-ttu-id="228cd-248">Questa area di memoria è facilmente utilizzabile rendendola in un pool di memoria pacchetti NetX.</span><span class="sxs-lookup"><span data-stu-id="228cd-248">This memory area is easily utilized by making it into a NetX packet memory pool.</span></span>

### <a name="creating-packet-pools"></a><span data-ttu-id="228cd-249">Creazione di pool di pacchetti</span><span class="sxs-lookup"><span data-stu-id="228cd-249">Creating Packet Pools</span></span>
<span data-ttu-id="228cd-250">I pool di pacchetti vengono creati durante l'inizializzazione o durante la fase di esecuzione dai thread dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="228cd-250">Packet pools are created either during initialization or during runtime by application threads.</span></span> <span data-ttu-id="228cd-251">Non sono previsti limiti per il numero di pool di memoria pacchetti in un'applicazione NetX.</span><span class="sxs-lookup"><span data-stu-id="228cd-251">There are no limits on the number of packet memory pools in a NetX application.</span></span>

### <a name="packet-header-nx_packet"></a><span data-ttu-id="228cd-252">NX_PACKET intestazione pacchetto</span><span class="sxs-lookup"><span data-stu-id="228cd-252">Packet Header NX_PACKET</span></span>
<span data-ttu-id="228cd-253">Per impostazione predefinita, NetX inserisce l'intestazione del pacchetto immediatamente prima dell'area del payload del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="228cd-253">By default, NetX places the packet header immediately before the packet payload area.</span></span> <span data-ttu-id="228cd-254">Il pool di memoria pacchetti è fondamentalmente una serie di pacchetti, ovvero le intestazioni seguite immediatamente dal payload del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="228cd-254">The packet memory pool is basically a series of packets—headers followed immediately by the packet payload.</span></span> <span data-ttu-id="228cd-255">L'intestazione del pacchetto (***NX_PACKET***) e il layout del pool di pacchetti sono illustrati nella figura 3.</span><span class="sxs-lookup"><span data-stu-id="228cd-255">The packet header (***NX_PACKET***) and the layout of the packet pool are pictured in Figure 3.</span></span>

<span data-ttu-id="228cd-256">Per i driver dei dispositivi di rete che sono in grado di eseguire zero operazioni di copia, in genere l'indirizzo iniziale dell'area del payload del pacchetto viene programmato nella logica DMA.</span><span class="sxs-lookup"><span data-stu-id="228cd-256">For network devices driver that are able to perform zero copy operations, typically the starting address of the packet payload area is programmed into the DMA logic.</span></span> <span data-ttu-id="228cd-257">Alcuni motori DMA hanno requisiti di allineamento nell'area del payload.</span><span class="sxs-lookup"><span data-stu-id="228cd-257">Certain DMA engines have alignment requirement on the payload area.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="228cd-258">\* È necessario che il driver di rete chiami la funzione \***nx_packet_transmit_release** _ al termine della trasmissione di un pacchetto.</span><span class="sxs-lookup"><span data-stu-id="228cd-258">\*The network driver to must call the \***nx_packet_transmit_release** _ function when the transmission of a packet is complete.</span></span> <span data-ttu-id="228cd-259">Questa funzione verifica che il pacchetto non faccia parte di una coda di output TCP prima che venga effettivamente inserito nel pool disponibile.</span><span class="sxs-lookup"><span data-stu-id="228cd-259">This function checks to make sure the packet is not part of a TCP output queue before it is actually placed back in the available pool.</span></span> <span data-ttu-id="228cd-260">La mancata chiamata di questa funzione può comportare behavior._ imprevedibili</span><span class="sxs-lookup"><span data-stu-id="228cd-260">Failure to call this function can result in unpredictable behavior._</span></span>

![Layout dell'intestazione e del pool di pacchetti](./media/user-guide/packet-header-packet-pool-layout.png)

<span data-ttu-id="228cd-262">**FIGURA 3. Layout dell'intestazione e del pool di pacchetti**</span><span class="sxs-lookup"><span data-stu-id="228cd-262">**FIGURE 3. Packet Header and Packet Pool Layout**</span></span>

<span data-ttu-id="228cd-263">I campi dell'intestazione del pacchetto vengono definiti come illustrato nella tabella seguente.</span><span class="sxs-lookup"><span data-stu-id="228cd-263">The fields of the packet header are defined as shown in the following table.</span></span> <span data-ttu-id="228cd-264">Si noti che questa tabella non è un elenco completo di tutti i membri della struttura *NX_PACKET* .</span><span class="sxs-lookup"><span data-stu-id="228cd-264">Note that this table is not a comprehensive list of all the members in the *NX_PACKET* structure.</span></span>

| <span data-ttu-id="228cd-265">Intestazione pacchetto</span><span class="sxs-lookup"><span data-stu-id="228cd-265">Packet header</span></span>          | <span data-ttu-id="228cd-266">Scopo</span><span class="sxs-lookup"><span data-stu-id="228cd-266">Purpose</span></span>                                                                                                                                                                                                                                                                                                                            |
|------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="228cd-267">*nx_packet_pool_owner*</span><span class="sxs-lookup"><span data-stu-id="228cd-267">*nx_packet_pool_owner*</span></span>   | <span data-ttu-id="228cd-268">Questo campo fa riferimento al pool di pacchetti proprietario del pacchetto specifico.</span><span class="sxs-lookup"><span data-stu-id="228cd-268">This field points to the packet pool that owns this particular packet.</span></span> <span data-ttu-id="228cd-269">Quando il pacchetto viene rilasciato, viene rilasciato a questo particolare pool.</span><span class="sxs-lookup"><span data-stu-id="228cd-269">When the packet is released, it is released to this particular pool.</span></span> <span data-ttu-id="228cd-270">Con la proprietà del pool all'interno di ogni pacchetto, è possibile che un datagramma si estenda su più pacchetti da più pool di pacchetti.</span><span class="sxs-lookup"><span data-stu-id="228cd-270">With the pool ownership inside each packet, it is possible for a datagram to span multiple packets from multiple packet pools.</span></span>                                                         |
| <span data-ttu-id="228cd-271">*nx_packet_next*</span><span class="sxs-lookup"><span data-stu-id="228cd-271">*nx_packet_next*</span></span>         | <span data-ttu-id="228cd-272">Questo campo fa riferimento al pacchetto successivo all'interno dello stesso frame.</span><span class="sxs-lookup"><span data-stu-id="228cd-272">This field points to the next packet within the same frame.</span></span> <span data-ttu-id="228cd-273">Se è NULL, non sono presenti pacchetti aggiuntivi che fanno parte del frame.</span><span class="sxs-lookup"><span data-stu-id="228cd-273">If NULL, there are no additional packets that are part of the frame.</span></span> |
| <span data-ttu-id="228cd-274">*nx_packet_last*</span><span class="sxs-lookup"><span data-stu-id="228cd-274">*nx_packet_last*</span></span>         | <span data-ttu-id="228cd-275">Questo campo punta all'ultimo pacchetto all'interno dello stesso pacchetto di rete.</span><span class="sxs-lookup"><span data-stu-id="228cd-275">This field points to the last packet within the same network packet.</span></span> <span data-ttu-id="228cd-276">Se NULL, questo pacchetto rappresenta l'intero pacchetto di rete.</span><span class="sxs-lookup"><span data-stu-id="228cd-276">If NULL, this packet represents the entire network packet.</span></span>  |
| <span data-ttu-id="228cd-277">*nx_packet_length*</span><span class="sxs-lookup"><span data-stu-id="228cd-277">*nx_packet_length*</span></span>       | <span data-ttu-id="228cd-278">Questo campo contiene il numero totale di byte nell'intero pacchetto di rete, incluso il totale di tutti i byte in tutti i pacchetti concatenati dal membro *nx_packet_next* .</span><span class="sxs-lookup"><span data-stu-id="228cd-278">This field contains the total number of bytes in the entire network packet, including the total of all bytes in all packets chained together by the *nx_packet_next* member.</span></span> |
| <span data-ttu-id="228cd-279">*nx_packet_ip_interface*</span><span class="sxs-lookup"><span data-stu-id="228cd-279">*nx_packet_ip_interface*</span></span> | <span data-ttu-id="228cd-280">Questo campo è il blocco di controllo dell'interfaccia che viene assegnato al pacchetto quando viene ricevuto dal driver di interfaccia e da NetX per i pacchetti in uscita.</span><span class="sxs-lookup"><span data-stu-id="228cd-280">This field is the interface control block which is assigned to the packet when it is received by the interface driver, and by NetX for outgoing packets.</span></span> <span data-ttu-id="228cd-281">Un blocco di controllo dell'interfaccia descrive l'interfaccia, ad esempio l'indirizzo di rete, l'indirizzo MAC, l'indirizzo IP e lo stato dell'interfaccia, ad esempio collegamento abilitato e mapping fisico obbligatorio.</span><span class="sxs-lookup"><span data-stu-id="228cd-281">An interface control block describes the interface e.g. network address, MAC address, IP address and interface status such as link enabled and physical mapping required.</span></span> |
| <span data-ttu-id="228cd-282">*nx_packet_data_start*</span><span class="sxs-lookup"><span data-stu-id="228cd-282">*nx_packet_data_start*</span></span>   | <span data-ttu-id="228cd-283">Questo campo punta all'inizio dell'area del payload fisico del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="228cd-283">This field points to the start of the physical payload area of this packet.</span></span> <span data-ttu-id="228cd-284">Non è necessario che si trovi immediatamente dopo l'intestazione NX_PACKET, ma è l'impostazione predefinita per il servizio ***nx_packet_pool_create*** .</span><span class="sxs-lookup"><span data-stu-id="228cd-284">It does not have to be immediately following the NX_PACKET header, but that is the default for the ***nx_packet_pool_create*** service.</span></span> |
| <span data-ttu-id="228cd-285">*nx_packet_data_end*</span><span class="sxs-lookup"><span data-stu-id="228cd-285">*nx_packet_data_end*</span></span>     | <span data-ttu-id="228cd-286">Questo campo punta alla fine dell'area del payload fisico del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="228cd-286">This field points to the end of the physical payload area of this packet.</span></span> <span data-ttu-id="228cd-287">La differenza tra questo campo e il campo nx_packet_data_start rappresenta le dimensioni del payload.</span><span class="sxs-lookup"><span data-stu-id="228cd-287">The difference between this field and the nx_packet_data_start field represents the payload size.</span></span> |
| <span data-ttu-id="228cd-288">*nx_packet_prepend_ptr*</span><span class="sxs-lookup"><span data-stu-id="228cd-288">*nx_packet_prepend_ptr*</span></span>  | <span data-ttu-id="228cd-289">Questo campo fa riferimento alla posizione in cui vengono aggiunti i dati dei pacchetti, ovvero l'intestazione del protocollo o i dati effettivi, davanti ai dati dei pacchetti esistenti (se presenti) nell'area del payload del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="228cd-289">This field points to the location of where packet data, either protocol header or actual data, is added in front of the existing packet data (if any) in the packet payload area.</span></span> <span data-ttu-id="228cd-290">Deve essere maggiore o uguale alla posizione del puntatore *nx_packet_data_start* e minore o uguale al puntatore di *nx_packet_append_ptr* .</span><span class="sxs-lookup"><span data-stu-id="228cd-290">It must be greater than or equal to the *nx_packet_data_start* pointer location and less than or equal to the *nx_packet_append_ptr* pointer.</span></span>  <span data-ttu-id="228cd-291">*Per motivi di prestazioni, NetX presuppone che, quando il pacchetto viene passato nei servizi NetX per la trasmissione, il puntatore anteposto punti all'indirizzo allineato a parole lunghe.*</span><span class="sxs-lookup"><span data-stu-id="228cd-291">*For performance reasons, NetX assumes that when the packet is passed into NetX services for transmission, the prepend pointer points to long word aligned address.*</span></span> |
| <span data-ttu-id="228cd-292">*nx_packet_append_ptr*</span><span class="sxs-lookup"><span data-stu-id="228cd-292">*nx_packet_append_ptr*</span></span>    | <span data-ttu-id="228cd-293">Questo campo punta alla fine dei dati attualmente presenti nell'area del payload del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="228cd-293">This field points to the end of the data currently in the packet payload area.</span></span> <span data-ttu-id="228cd-294">Deve trovarsi tra la posizione di memoria a cui punta *nx_packet_prepend_ptr* e *nx_packet_data_end*.</span><span class="sxs-lookup"><span data-stu-id="228cd-294">It must be in between the memory location pointed to by *nx_packet_prepend_ptr* and *nx_packet_data_end*.</span></span> <span data-ttu-id="228cd-295">La differenza tra questo campo e il campo *nx_packet_prepend_ptr* rappresenta la quantità di dati in questo pacchetto.</span><span class="sxs-lookup"><span data-stu-id="228cd-295">The difference between this field and the *nx_packet_prepend_ptr* field represents the amount of data in this packet.</span></span> |
| <span data-ttu-id="228cd-296">*nx_packet_fragment_next*</span><span class="sxs-lookup"><span data-stu-id="228cd-296">*nx_packet_fragment_next*</span></span> | <span data-ttu-id="228cd-297">Questo campo viene utilizzato per contenere pacchetti frammentati fino a quando non è possibile riassemblare l'intero pacchetto.</span><span class="sxs-lookup"><span data-stu-id="228cd-297">This field is used to hold fragmented packets until the entire packet can be re-assembled.</span></span> |
| <span data-ttu-id="228cd-298">*nx_packet_pad*</span><span class="sxs-lookup"><span data-stu-id="228cd-298">*nx_packet_pad*</span></span>           | <span data-ttu-id="228cd-299">Questo campo definisce la lunghezza del riempimento in parole a 4 byte per ottenere il requisito di allineamento desiderato.</span><span class="sxs-lookup"><span data-stu-id="228cd-299">This fields defines the length of padding in 4- byte words to achieve the desired alignment requirement.</span></span> <span data-ttu-id="228cd-300">Questo campo viene rimosso se *NX_PACKET_HEADER_PAD* non è definito.</span><span class="sxs-lookup"><span data-stu-id="228cd-300">This field is removed if *NX_PACKET_HEADER_PAD* is not defined.</span></span> |
|  |  |

### <a name="packet-header-offsets"></a><span data-ttu-id="228cd-301">Offset dell'intestazione del pacchetto</span><span class="sxs-lookup"><span data-stu-id="228cd-301">Packet Header Offsets</span></span>

<span data-ttu-id="228cd-302">Le dimensioni dell'intestazione del pacchetto sono definite in modo da consentire spazio sufficiente per contenere le dimensioni dell'intestazione.</span><span class="sxs-lookup"><span data-stu-id="228cd-302">Packet header size is defined to allow enough room to accommodate the size of the header.</span></span> <span data-ttu-id="228cd-303">Il servizio *nx_packet_allocate* viene utilizzato per allocare un pacchetto e per regolare il puntatore anteposto nel pacchetto in base al tipo di pacchetto specificato.</span><span class="sxs-lookup"><span data-stu-id="228cd-303">The *nx_packet_allocate* service is used to allocate a packet and adjusts the prepend pointer in the packet according to the type of packet specified.</span></span> <span data-ttu-id="228cd-304">Il tipo di pacchetto indica a NetX l'offset necessario per inserire l'intestazione del protocollo, ad esempio UDP, TCP o ICMP, davanti ai dati del protocollo.</span><span class="sxs-lookup"><span data-stu-id="228cd-304">The packet type tells NetX the offset required for inserting the protocol header (such as UDP, TCP, or ICMP) in front of the protocol data.</span></span>

<span data-ttu-id="228cd-305">I tipi seguenti sono definiti in NetX per prendere in considerazione l'intestazione IP e l'intestazione del livello fisico (Ethernet) nel pacchetto.</span><span class="sxs-lookup"><span data-stu-id="228cd-305">The following types are defined in NetX to take into account the IP header and physical layer (Ethernet) header in the packet.</span></span> <span data-ttu-id="228cd-306">Nel secondo caso, si presuppone che sia 16 byte tenendo in considerazione l'allineamento richiesto di 4 byte.</span><span class="sxs-lookup"><span data-stu-id="228cd-306">In the latter case, it is assumed to be 16 bytes taking the required 4-byte alignment into consideration.</span></span> <span data-ttu-id="228cd-307">I pacchetti IP sono ancora definiti in NetX per le applicazioni per l'allocazione di pacchetti per le reti IP.</span><span class="sxs-lookup"><span data-stu-id="228cd-307">IP packets are still defined in NetX for applications to allocate packets for IP networks.</span></span> <span data-ttu-id="228cd-308">La tabella seguente illustra i simboli definiti:</span><span class="sxs-lookup"><span data-stu-id="228cd-308">The following table shows symbols defined:</span></span>

| <span data-ttu-id="228cd-309">Tipo di pacchetto</span><span class="sxs-lookup"><span data-stu-id="228cd-309">Packet Type</span></span>   | <span data-ttu-id="228cd-310">Valore</span><span class="sxs-lookup"><span data-stu-id="228cd-310">Value</span></span> |
|---------------|-------|
| <span data-ttu-id="228cd-311">NX_IP_PACKET</span><span class="sxs-lookup"><span data-stu-id="228cd-311">NX_IP_PACKET</span></span>  | <span data-ttu-id="228cd-312">0x24</span><span class="sxs-lookup"><span data-stu-id="228cd-312">0x24</span></span>  |
| <span data-ttu-id="228cd-313">NX_UDP_PACKET</span><span class="sxs-lookup"><span data-stu-id="228cd-313">NX_UDP_PACKET</span></span> | <span data-ttu-id="228cd-314">0x2c</span><span class="sxs-lookup"><span data-stu-id="228cd-314">0x2c</span></span>  |
| <span data-ttu-id="228cd-315">NX_TCP_PACKET</span><span class="sxs-lookup"><span data-stu-id="228cd-315">NX_TCP_PACKET</span></span> | <span data-ttu-id="228cd-316">0x38</span><span class="sxs-lookup"><span data-stu-id="228cd-316">0x38</span></span>  |
|               |       |

### <a name="pool-capacity"></a><span data-ttu-id="228cd-317">Capacità pool</span><span class="sxs-lookup"><span data-stu-id="228cd-317">Pool Capacity</span></span>
<span data-ttu-id="228cd-318">Il numero di pacchetti in un pool di pacchetti è una funzione delle dimensioni del payload e il numero totale di byte nell'area di memoria fornita al servizio di creazione del pool di pacchetti.</span><span class="sxs-lookup"><span data-stu-id="228cd-318">The number of packets in a packet pool is a function of the payload size and the total number of bytes in the memory area supplied to the packet pool create service.</span></span> <span data-ttu-id="228cd-319">La capacità del pool viene calcolata dividendo le dimensioni del pacchetto (incluse le dimensioni dell'intestazione NX_PACKET, le dimensioni del payload e l'allineamento appropriato) nel numero totale di byte nell'area di memoria specificata.</span><span class="sxs-lookup"><span data-stu-id="228cd-319">The capacity of the pool is calculated by dividing the packet size (including the size of the NX_PACKET header, the payload size, and proper alignment) into the total number of bytes in the supplied memory area.</span></span>

### <a name="thread-suspension"></a><span data-ttu-id="228cd-320">Sospensione thread</span><span class="sxs-lookup"><span data-stu-id="228cd-320">Thread Suspension</span></span>
<span data-ttu-id="228cd-321">I thread dell'applicazione possono sospendere l'attesa di un pacchetto da un pool vuoto.</span><span class="sxs-lookup"><span data-stu-id="228cd-321">Application threads can suspend while waiting for a packet from an empty pool.</span></span> <span data-ttu-id="228cd-322">Quando un pacchetto viene restituito al pool, al thread sospeso viene assegnato questo pacchetto e ripreso.</span><span class="sxs-lookup"><span data-stu-id="228cd-322">When a packet is returned to the pool, the suspended thread is given this packet and resumed.</span></span>

<span data-ttu-id="228cd-323">Se più thread vengono sospesi nello stesso pool di pacchetti, vengono ripresi nell'ordine in cui sono stati sospesi (FIFO).</span><span class="sxs-lookup"><span data-stu-id="228cd-323">If multiple threads are suspended on the same packet pool, they are resumed in the order they were suspended (FIFO).</span></span>

### <a name="pool-statistics-and-errors"></a><span data-ttu-id="228cd-324">Statistiche ed errori del pool</span><span class="sxs-lookup"><span data-stu-id="228cd-324">Pool Statistics and Errors</span></span>
<span data-ttu-id="228cd-325">Se abilitata, gli **errori** software di gestione pacchetti di NETX tengono traccia di diverse statistiche ed errori che possono essere utili per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="228cd-325">If enabled, the NetX packet management software **Errors** keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="228cd-326">Per i pool di pacchetti vengono mantenute le statistiche e i report degli errori seguenti:</span><span class="sxs-lookup"><span data-stu-id="228cd-326">The following statistics and error reports are maintained for packet pools:</span></span>

* <span data-ttu-id="228cd-327">Totale pacchetti nel pool</span><span class="sxs-lookup"><span data-stu-id="228cd-327">Total Packets in Pool</span></span>
* <span data-ttu-id="228cd-328">Pacchetti disponibili nel pool</span><span class="sxs-lookup"><span data-stu-id="228cd-328">Free Packets in Pool</span></span>
* <span data-ttu-id="228cd-329">Richieste di allocazione vuote del pool</span><span class="sxs-lookup"><span data-stu-id="228cd-329">Pool Empty Allocation Requests</span></span>
* <span data-ttu-id="228cd-330">Sospensioni di allocazione vuote del pool</span><span class="sxs-lookup"><span data-stu-id="228cd-330">Pool Empty Allocation Suspensions</span></span>
* <span data-ttu-id="228cd-331">Versioni di pacchetti non valide</span><span class="sxs-lookup"><span data-stu-id="228cd-331">Invalid Packet Releases</span></span>

<span data-ttu-id="228cd-332">Tutte le statistiche e le segnalazioni degli errori, ad eccezione del numero totale e dei pacchetti gratuiti nel pool, sono incorporate nella libreria NetX a meno che non sia definito \***NX_DISABLE_PACKET_INFO** _.</span><span class="sxs-lookup"><span data-stu-id="228cd-332">All of these statistics and error reports, except for total and free packet count in pool, are built into NetX library unless \***NX_DISABLE_PACKET_INFO** _ is defined.</span></span> <span data-ttu-id="228cd-333">Questi dati sono disponibili per l'applicazione con il servizio _ \*_nx_packet_pool_info_get_\*\*.</span><span class="sxs-lookup"><span data-stu-id="228cd-333">This data is available to the application with the _ *_nx_packet_pool_info_get_*\* service.</span></span>

### <a name="packet-pool-control-block-nx_packet_pool"></a><span data-ttu-id="228cd-334">Blocco di controllo del pool di pacchetti NX_PACKET_POOL</span><span class="sxs-lookup"><span data-stu-id="228cd-334">Packet Pool Control Block NX_PACKET_POOL</span></span>

<span data-ttu-id="228cd-335">Le caratteristiche di ogni pool di memoria dei pacchetti sono disponibili nel relativo blocco di controllo.</span><span class="sxs-lookup"><span data-stu-id="228cd-335">The characteristics of each packet memory pool are found in its control block.</span></span> <span data-ttu-id="228cd-336">Contiene informazioni utili, ad esempio l'elenco collegato di pacchetti gratuiti, il numero di pacchetti disponibili e le dimensioni del payload per i pacchetti in questo pool.</span><span class="sxs-lookup"><span data-stu-id="228cd-336">It contains useful information such as the linked list of free packets, the number of free packets, and the payload size for packets in this pool.</span></span> <span data-ttu-id="228cd-337">Questa struttura viene definita nel file *nx_api. h* .</span><span class="sxs-lookup"><span data-stu-id="228cd-337">This structure is defined in the *nx_api.h* file.</span></span>

<span data-ttu-id="228cd-338">I blocchi di controllo del pool di pacchetti possono trovarsi in qualsiasi punto della memoria, ma è più comune fare in modo che il controllo blocchi una struttura globale definendola al di fuori dell'ambito di qualsiasi funzione.</span><span class="sxs-lookup"><span data-stu-id="228cd-338">Packet pool control blocks can be located anywhere in memory, but it is most common to make the control block a global structure by defining it outside the scope of any function.</span></span>

## <a name="ip-protocol"></a><span data-ttu-id="228cd-339">Protocollo IP</span><span class="sxs-lookup"><span data-stu-id="228cd-339">IP Protocol</span></span>

<span data-ttu-id="228cd-340">Il componente IP (Internet Protocol) di NetX è responsabile dell'invio e della ricezione di pacchetti IP in Internet.</span><span class="sxs-lookup"><span data-stu-id="228cd-340">The Internet Protocol (IP) component of NetX is responsible for sending and receiving IP packets on the Internet.</span></span> <span data-ttu-id="228cd-341">In NetX, è il componente responsabile dell'invio e della ricezione di messaggi TCP, UDP, ICMP e IGMP, usando il driver di rete sottostante.</span><span class="sxs-lookup"><span data-stu-id="228cd-341">In NetX, it is the component ultimately responsible for sending and receiving TCP, UDP, ICMP, and IGMP messages, utilizing the underlying network driver.</span></span>

<span data-ttu-id="228cd-342">NetX supporta il protocollo IP (RFC 791)</span><span class="sxs-lookup"><span data-stu-id="228cd-342">NetX supports IP protocol (RFC 791)</span></span>

### <a name="ip-addresses"></a><span data-ttu-id="228cd-343">Indirizzi IP</span><span class="sxs-lookup"><span data-stu-id="228cd-343">IP Addresses</span></span>

<span data-ttu-id="228cd-344">Ogni host su Internet dispone di un identificatore univoco a 32 bit denominato indirizzo IP.</span><span class="sxs-lookup"><span data-stu-id="228cd-344">Each host on the Internet has a unique 32-bit identifier called an IP address.</span></span> <span data-ttu-id="228cd-345">Sono disponibili cinque classi di indirizzi IP, come illustrato nella figura 4.</span><span class="sxs-lookup"><span data-stu-id="228cd-345">There are five classes of IP addresses as described in Figure 4.</span></span> <span data-ttu-id="228cd-346">Gli intervalli delle cinque classi di indirizzi IP sono i seguenti:</span><span class="sxs-lookup"><span data-stu-id="228cd-346">The ranges of the five IP address classes are as follows:</span></span>

| <span data-ttu-id="228cd-347">Classe</span><span class="sxs-lookup"><span data-stu-id="228cd-347">Class</span></span> | <span data-ttu-id="228cd-348">Range</span><span class="sxs-lookup"><span data-stu-id="228cd-348">Range</span></span>                        |
|-------|------------------------------|
| <span data-ttu-id="228cd-349">A</span><span class="sxs-lookup"><span data-stu-id="228cd-349">A</span></span>     | <span data-ttu-id="228cd-350">da 0.0.0.0 a 127.255.255.255</span><span class="sxs-lookup"><span data-stu-id="228cd-350">0.0.0.0 to 127.255.255.255</span></span>   |
| <span data-ttu-id="228cd-351">B</span><span class="sxs-lookup"><span data-stu-id="228cd-351">B</span></span>     | <span data-ttu-id="228cd-352">da 128.0.0.0 a 191.255.255.255</span><span class="sxs-lookup"><span data-stu-id="228cd-352">128.0.0.0 to 191.255.255.255</span></span> |
| <span data-ttu-id="228cd-353">C</span><span class="sxs-lookup"><span data-stu-id="228cd-353">C</span></span>     | <span data-ttu-id="228cd-354">da 192.0.0.0 a 223.255.255.255</span><span class="sxs-lookup"><span data-stu-id="228cd-354">192.0.0.0 to 223.255.255.255</span></span> |
| <span data-ttu-id="228cd-355">D</span><span class="sxs-lookup"><span data-stu-id="228cd-355">D</span></span>     | <span data-ttu-id="228cd-356">da 224.0.0.0 a 239.255.255.255</span><span class="sxs-lookup"><span data-stu-id="228cd-356">224.0.0.0 to 239.255.255.255</span></span> |
| <span data-ttu-id="228cd-357">E</span><span class="sxs-lookup"><span data-stu-id="228cd-357">E</span></span>     | <span data-ttu-id="228cd-358">da 240.0.0.0 a 247.255.255.255</span><span class="sxs-lookup"><span data-stu-id="228cd-358">240.0.0.0 to 247.255.255.255</span></span> |

<span data-ttu-id="228cd-359">**7 bit a 24 bit**</span><span class="sxs-lookup"><span data-stu-id="228cd-359">**7 bits 24 bits**</span></span>

![Struttura degli indirizzi IP](./media/user-guide/ip-address-structure.png)

<span data-ttu-id="228cd-361">**FIGURA 4. Struttura degli indirizzi IP**</span><span class="sxs-lookup"><span data-stu-id="228cd-361">**FIGURE 4. IP Address Structure**</span></span>

<span data-ttu-id="228cd-362">Sono disponibili anche tre tipi di specifiche degli indirizzi: *unicast*, *broadcast* e *multicast*.</span><span class="sxs-lookup"><span data-stu-id="228cd-362">There are also three types of address specifications: *unicast*, *broadcast*, and *multicast*.</span></span> <span data-ttu-id="228cd-363">Gli indirizzi unicast sono gli indirizzi IP che identificano un host specifico su Internet.</span><span class="sxs-lookup"><span data-stu-id="228cd-363">Unicast addresses are those IP addresses that identify a specific host on the Internet.</span></span> <span data-ttu-id="228cd-364">Gli indirizzi unicast possono essere un indirizzo IP di origine o di destinazione.</span><span class="sxs-lookup"><span data-stu-id="228cd-364">Unicast addresses can be either a source or a destination IP address.</span></span> <span data-ttu-id="228cd-365">Un indirizzo di trasmissione identifica tutti gli host in una rete o una subnet specifica e può essere utilizzato solo come indirizzi di destinazione.</span><span class="sxs-lookup"><span data-stu-id="228cd-365">A broadcast address identifies all hosts on a specific network or sub-network and can only be used as destination addresses.</span></span> <span data-ttu-id="228cd-366">Gli indirizzi broadcast vengono specificati con la parte dell'ID host dell'indirizzo impostato su uno.</span><span class="sxs-lookup"><span data-stu-id="228cd-366">Broadcast addresses are specified by having the host ID portion of the address set to ones.</span></span> <span data-ttu-id="228cd-367">Indirizzi multicast (classe D) specificare un gruppo dinamico di host su Internet.</span><span class="sxs-lookup"><span data-stu-id="228cd-367">Multicast addresses (Class D) specify a dynamic group of hosts on the Internet.</span></span> <span data-ttu-id="228cd-368">I membri del gruppo multicast possono partecipare e lasciare ogni volta che desiderano.</span><span class="sxs-lookup"><span data-stu-id="228cd-368">Members of the multicast group may join and leave whenever they wish.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="228cd-369">*Solo i protocolli senza connessione come UDP su IP possono utilizzare la trasmissione e la funzionalità di broadcast limitata del gruppo multicast.*</span><span class="sxs-lookup"><span data-stu-id="228cd-369">*Only connectionless protocols like UDP over IP can utilize broadcast and the limited broadcast capability of the multicast group.*</span></span>

> [!IMPORTANT]
> <span data-ttu-id="228cd-370">*La macro* Ip_address *è definito in*  \* **nx_api. h** _.</span><span class="sxs-lookup"><span data-stu-id="228cd-370">*The macro* IP_ADDRESS *is defined in* \***nx_api.h** _.</span></span> <span data-ttu-id="228cd-371">Consente di specificare facilmente gli indirizzi IP usando le virgole anziché i punti.</span><span class="sxs-lookup"><span data-stu-id="228cd-371">It allows easy specification of IP addresses using commas instead of a periods.</span></span> <span data-ttu-id="228cd-372">Ad esempio, IP_ADDRESS (128, 0, 0, 0) _specifies il primo indirizzo della classe B illustrato nella figura 4. \*</span><span class="sxs-lookup"><span data-stu-id="228cd-372">For example, IP_ADDRESS(128,0,0,0) _specifies the first class B address shown in Figure 4.\*</span></span>

### <a name="ip-gateway-address"></a><span data-ttu-id="228cd-373">Indirizzo IP gateway</span><span class="sxs-lookup"><span data-stu-id="228cd-373">IP Gateway Address</span></span>

<span data-ttu-id="228cd-374">I gateway di rete assistono gli host sulle proprie reti per inoltrare pacchetti destinati a destinazioni esterne al dominio locale.</span><span class="sxs-lookup"><span data-stu-id="228cd-374">Network gateways assist hosts on their networks to relay packets destined to destinations outside the local domain.</span></span> <span data-ttu-id="228cd-375">Ogni nodo ha una certa conoscenza dell'hop successivo da inviare a, ovvero la destinazione di uno degli elementi adiacenti o tramite una tabella di routing statica preprogrammata.</span><span class="sxs-lookup"><span data-stu-id="228cd-375">Each node has some knowledge of which next hop to send to, either the destination one of its neighbors, or through a pre-programmed static routing table.</span></span> <span data-ttu-id="228cd-376">Tuttavia, se questi approcci hanno esito negativo, il nodo deve inoltrare il pacchetto al gateway predefinito, con ulteriori informazioni su come instradare il pacchetto alla relativa destinazione.</span><span class="sxs-lookup"><span data-stu-id="228cd-376">However if these approaches fail, the node should forward the packet to its default gateway which has more information on how to route the packet to its destination.</span></span> <span data-ttu-id="228cd-377">Si noti che il gateway predefinito deve essere direttamente accessibile tramite una delle interfacce fisiche collegate all'istanza IP.</span><span class="sxs-lookup"><span data-stu-id="228cd-377">Note that the default gateway must be directly accessible through one of the physical interfaces attached to the IP instance.</span></span> <span data-ttu-id="228cd-378">L'applicazione chiama ***nx_ip_gateway_address_set*** per configurare l'indirizzo IP del gateway predefinito.</span><span class="sxs-lookup"><span data-stu-id="228cd-378">The application calls ***nx_ip_gateway_address_set*** to configure IP default gateway address.</span></span>

### <a name="ip-header"></a><span data-ttu-id="228cd-379">Intestazione IP</span><span class="sxs-lookup"><span data-stu-id="228cd-379">IP Header</span></span>

<span data-ttu-id="228cd-380">Per ogni pacchetto IP da inviare su Internet, deve avere un'intestazione IP.</span><span class="sxs-lookup"><span data-stu-id="228cd-380">For any IP packet to be sent on the Internet, it must have an IP header.</span></span> <span data-ttu-id="228cd-381">Quando protocolli di livello superiore (UDP, TCP, ICMP o IGMP) chiamano il componente IP per inviare un pacchetto, il modulo trasmissione IP inserisce un'intestazione IP davanti ai dati.</span><span class="sxs-lookup"><span data-stu-id="228cd-381">When higher-level protocols (UDP, TCP, ICMP, or IGMP) call the IP component to send a packet, the IP transmit module places an IP header in front of the data.</span></span> <span data-ttu-id="228cd-382">Viceversa, quando i pacchetti IP vengono ricevuti dalla rete, il componente IP rimuove l'intestazione IP dal pacchetto prima del recapito ai protocolli di livello superiore.</span><span class="sxs-lookup"><span data-stu-id="228cd-382">Conversely, when IP packets are received from the network, the IP component removes the IP header from the packet before delivery to the higher-level protocols.</span></span> <span data-ttu-id="228cd-383">La figura 5 Mostra il formato dell'intestazione IP.</span><span class="sxs-lookup"><span data-stu-id="228cd-383">Figure 5 shows the format of the IP header.</span></span>

![Formato intestazione IP](./media/user-guide/ip-header-format.png)

<span data-ttu-id="228cd-385">**FIGURA 5. Formato intestazione IP**</span><span class="sxs-lookup"><span data-stu-id="228cd-385">**FIGURE 5. IP Header Format**</span></span>

> [!IMPORTANT]
> <span data-ttu-id="228cd-386">*È previsto che tutte le intestazioni nell'implementazione TCP/IP siano in formato big endian. In questo formato, il byte più significativo della parola risiede nell'indirizzo di byte più basso. Ad esempio, la versione a 4 bit e la lunghezza dell'intestazione a 4 bit dell'intestazione IP devono trovarsi sul primo byte dell'intestazione.*</span><span class="sxs-lookup"><span data-stu-id="228cd-386">*All headers in the TCP/IP implementation are expected to be in big endian format. In this format, the most significant byte of the word resides at the lowest byte address. For example, the 4-bit version and the 4-bit header length of the IP header must be located on the first byte of the header.*</span></span>

<span data-ttu-id="228cd-387">I campi dell'intestazione IP sono definiti come segue:</span><span class="sxs-lookup"><span data-stu-id="228cd-387">The fields of the IP header are defined as follows:</span></span>

<span data-ttu-id="228cd-388">**Scopo campo intestazione IP**</span><span class="sxs-lookup"><span data-stu-id="228cd-388">**IP Header Field Purpose**</span></span>

<span data-ttu-id="228cd-389">***versione a 4 bit*** Questo campo contiene la versione di IP rappresentata da questa intestazione.</span><span class="sxs-lookup"><span data-stu-id="228cd-389">***4-bit version*** This field contains the version of IP this header represents.</span></span> <span data-ttu-id="228cd-390">Per IP versione 4, che è il supporto di NetX, il valore di questo campo è 4.</span><span class="sxs-lookup"><span data-stu-id="228cd-390">For IP version 4, which is what NetX supports, the value of this field is 4.</span></span>

<span data-ttu-id="228cd-391">***lunghezza intestazione a 4 bit*** Questo campo specifica il numero di parole a 32 bit nell'intestazione IP.</span><span class="sxs-lookup"><span data-stu-id="228cd-391">***4-bit header length*** This field specifies the number of 32-bit words in the IP header.</span></span> <span data-ttu-id="228cd-392">Se non sono presenti parole di opzione, il valore per questo campo è 5.</span><span class="sxs-lookup"><span data-stu-id="228cd-392">If no option words are present, the value for this field is 5.</span></span>

<span data-ttu-id="228cd-393">***tipo di servizio (TOS) a 8 bit*** Questo campo specifica il tipo di servizio richiesto per il pacchetto IP.</span><span class="sxs-lookup"><span data-stu-id="228cd-393">***8-bit type of service (TOS)*** This field specifies the type of service requested for this IP packet.</span></span> <span data-ttu-id="228cd-394">Le richieste valide sono le seguenti:</span><span class="sxs-lookup"><span data-stu-id="228cd-394">Valid requests are as follows:</span></span>

| <span data-ttu-id="228cd-395">**Richiesta TOS**</span><span class="sxs-lookup"><span data-stu-id="228cd-395">**TOS Request**</span></span>     | <span data-ttu-id="228cd-396">**Valore**</span><span class="sxs-lookup"><span data-stu-id="228cd-396">**Value**</span></span> |
| ------------------- | --------- |
| <span data-ttu-id="228cd-397">Normale</span><span class="sxs-lookup"><span data-stu-id="228cd-397">Normal</span></span>              | <span data-ttu-id="228cd-398">0x00</span><span class="sxs-lookup"><span data-stu-id="228cd-398">0x00</span></span>      |
| <span data-ttu-id="228cd-399">Ritardo minimo</span><span class="sxs-lookup"><span data-stu-id="228cd-399">Minimum Delay</span></span>       | <span data-ttu-id="228cd-400">0x10</span><span class="sxs-lookup"><span data-stu-id="228cd-400">0x10</span></span>      |
| <span data-ttu-id="228cd-401">Numero massimo di dati</span><span class="sxs-lookup"><span data-stu-id="228cd-401">Maximum Data</span></span>        | <span data-ttu-id="228cd-402">0x08</span><span class="sxs-lookup"><span data-stu-id="228cd-402">0x08</span></span>      |
| <span data-ttu-id="228cd-403">Affidabilità massima</span><span class="sxs-lookup"><span data-stu-id="228cd-403">Maximum Reliability</span></span> | <span data-ttu-id="228cd-404">0x04</span><span class="sxs-lookup"><span data-stu-id="228cd-404">0x04</span></span>      |
| <span data-ttu-id="228cd-405">Costo minimo</span><span class="sxs-lookup"><span data-stu-id="228cd-405">Minimum Cost</span></span>        | <span data-ttu-id="228cd-406">0x02</span><span class="sxs-lookup"><span data-stu-id="228cd-406">0x02</span></span>      |

<span data-ttu-id="228cd-407">***lunghezza totale a 16 bit*** Questo campo contiene la lunghezza totale del datagramma IP in byte, inclusa l'intestazione IP.</span><span class="sxs-lookup"><span data-stu-id="228cd-407">***16-bit total length*** This field contains the total length of the IP datagram in bytes, including the IP header.</span></span> <span data-ttu-id="228cd-408">Un datagramma IP è l'unità di base delle informazioni disponibili in una rete Internet TCP/IP.</span><span class="sxs-lookup"><span data-stu-id="228cd-408">An IP datagram is the basic unit of information found on a TCP/IP Internet.</span></span> <span data-ttu-id="228cd-409">Contiene un indirizzo di origine e di destinazione oltre ai dati.</span><span class="sxs-lookup"><span data-stu-id="228cd-409">It contains a destination and source address in addition to data.</span></span> <span data-ttu-id="228cd-410">Poiché si tratta di un campo a 16 bit, le dimensioni massime di un datagramma IP sono pari a 65.535 byte.</span><span class="sxs-lookup"><span data-stu-id="228cd-410">Because it is a 16-bit field, the maximum size of an IP datagram is 65,535 bytes.</span></span>

<span data-ttu-id="228cd-411">***identificazione a 16 bit*** Il campo è un numero usato per identificare in modo univoco ogni datagramma IP inviato da un host.</span><span class="sxs-lookup"><span data-stu-id="228cd-411">***16-bit identification*** The field is a number used to uniquely identify each IP datagram sent from a host.</span></span> <span data-ttu-id="228cd-412">Questo numero viene in genere incrementato dopo l'invio di un datagramma IP.</span><span class="sxs-lookup"><span data-stu-id="228cd-412">This number is typically incremented after an IP datagram is sent.</span></span> <span data-ttu-id="228cd-413">È particolarmente utile per assemblare frammenti di pacchetti IP ricevuti.</span><span class="sxs-lookup"><span data-stu-id="228cd-413">It is especially useful in assembling received IP packet fragments.</span></span>

<span data-ttu-id="228cd-414">***flag a 3 bit*** Questo campo contiene informazioni sulla frammentazione IP.</span><span class="sxs-lookup"><span data-stu-id="228cd-414">***3-bit flags*** This field contains IP fragmentation information.</span></span> <span data-ttu-id="228cd-415">Il bit 14 è il bit "not Fragment".</span><span class="sxs-lookup"><span data-stu-id="228cd-415">Bit 14 is the "don't fragment" bit.</span></span> <span data-ttu-id="228cd-416">Se questo bit è impostato, il datagramma IP in uscita non verrà frammentato.</span><span class="sxs-lookup"><span data-stu-id="228cd-416">If this bit is set, the outgoing IP datagram will not be fragmented.</span></span> <span data-ttu-id="228cd-417">Il bit 13 è il bit "More Fragments".</span><span class="sxs-lookup"><span data-stu-id="228cd-417">Bit 13 is the "more fragments" bit.</span></span> <span data-ttu-id="228cd-418">Se questo bit è impostato, sono presenti più frammenti.</span><span class="sxs-lookup"><span data-stu-id="228cd-418">If this bit is set, there are more fragments.</span></span> <span data-ttu-id="228cd-419">Se questo bit è chiaro, questo è l'ultimo frammento del pacchetto IP.</span><span class="sxs-lookup"><span data-stu-id="228cd-419">If this bit is clear, this is the last fragment of the IP packet.</span></span>

<span data-ttu-id="228cd-420">**Scopo campo intestazione IP**</span><span class="sxs-lookup"><span data-stu-id="228cd-420">**IP Header Field Purpose**</span></span>

<span data-ttu-id="228cd-421">***offset frammento a 13 bit*** Questo campo contiene i 13 bit superiori dell'offset del frammento.</span><span class="sxs-lookup"><span data-stu-id="228cd-421">***13-bit fragment offset*** This field contains the upper 13-bits of the fragment offset.</span></span> <span data-ttu-id="228cd-422">Per questo motivo, gli offset dei frammenti sono consentiti solo su limiti di 8 byte.</span><span class="sxs-lookup"><span data-stu-id="228cd-422">Because of this, fragment offsets are only allowed on 8-byte boundaries.</span></span> <span data-ttu-id="228cd-423">Il primo frammento di un datagramma IP frammentato avrà un set di bit "più frammenti" e un offset pari a 0.</span><span class="sxs-lookup"><span data-stu-id="228cd-423">The first fragment of a fragmented IP datagram will have the “more fragments” bit set and have an offset of 0.</span></span>

<span data-ttu-id="228cd-424">***durata (TTL) a 8 bit*** Questo campo contiene il numero di router che possono essere superati dal datagramma, che limita la durata del datagramma.</span><span class="sxs-lookup"><span data-stu-id="228cd-424">***8-bit time to live (TTL)*** This field contains the number of routers this datagram can pass, which limits the lifetime of the datagram.</span></span>

<span data-ttu-id="228cd-425">***protocollo a 8 bit*** Questo campo specifica il protocollo che usa il datagramma IP.</span><span class="sxs-lookup"><span data-stu-id="228cd-425">***8-bit protocol*** This field specifies which protocol is using the IP datagram.</span></span> <span data-ttu-id="228cd-426">Di seguito è riportato un elenco di protocolli validi e dei relativi valori:</span><span class="sxs-lookup"><span data-stu-id="228cd-426">The following is a list of valid protocols and their values:</span></span>

| <span data-ttu-id="228cd-427">Protocollo</span><span class="sxs-lookup"><span data-stu-id="228cd-427">Protocol</span></span> | <span data-ttu-id="228cd-428">Valore</span><span class="sxs-lookup"><span data-stu-id="228cd-428">Value</span></span> |
|----------|-------|
| <span data-ttu-id="228cd-429">ICMP</span><span class="sxs-lookup"><span data-stu-id="228cd-429">ICMP</span></span>     | <span data-ttu-id="228cd-430">0x01</span><span class="sxs-lookup"><span data-stu-id="228cd-430">0x01</span></span>  |
| <span data-ttu-id="228cd-431">IGMP</span><span class="sxs-lookup"><span data-stu-id="228cd-431">IGMP</span></span>     | <span data-ttu-id="228cd-432">0x02</span><span class="sxs-lookup"><span data-stu-id="228cd-432">0x02</span></span>  |
| <span data-ttu-id="228cd-433">TCP</span><span class="sxs-lookup"><span data-stu-id="228cd-433">TCP</span></span>      | <span data-ttu-id="228cd-434">0X06</span><span class="sxs-lookup"><span data-stu-id="228cd-434">0X06</span></span>  |
| <span data-ttu-id="228cd-435">UDP</span><span class="sxs-lookup"><span data-stu-id="228cd-435">UDP</span></span>      | <span data-ttu-id="228cd-436">0X11</span><span class="sxs-lookup"><span data-stu-id="228cd-436">0X11</span></span>  |
|          |       |


<span data-ttu-id="228cd-437">***checksum a 16 bit*** Questo campo contiene il checksum a 16 bit che copre solo l'intestazione IP.</span><span class="sxs-lookup"><span data-stu-id="228cd-437">***16-bit checksum*** This field contains the 16-bit checksum that covers the IP header only.</span></span> <span data-ttu-id="228cd-438">Nei protocolli di livello superiore sono presenti checksum aggiuntivi che coprono il payload IP.</span><span class="sxs-lookup"><span data-stu-id="228cd-438">There are additional checksums in the higher level protocols that cover the IP payload.</span></span>

<span data-ttu-id="228cd-439">***indirizzo IP di origine a 32 bit*** Questo campo contiene l'indirizzo IP del mittente ed è sempre un indirizzo host.</span><span class="sxs-lookup"><span data-stu-id="228cd-439">***32-bit source IP address*** This field contains the IP address of the sender and is always a host address.</span></span>

<span data-ttu-id="228cd-440">***indirizzo IP di destinazione a 32 bit*** Questo campo contiene l'indirizzo IP del destinatario o dei ricevitori se l'indirizzo è un indirizzo broadcast o multicast.</span><span class="sxs-lookup"><span data-stu-id="228cd-440">***32-bit destination IP address*** This field contains the IP address of the receiver or receivers if the address is a broadcast or multicast address.</span></span>

### <a name="creating-ip-instances"></a><span data-ttu-id="228cd-441">Creazione di istanze IP</span><span class="sxs-lookup"><span data-stu-id="228cd-441">Creating IP Instances</span></span>

<span data-ttu-id="228cd-442">Le istanze IP vengono create durante l'inizializzazione o durante la fase di esecuzione dai thread dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="228cd-442">IP instances are created either during initialization or during runtime by application threads.</span></span> <span data-ttu-id="228cd-443">L'indirizzo IP iniziale, network mask, il pool di pacchetti predefinito, il driver multimediale e la memoria e la priorità del thread IP interno sono definiti dal servizio *nx_ip_create* .</span><span class="sxs-lookup"><span data-stu-id="228cd-443">The initial IP address, network mask, default packet pool, media driver, and memory and priority of the internal IP thread are defined by the *nx_ip_create* service.</span></span> <span data-ttu-id="228cd-444">Se l'applicazione Inizializza l'istanza IP con il relativo indirizzo IP impostato su un indirizzo non valido (0.0.0.0), si presuppone che l'indirizzo dell'interfaccia venga risolto dalla configurazione manuale in un secondo momento, tramite RARP o tramite DHCP o protocolli simili.</span><span class="sxs-lookup"><span data-stu-id="228cd-444">If the application initializes the IP instance with its IP address set to an invalid address(0.0.0.0), it is assumed that the interface address is going to resolved by manual configuration later, via RARP, or through DHCP or similar protocols.</span></span>

<span data-ttu-id="228cd-445">Per i sistemi con più interfacce di rete, l'interfaccia principale viene designata quando si chiama *nx_ip_create*.</span><span class="sxs-lookup"><span data-stu-id="228cd-445">For systems with multiple network interfaces, the primary interface is designated when calling *nx_ip_create*.</span></span> <span data-ttu-id="228cd-446">Ogni interfaccia aggiuntiva può essere collegata alla stessa istanza IP chiamando *nx_ip_interface_attach*.</span><span class="sxs-lookup"><span data-stu-id="228cd-446">Each additional interface can be attached to the same IP instance by calling *nx_ip_interface_attach*.</span></span> <span data-ttu-id="228cd-447">Questo servizio archivia informazioni sull'interfaccia di rete (ad esempio indirizzo IP, network mask) nel blocco di controllo dell'interfaccia e associa l'istanza del driver al blocco di controllo dell'interfaccia nell'istanza IP.</span><span class="sxs-lookup"><span data-stu-id="228cd-447">This service stores information about the network interface (such as IP address, network mask) in the interface control block, and associates the driver instance with the interface control block in the IP instance.</span></span> <span data-ttu-id="228cd-448">Quando il driver riceve un pacchetto di dati, deve archiviare le informazioni sull'interfaccia nella struttura NX_PACKET prima di inoltrarle alla logica di ricezione IP.</span><span class="sxs-lookup"><span data-stu-id="228cd-448">As the driver receives a data packet, it needs to store the interface information in the NX_PACKET structure before forwarding it to the IP receive logic.</span></span> <span data-ttu-id="228cd-449">Nota è necessario che un'istanza IP sia già stata creata prima di eseguire il fissaggio di qualsiasi interfaccia.</span><span class="sxs-lookup"><span data-stu-id="228cd-449">Note an IP instance must already be created before attaching any interfaces.</span></span>

 ### <a name="ip-send"></a><span data-ttu-id="228cd-450">Invio IP</span><span class="sxs-lookup"><span data-stu-id="228cd-450">IP Send</span></span>
 <span data-ttu-id="228cd-451">L'elaborazione dell'invio IP in NetX è molto semplificata.</span><span class="sxs-lookup"><span data-stu-id="228cd-451">The IP send processing in NetX is very streamlined.</span></span>

<span data-ttu-id="228cd-452">Il puntatore anteposto nel pacchetto viene spostato all'indietro per contenere l'intestazione IP.</span><span class="sxs-lookup"><span data-stu-id="228cd-452">The prepend pointer in the packet is moved backwards to accommodate the IP header.</span></span> <span data-ttu-id="228cd-453">L'intestazione IP viene completata (con tutte le opzioni specificate dal livello del protocollo chiamante), il checksum IP viene calcolato in linea e il pacchetto viene inviato al driver di rete associato.</span><span class="sxs-lookup"><span data-stu-id="228cd-453">The IP header is completed (with all the options specified by the calling protocol layer), the IP checksum is computed in-line, and the packet is dispatched to the associated network driver.</span></span> <span data-ttu-id="228cd-454">Inoltre, la frammentazione in uscita è coordinata anche all'interno dell'elaborazione di trasmissione IP.</span><span class="sxs-lookup"><span data-stu-id="228cd-454">In addition, outgoing fragmentation is also coordinated from within the IP send processing.</span></span>

<span data-ttu-id="228cd-455">Per IP, NetX avvia le richieste ARP se è necessario il mapping fisico per l'indirizzo IP di destinazione.</span><span class="sxs-lookup"><span data-stu-id="228cd-455">For IP, NetX initiates ARP requests if physical mapping is needed for the destination IP address.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="228cd-456">*Per la connettività IP, i pacchetti che richiedono la risoluzione degli indirizzi IP (ad esempio, il mapping fisico) vengono accodati nella coda ARP finché il numero di pacchetti in coda non supera la profondità della coda ARP (definita dal* *simbolo **NX_ARP_MAX_QUEUE_DEPTH**). Se* *viene raggiunta la profondità della coda, NETX rimuoverà il pacchetto meno recente nella coda e continuerà ad attendere la risoluzione degli indirizzi per i pacchetti rimanenti accodati. D'altra parte, se non viene risolta una voce ARP, i pacchetti in sospeso sulla voce ARP vengono rilasciati al timeout della voce ARP.*</span><span class="sxs-lookup"><span data-stu-id="228cd-456">*For IP connectivity, packets that require IP address resolution (i.e., physical mapping) are enqueued on the ARP queue until the number of packets queued exceeds the ARP queue depth (defined by the* *symbol **NX_ARP_MAX_QUEUE_DEPTH**). If the* *queue depth is reached, NetX will remove the oldest packet on the queue and continue waiting for address resolution for the remaining packets enqueued. On the other hand, if an ARP entry is not resolved, the pending packets on the ARP entry are released upon ARP entry timeout.*</span></span>

<span data-ttu-id="228cd-457">Per i sistemi con più interfacce di rete, NetX sceglie un'interfaccia basata sull'indirizzo IP di destinazione.</span><span class="sxs-lookup"><span data-stu-id="228cd-457">For systems with multiple network interfaces, NetX chooses an interface based on the destination IP address.</span></span> <span data-ttu-id="228cd-458">La procedura seguente si applica al processo di selezione:</span><span class="sxs-lookup"><span data-stu-id="228cd-458">The following procedure applies to the selection process:</span></span>

1. <span data-ttu-id="228cd-459">Se un indirizzo di destinazione è broadcast IP o multicast e se è specificata un'interfaccia in uscita valida, utilizzare tale interfaccia.</span><span class="sxs-lookup"><span data-stu-id="228cd-459">If a destination address is IP broadcast or multicast, and if a valid outgoing interface is specified, use that interface.</span></span> <span data-ttu-id="228cd-460">In caso contrario, viene utilizzata la prima interfaccia fisica.</span><span class="sxs-lookup"><span data-stu-id="228cd-460">Otherwise, the first physical interface is used.</span></span>

2. <span data-ttu-id="228cd-461">Se l'indirizzo di destinazione viene trovato nella tabella di routing statica, viene utilizzata l'interfaccia associata al gateway.</span><span class="sxs-lookup"><span data-stu-id="228cd-461">If the destination address is found in the static routing table, the interface associated with the gateway is used.</span></span>

3. <span data-ttu-id="228cd-462">Se la destinazione è on-link, viene utilizzata l'interfaccia di collegamento.</span><span class="sxs-lookup"><span data-stu-id="228cd-462">If the destination is on-link, the on-link interface is used.</span></span>

4. <span data-ttu-id="228cd-463">Se l'indirizzo di destinazione è un indirizzo di loopback 127.0.0.1, viene utilizzata l'interfaccia di loopback.</span><span class="sxs-lookup"><span data-stu-id="228cd-463">If the destination address is a loopback address 127.0.0.1, the loopback interface is used.</span></span>

5. <span data-ttu-id="228cd-464">Se il gateway predefinito è configurato correttamente, usare l'interfaccia associata al gateway predefinito per trasmettere il pacchetto.</span><span class="sxs-lookup"><span data-stu-id="228cd-464">If the default gateway is properly configured, use the interface associated with the default gateway to transmit the packet.</span></span>

6. <span data-ttu-id="228cd-465">Il pacchetto di output viene eliminato se non si verificano errori.</span><span class="sxs-lookup"><span data-stu-id="228cd-465">The output packet is dropped if all the above fails.</span></span>

### <a name="ip-receive"></a><span data-ttu-id="228cd-466">Ricezione IP</span><span class="sxs-lookup"><span data-stu-id="228cd-466">IP Receive</span></span>

<span data-ttu-id="228cd-467">L'elaborazione di ricezione IP viene chiamata dal driver di rete o dal thread IP interno (per l'elaborazione dei pacchetti nella coda di pacchetti ricevuta posticipata).</span><span class="sxs-lookup"><span data-stu-id="228cd-467">The IP receive processing is either called from the network driver or the internal IP thread (for processing packets on the deferred received packet queue).</span></span> <span data-ttu-id="228cd-468">L'elaborazione di ricezione IP esamina il campo protocollo e tenta di inviare il pacchetto al componente protocollo appropriato.</span><span class="sxs-lookup"><span data-stu-id="228cd-468">The IP receive processing examines the protocol field and attempts to dispatch the packet to the proper protocol component.</span></span> <span data-ttu-id="228cd-469">Prima che il pacchetto venga effettivamente inviato, l'intestazione IP viene rimossa facendo avanzare il puntatore anteposto oltre l'intestazione IP.</span><span class="sxs-lookup"><span data-stu-id="228cd-469">Before the packet is actually dispatched, the IP header is removed by advancing the prepend pointer past the IP header.</span></span>

<span data-ttu-id="228cd-470">L'elaborazione della ricezione IP rileva inoltre i pacchetti IP frammentati ed esegue i passaggi necessari per riassemblarli se la frammentazione è abilitata.</span><span class="sxs-lookup"><span data-stu-id="228cd-470">IP receive processing also detects fragmented IP packets and performs the necessary steps to reassemble them if fragmentation is enabled.</span></span> <span data-ttu-id="228cd-471">Se la frammentazione è necessaria ma non abilitata, il pacchetto viene eliminato.</span><span class="sxs-lookup"><span data-stu-id="228cd-471">If fragmentation is needed but not enabled, the packet is dropped.</span></span>

<span data-ttu-id="228cd-472">NetX determina l'interfaccia di rete appropriata in base all'interfaccia specificata nel pacchetto.</span><span class="sxs-lookup"><span data-stu-id="228cd-472">NetX determines the appropriate network interface based on the interface specified in the packet.</span></span> <span data-ttu-id="228cd-473">Se l'interfaccia del pacchetto è NULL, l'impostazione predefinita di NetX è l'interfaccia primaria.</span><span class="sxs-lookup"><span data-stu-id="228cd-473">If the packet interface is NULL, NetX defaults to the primary interface.</span></span> <span data-ttu-id="228cd-474">Questa operazione viene eseguita per garantire la compatibilità con i driver Ethernet NetX legacy.</span><span class="sxs-lookup"><span data-stu-id="228cd-474">This is done to guarantee compatibility with legacy NetX Ethernet drivers.</span></span>

### <a name="raw-ip-send"></a><span data-ttu-id="228cd-475">Invio IP non elaborato</span><span class="sxs-lookup"><span data-stu-id="228cd-475">Raw IP Send</span></span>

<span data-ttu-id="228cd-476">Un pacchetto IP non elaborato è un frame IP che contiene il payload del protocollo di livello superiore non direttamente supportato ed elaborato da NetX.</span><span class="sxs-lookup"><span data-stu-id="228cd-476">A raw IP packet is an IP frame that contains upper layer protocol payload not directly supported (and processed) by NetX.</span></span> <span data-ttu-id="228cd-477">Un pacchetto non elaborato consente agli sviluppatori di definire le proprie applicazioni basate su IP.</span><span class="sxs-lookup"><span data-stu-id="228cd-477">A raw packet allows developers to define their own IP-based applications.</span></span> <span data-ttu-id="228cd-478">Un'applicazione può inviare pacchetti IP non elaborati direttamente usando il servizio ***nx_ip_raw_packet_send** _ se l'elaborazione di pacchetti IP non elaborati è stata abilitata con il servizio di _*_nx_ip_raw_packet_enabled_\*_ .</span><span class="sxs-lookup"><span data-stu-id="228cd-478">An application may send raw IP packets directly using the ***nx_ip_raw_packet_send** _ service if raw IP packet processing has been enabled with the _*_nx_ip_raw_packet_enabled_\*_ service.</span></span> <span data-ttu-id="228cd-479">Se l'indirizzo di destinazione è un indirizzo multicast o broadcast, tuttavia, NetX per impostazione predefinita è la prima interfaccia (primaria).</span><span class="sxs-lookup"><span data-stu-id="228cd-479">If the destination address is a multicast or broadcast address, however, NetX defaults to the first (primary) interface.</span></span> <span data-ttu-id="228cd-480">Pertanto, per inviare tali pacchetti alle interfacce secondarie, l'applicazione deve usare il servizio _ *_nx_ip_raw_packet_interface_send_*\* per specificare l'indirizzo di origine da usare per il pacchetto in uscita.</span><span class="sxs-lookup"><span data-stu-id="228cd-480">Therefore, to send such packets out on secondary interfaces, the application must use the _ *_nx_ip_raw_packet_interface_send_*\* service to specify the source address to use for the outgoing packet.</span></span>

### <a name="raw-ip-receive"></a><span data-ttu-id="228cd-481">Ricezione di indirizzi IP non elaborati</span><span class="sxs-lookup"><span data-stu-id="228cd-481">Raw IP Receive</span></span>

<span data-ttu-id="228cd-482">Se l'elaborazione dei pacchetti IP non elaborati è abilitata, l'applicazione può ricevere pacchetti IP non elaborati tramite il servizio \***nx_ip_raw_packet_receive** _.</span><span class="sxs-lookup"><span data-stu-id="228cd-482">If raw IP packet processing is enabled, the application may receive raw IP packets through the \***nx_ip_raw_packet_receive** _ service.</span></span> <span data-ttu-id="228cd-483">Tutti i pacchetti in ingresso vengono elaborati in base al protocollo specificato nell'intestazione IP.</span><span class="sxs-lookup"><span data-stu-id="228cd-483">All incoming packets are processed according to the protocol specified in the IP header.</span></span> <span data-ttu-id="228cd-484">Se il protocollo specifica UDP, TCP, IGMP o ICMP, NetX elaborerà il pacchetto utilizzando il gestore appropriato per il tipo di protocollo del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="228cd-484">If the protocol specifies UDP, TCP, IGMP or ICMP, NetX will process the packet using the appropriate handler for the packet protocol type.</span></span> <span data-ttu-id="228cd-485">Se il protocollo non è uno di questi protocolli e la ricezione di indirizzi IP non elaborati è abilitata, il pacchetto in arrivo verrà inserito nella coda dei pacchetti non elaborati in attesa che l'applicazione la riceva tramite il servizio _ \*_nx_ip_raw_packet_receive_\*\*.</span><span class="sxs-lookup"><span data-stu-id="228cd-485">If the protocol is not one of these protocols, and raw IP receive is enabled, the incoming packet will be put into the raw packet queue waiting for the application to receive it via the _ *_nx_ip_raw_packet_receive_*\* service.</span></span> <span data-ttu-id="228cd-486">I thread dell'applicazione possono inoltre sospendere con un timeout facoltativo durante l'attesa di un pacchetto IP non elaborato.</span><span class="sxs-lookup"><span data-stu-id="228cd-486">In addition, application threads may suspend with an optional timeout while waiting for a raw IP packet.</span></span>

### <a name="default-packet-pool"></a><span data-ttu-id="228cd-487">Pool di pacchetti predefinito</span><span class="sxs-lookup"><span data-stu-id="228cd-487">Default Packet Pool</span></span>

<span data-ttu-id="228cd-488">A ogni istanza IP viene assegnato un pool di pacchetti predefinito durante la creazione.</span><span class="sxs-lookup"><span data-stu-id="228cd-488">Each IP instance is given a default packet pool during creation.</span></span> <span data-ttu-id="228cd-489">Questo pool di pacchetti viene usato per allocare pacchetti per ARP, RARP, ICMP, IGMP, diversi pacchetti di controllo TCP (ad esempio SYN, ACK).</span><span class="sxs-lookup"><span data-stu-id="228cd-489">This packet pool is used to allocate packets for ARP, RARP, ICMP, IGMP, various TCP control packets (such as SYN, ACK).</span></span> <span data-ttu-id="228cd-490">Se il pool di pacchetti predefinito è vuoto quando NetX deve allocare un pacchetto, NetX potrebbe dover interrompere l'operazione specifica e restituirà un messaggio di errore, se possibile.</span><span class="sxs-lookup"><span data-stu-id="228cd-490">If the default packet pool is empty when NetX needs to allocate a packet, NetX may have to abort the particular operation, and will return an error message if possible.</span></span>

### <a name="ip-helper-thread"></a><span data-ttu-id="228cd-491">Thread helper IP</span><span class="sxs-lookup"><span data-stu-id="228cd-491">IP Helper Thread</span></span>

<span data-ttu-id="228cd-492">Ogni istanza IP ha un thread helper.</span><span class="sxs-lookup"><span data-stu-id="228cd-492">Each IP instance has a helper thread.</span></span> <span data-ttu-id="228cd-493">Questo thread è responsabile della gestione di tutte le operazioni di elaborazione dei pacchetti posticipate e di tutte le elaborazioni periodiche.</span><span class="sxs-lookup"><span data-stu-id="228cd-493">This thread is responsible for handling all deferred packet processing and all periodic processing.</span></span> <span data-ttu-id="228cd-494">Il thread helper IP viene creato in ***nx_ip_create.***</span><span class="sxs-lookup"><span data-stu-id="228cd-494">The IP helper thread is created in ***nx_ip_create.***</span></span> <span data-ttu-id="228cd-495">Questo è il punto in cui al thread viene assegnato lo stack e la priorità.</span><span class="sxs-lookup"><span data-stu-id="228cd-495">This is where the thread is given its stack and priority.</span></span> <span data-ttu-id="228cd-496">Si noti che la prima elaborazione nel thread helper IP consiste nel completare l'inizializzazione del driver di rete associata al servizio di creazione IP.</span><span class="sxs-lookup"><span data-stu-id="228cd-496">Note that the first processing in the IP helper thread is to finish the network driver initialization associated with the IP create service.</span></span> <span data-ttu-id="228cd-497">Al termine dell'inizializzazione del driver di rete, il thread di supporto avvia un ciclo infinito per elaborare le richieste periodiche e del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="228cd-497">After the network driver initialization is complete, the helper thread starts an endless loop to process packet and periodic requests.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="228cd-498">*Se si verifica un comportamento inspiegabile all'interno del thread helper IP, l'aumento delle dimensioni dello stack durante il servizio di creazione IP è il primo passaggio di debug. Se lo stack è troppo piccolo, il thread helper IP potrebbe probabilmente sovrascrivere la memoria, che potrebbe causare problemi insoliti.*</span><span class="sxs-lookup"><span data-stu-id="228cd-498">*If unexplained behavior is seen within the IP helper thread, increasing its stack size during the IP create service is the first debugging step. If the stack is too small, the IP helper thread could possibly be overwriting memory, which may cause unusual problems.*</span></span>

### <a name="thread-suspension"></a><span data-ttu-id="228cd-499">Sospensione thread</span><span class="sxs-lookup"><span data-stu-id="228cd-499">Thread Suspension</span></span>

<span data-ttu-id="228cd-500">I thread dell'applicazione possono sospendere il tentativo di ricevere pacchetti IP non elaborati.</span><span class="sxs-lookup"><span data-stu-id="228cd-500">Application threads can suspend while attempting to receive raw IP packets.</span></span> <span data-ttu-id="228cd-501">Dopo la ricezione di un pacchetto non elaborato, il nuovo pacchetto viene assegnato al primo thread sospeso e il thread viene ripreso.</span><span class="sxs-lookup"><span data-stu-id="228cd-501">After a raw packet is received, the new packet is given to the first thread suspended and that thread is resumed.</span></span> <span data-ttu-id="228cd-502">I servizi NetX per la ricezione di pacchetti hanno tutti un timeout di sospensione facoltativo.</span><span class="sxs-lookup"><span data-stu-id="228cd-502">NetX services for receiving packets all have an optional suspension timeout.</span></span> <span data-ttu-id="228cd-503">Quando viene ricevuto un pacchetto o il timeout scade, il thread dell'applicazione viene ripreso con lo stato di completamento appropriato.</span><span class="sxs-lookup"><span data-stu-id="228cd-503">When a packet is received or the timeout expires, the application thread is resumed with the appropriate completion status.</span></span>

### <a name="ip-statistics-and-errors"></a><span data-ttu-id="228cd-504">Statistiche IP ed errori</span><span class="sxs-lookup"><span data-stu-id="228cd-504">IP Statistics and Errors</span></span>

<span data-ttu-id="228cd-505">Se abilitata, il NetX tiene traccia di diverse statistiche ed errori che possono essere utili per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="228cd-505">If enabled, the NetX keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="228cd-506">Per ogni istanza IP vengono mantenute le statistiche e i report degli errori seguenti:</span><span class="sxs-lookup"><span data-stu-id="228cd-506">The following statistics and error reports are maintained for each IP instance:</span></span>

- <span data-ttu-id="228cd-507">Totale pacchetti IP inviati</span><span class="sxs-lookup"><span data-stu-id="228cd-507">Total IP Packets Sent</span></span>
- <span data-ttu-id="228cd-508">Totale byte IP inviati</span><span class="sxs-lookup"><span data-stu-id="228cd-508">Total IP Bytes Sent</span></span>
- <span data-ttu-id="228cd-509">Totale pacchetti IP ricevuti</span><span class="sxs-lookup"><span data-stu-id="228cd-509">Total IP Packets Received</span></span>
- <span data-ttu-id="228cd-510">Totale byte IP ricevuti</span><span class="sxs-lookup"><span data-stu-id="228cd-510">Total IP Bytes Received</span></span>
- <span data-ttu-id="228cd-511">Totale pacchetti IP non validi</span><span class="sxs-lookup"><span data-stu-id="228cd-511">Total IP Invalid Packets</span></span>
- <span data-ttu-id="228cd-512">Totale pacchetti di ricezione IP eliminati</span><span class="sxs-lookup"><span data-stu-id="228cd-512">Total IP Receive Packets Dropped</span></span>
- <span data-ttu-id="228cd-513">Totale errori di checksum di ricezione IP</span><span class="sxs-lookup"><span data-stu-id="228cd-513">Total IP Receive Checksum Errors</span></span>
- <span data-ttu-id="228cd-514">Totale pacchetti di invio IP eliminati</span><span class="sxs-lookup"><span data-stu-id="228cd-514">Total IP Send Packets Dropped</span></span>
- <span data-ttu-id="228cd-515">Totale frammenti IP inviati</span><span class="sxs-lookup"><span data-stu-id="228cd-515">Total IP Fragments Sent</span></span>
- <span data-ttu-id="228cd-516">Totale frammenti IP ricevuti</span><span class="sxs-lookup"><span data-stu-id="228cd-516">Total IP Fragments Received</span></span>

<span data-ttu-id="228cd-517">Tutte le statistiche e i report degli errori sono disponibili per l'applicazione con il servizio ***nx_ip_info_get*** .</span><span class="sxs-lookup"><span data-stu-id="228cd-517">All of these statistics and error reports are available to the application with the ***nx_ip_info_get*** service.</span></span>

### <a name="ip-control-block-nx_ip"></a><span data-ttu-id="228cd-518">NX_IP del blocco di controllo IP</span><span class="sxs-lookup"><span data-stu-id="228cd-518">IP Control Block NX_IP</span></span>

<span data-ttu-id="228cd-519">Le caratteristiche di ogni istanza IP si trovano nel relativo blocco di controllo.</span><span class="sxs-lookup"><span data-stu-id="228cd-519">The characteristics of each IP instance are found in its control block.</span></span> <span data-ttu-id="228cd-520">Contiene informazioni utili quali gli indirizzi IP e le maschere di rete di ogni dispositivo di rete e una tabella di indirizzi IP adiacenti e mapping di indirizzi hardware fisici.</span><span class="sxs-lookup"><span data-stu-id="228cd-520">It contains useful information such as the IP addresses and network masks of each network device, and a table of neighbor IP and physical hardware address mapping.</span></span> <span data-ttu-id="228cd-521">Questa struttura è definita nei blocchi di controllo dell'istanza IP del ***nx_api. h*** può trovarsi in qualsiasi punto della memoria, ma è più comune fare in modo che il controllo blocchi una struttura globale definendolo al di fuori dell'ambito di qualsiasi funzione.</span><span class="sxs-lookup"><span data-stu-id="228cd-521">This structure is defined in the ***nx_api.h*** IP instance control blocks can be located anywhere in memory, but it is most common to make the control block a global structure by defining it outside the scope of any function.</span></span>

### <a name="static-ip-routing"></a><span data-ttu-id="228cd-522">Routing IP statico</span><span class="sxs-lookup"><span data-stu-id="228cd-522">Static IP Routing</span></span>

<span data-ttu-id="228cd-523">La funzionalità di routing statico consente a un'applicazione di specificare una rete IP e l'indirizzo hop successivo per indirizzi IP di destinazione specifici fuori rete.</span><span class="sxs-lookup"><span data-stu-id="228cd-523">The static routing feature allows an application to specify an IP network and next hop address for specific out of network destination IP addresses.</span></span> <span data-ttu-id="228cd-524">Se il routing statico è abilitato, NetX Cerca nella tabella di routing statica una voce corrispondente all'indirizzo di destinazione del pacchetto da inviare.</span><span class="sxs-lookup"><span data-stu-id="228cd-524">If static routing is enabled, NetX searches through the static routing table for an entry matching the destination address of the packet to send.</span></span> <span data-ttu-id="228cd-525">Se non viene trovata alcuna corrispondenza, NetX esegue la ricerca nell'elenco di interfacce fisiche e sceglie un indirizzo IP di origine e un indirizzo hop successivo in base all'indirizzo IP di destinazione e al network mask.</span><span class="sxs-lookup"><span data-stu-id="228cd-525">If no match is found, NetX searches through the list of physical interfaces and chooses a source IP address and next hop address based on the destination IP address and the network mask.</span></span> <span data-ttu-id="228cd-526">Se la destinazione non corrisponde ad alcuno degli indirizzi IP dei driver di rete collegati all'istanza IP, NetX sceglie un'interfaccia connessa direttamente al gateway predefinito e usa l'indirizzo IP dell'interfaccia come indirizzo di origine e il gateway predefinito come hop successivo.</span><span class="sxs-lookup"><span data-stu-id="228cd-526">If the destination does not match any of the IP addresses of the network drivers attached to the IP instance, NetX chooses an interface that is directly connected to the default gateway, and uses the IP address of the interface as source address, and the default gateway as the next hop.</span></span>

<span data-ttu-id="228cd-527">Le voci possono essere aggiunte e rimosse dalla tabella di routing statica usando rispettivamente i servizi ***nx_ip_static_route_add*** e \***nx_ip_static_route_delete** _.</span><span class="sxs-lookup"><span data-stu-id="228cd-527">Entries can be added and removed from the static routing table using the ***nx_ip_static_route_add*** and \***nx_ip_static_route_delete** _ services, respectively.</span></span> <span data-ttu-id="228cd-528">Per usare il routing statico, l'applicazione host deve abilitare questa funzionalità definendo _ *_NX_ENABLE_IP_STATIC_ROUTING_*. \*</span><span class="sxs-lookup"><span data-stu-id="228cd-528">To use static routing, the host application must enable this feature by defining _ *_NX_ENABLE_IP_STATIC_ROUTING_*.\*</span></span>

> [!IMPORTANT]
> <span data-ttu-id="228cd-529">*Quando si aggiunge una voce alla tabella di routing statica, NetX verifica la presenza di una voce corrispondente per l'indirizzo di destinazione specificato già nella tabella. Se ne esiste uno, fornisce la preferenza alla voce con la rete più piccola (prefisso più lungo) nell'network mask.*</span><span class="sxs-lookup"><span data-stu-id="228cd-529">*When adding an entry to the static routing table, NetX checks for a matching entry for the specified destination address already in the table. If one exists, it gives preference to the entry with the smaller network (longer prefix) in the network mask.*</span></span>

### <a name="ip-fragmentation"></a><span data-ttu-id="228cd-530">Frammentazione IP</span><span class="sxs-lookup"><span data-stu-id="228cd-530">IP Fragmentation</span></span>

<span data-ttu-id="228cd-531">Il dispositivo di rete potrebbe avere limiti per le dimensioni dei pacchetti in uscita.</span><span class="sxs-lookup"><span data-stu-id="228cd-531">The network device may have limits on the size of outgoing packets.</span></span> <span data-ttu-id="228cd-532">Questo limite è denominato MTU (Maximum Transmission Unit).</span><span class="sxs-lookup"><span data-stu-id="228cd-532">This limit is called the maximum transmission unit (MTU).</span></span> <span data-ttu-id="228cd-533">MTU IP è la dimensione massima del frame IP che un driver del livello di collegamento è in grado di trasmettere senza frammentazione del pacchetto IP.</span><span class="sxs-lookup"><span data-stu-id="228cd-533">IP MTU is the largest IP frame size a link layer driver is able to transmit without fragmenting the IP packet.</span></span> <span data-ttu-id="228cd-534">Durante la fase di inizializzazione di un driver di dispositivo, il modulo driver deve configurare le dimensioni MTU IP tramite il servizio \***nx_ip_interface_mtu_set**. \*</span><span class="sxs-lookup"><span data-stu-id="228cd-534">During a device driver initialization phase, the driver module must configure its IP MTU size via the service \***nx_ip_interface_mtu_set**.\*</span></span>

<span data-ttu-id="228cd-535">Sebbene non sia consigliabile, l'applicazione può generare datagrammi di dimensioni superiori rispetto alla MTU IP sottostante supportata dal dispositivo.</span><span class="sxs-lookup"><span data-stu-id="228cd-535">Although not recommended, the application may generate datagrams larger than the underlying IP MTU supported by the device.</span></span> <span data-ttu-id="228cd-536">Prima di trasmettere tale datagramma IP, il livello IP deve frammentare questi pacchetti.</span><span class="sxs-lookup"><span data-stu-id="228cd-536">Before transmitting such IP datagram, the IP layer must fragment these packets.</span></span> <span data-ttu-id="228cd-537">Alla ricezione di frame IP frammentati, l'estremità ricevente deve archiviare tutti i frame IP frammentati con lo stesso ID di frammentazione e riassemblarli nell'ordine.</span><span class="sxs-lookup"><span data-stu-id="228cd-537">On receiving fragmented IP frames, the receiving end must store all fragmented IP frames with the same fragmentation ID, and reassemble them in order.</span></span> <span data-ttu-id="228cd-538">Se la logica di ricezione IP non è in grado di raccogliere tutti i frammenti per ripristinare il frame IP originale nel tempo, vengono rilasciati tutti i frammenti.</span><span class="sxs-lookup"><span data-stu-id="228cd-538">If the IP receive logic is unable to collect all the fragments to restore the original IP frame in time, all the fragments are released.</span></span> <span data-ttu-id="228cd-539">È il protocollo di livello superiore per rilevare tale perdita di pacchetti e ripristinarla.</span><span class="sxs-lookup"><span data-stu-id="228cd-539">It is up to the upper layer protocol to detect such packet loss and recover from it.</span></span>

<span data-ttu-id="228cd-540">Per supportare la frammentazione IP e l'operazione di riassemblaggio, progettazione sistema deve abilitare la funzionalità di frammentazione IP in NetX usando il servizio ***nx_ip_fragment_enable*** .</span><span class="sxs-lookup"><span data-stu-id="228cd-540">In order to support IP fragmentation and reassembly operation, the system designer must enable the IP fragmentation feature in NetX using the ***nx_ip_fragment_enable*** service.</span></span> <span data-ttu-id="228cd-541">Se questa funzionalità non è abilitata, i pacchetti IP frammentati in ingresso vengono eliminati, oltre a pacchetti che superano il MTU del driver di rete.</span><span class="sxs-lookup"><span data-stu-id="228cd-541">If this feature is not enabled, incoming fragmented IP packets are discarded, as well as packets that exceed the network driver's MTU.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="228cd-542">*La logica di frammentazione IP può essere rimossa completamente definendo*  \* **NX_DISABLE_FRAGMENTATION** _ _when la compilazione della libreria theNetX.</span><span class="sxs-lookup"><span data-stu-id="228cd-542">*The IP Fragmentation logic can be removed completely by defining* \***NX_DISABLE_FRAGMENTATION** _ _when building theNetX library.</span></span> <span data-ttu-id="228cd-543">Questa operazione consente di ridurre le dimensioni del codice di NetX. \*</span><span class="sxs-lookup"><span data-stu-id="228cd-543">Doing so helps reduce the code size of NetX.\*</span></span>

## <a name="address-resolution-protocol-arp-in-ip"></a><span data-ttu-id="228cd-544">ARP (Address Resolution Protocol) nell'IP</span><span class="sxs-lookup"><span data-stu-id="228cd-544">Address Resolution Protocol (ARP) in IP</span></span>

<span data-ttu-id="228cd-545">Il protocollo ARP (Address Resolution Protocol) è responsabile del mapping dinamico degli indirizzi IP a 32 bit a quelli del supporto fisico sottostante (RFC 826).</span><span class="sxs-lookup"><span data-stu-id="228cd-545">The Address Resolution Protocol (ARP) is responsible for dynamically mapping 32-bit IP addresses to those of the underlying physical media (RFC 826).</span></span> <span data-ttu-id="228cd-546">Ethernet è il supporto fisico più comune e supporta gli indirizzi a 48 bit.</span><span class="sxs-lookup"><span data-stu-id="228cd-546">Ethernet is the most typical physical media, and it supports 48-bit addresses.</span></span> <span data-ttu-id="228cd-547">La necessità di ARP è determinata dal driver di rete fornito al servizio ***nx_ip_create*** .</span><span class="sxs-lookup"><span data-stu-id="228cd-547">The need for ARP is determined by the network driver supplied to the ***nx_ip_create*** service.</span></span> <span data-ttu-id="228cd-548">Se è necessario un mapping fisico, il driver di rete deve impostare il flag ***nx_interface_address_mapping_needed*** nell'interfaccia strcuture.</span><span class="sxs-lookup"><span data-stu-id="228cd-548">If physical mapping is required, the network driver must set the flag ***nx_interface_address_mapping_needed*** in the interface strcuture.</span></span>

### <a name="arp-enable"></a><span data-ttu-id="228cd-549">Abilitazione ARP</span><span class="sxs-lookup"><span data-stu-id="228cd-549">ARP Enable</span></span>
<span data-ttu-id="228cd-550">Per il corretto funzionamento di ARP, l'applicazione deve prima essere abilitata dall'applicazione con il servizio ***nx_arp_enable*** .</span><span class="sxs-lookup"><span data-stu-id="228cd-550">For ARP to function properly, it must first be enabled by the application with the ***nx_arp_enable*** service.</span></span> <span data-ttu-id="228cd-551">Questo servizio configura varie strutture di dati per l'elaborazione ARP, inclusa la creazione di un'area della cache ARP dalla memoria fornita al servizio di abilitazione ARP.</span><span class="sxs-lookup"><span data-stu-id="228cd-551">This service sets up various data structures for ARP processing, including the creation of an ARP cache area from the memory supplied to the ARP enable service.</span></span>

### <a name="arp-cache"></a><span data-ttu-id="228cd-552">Cache ARP</span><span class="sxs-lookup"><span data-stu-id="228cd-552">ARP Cache</span></span>
<span data-ttu-id="228cd-553">La cache ARP può essere visualizzata come una matrice di strutture di dati di mapping ARP interne.</span><span class="sxs-lookup"><span data-stu-id="228cd-553">The ARP cache can be viewed as an array of internal ARP mapping data structures.</span></span> <span data-ttu-id="228cd-554">Ogni struttura interna è in grado di gestire la relazione tra un indirizzo IP e un indirizzo hardware fisico.</span><span class="sxs-lookup"><span data-stu-id="228cd-554">Each internal structure is capable of maintaining the relationship between an IP address and a physical hardware address.</span></span> <span data-ttu-id="228cd-555">Ogni struttura di dati dispone inoltre di puntatori di collegamento, in modo che possa essere parte di più elenchi collegati.</span><span class="sxs-lookup"><span data-stu-id="228cd-555">In addition, each data structure has link pointers so it can be part of multiple linked lists.</span></span>

<span data-ttu-id="228cd-556">L'applicazione può cercare un indirizzo IP dalla cache ARP specificando l'indirizzo MAC hardware usando il servizio \***nx_arp_ip_address_find** _ se il mapping esiste nella tabella ARP.</span><span class="sxs-lookup"><span data-stu-id="228cd-556">Application can look up an IP address from the ARP cache by supplying hardware MAC address using the service \***nx_arp_ip_address_find** _ if the mapping exists in the ARP table.</span></span> <span data-ttu-id="228cd-557">Analogamente, il servizio _ *_nx_arp_hardware_address_find_*\* restituisce l'indirizzo Mac per un determinato indirizzo IP.</span><span class="sxs-lookup"><span data-stu-id="228cd-557">Similarly, the service _ *_nx_arp_hardware_address_find_*\* returns the MAC address for a given IP address.</span></span>


### <a name="arp-dynamic-entries"></a><span data-ttu-id="228cd-558">Voci dinamiche ARP</span><span class="sxs-lookup"><span data-stu-id="228cd-558">ARP Dynamic Entries</span></span>

<span data-ttu-id="228cd-559">Per impostazione predefinita, il servizio ARP Enable inserisce tutte le voci della cache ARP nell'elenco delle voci ARP dinamiche disponibili.</span><span class="sxs-lookup"><span data-stu-id="228cd-559">By default, the ARP enable service places all entries in the ARP cache on the list of available dynamic ARP entries.</span></span> <span data-ttu-id="228cd-560">Una voce ARP dinamica viene allocata da questo elenco NetX quando viene rilevata una richiesta di invio a un indirizzo IP non mappato.</span><span class="sxs-lookup"><span data-stu-id="228cd-560">A dynamic ARP entry is allocated from this list by NetX when a send request to an unmapped IP address is detected.</span></span> <span data-ttu-id="228cd-561">Dopo l'allocazione, la voce ARP viene configurata e viene inviata una richiesta ARP al supporto fisico.</span><span class="sxs-lookup"><span data-stu-id="228cd-561">After allocation, the ARP entry is set up and an ARP request is sent to the physical media.</span></span>

<span data-ttu-id="228cd-562">È possibile creare una voce dinamica anche dal servizio ***nx_arp_dynamic_entry_set***.</span><span class="sxs-lookup"><span data-stu-id="228cd-562">A dynamic entry can also be created by the service ***nx_arp_dynamic_entry_set***.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="228cd-563">*Se tutte le voci ARP dinamiche sono in uso, la voce ARP usata meno di recente viene sostituita con un nuovo mapping.*</span><span class="sxs-lookup"><span data-stu-id="228cd-563">*If all dynamic ARP entries are in use, the least recently used ARP entry is replaced with a new mapping.*</span></span>

### <a name="arp-static-entries"></a><span data-ttu-id="228cd-564">Voci statiche ARP</span><span class="sxs-lookup"><span data-stu-id="228cd-564">ARP Static Entries</span></span>
<span data-ttu-id="228cd-565">L'applicazione può anche impostare il mapping ARP statico usando il servizio ***nx_arp_static_entry_create*** .</span><span class="sxs-lookup"><span data-stu-id="228cd-565">The application can also set up static ARP mapping by using the ***nx_arp_static_entry_create*** service.</span></span> <span data-ttu-id="228cd-566">Questo servizio alloca una voce ARP dall'elenco di voci ARP dinamiche e la inserisce nell'elenco statico con le informazioni di mapping fornite dall'applicazione.</span><span class="sxs-lookup"><span data-stu-id="228cd-566">This service allocates an ARP entry from the dynamic ARP entry list and places it on the static list with the mapping information supplied by the application.</span></span> <span data-ttu-id="228cd-567">Le voci ARP statiche non sono soggette a riutilizzo o invecchiamento.</span><span class="sxs-lookup"><span data-stu-id="228cd-567">Static ARP entries are not subject to reuse or aging.</span></span> <span data-ttu-id="228cd-568">L'applicazione può eliminare una voce statica utilizzando il servizio ***nx_arp_static_entry_delete***.</span><span class="sxs-lookup"><span data-stu-id="228cd-568">The application can delete a static entry by using the service ***nx_arp_static_entry_delete***.</span></span>
<span data-ttu-id="228cd-569">Per rimuovere tutte le voci statiche nella tabella ARP, è possibile che l'applicazione utilizzi il ***nx_arp_static_entries_delete*** di servizio.</span><span class="sxs-lookup"><span data-stu-id="228cd-569">To remove all static entries in the ARP table, the application may use the service ***nx_arp_static_entries_delete***.</span></span>

### <a name="automatic-arp-entry"></a><span data-ttu-id="228cd-570">Voce ARP automatica</span><span class="sxs-lookup"><span data-stu-id="228cd-570">Automatic ARP Entry</span></span>
<span data-ttu-id="228cd-571">NetX registra il mapping IP/MAC del peer dopo le risposte del peer alla richiesta ARP.</span><span class="sxs-lookup"><span data-stu-id="228cd-571">NetX records the peer's IP/MAC mapping after the peer responses to the ARP request.</span></span> <span data-ttu-id="228cd-572">NetX implementa anche la funzionalità di immissione automatica di ARP in cui registra il mapping degli indirizzi IP/MAC peer in base alle richieste ARP non richieste dalla rete.</span><span class="sxs-lookup"><span data-stu-id="228cd-572">NetX also implements the automatic ARP entry feature where it records peer IP/MAC address mapping based on unsolicited ARP requests from the network.</span></span> <span data-ttu-id="228cd-573">Questa funzionalità consente di popolare la tabella ARP con le informazioni sul peer, riducendo il ritardo necessario per il ciclo di richiesta/risposta ARP.</span><span class="sxs-lookup"><span data-stu-id="228cd-573">This feature allows the ARP table to be populated with peer information, reducing the delay needed to go through the ARP request/response cycle.</span></span> <span data-ttu-id="228cd-574">Tuttavia, il lato negativo dell'abilitazione di ARP automatico è che la tabella ARP tende a riempirsi rapidamente in una rete occupata con molti nodi sul collegamento locale, il che porterebbe alla sostituzione della voce ARP.</span><span class="sxs-lookup"><span data-stu-id="228cd-574">However the downside with enabling automatic ARP is that the ARP table tend to fill up quickly on a busy network with many nodes on the local link, which would eventually lead to ARP entry replacement.</span></span>

<span data-ttu-id="228cd-575">Questa funzionalità è abilitata per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="228cd-575">This feature is enabled by default.</span></span> <span data-ttu-id="228cd-576">Per disabilitarla, è necessario compilare la libreria NetX con il simbolo ***NX_DISABLE_ARP_AUTO_ENTRY*** definito.</span><span class="sxs-lookup"><span data-stu-id="228cd-576">To disable it, the NetX library must be compiled with the symbol ***NX_DISABLE_ARP_AUTO_ENTRY*** defined.</span></span>

### <a name="arp-messages"></a><span data-ttu-id="228cd-577">Messaggi ARP</span><span class="sxs-lookup"><span data-stu-id="228cd-577">ARP Messages</span></span>

<span data-ttu-id="228cd-578">Come indicato in precedenza, viene inviato un messaggio di richiesta ARP quando l'attività IP rileva che il mapping è necessario per un indirizzo IP.</span><span class="sxs-lookup"><span data-stu-id="228cd-578">As mentioned previously, an ARP request message is sent when the IP task detects that mapping is needed for an IP address.</span></span> <span data-ttu-id="228cd-579">Le richieste ARP vengono inviate periodicamente (ogni \***NX_ARP_UPDATE_RATE** _ secondi) finché non viene ricevuta una risposta ARP corrispondente.</span><span class="sxs-lookup"><span data-stu-id="228cd-579">ARP requests are sent periodically (every \***NX_ARP_UPDATE_RATE** _ seconds) until a corresponding ARP response is received.</span></span> <span data-ttu-id="228cd-580">Viene eseguito un totale di _ *_NX_ARP_MAXIMUM_RETRIES_*\* richieste ARP prima che il tentativo ARP venga abbandonato.</span><span class="sxs-lookup"><span data-stu-id="228cd-580">A total of _ *_NX_ARP_MAXIMUM_RETRIES_*\* ARP requests are made before the ARP attempt is abandoned.</span></span> <span data-ttu-id="228cd-581">Quando viene ricevuta una risposta ARP, le informazioni sull'indirizzo fisico associate vengono archiviate nella voce ARP presente nella cache.</span><span class="sxs-lookup"><span data-stu-id="228cd-581">When an ARP response is received, the associated physical address information is stored in the ARP entry that is in the cache.</span></span>

<span data-ttu-id="228cd-582">Per i sistemi multihome, NetX determina quale interfaccia inviare le richieste e le risposte ARP in base all'indirizzo di destinazione specificato.</span><span class="sxs-lookup"><span data-stu-id="228cd-582">For multihome systems, NetX determines which interface to send the ARP requests and responses based on destination address specified.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="228cd-583">*I pacchetti IP in uscita vengono accodati mentre NETX attende la risposta ARP. Il numero di pacchetti IP in uscita* *accodati viene definito dalla costante*  \* **NX_ARP_MAX_QUEUE_DEPTH**. \*</span><span class="sxs-lookup"><span data-stu-id="228cd-583">*Outgoing IP packets are queued while NetX waits for the ARP response. The number of outgoing IP* *packets queued is defined by the constant* \***NX_ARP_MAX_QUEUE_DEPTH**.\*</span></span>

<span data-ttu-id="228cd-584">NetX risponde anche alle richieste ARP da altri nodi nella rete IP locale.</span><span class="sxs-lookup"><span data-stu-id="228cd-584">NetX also responds to ARP requests from other nodes on the local IP network.</span></span> <span data-ttu-id="228cd-585">Quando viene effettuata una richiesta ARP esterna che corrisponde all'indirizzo IP corrente dell'interfaccia che riceve la richiesta ARP, NetX compila un messaggio di risposta ARP che contiene l'indirizzo fisico corrente.</span><span class="sxs-lookup"><span data-stu-id="228cd-585">When an external ARP request is made that matches the current IP address of the interface that receives the ARP request, NetX builds an ARP response message that contains the current physical address.</span></span>

<span data-ttu-id="228cd-586">I formati delle richieste e delle risposte ARP Ethernet sono illustrati nella figura 6 e sono descritti di seguito:</span><span class="sxs-lookup"><span data-stu-id="228cd-586">The formats of Ethernet ARP requests and responses are shown in Figure 6 and are described below:</span></span>

| <span data-ttu-id="228cd-587">Campo richiesta/risposta</span><span class="sxs-lookup"><span data-stu-id="228cd-587">Request/Response Field</span></span>       | <span data-ttu-id="228cd-588">Scopo</span><span class="sxs-lookup"><span data-stu-id="228cd-588">Purpose</span></span>    |
|------------------------------|-----------------|
| <span data-ttu-id="228cd-589">Indirizzo di destinazione Ethernet</span><span class="sxs-lookup"><span data-stu-id="228cd-589">Ethernet Destination Address</span></span> | <span data-ttu-id="228cd-590">Questo campo di 6 byte contiene l'indirizzo di destinazione per la risposta ARP ed è un broadcast (tutti) per le richieste ARP.</span><span class="sxs-lookup"><span data-stu-id="228cd-590">This 6-byte field contains the destination address for the ARP response and is a broadcast (all ones) for ARP requests.</span></span> <span data-ttu-id="228cd-591">Questo campo viene configurato dal driver di rete.</span><span class="sxs-lookup"><span data-stu-id="228cd-591">This field is setup by the network driver.</span></span> |
| <span data-ttu-id="228cd-592">Indirizzo di origine Ethernet</span><span class="sxs-lookup"><span data-stu-id="228cd-592">Ethernet Source Address</span></span>      | <span data-ttu-id="228cd-593">Questo campo di 6 byte contiene l'indirizzo del mittente della richiesta o della risposta ARP e viene configurato dal driver di rete.</span><span class="sxs-lookup"><span data-stu-id="228cd-593">This 6-byte field contains the address of the sender of the ARP request or response and is set up by the network driver.</span></span> |
| <span data-ttu-id="228cd-594">Tipo di frame</span><span class="sxs-lookup"><span data-stu-id="228cd-594">Frame Type</span></span>                   | <span data-ttu-id="228cd-595">Questo campo a 2 byte contiene il tipo di frame Ethernet presente e, per le richieste e le risposte ARP, è uguale a 0x0806.</span><span class="sxs-lookup"><span data-stu-id="228cd-595">This 2-byte field contains the type of Ethernet frame present and, for ARP requests and responses, this is equal to 0x0806.</span></span> <span data-ttu-id="228cd-596">Questo è l'ultimo campo che il driver di rete è responsabile della configurazione.</span><span class="sxs-lookup"><span data-stu-id="228cd-596">This is the last field the network driver is responsible for setting up.</span></span> |
| <span data-ttu-id="228cd-597">Tipo di hardware</span><span class="sxs-lookup"><span data-stu-id="228cd-597">Hardware Type</span></span>                | <span data-ttu-id="228cd-598">Questo campo a 2 byte contiene il tipo di hardware, ovvero 0x0001 per Ethernet.</span><span class="sxs-lookup"><span data-stu-id="228cd-598">This 2-byte field contains the hardware type, which is 0x0001 for Ethernet.</span></span> |
| <span data-ttu-id="228cd-599">Tipo di protocollo</span><span class="sxs-lookup"><span data-stu-id="228cd-599">Protocol Type</span></span>                | <span data-ttu-id="228cd-600">Questo campo a 2 byte contiene il tipo di protocollo, ovvero 0x0800 per gli indirizzi IP.</span><span class="sxs-lookup"><span data-stu-id="228cd-600">This 2-byte field contains the protocol type, which is 0x0800 for IP addresses.</span></span> |
| <span data-ttu-id="228cd-601">Dimensioni hardware</span><span class="sxs-lookup"><span data-stu-id="228cd-601">Hardware Size</span></span>                | <span data-ttu-id="228cd-602">Questo campo a 1 byte contiene le dimensioni degli indirizzi hardware, ovvero 6 per gli indirizzi Ethernet.</span><span class="sxs-lookup"><span data-stu-id="228cd-602">This 1-byte field contains the hardware address size, which is 6 for Ethernet addresses.</span></span> |


![Formato del pacchetto ARP](./media/user-guide/arp-packet-format.png)

<span data-ttu-id="228cd-604">**FIGURA 6. Formato del pacchetto ARP**</span><span class="sxs-lookup"><span data-stu-id="228cd-604">**FIGURE 6. ARP Packet Format**</span></span>

| <span data-ttu-id="228cd-605">Campo richiesta/risposta</span><span class="sxs-lookup"><span data-stu-id="228cd-605">Request/Response Field</span></span> | <span data-ttu-id="228cd-606">Scopo</span><span class="sxs-lookup"><span data-stu-id="228cd-606">Purpose</span></span>  |
|---|---|
| <span data-ttu-id="228cd-607">Dimensioni protocollo</span><span class="sxs-lookup"><span data-stu-id="228cd-607">Protocol Size</span></span> | <span data-ttu-id="228cd-608">Questo campo a 1 byte contiene le dimensioni dell'indirizzo IP, ovvero 4 per gli indirizzi IP.</span><span class="sxs-lookup"><span data-stu-id="228cd-608">This 1-byte field contains the IP address size, which is 4 for IP addresses.</span></span>  |
| <span data-ttu-id="228cd-609">Codice operativo</span><span class="sxs-lookup"><span data-stu-id="228cd-609">Operation Code</span></span> | <span data-ttu-id="228cd-610">Questo campo a 2 byte contiene l'operazione per questo pacchetto ARP.</span><span class="sxs-lookup"><span data-stu-id="228cd-610">This 2-byte field contains the operation for this ARP packet.</span></span> <span data-ttu-id="228cd-611">Una richiesta ARP viene specificata con il valore di 0x0001, mentre una risposta ARP viene rappresentata da un valore di 0x0002.</span><span class="sxs-lookup"><span data-stu-id="228cd-611">An ARP request is specified with the value of 0x0001, while an ARP response is represented by a value of 0x0002.</span></span>  |
| <span data-ttu-id="228cd-612">Indirizzo Ethernet mittente</span><span class="sxs-lookup"><span data-stu-id="228cd-612">Sender Ethernet Address</span></span> | <span data-ttu-id="228cd-613">Questo campo a 6 byte contiene l'indirizzo Ethernet del mittente.</span><span class="sxs-lookup"><span data-stu-id="228cd-613">This 6-byte field contains the sender's Ethernet address.</span></span> |
| <span data-ttu-id="228cd-614">Indirizzo IP mittente</span><span class="sxs-lookup"><span data-stu-id="228cd-614">Sender IP Address</span></span> | <span data-ttu-id="228cd-615">Questo campo a 4 byte contiene l'indirizzo IP del mittente.</span><span class="sxs-lookup"><span data-stu-id="228cd-615">This 4-byte field contains the sender's IP address.</span></span> |
| <span data-ttu-id="228cd-616">Indirizzo Ethernet di destinazione</span><span class="sxs-lookup"><span data-stu-id="228cd-616">Target Ethernet Address</span></span> | <span data-ttu-id="228cd-617">Questo campo a 6 byte contiene l'indirizzo Ethernet della destinazione.</span><span class="sxs-lookup"><span data-stu-id="228cd-617">This 6-byte field contains the target's Ethernet address.</span></span> |
| <span data-ttu-id="228cd-618">Indirizzo IP di destinazione</span><span class="sxs-lookup"><span data-stu-id="228cd-618">Target IP Address</span></span> | <span data-ttu-id="228cd-619">Questo campo a 4 byte contiene l'indirizzo IP della destinazione.</span><span class="sxs-lookup"><span data-stu-id="228cd-619">This 4-byte field contains the target's IP address.</span></span> |

> [!IMPORTANT]
> <span data-ttu-id="228cd-620">*Le richieste e le risposte ARP sono pacchetti a livello Ethernet. Tutti gli altri pacchetti TCP/IP sono incapsulati da un'intestazione del pacchetto IP.*</span><span class="sxs-lookup"><span data-stu-id="228cd-620">*ARP requests and responses are Ethernet-level packets. All other TCP/IP packets are encapsulated by an IP packet header.*</span></span>

> [!IMPORTANT]
> <span data-ttu-id="228cd-621">*È previsto che tutti i messaggi ARP nell'implementazione TCP/IP siano in formato big endian. In questo formato, il byte più significativo della parola risiede nell'indirizzo di byte più basso.*</span><span class="sxs-lookup"><span data-stu-id="228cd-621">*All ARP messages in the TCP/IP implementation are expected to be in big endian format. In this format, the most significant byte of the word resides at the lowest byte address.*</span></span>

### <a name="arp-aging"></a><span data-ttu-id="228cd-622">Durata ARP</span><span class="sxs-lookup"><span data-stu-id="228cd-622">ARP Aging</span></span>

<span data-ttu-id="228cd-623">NetX supporta l'invalidamento automatico della voce ARP dinamica.</span><span class="sxs-lookup"><span data-stu-id="228cd-623">NetX supports automatic dynamic ARP entry invalidation.</span></span><span data-ttu-id="228cd-624">\ ***NX_ARP_EXPIRATION_RATE** _specifies il numero di secondi per cui un indirizzo IP stabilito al mapping fisico rimane valido.</span><span class="sxs-lookup"><span data-stu-id="228cd-624">\ ***NX_ARP_EXPIRATION_RATE** _specifies the number of seconds an established IP address to physical mapping stays valid.</span></span> <span data-ttu-id="228cd-625">Dopo la scadenza, la voce ARP viene rimossa dalla cache ARP.</span><span class="sxs-lookup"><span data-stu-id="228cd-625">After expiration, the ARP entry is removed from the ARP cache.</span></span> <span data-ttu-id="228cd-626">Il tentativo successivo di inviare all'indirizzo IP corrispondente comporterà una nuova richiesta ARP.</span><span class="sxs-lookup"><span data-stu-id="228cd-626">The next attempt to send to the corresponding IP address will result in a new ARP request.</span></span> <span data-ttu-id="228cd-627">Impostando _ *_NX_ARP_EXPIRATION_RATE_*\* su zero, viene disabilitata la durata ARP, che è la configurazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="228cd-627">Setting _ *_NX_ARP_EXPIRATION_RATE_*\* to zero disables ARP aging, which is the default configuration.</span></span>

### <a name="arp-defend"></a><span data-ttu-id="228cd-628">Difesa ARP</span><span class="sxs-lookup"><span data-stu-id="228cd-628">ARP Defend</span></span>

<span data-ttu-id="228cd-629">Quando viene ricevuta una richiesta ARP o un pacchetto di risposta ARP e il mittente ha lo stesso indirizzo IP, che è in conflitto con l'indirizzo IP del nodo, NetX invia una richiesta ARP per tale indirizzo come difesa.</span><span class="sxs-lookup"><span data-stu-id="228cd-629">When an ARP request or ARP response packet is received and the sender has the same IP address, which conflicts with the IP address of this node, NetX sends an ARP request for that address as a defense.</span></span> <span data-ttu-id="228cd-630">Se il pacchetto ARP dei conflitti viene ricevuto più di una volta in 10 secondi, NetX non invia più pacchetti di difesa.</span><span class="sxs-lookup"><span data-stu-id="228cd-630">If the conflict ARP packet is received more than once in 10 seconds, NetX does not send more defend packets.</span></span> <span data-ttu-id="228cd-631">L'intervallo predefinito di 10 secondi può essere ridefinito da \***NX_ARP_DEFEND_INTERVAL** _.</span><span class="sxs-lookup"><span data-stu-id="228cd-631">The default interval 10 seconds can be redefined by \***NX_ARP_DEFEND_INTERVAL** _.</span></span> <span data-ttu-id="228cd-632">Questo comportamento segue i criteri specificati in 2.4 (c) di RFC5227.</span><span class="sxs-lookup"><span data-stu-id="228cd-632">This behavior follows the policy specified in 2.4(c) of RFC5227.</span></span> <span data-ttu-id="228cd-633">Poiché Windows XP ignora l'annuncio ARP come risposta per il probe ARP, l'utente può definire _ *_NX_ARP_DEFEND_BY_REPLY_* \* per inviare la risposta ARP come difesa aggiuntiva.</span><span class="sxs-lookup"><span data-stu-id="228cd-633">Since Windows XP ignores ARP announcement as a response for its ARP probe, user can define _\*_NX_ARP_DEFEND_BY_REPLY_\*\*to send ARP response as additional defence.</span></span>

### <a name="arp-statistics-and-errors"></a><span data-ttu-id="228cd-634">Statistiche ed errori ARP</span><span class="sxs-lookup"><span data-stu-id="228cd-634">ARP Statistics and Errors</span></span>

<span data-ttu-id="228cd-635">Se abilitata, il software ARP NetX tiene traccia di diverse statistiche ed errori che possono essere utili per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="228cd-635">If enabled, the NetX ARP software keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="228cd-636">Per l'elaborazione ARP di ogni IP vengono mantenute le statistiche e i report degli errori seguenti:</span><span class="sxs-lookup"><span data-stu-id="228cd-636">The following statistics and error reports are maintained for each IP's ARP processing:</span></span>

- <span data-ttu-id="228cd-637">Totale richieste ARP inviate</span><span class="sxs-lookup"><span data-stu-id="228cd-637">Total ARP Requests Sent</span></span>
- <span data-ttu-id="228cd-638">Totale richieste ARP ricevute</span><span class="sxs-lookup"><span data-stu-id="228cd-638">Total ARP Requests Received</span></span>
- <span data-ttu-id="228cd-639">Totale risposte ARP inviate</span><span class="sxs-lookup"><span data-stu-id="228cd-639">Total ARP Responses Sent</span></span>
- <span data-ttu-id="228cd-640">Totale risposte ARP ricevute</span><span class="sxs-lookup"><span data-stu-id="228cd-640">Total ARP Responses Received</span></span>
- <span data-ttu-id="228cd-641">Totale voci dinamiche ARP</span><span class="sxs-lookup"><span data-stu-id="228cd-641">Total ARP Dynamic Entries</span></span>
- <span data-ttu-id="228cd-642">Totale voci statiche ARP</span><span class="sxs-lookup"><span data-stu-id="228cd-642">Total ARP Static Entries</span></span>
- <span data-ttu-id="228cd-643">Totale voci ARP obsolete</span><span class="sxs-lookup"><span data-stu-id="228cd-643">Total ARP Aged Entries</span></span>
- <span data-ttu-id="228cd-644">Totale messaggi ARP non validi</span><span class="sxs-lookup"><span data-stu-id="228cd-644">Total ARP Invalid Messages</span></span>

<span data-ttu-id="228cd-645">Tutte le statistiche e i report degli errori sono disponibili per l'applicazione con il servizio ***nx_arp_info_get*** .</span><span class="sxs-lookup"><span data-stu-id="228cd-645">All these statistics and error reports are available to the application with the ***nx_arp_info_get*** service.</span></span>

## <a name="reverse-address-resolution-protocol-rarp-in-ip"></a><span data-ttu-id="228cd-646">Protocollo RARP (Reverse Address Resolution Protocol) nell'IP</span><span class="sxs-lookup"><span data-stu-id="228cd-646">Reverse Address Resolution Protocol (RARP) in IP</span></span>

<span data-ttu-id="228cd-647">Il protocollo RARP (inverso Address Resolution Protocol) è il protocollo per la richiesta di assegnazione di rete degli indirizzi IP a 32 bit dell'host (RFC 903).</span><span class="sxs-lookup"><span data-stu-id="228cd-647">The Reverse Address Resolution Protocol (RARP) is the protocol for requesting network assignment of the host's 32-bit IP addresses (RFC 903).</span></span> <span data-ttu-id="228cd-648">Questa operazione viene eseguita tramite una richiesta RARP e continua periodicamente finché un membro di rete non assegna un indirizzo IP all'interfaccia di rete host in una risposta RARP.</span><span class="sxs-lookup"><span data-stu-id="228cd-648">This is done through an RARP request and continues periodically until a network member assigns an IP address to the host network interface in an RARP response.</span></span> <span data-ttu-id="228cd-649">L'applicazione crea un'istanza IP dal servizio ***nx_ip_create*** con un indirizzo IP zero.</span><span class="sxs-lookup"><span data-stu-id="228cd-649">The application creates an IP instance by the service ***nx_ip_create*** with a zero IP address.</span></span> <span data-ttu-id="228cd-650">Se RARP è abilitato dall'applicazione, può usare il protocollo RARP per richiedere un indirizzo IP dal server di rete accessibile tramite l'interfaccia con un indirizzo IP zero.</span><span class="sxs-lookup"><span data-stu-id="228cd-650">If RARP is enabled by the application, it can use the RARP protocol to request an IP address from the network server accessible through the interface that has a zero IP address.</span></span>

### <a name="rarp-enable"></a><span data-ttu-id="228cd-651">Abilitazione di RARP</span><span class="sxs-lookup"><span data-stu-id="228cd-651">RARP Enable</span></span>

<span data-ttu-id="228cd-652">Per usare RARP, l'applicazione deve creare l'istanza IP con un indirizzo IP pari a zero, quindi abilitare RARP usando il servizio ***nx_rarp_enable***.</span><span class="sxs-lookup"><span data-stu-id="228cd-652">To use RARP, the application must create the IP instance with an IP address of zero, then enable RARP using the service ***nx_rarp_enable***.</span></span> <span data-ttu-id="228cd-653">Per i sistemi multihome, almeno un dispositivo di rete associato all'istanza IP deve avere un indirizzo IP uguale a zero.</span><span class="sxs-lookup"><span data-stu-id="228cd-653">For multihome systems, at least one network device associated with the IP instance must have an IP address of zero.</span></span> <span data-ttu-id="228cd-654">L'elaborazione di RARP invia periodicamente messaggi di richiesta RARP per il sistema NetX che richiedono un indirizzo IP fino a quando non viene ricevuta una risposta RARP valida con l'indirizzo IP di rete designato.</span><span class="sxs-lookup"><span data-stu-id="228cd-654">The RARP processing periodically sends RARP request messages for the NetX system requiring an IP address until a valid RARP reply with the network designated IP address is received.</span></span> <span data-ttu-id="228cd-655">A questo punto, l'elaborazione di RARP è stata completata.</span><span class="sxs-lookup"><span data-stu-id="228cd-655">At this point, RARP processing is complete.</span></span>

<span data-ttu-id="228cd-656">Dopo l'abilitazione di RARP, questo viene disabilitato automaticamente dopo la risoluzione di tutti gli indirizzi di interfaccia.</span><span class="sxs-lookup"><span data-stu-id="228cd-656">After RARP has been enabled, it is disabled automatically after all interface addresses are resolved.</span></span> <span data-ttu-id="228cd-657">L'applicazione può forzare l'interruzione di RARP utilizzando il servizio ***nx_rarp_disable***.</span><span class="sxs-lookup"><span data-stu-id="228cd-657">The application may force RARP to terminate by using the service ***nx_rarp_disable***.</span></span>

###  <a name="rarp-request"></a><span data-ttu-id="228cd-658">Richiesta RARP</span><span class="sxs-lookup"><span data-stu-id="228cd-658">RARP Request</span></span>

<span data-ttu-id="228cd-659">Il formato di un pacchetto di richiesta RARP è quasi identico al pacchetto ARP illustrato nella figura 6 nell'argomento [messaggi ARP](#arp-messages). L'unica differenza è che il campo tipo di frame è 0x8035 e il campo del *codice operativo* è 3, che designa una richiesta RARP.</span><span class="sxs-lookup"><span data-stu-id="228cd-659">The format of an RARP request packet is almost identical to the ARP packet shown in Figure 6 in the topic [ARP Messages](#arp-messages).The only difference is the frame type field is 0x8035 and the *Operation Code* field is 3, designating an RARP request.</span></span> <span data-ttu-id="228cd-660">Come indicato in precedenza, le richieste RARP verranno inviate periodicamente (ogni ***NX_RARP_UPDATE_RATE*** secondi) finché non viene ricevuta una risposta RARP con l'indirizzo IP assegnato alla rete.</span><span class="sxs-lookup"><span data-stu-id="228cd-660">As mentioned previously, RARP requests will be sent periodically (every ***NX_RARP_UPDATE_RATE*** seconds) until a RARP reply with the network assigned IP address is received.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="228cd-661">*È previsto che tutti i messaggi RARP nell'implementazione TCP/IP siano in formato big endian. In questo formato, il byte più significativo della parola risiede nell'indirizzo di byte più basso.*</span><span class="sxs-lookup"><span data-stu-id="228cd-661">*All RARP messages in the TCP/IP implementation are expected to be in big endian format. In this format, the most significant byte of the word resides at the lowest byte address.*</span></span>

### <a name="rarp-reply"></a><span data-ttu-id="228cd-662">Risposta RARP</span><span class="sxs-lookup"><span data-stu-id="228cd-662">RARP Reply</span></span>

<span data-ttu-id="228cd-663">I messaggi di risposta RARP vengono ricevuti dalla rete e contengono l'indirizzo IP assegnato alla rete per questo host.</span><span class="sxs-lookup"><span data-stu-id="228cd-663">RARP reply messages are received from the network and contain the network assigned IP address for this host.</span></span> <span data-ttu-id="228cd-664">Il formato di un pacchetto di risposta RARP è quasi identico al pacchetto ARP illustrato nella figura 6.</span><span class="sxs-lookup"><span data-stu-id="228cd-664">The format of an RARP reply packet is almost identical to the ARP packet shown in Figure 6.</span></span> <span data-ttu-id="228cd-665">L'unica differenza è che il campo tipo di frame è 0x8035 e il campo del *codice operativo* è 4, che definisce una risposta RARP.</span><span class="sxs-lookup"><span data-stu-id="228cd-665">The only difference is the frame type field is 0x8035 and the *Operation Code* field is 4, which designates an RARP reply.</span></span> <span data-ttu-id="228cd-666">Dopo la ricezione, l'indirizzo IP viene configurato nell'istanza IP, la richiesta di RARP periodica è disabilitata e l'istanza IP è ora pronta per le normali operazioni di rete.</span><span class="sxs-lookup"><span data-stu-id="228cd-666">After received, the IP address is setup in the IP instance, the periodic RARP request is disabled, and the IP instance is now ready for normal network operation.</span></span>

<span data-ttu-id="228cd-667">Per gli host multihomed, l'indirizzo IP viene applicato all'interfaccia di rete richiedente.</span><span class="sxs-lookup"><span data-stu-id="228cd-667">For multihome hosts, the IP address is applied to the requesting network interface.</span></span> <span data-ttu-id="228cd-668">Se sono presenti altre interfacce di rete che richiedono ancora un'assegnazione di indirizzi IP, il servizio di RARP periodico continua fino a quando non vengono risolte tutte le richieste di indirizzi IP dell'interfaccia.</span><span class="sxs-lookup"><span data-stu-id="228cd-668">If there are other network interfaces still requesting an IP address assignment, the periodic RARP service continues until all interface IP address requests are resolved.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="228cd-669">*L'applicazione non deve usare l'istanza IP fino al completamento dell'elaborazione di RARP. Il **nx_ip_status_check** può essere utilizzato dalle applicazioni per attendere il completamento del RARP. Per i sistemi multihome, l'applicazione non deve usare l'interfaccia richiedente fino al completamento dell'elaborazione di RARP su tale interfaccia. È possibile controllare lo stato dell'indirizzo IP nel dispositivo secondario con il servizio **nx_ip_interface_status_check** .*</span><span class="sxs-lookup"><span data-stu-id="228cd-669">*The application should not use the IP instance until the RARP processing is complete. The **nx_ip_status_check** may be used by applications to wait for the RARP completion. For multihome systems, the application should not use the requesting interface until the RARP processing is complete on that interface. Status of the IP address on the secondary device can be checked with the **nx_ip_interface_status_check** service.*</span></span>

### <a name="rarp-statistics-and-errors"></a><span data-ttu-id="228cd-670">Statistiche ed errori di RARP</span><span class="sxs-lookup"><span data-stu-id="228cd-670">RARP Statistics and Errors</span></span>

<span data-ttu-id="228cd-671">Se abilitata, il software NetX RARP tiene traccia di diverse statistiche ed errori che possono essere utili per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="228cd-671">If enabled, the NetX RARP software keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="228cd-672">Per l'elaborazione RARP di ogni IP vengono mantenute le statistiche e i report degli errori seguenti:</span><span class="sxs-lookup"><span data-stu-id="228cd-672">The following statistics and error reports are maintained for each IP's RARP processing:</span></span>

- <span data-ttu-id="228cd-673">Totale richieste RARP inviate</span><span class="sxs-lookup"><span data-stu-id="228cd-673">Total RARP Requests Sent</span></span>
- <span data-ttu-id="228cd-674">Totale risposte RARP ricevute</span><span class="sxs-lookup"><span data-stu-id="228cd-674">Total RARP Responses Received</span></span>
- <span data-ttu-id="228cd-675">Totale messaggi non validi RARP</span><span class="sxs-lookup"><span data-stu-id="228cd-675">Total RARP Invalid Messages</span></span>

<span data-ttu-id="228cd-676">Tutte le statistiche e i report degli errori sono disponibili per l'applicazione con il servizio ***nx_rarp_info_get*** .</span><span class="sxs-lookup"><span data-stu-id="228cd-676">All these statistics and error reports are available to the application with the ***nx_rarp_info_get*** service.</span></span>

## <a name="internet-control-message-protocol-icmp"></a><span data-ttu-id="228cd-677">Internet Control Message Protocol (ICMP)</span><span class="sxs-lookup"><span data-stu-id="228cd-677">Internet Control Message Protocol (ICMP)</span></span>

<span data-ttu-id="228cd-678">Internet Control Message Protocol per IP (ICMP) è limitato al passaggio delle informazioni sugli errori e sul controllo tra i membri della rete IP.</span><span class="sxs-lookup"><span data-stu-id="228cd-678">Internet Control Message Protocol for IP (ICMP) is limited to passing error and control information between IP network members.</span></span>

<span data-ttu-id="228cd-679">Come per la maggior parte degli altri messaggi di livello applicazione (ad esempio TCP/IP), i messaggi ICMP sono incapsulati da un'intestazione IP con la designazione del protocollo ICMP.</span><span class="sxs-lookup"><span data-stu-id="228cd-679">Like most other application layer (e.g., TCP/IP) messages, ICMP messages are encapsulated by an IP header with the ICMP protocol designation.</span></span>

### <a name="icmp-statistics-and-errors"></a><span data-ttu-id="228cd-680">Statistiche ed errori ICMP</span><span class="sxs-lookup"><span data-stu-id="228cd-680">ICMP Statistics and Errors</span></span>

<span data-ttu-id="228cd-681">Se abilitata, NetX tiene traccia di diversi errori e statistiche ICMP che possono risultare utili per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="228cd-681">If enabled, NetX keeps track of several ICMP statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="228cd-682">Per l'elaborazione ICMP di ogni IP vengono mantenute le statistiche e i report degli errori seguenti:</span><span class="sxs-lookup"><span data-stu-id="228cd-682">The following statistics and error reports are maintained for each IP's ICMP processing:</span></span>

- <span data-ttu-id="228cd-683">Totale ping ICMP inviati</span><span class="sxs-lookup"><span data-stu-id="228cd-683">Total ICMP Pings Sent</span></span>
- <span data-ttu-id="228cd-684">Timeout totali ping ICMP</span><span class="sxs-lookup"><span data-stu-id="228cd-684">Total ICMP Ping Timeouts</span></span>
- <span data-ttu-id="228cd-685">Totale thread ping ICMP sospesi</span><span class="sxs-lookup"><span data-stu-id="228cd-685">Total ICMP Ping Threads Suspended</span></span>
- <span data-ttu-id="228cd-686">Totale risposte ping ICMP ricevute</span><span class="sxs-lookup"><span data-stu-id="228cd-686">Total ICMP Ping Responses Received</span></span>
- <span data-ttu-id="228cd-687">Totale errori di checksum ICMP</span><span class="sxs-lookup"><span data-stu-id="228cd-687">Total ICMP Checksum Errors</span></span>
- <span data-ttu-id="228cd-688">Totale messaggi non gestiti ICMP</span><span class="sxs-lookup"><span data-stu-id="228cd-688">Total ICMP Unhandled Messages</span></span>

<span data-ttu-id="228cd-689">Tutte le statistiche e i report degli errori sono disponibili per l'applicazione con il servizio ***nx_icmp_info_get*** .</span><span class="sxs-lookup"><span data-stu-id="228cd-689">All these statistics and error reports are available to the application with the ***nx_icmp_info_get*** service.</span></span>

### <a name="icmp-enable"></a><span data-ttu-id="228cd-690">Abilita ICMP</span><span class="sxs-lookup"><span data-stu-id="228cd-690">ICMP Enable</span></span>
<span data-ttu-id="228cd-691">Prima che i messaggi ICMP possano essere elaborati da NetX, l'applicazione deve chiamare il servizio ***nx_icmp_enable*** per abilitare l'elaborazione ICMP.</span><span class="sxs-lookup"><span data-stu-id="228cd-691">Before ICMP messages can be processed by NetX, the application must call the ***nx_icmp_enable*** service to enable ICMP processing.</span></span> <span data-ttu-id="228cd-692">Al termine di questa operazione, l'applicazione può emettere richieste ping e i pacchetti ping in ingresso del campo.</span><span class="sxs-lookup"><span data-stu-id="228cd-692">After this is done, the application can issue ping requests and field incoming ping packets.</span></span>

### <a name="icmp-echo-request"></a><span data-ttu-id="228cd-693">Richiesta echo ICMP</span><span class="sxs-lookup"><span data-stu-id="228cd-693">ICMP Echo Request</span></span>
<span data-ttu-id="228cd-694">Una richiesta echo è un tipo di messaggio ICMP usato in genere per verificare l'esistenza di un nodo specifico nella rete, come identificato dall'indirizzo IP dell'host.</span><span class="sxs-lookup"><span data-stu-id="228cd-694">An echo request is one type of ICMP message that is typically used to check for the existence of a specific node on the network, as identified by its host IP address.</span></span> <span data-ttu-id="228cd-695">Il popolare comando ping viene implementato utilizzando i messaggi ICMP Echo Request/Echo Reply.</span><span class="sxs-lookup"><span data-stu-id="228cd-695">The popular ping command is implemented using ICMP echo request/echo reply messages.</span></span> <span data-ttu-id="228cd-696">Se l'host specifico è presente, lo stack di rete elabora la richiesta e le risposte ping con una risposta ping.</span><span class="sxs-lookup"><span data-stu-id="228cd-696">If the specific host is present, its network stack processes the ping request and responses with a ping response.</span></span> <span data-ttu-id="228cd-697">Figura 7 dettagli del formato del messaggio ping ICMP.</span><span class="sxs-lookup"><span data-stu-id="228cd-697">Figure 7 details the ICMP ping message format.</span></span>

![Messaggio ping ICMP](./media/user-guide/icmp-ping-message.png)

<span data-ttu-id="228cd-699">**FIGURA 7. Messaggio ping ICMP**</span><span class="sxs-lookup"><span data-stu-id="228cd-699">**FIGURE 7. ICMP Ping Message**</span></span>

> [!IMPORTANT]
> <span data-ttu-id="228cd-700">*È previsto che tutti i messaggi ICMP nell'implementazione TCP/IP siano in formato big endian. In questo formato, il byte più significativo della parola risiede nell'indirizzo di byte più basso.*</span><span class="sxs-lookup"><span data-stu-id="228cd-700">*All ICMP messages in the TCP/IP implementation are expected to be in big endian format. In this format, the most significant byte of the word resides at the lowest byte address.*</span></span>

<span data-ttu-id="228cd-701">Nella tabella seguente viene descritto il formato di intestazione ICMP:</span><span class="sxs-lookup"><span data-stu-id="228cd-701">The following table describes the ICMP header format:</span></span>

| <span data-ttu-id="228cd-702">Campo di intestazione</span><span class="sxs-lookup"><span data-stu-id="228cd-702">Header Field</span></span>    | <span data-ttu-id="228cd-703">Scopo</span><span class="sxs-lookup"><span data-stu-id="228cd-703">Purpose</span></span> |
|-----------------|---------------------------------------------------|
| <span data-ttu-id="228cd-704">Tipo</span><span class="sxs-lookup"><span data-stu-id="228cd-704">Type</span></span>            | <span data-ttu-id="228cd-705">Questo campo specifica il messaggio ICMP (BITS 31-24).</span><span class="sxs-lookup"><span data-stu-id="228cd-705">This field specifies the ICMP message (bits 31- 24).</span></span> <span data-ttu-id="228cd-706">Le più comuni sono: 0 Echo Reply 8 richiesta echo</span><span class="sxs-lookup"><span data-stu-id="228cd-706">The most common are:   0 Echo Reply   8 Echo Request</span></span> |
| <span data-ttu-id="228cd-707">Codice</span><span class="sxs-lookup"><span data-stu-id="228cd-707">Code</span></span>            | <span data-ttu-id="228cd-708">Questo campo è specifico del contesto nel campo del tipo (BITS 23-16).</span><span class="sxs-lookup"><span data-stu-id="228cd-708">This field is context specific on the type field (bits 23-16).</span></span> <span data-ttu-id="228cd-709">Per una richiesta o una risposta echo il codice è impostato su zero.</span><span class="sxs-lookup"><span data-stu-id="228cd-709">For an echo request or reply the code is set to zero.</span></span> |
| <span data-ttu-id="228cd-710">Checksum</span><span class="sxs-lookup"><span data-stu-id="228cd-710">Checksum</span></span>        | <span data-ttu-id="228cd-711">Questo campo contiene il checksum a 16 bit della somma di complemento a uno del messaggio ICMP, inclusa l'intera intestazione ICMP che inizia con il campo tipo.</span><span class="sxs-lookup"><span data-stu-id="228cd-711">This field contains the 16-bit checksum of the one's complement sum of the ICMP message including the entire the ICMP header starting with the Type field.</span></span> <span data-ttu-id="228cd-712">Prima di generare il checksum, il campo checksum viene cancellato.</span><span class="sxs-lookup"><span data-stu-id="228cd-712">Before generating the checksum, the checksum field is cleared.</span></span>                 |
| <span data-ttu-id="228cd-713">Identification</span><span class="sxs-lookup"><span data-stu-id="228cd-713">Identification</span></span>  | <span data-ttu-id="228cd-714">Questo campo contiene un valore ID che identifica l'host. un host deve usare l'ID Estratto da una richiesta ECHO nella risposta ECHO (BITS 31-16).</span><span class="sxs-lookup"><span data-stu-id="228cd-714">This field contains an ID value identifying the host; a host should use the ID extracted from an ECHO request in the ECHO REPLY (bits 31-16).</span></span> |
| <span data-ttu-id="228cd-715">Numero di sequenza</span><span class="sxs-lookup"><span data-stu-id="228cd-715">Sequence number</span></span> | <span data-ttu-id="228cd-716">Questo campo contiene un valore ID. un host deve usare l'ID Estratto da una richiesta ECHO nella risposta ECHO (BITS 31-16).</span><span class="sxs-lookup"><span data-stu-id="228cd-716">This field contains an ID value; a host should use the ID extracted from an ECHO request in the ECHO REPLY (bits 31-16).</span></span> <span data-ttu-id="228cd-717">Diversamente dal campo identificatore, questo valore verrà modificato in una richiesta echo successiva dallo stesso host (BITS 15-0).</span><span class="sxs-lookup"><span data-stu-id="228cd-717">Unlike the identifier field, this value will change in a subsequent Echo request from the same host (bits 15-0).</span></span> |


### <a name="icmp-echo-response"></a><span data-ttu-id="228cd-718">Risposta echo ICMP</span><span class="sxs-lookup"><span data-stu-id="228cd-718">ICMP Echo Response</span></span>
<span data-ttu-id="228cd-719">Una risposta ping è un altro tipo di messaggio ICMP generato internamente dal componente ICMP in risposta a una richiesta ping esterna.</span><span class="sxs-lookup"><span data-stu-id="228cd-719">A ping response is another type of ICMP message that is generated internally by the ICMP component in response to an external ping request.</span></span> <span data-ttu-id="228cd-720">Oltre al riconoscimento, la risposta ping contiene anche una copia dei dati utente forniti nella richiesta ping.</span><span class="sxs-lookup"><span data-stu-id="228cd-720">In addition to acknowledgement, the ping response also contains a copy of the user data supplied in the ping request.</span></span>

## <a name="internet-group-management-protocol-igmp"></a><span data-ttu-id="228cd-721">IGMP (Internet Group Management Protocol)</span><span class="sxs-lookup"><span data-stu-id="228cd-721">Internet Group Management Protocol (IGMP)</span></span>

<span data-ttu-id="228cd-722">Il protocollo IGMP (Internet Group Management Protocol) fornisce un dispositivo per comunicare con gli elementi adiacenti e i relativi router che intende ricevere o aggiungere un gruppo multicast IP (RFC 1112 e RFC 2236).</span><span class="sxs-lookup"><span data-stu-id="228cd-722">The Internet Group Management Protocol (IGMP) provides a device to communicate with its neighbors and its routers that it intends to receive, or join, an IP multicast group (RFC 1112 and RFC 2236).</span></span> <span data-ttu-id="228cd-723">Un gruppo multicast è essenzialmente una raccolta dinamica di membri di rete ed è rappresentato da un indirizzo IP di classe D.</span><span class="sxs-lookup"><span data-stu-id="228cd-723">A multicast group is basically a dynamic collection of network members and is represented by a Class D IP address.</span></span> <span data-ttu-id="228cd-724">I membri del gruppo multicast possono uscire in qualsiasi momento e i nuovi membri possono partecipare in qualsiasi momento.</span><span class="sxs-lookup"><span data-stu-id="228cd-724">Members of the multicast group may leave at any time, and new members may join at any time.</span></span> <span data-ttu-id="228cd-725">Il coordinamento necessario per l'aggiunta e l'uscita del gruppo è la responsabilità di IGMP.</span><span class="sxs-lookup"><span data-stu-id="228cd-725">The coordination involved in joining and leaving the group is the responsibility of IGMP.</span></span>

### <a name="igmp-enable"></a><span data-ttu-id="228cd-726">Abilitazione IGMP</span><span class="sxs-lookup"><span data-stu-id="228cd-726">IGMP Enable</span></span>

<span data-ttu-id="228cd-727">Prima che qualsiasi attività multicast possa essere eseguita in NetX, l'applicazione deve chiamare il servizio ***nx_igmp_enable*** .</span><span class="sxs-lookup"><span data-stu-id="228cd-727">Before any multicasting activity can take place in NetX, the application must call the ***nx_igmp_enable*** service.</span></span> <span data-ttu-id="228cd-728">Questo servizio esegue l'inizializzazione IGMP di base per la preparazione delle richieste multicast.</span><span class="sxs-lookup"><span data-stu-id="228cd-728">This service performs basic IGMP initialization in preparation for multicast requests.</span></span>

### <a name="multicast-ip-addressing"></a><span data-ttu-id="228cd-729">Indirizzi IP multicast</span><span class="sxs-lookup"><span data-stu-id="228cd-729">Multicast IP Addressing</span></span>

<span data-ttu-id="228cd-730">Come indicato in precedenza, gli indirizzi multicast sono effettivamente di classe D indirizzi IP, come illustrato nella figura 4 nella pagina 58.</span><span class="sxs-lookup"><span data-stu-id="228cd-730">As mentioned previously, multicast addresses are actually Class D IP addresses as shown in Figure 4 on page 58.</span></span> <span data-ttu-id="228cd-731">I 28 bit inferiori dell'indirizzo della classe D corrispondono all'ID del gruppo multicast.</span><span class="sxs-lookup"><span data-stu-id="228cd-731">The lower 28-bits of the Class D address correspond to the multicast group ID.</span></span> <span data-ttu-id="228cd-732">Sono disponibili una serie di indirizzi multicast predefiniti.</span><span class="sxs-lookup"><span data-stu-id="228cd-732">There are a series of pre-defined multicast addresses.</span></span> <span data-ttu-id="228cd-733">Tuttavia, l' *Indirizzo All Hosts* (244.0.0.1) è particolarmente importante per l'elaborazione IGMP.</span><span class="sxs-lookup"><span data-stu-id="228cd-733">However, the *all hosts address* (244.0.0.1) is particularly important to IGMP processing.</span></span> <span data-ttu-id="228cd-734">L' *indirizzo tutti gli host* viene usato dai router per eseguire una query su tutti i membri multicast per segnalare i gruppi multicast a cui appartengono.</span><span class="sxs-lookup"><span data-stu-id="228cd-734">The *all hosts address* is used by routers to query all multicast members to report on which multicast groups they belong to.</span></span>

### <a name="physical-address-mapping-in-ip"></a><span data-ttu-id="228cd-735">Mapping degli indirizzi fisici nell'IP</span><span class="sxs-lookup"><span data-stu-id="228cd-735">Physical Address Mapping in IP</span></span>

<span data-ttu-id="228cd-736">Gli indirizzi multicast della classe D vengono mappati direttamente agli indirizzi Ethernet fisici compresi tra 01.00.5 e 00.00.00 tramite 01.00.5 e 7F. FF. FF.</span><span class="sxs-lookup"><span data-stu-id="228cd-736">Class D multicast addresses map directly to physical Ethernet addresses ranging from 01.00.5e.00.00.00 through 01.00.5e.7f.ff.ff.</span></span> <span data-ttu-id="228cd-737">I 23 bit inferiori della mappa indirizzi IP multicast direttamente ai 23 bit inferiori dell'indirizzo Ethernet.</span><span class="sxs-lookup"><span data-stu-id="228cd-737">The lower 23 bits of the IP multicast address map directly to the lower 23 bits of the Ethernet address.</span></span>

### <a name="multicast-group-join"></a><span data-ttu-id="228cd-738">Join gruppo multicast</span><span class="sxs-lookup"><span data-stu-id="228cd-738">Multicast Group Join</span></span>

<span data-ttu-id="228cd-739">Le applicazioni che devono partecipare a un particolare gruppo multicast possono eseguire questa operazione chiamando il servizio ***nx_igmp_multicast_join*** .</span><span class="sxs-lookup"><span data-stu-id="228cd-739">Applications that need to join a particular multicast group may do so by calling the ***nx_igmp_multicast_join*** service.</span></span> <span data-ttu-id="228cd-740">Questo servizio tiene traccia del numero di richieste da unire in join a questo gruppo multicast.</span><span class="sxs-lookup"><span data-stu-id="228cd-740">This service keeps track of the number of requests to join this multicast group.</span></span> <span data-ttu-id="228cd-741">Se si tratta della prima richiesta dell'applicazione per l'aggiunta al gruppo multicast, viene inviato un report IGMP sulla rete primaria indicante che l'intenzione dell'host è partecipare al gruppo.</span><span class="sxs-lookup"><span data-stu-id="228cd-741">If this is the first application request to join the multicast group, an IGMP report is sent out on the primary network indicating this host's intention to join the group.</span></span> <span data-ttu-id="228cd-742">Successivamente, il driver di rete viene chiamato per configurare per l'ascolto dei pacchetti con l'indirizzo Ethernet per questo gruppo multicast.</span><span class="sxs-lookup"><span data-stu-id="228cd-742">Next, the network driver is called to set up for listening for packets with the Ethernet address for this multicast group.</span></span>

<span data-ttu-id="228cd-743">In un sistema multihome, se il gruppo multicast è accessibile tramite un'interfaccia specifica, l'applicazione deve utilizzare il ***nx_igmp_multicast_interface_join*** di servizio anziché \***nx_igmp_multicast_join**, \* che è limitato ai gruppi multicast nella rete primaria.</span><span class="sxs-lookup"><span data-stu-id="228cd-743">In a multihome system, if the multicast group is accessible via a specific interface, application shall use the service ***nx_igmp_multicast_interface_join*** instead of \***nx_igmp_multicast_join**,\* which is limited to multicast groups on the primary network.</span></span>

### <a name="multicast-group-leave"></a><span data-ttu-id="228cd-744">Uscita gruppo multicast</span><span class="sxs-lookup"><span data-stu-id="228cd-744">Multicast Group Leave</span></span>

<span data-ttu-id="228cd-745">Le applicazioni che devono lasciare un gruppo multicast precedentemente aggiunto possono eseguire questa operazione chiamando il servizio ***nx_igmp_multicast_leave*** .</span><span class="sxs-lookup"><span data-stu-id="228cd-745">Applications that need to leave a previously joined multicast group may do so by calling the ***nx_igmp_multicast_leave*** service.</span></span> <span data-ttu-id="228cd-746">Questo servizio riduce il numero interno associato al numero di volte in cui è stato aggiunto il gruppo.</span><span class="sxs-lookup"><span data-stu-id="228cd-746">This service reduces the internal count associated with how many times the group was joined.</span></span> <span data-ttu-id="228cd-747">Se non sono presenti richieste di join in attesa per un gruppo, il driver di rete viene chiamato per disabilitare l'ascolto dei pacchetti con l'indirizzo Ethernet del gruppo multicast</span><span class="sxs-lookup"><span data-stu-id="228cd-747">If there are no outstanding join requests for a group, the network driver is called to disable listening for packets with this multicast group's Ethernet address</span></span>

### <a name="multicast-loopback"></a><span data-ttu-id="228cd-748">Loopback multicast</span><span class="sxs-lookup"><span data-stu-id="228cd-748">Multicast Loopback</span></span>

<span data-ttu-id="228cd-749">Un'applicazione potrebbe voler ricevere il traffico multicast originato da una delle origini nello stesso nodo.</span><span class="sxs-lookup"><span data-stu-id="228cd-749">An application may wish to receive multicast traffic originated from one of the sources on the same node.</span></span> <span data-ttu-id="228cd-750">A questo scopo, il componente multicast IP deve avere il loopback abilitato utilizzando il servizio ***nx_igmp_loopback_enable***.</span><span class="sxs-lookup"><span data-stu-id="228cd-750">This requires the IP multicast component to have loopback enabled by using the service ***nx_igmp_loopback_enable***.</span></span>

### <a name="igmp-report-message"></a><span data-ttu-id="228cd-751">Messaggio report IGMP</span><span class="sxs-lookup"><span data-stu-id="228cd-751">IGMP Report Message</span></span>

<span data-ttu-id="228cd-752">Quando l'applicazione viene aggiunta a un gruppo multicast, viene inviato un messaggio di report IGMP tramite la rete per indicare che l'intenzione dell'host deve essere aggiunta a un particolare gruppo multicast.</span><span class="sxs-lookup"><span data-stu-id="228cd-752">When the application joins a multicast group, an IGMP report message is sent via the network to indicate the host's intention to join a particular multicast group.</span></span> <span data-ttu-id="228cd-753">Il formato del messaggio del report IGMP è illustrato nella figura 8.</span><span class="sxs-lookup"><span data-stu-id="228cd-753">The format of the IGMP report message is shown in Figure 8.</span></span> <span data-ttu-id="228cd-754">L'indirizzo del gruppo multicast viene utilizzato sia per il messaggio di gruppo nel messaggio del report IGMP che per l'indirizzo IP di destinazione.</span><span class="sxs-lookup"><span data-stu-id="228cd-754">The multicast group address is used for both the group message in the IGMP report message and the destination IP address.</span></span>

![Messaggio report IGMP](./media/user-guide/igmp-report-message.png)

<span data-ttu-id="228cd-756">**FIGURA 8. Messaggio report IGMP**</span><span class="sxs-lookup"><span data-stu-id="228cd-756">**FIGURE 8. IGMP Report Message**</span></span>

<span data-ttu-id="228cd-757">Nella figura precedente (Figura 8), l'intestazione IGMP contiene un campo versione/tipo, il tempo di risposta massimo, un campo di checksum e un campo dell'indirizzo del gruppo multicast.</span><span class="sxs-lookup"><span data-stu-id="228cd-757">In the figure above (Figure 8), the IGMP header contains a version/type field, maximum response time, a checksum field, and a multicast group address field.</span></span> <span data-ttu-id="228cd-758">Per i messaggi IGMPv1, il campo tempi di risposta massimi è sempre impostato su zero, perché non fa parte del protocollo IGMPv1.</span><span class="sxs-lookup"><span data-stu-id="228cd-758">For IGMPv1 messages, the Maximum Response Time field is always set to zero, as this is not part of the IGMPv1 protocol.</span></span> <span data-ttu-id="228cd-759">Il campo tempo di risposta massimo viene impostato quando l'host riceve un messaggio IGMP di tipo query e viene cancellato quando un host riceve il messaggio del tipo di report di un altro host come definito dal protocollo IGMPv2.</span><span class="sxs-lookup"><span data-stu-id="228cd-759">The Maximum Response Time field is set when the host receives a Query type IGMP message and cleared when a host receives another host's Report type message as defined by the IGMPv2 protocol.</span></span>

<span data-ttu-id="228cd-760">Di seguito viene descritto il formato di intestazione IGMP:</span><span class="sxs-lookup"><span data-stu-id="228cd-760">The following describes the IGMP header format:</span></span>

| <span data-ttu-id="228cd-761">**Campo di intestazione**</span><span class="sxs-lookup"><span data-stu-id="228cd-761">**Header Field**</span></span>          | <span data-ttu-id="228cd-762">**Scopo**</span><span class="sxs-lookup"><span data-stu-id="228cd-762">**Purpose**</span></span> |
|-----------------------|--------------------------------------------------------------------|
| <span data-ttu-id="228cd-763">Versione</span><span class="sxs-lookup"><span data-stu-id="228cd-763">Version</span></span>               | <span data-ttu-id="228cd-764">Questo campo specifica la versione IGMP (BITS 31-28).</span><span class="sxs-lookup"><span data-stu-id="228cd-764">This field specifies the IGMP version (bits 31- 28).</span></span>                                                                               |
| <span data-ttu-id="228cd-765">Tipo</span><span class="sxs-lookup"><span data-stu-id="228cd-765">Type</span></span>                  | <span data-ttu-id="228cd-766">Questo campo specifica il tipo di messaggio IGMP (BITS 27 -24).</span><span class="sxs-lookup"><span data-stu-id="228cd-766">This field specifies the type of IGMP message (bits 27 -24).</span></span>                                                                       |
| <span data-ttu-id="228cd-767">Tempo di risposta massimo</span><span class="sxs-lookup"><span data-stu-id="228cd-767">Maximum Response Time</span></span> | <span data-ttu-id="228cd-768">Non utilizzato in IGMPv1.</span><span class="sxs-lookup"><span data-stu-id="228cd-768">Not used in IGMPv1.</span></span> <span data-ttu-id="228cd-769">In IGMPv2 questo campo funge da tempo di risposta massimo.</span><span class="sxs-lookup"><span data-stu-id="228cd-769">In IGMPv2 this field serves as the maximum response time.</span></span>                                                      |
| <span data-ttu-id="228cd-770">Checksum</span><span class="sxs-lookup"><span data-stu-id="228cd-770">Checksum</span></span>              | <span data-ttu-id="228cd-771">Questo campo contiene il checksum a 16 bit della somma del complemento a uno del messaggio IGMP che inizia con la versione IGMP (BITS 0-15)</span><span class="sxs-lookup"><span data-stu-id="228cd-771">This field contains the 16-bit checksum of the one's complement sum of the IGMP message starting with the IGMP version (bits 0-15)</span></span> |
| <span data-ttu-id="228cd-772">Indirizzo del gruppo</span><span class="sxs-lookup"><span data-stu-id="228cd-772">Group Address</span></span>         | <span data-ttu-id="228cd-773">Indirizzo IP del gruppo di classe D a 32 bit</span><span class="sxs-lookup"><span data-stu-id="228cd-773">32-bit class D group IP address</span></span> |


<span data-ttu-id="228cd-774">I messaggi di report IGMP vengono inviati anche in risposta ai messaggi di query IGMP inviati da un router multicast.</span><span class="sxs-lookup"><span data-stu-id="228cd-774">IGMP report messages are also sent in response to IGMP query messages sent by a multicast router.</span></span> <span data-ttu-id="228cd-775">I router multicast inviano periodicamente messaggi di query per vedere quali host richiedono ancora l'appartenenza al gruppo.</span><span class="sxs-lookup"><span data-stu-id="228cd-775">Multicast routers periodically send query messages out to see which hosts still require group membership.</span></span> <span data-ttu-id="228cd-776">I messaggi di query hanno lo stesso formato del messaggio di report IGMP illustrato nella figura 8.</span><span class="sxs-lookup"><span data-stu-id="228cd-776">Query messages have the same format as the IGMP Report message shown in Figure 8.</span></span> <span data-ttu-id="228cd-777">Le uniche differenze sono il tipo IGMP è uguale a 1 e il campo Indirizzo gruppo è impostato su 0.</span><span class="sxs-lookup"><span data-stu-id="228cd-777">The only differences are the IGMP type is equal to 1 and the group address field is set to 0.</span></span> <span data-ttu-id="228cd-778">I messaggi di query IGMP vengono inviati all'indirizzo IP *tutti gli host* dal router multicast.</span><span class="sxs-lookup"><span data-stu-id="228cd-778">IGMP Query messages are sent to the *all hosts* IP address by the multicast router.</span></span> <span data-ttu-id="228cd-779">Un host che desidera comunque mantenere l'appartenenza al gruppo risponde inviando un altro messaggio di report IGMP.</span><span class="sxs-lookup"><span data-stu-id="228cd-779">A host that still wishes to maintain group membership responds by sending another IGMP Report message.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="228cd-780">*È previsto che tutti i messaggi nell'implementazione TCP/IP siano in formato **Big Endian** . In questo formato, il byte più significativo della parola risiede nell'indirizzo di byte più basso.*</span><span class="sxs-lookup"><span data-stu-id="228cd-780">*All messages in the TCP/IP implementation are expected to be in **big endian** format. In this format, the most significant byte of the word resides at the lowest byte address.*</span></span>

### <a name="igmp-statistics-and-errors"></a><span data-ttu-id="228cd-781">Statistiche ed errori IGMP</span><span class="sxs-lookup"><span data-stu-id="228cd-781">IGMP Statistics and Errors</span></span>

<span data-ttu-id="228cd-782">Se abilitata, il software IGMP NetX tiene traccia di diverse statistiche ed errori che possono essere utili per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="228cd-782">If enabled, the NetX IGMP software keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="228cd-783">Per l'elaborazione IGMP di ogni IP vengono mantenute le statistiche e i report degli errori seguenti:</span><span class="sxs-lookup"><span data-stu-id="228cd-783">The following statistics and error reports are maintained for each IP's IGMP processing:</span></span>

- <span data-ttu-id="228cd-784">Totale report IGMP inviati</span><span class="sxs-lookup"><span data-stu-id="228cd-784">Total IGMP Reports Sent</span></span>
- <span data-ttu-id="228cd-785">Totale query IGMP ricevute</span><span class="sxs-lookup"><span data-stu-id="228cd-785">Total IGMP Queries Received</span></span>
- <span data-ttu-id="228cd-786">Totale errori di checksum IGMP</span><span class="sxs-lookup"><span data-stu-id="228cd-786">Total IGMP Checksum Errors</span></span>
- <span data-ttu-id="228cd-787">Totale gruppi correnti IGMP aggiunti</span><span class="sxs-lookup"><span data-stu-id="228cd-787">Total IGMP Current Groups Joined</span></span>

<span data-ttu-id="228cd-788">Tutte le statistiche e i report degli errori sono disponibili per l'applicazione con il servizio ***nx_igmp_info_get*** .</span><span class="sxs-lookup"><span data-stu-id="228cd-788">All these statistics and error reports are available to the application with the ***nx_igmp_info_get*** service.</span></span>

## <a name="user-datagram-protocol-udp"></a><span data-ttu-id="228cd-789">UDP (User Datagram Protocol)</span><span class="sxs-lookup"><span data-stu-id="228cd-789">User Datagram Protocol (UDP)</span></span>

<span data-ttu-id="228cd-790">Il protocollo UDP (User Datagram Protocol) fornisce la forma più semplice di trasferimento dei dati tra i membri di rete (RFC 768).</span><span class="sxs-lookup"><span data-stu-id="228cd-790">The User Datagram Protocol (UDP) provides the simplest form of data transfer between network members (RFC 768).</span></span> <span data-ttu-id="228cd-791">I pacchetti di dati UDP vengono inviati da un membro di rete a un altro nel modo migliore possibile. ovvero, non esiste alcun meccanismo incorporato per il riconoscimento da parte del destinatario del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="228cd-791">UDP data packets are sent from one network member to another in a best effort fashion; i.e., there is no built-in mechanism for acknowledgement by the packet recipient.</span></span> <span data-ttu-id="228cd-792">Inoltre, per l'invio di un pacchetto UDP non è necessario stabilire alcuna connessione in anticipo.</span><span class="sxs-lookup"><span data-stu-id="228cd-792">In addition, sending a UDP packet does not require any connection to be established in advance.</span></span> <span data-ttu-id="228cd-793">Per questo motivo, la trasmissione dei pacchetti UDP è molto efficiente.</span><span class="sxs-lookup"><span data-stu-id="228cd-793">Because of this, UDP packet transmission is very efficient.</span></span>

### <a name="udp-header"></a><span data-ttu-id="228cd-794">Intestazione UDP</span><span class="sxs-lookup"><span data-stu-id="228cd-794">UDP Header</span></span>
<span data-ttu-id="228cd-795">UDP posiziona una semplice intestazione del pacchetto davanti ai dati dell'applicazione durante la trasmissione e rimuove un'intestazione UDP simile dal pacchetto alla ricezione prima di consegnare un pacchetto UDP ricevuto all'applicazione.</span><span class="sxs-lookup"><span data-stu-id="228cd-795">UDP places a simple packet header in front of the application's data on transmission, and removes a similar UDP header from the packet on reception before delivering a received UDP packet to the application.</span></span> <span data-ttu-id="228cd-796">UDP usa il protocollo IP per l'invio e la ricezione di pacchetti, ovvero è presente un'intestazione IP davanti all'intestazione UDP quando il pacchetto si trova nella rete.</span><span class="sxs-lookup"><span data-stu-id="228cd-796">UDP utilizes the IP protocol for sending and receiving packets, which means there is an IP header in front of the UDP header when the packet is on the network.</span></span> <span data-ttu-id="228cd-797">Nella figura 9 è illustrato il formato dell'intestazione UDP.</span><span class="sxs-lookup"><span data-stu-id="228cd-797">Figure 9 shows the format of the UDP header.</span></span>

![Intestazione UDP](./media/user-guide/udp-header.png)

<span data-ttu-id="228cd-799">**FIGURA 9. Intestazione UDP**</span><span class="sxs-lookup"><span data-stu-id="228cd-799">**FIGURE 9. UDP Header**</span></span>

> [!IMPORTANT]
> <span data-ttu-id="228cd-800">*È previsto che tutte le intestazioni nell'implementazione di UDP/IP siano in formato big endian. In questo formato, il byte più significativo della parola risiede nell'indirizzo di byte più basso.*</span><span class="sxs-lookup"><span data-stu-id="228cd-800">*All headers in the UDP/IP implementation are expected to be in big endian format. In this format, the most significant byte of the word resides at the lowest byte address.*</span></span>

<span data-ttu-id="228cd-801">Di seguito viene descritto il formato dell'intestazione UDP:</span><span class="sxs-lookup"><span data-stu-id="228cd-801">The following describes the UDP header format:</span></span>

| <span data-ttu-id="228cd-802">Campo di intestazione</span><span class="sxs-lookup"><span data-stu-id="228cd-802">Header Field</span></span>                   | <span data-ttu-id="228cd-803">Scopo</span><span class="sxs-lookup"><span data-stu-id="228cd-803">Purpose</span></span> |
|--------------------------------|---------------------------------------------|
| <span data-ttu-id="228cd-804">numero di porta di origine a 16 bit</span><span class="sxs-lookup"><span data-stu-id="228cd-804">16-bit source port number</span></span>      | <span data-ttu-id="228cd-805">Questo campo contiene la porta da cui viene inviato il pacchetto UDP.</span><span class="sxs-lookup"><span data-stu-id="228cd-805">This field contains the port on which the UDP packet is being sent from.</span></span> <span data-ttu-id="228cd-806">Le porte UDP valide sono comprese tra 1 e 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="228cd-806">Valid UDP ports range from 1 through 0xFFFF.</span></span> |
| <span data-ttu-id="228cd-807">numero porta di destinazione a 16 bit</span><span class="sxs-lookup"><span data-stu-id="228cd-807">16-bit destination port number</span></span> | <span data-ttu-id="228cd-808">Questo campo contiene la porta UDP a cui viene inviato il pacchetto.</span><span class="sxs-lookup"><span data-stu-id="228cd-808">This field contains the UDP port to which the packet is being sent to.</span></span> <span data-ttu-id="228cd-809">Le porte UDP valide sono comprese tra 1 e 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="228cd-809">Valid UDP ports range from 1 through 0xFFFF.</span></span>   |
| <span data-ttu-id="228cd-810">lunghezza UDP a 16 bit</span><span class="sxs-lookup"><span data-stu-id="228cd-810">16-bit UDP length</span></span>   | <span data-ttu-id="228cd-811">Questo campo contiene il numero di byte nel pacchetto UDP, incluse le dimensioni dell'intestazione UDP.</span><span class="sxs-lookup"><span data-stu-id="228cd-811">This field contains the number of bytes in the UDP packet, including the size of the UDP header.</span></span>                                  |
| <span data-ttu-id="228cd-812">checksum UDP a 16 bit</span><span class="sxs-lookup"><span data-stu-id="228cd-812">16-bit UDP checksum</span></span> | <span data-ttu-id="228cd-813">Questo campo contiene il checksum a 16 bit per il pacchetto, tra cui l'intestazione UDP, l'area dati del pacchetto e l'intestazione pseudo-IP.</span><span class="sxs-lookup"><span data-stu-id="228cd-813">This field contains the 16-bit checksum for the packet, including the UDP header, the packet data area, and the pseudo IP header.</span></span> |

### <a name="udp-enable"></a><span data-ttu-id="228cd-814">Abilita UDP</span><span class="sxs-lookup"><span data-stu-id="228cd-814">UDP Enable</span></span>

<span data-ttu-id="228cd-815">Prima che sia possibile la trasmissione di pacchetti UDP, l'applicazione deve prima abilitare UDP chiamando il servizio ***nx_udp_enable*** .</span><span class="sxs-lookup"><span data-stu-id="228cd-815">Before UDP packet transmission is possible, the application must first enable UDP by calling the ***nx_udp_enable*** service.</span></span> <span data-ttu-id="228cd-816">Dopo l'abilitazione, l'applicazione è gratuita per inviare e ricevere pacchetti UDP.</span><span class="sxs-lookup"><span data-stu-id="228cd-816">After enabled, the application is free to send and receive UDP packets.</span></span>

### <a name="udp-socket-create"></a><span data-ttu-id="228cd-817">Creazione socket UDP</span><span class="sxs-lookup"><span data-stu-id="228cd-817">UDP Socket Create</span></span>

<span data-ttu-id="228cd-818">I socket UDP vengono creati durante l'inizializzazione o durante la fase di esecuzione dai thread dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="228cd-818">UDP sockets are created either during initialization or during runtime by application threads.</span></span> <span data-ttu-id="228cd-819">Il tipo di servizio, la durata (TTL) e la profondità della coda di ricezione specificati sono definiti dal servizio ***nx_udp_socket_create*** .</span><span class="sxs-lookup"><span data-stu-id="228cd-819">The initial type of service, time to live, and receive queue depth are defined by the ***nx_udp_socket_create*** service.</span></span> <span data-ttu-id="228cd-820">Non sono previsti limiti per il numero di socket UDP in un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="228cd-820">There are no limits on the number of UDP sockets in an application.</span></span>

### <a name="udp-checksum"></a><span data-ttu-id="228cd-821">Checksum UDP</span><span class="sxs-lookup"><span data-stu-id="228cd-821">UDP Checksum</span></span>

<span data-ttu-id="228cd-822">UDP specifica un checksum a 16 bit a complemento di uno che copre la pseudo intestazione IP (costituita dall'indirizzo IP di origine, indirizzo IP di destinazione e la parola IP di protocollo/lunghezza), l'intestazione UDP e i dati del pacchetto UDP.</span><span class="sxs-lookup"><span data-stu-id="228cd-822">UDP specifies a one's complement 16-bit checksum that covers the IP pseudo header (consisting of the source IP address, destination IP address, and the protocol/length IP word), the UDP header, and the UDP packet data.</span></span> <span data-ttu-id="228cd-823">Se il checksum UDP calcolato è 0, viene archiviato come tutti i valori (0xFFFF).</span><span class="sxs-lookup"><span data-stu-id="228cd-823">If the calculated UDP checksum is 0, it is stored as all ones (0xFFFF).</span></span> <span data-ttu-id="228cd-824">Se per il socket di invio è disabilitata la logica di checksum UDP, nel campo checksum UDP viene inserito uno zero per indicare che il checksum non è stato calcolato.</span><span class="sxs-lookup"><span data-stu-id="228cd-824">If the sending socket has the UDP checksum logic disabled, a zero is placed in the UDP checksum field to indicate the checksum was not calculated.</span></span> <span data-ttu-id="228cd-825">Se il checksum UDP non corrisponde al checksum calcolato dal ricevitore, il pacchetto UDP viene semplicemente ignorato.</span><span class="sxs-lookup"><span data-stu-id="228cd-825">If the UDP checksum does not match the computed checksum by the receiver, the UDP packet is simply discarded.</span></span>

<span data-ttu-id="228cd-826">Nella rete IP, il checksum UDP è facoltativo.</span><span class="sxs-lookup"><span data-stu-id="228cd-826">On the IP network, UDP checksum is optional.</span></span> <span data-ttu-id="228cd-827">NetX consente a un'applicazione di abilitare o disabilitare il calcolo del checksum UDP per singolo socket.</span><span class="sxs-lookup"><span data-stu-id="228cd-827">NetX allows an application to enable or disable UDP checksum calculation on a per-socket basis.</span></span> <span data-ttu-id="228cd-828">Per impostazione predefinita, la logica di checksum del socket UDP è abilitata.</span><span class="sxs-lookup"><span data-stu-id="228cd-828">By default, the UDP socket checksum logic is enabled.</span></span> <span data-ttu-id="228cd-829">L'applicazione può disabilitare la logica di checksum per un particolare socket UDP chiamando il servizio ***nx_udp_socket_checksum_disable*** .</span><span class="sxs-lookup"><span data-stu-id="228cd-829">The application can disable checksum logic for a particular UDP socket by calling the ***nx_udp_socket_checksum_disable*** service.</span></span>

<span data-ttu-id="228cd-830">Alcuni controller Ethernet sono in grado di generare rapidamente il checksum UDP.</span><span class="sxs-lookup"><span data-stu-id="228cd-830">Certain Ethernet controllers are able to generate the UDP checksum on the fly.</span></span> <span data-ttu-id="228cd-831">Se il sistema è in grado di utilizzare la funzionalità di calcolo di checksum hardware, la libreria NetX può essere compilata senza la logica di checksum.</span><span class="sxs-lookup"><span data-stu-id="228cd-831">If the system is able to use hardware checksum computation feature, the NetX library can be built without the checksum logic.</span></span> <span data-ttu-id="228cd-832">Per disabilitare il checksum del software UDP, è necessario compilare la libreria NetX con i simboli seguenti definiti: ***NX_DISABLE_UDP_TX_CHECKSUM*** e \***NX_DISABLE_UDP_RX_CHECKSUM **_ (descritto nel [capitolo 2](chapter2.md)). Le opzioni di configurazione rimuovono completamente la logica di checksum UDP da NetX, durante la chiamata del servizio _* nx_udp_socket_checksum_disable*** consente all'applicazione di disabilitare l'elaborazione del checksum UDP IP in base a ogni socket.</span><span class="sxs-lookup"><span data-stu-id="228cd-832">To disable UDP software checksum, the NetX library must be built with the following symbols defined: ***NX_DISABLE_UDP_TX_CHECKSUM*** and ***NX_DISABLE_UDP_RX_CHECKSUM\*\*_ (described in [Chapter 2](chapter2.md)). The configuration options remove UDP checksum logic from NetX entirely, while calling the _* nx_udp_socket_checksum_disable**\* service allows the application to disable IP UDP checksum processing on a per socket basis.</span></span>

### <a name="udp-ports-and-binding"></a><span data-ttu-id="228cd-833">Porte e binding UDP</span><span class="sxs-lookup"><span data-stu-id="228cd-833">UDP Ports and Binding</span></span>

<span data-ttu-id="228cd-834">Una porta UDP è un endpoint logico nel protocollo UDP.</span><span class="sxs-lookup"><span data-stu-id="228cd-834">A UDP port is a logical end point in the UDP protocol.</span></span> <span data-ttu-id="228cd-835">Nel componente UDP di NetX sono presenti 65.535 porte valide, comprese tra 1 e 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="228cd-835">There are 65,535 valid ports in the UDP component of NetX, ranging from 1 through 0xFFFF.</span></span> <span data-ttu-id="228cd-836">Per inviare o ricevere dati UDP, l'applicazione deve prima creare un socket UDP, quindi associarlo a una porta desiderata.</span><span class="sxs-lookup"><span data-stu-id="228cd-836">To send or receive UDP data, the application must first create a UDP socket, then bind it to a desired port.</span></span> <span data-ttu-id="228cd-837">Dopo aver associato un socket UDP a una porta, l'applicazione può inviare e ricevere dati su tale socket.</span><span class="sxs-lookup"><span data-stu-id="228cd-837">After binding a UDP socket to a port, the application may send and receive data on that socket.</span></span>

### <a name="udp-fast-pathtrade"></a><span data-ttu-id="228cd-838">Percorso veloce UDP&trade;</span><span class="sxs-lookup"><span data-stu-id="228cd-838">UDP Fast Path&trade;</span></span>

<span data-ttu-id="228cd-839">Il percorso veloce UDP &trade; è il nome di un percorso di overhead dei pacchetti basso tramite l'implementazione UDP di NETX.</span><span class="sxs-lookup"><span data-stu-id="228cd-839">The UDP Fast Path&trade; is the name for a low packet overhead path through the NetX UDP implementation.</span></span> <span data-ttu-id="228cd-840">L'invio di un pacchetto UDP richiede solo alcune chiamate di funzione: ***nx_udp_socket_send** _, _*_nx_ip_packet_send_\*_ e la chiamata finale al driver di rete.</span><span class="sxs-lookup"><span data-stu-id="228cd-840">Sending a UDP packet requires just a few function calls: ***nx_udp_socket_send** _, _*_nx_ip_packet_send_\*_, and the eventual call to the network driver.</span></span> <span data-ttu-id="228cd-841">_*_nx_udp_socket_send_*_ è disponibile in NETX per le applicazioni NETX esistenti ed è applicabile solo ai pacchetti IP.</span><span class="sxs-lookup"><span data-stu-id="228cd-841">_*_nx_udp_socket_send_*_ is available in NetX for existing NetX applications and is only applicable for IP packets.</span></span> <span data-ttu-id="228cd-842">Il metodo preferito, tuttavia, consiste nell'usare _ *_nx_udp_socket_send_*\* servizio descritto di seguito.</span><span class="sxs-lookup"><span data-stu-id="228cd-842">The preferred method, however, is to use _ *_nx_udp_socket_send_*\* service discussed below.</span></span> <span data-ttu-id="228cd-843">Nella ricezione di pacchetti UDP, il pacchetto UDP viene inserito nella coda di ricezione socket UDP appropriata o recapitato a un thread dell'applicazione sospesa in una singola chiamata di funzione dall'elaborazione dell'interrupt di ricezione del driver di rete.</span><span class="sxs-lookup"><span data-stu-id="228cd-843">On UDP packet reception, the UDP packet is either placed on the appropriate UDP socket receive queue or delivered to a suspended application thread in a single function call from the network driver's receive interrupt processing.</span></span> <span data-ttu-id="228cd-844">Questa logica altamente ottimizzata per l'invio e la ricezione di pacchetti UDP è l'essenza della tecnologia di percorso veloce UDP.</span><span class="sxs-lookup"><span data-stu-id="228cd-844">This highly optimized logic for sending and receiving UDP packets is the essence of UDP Fast Path technology.</span></span>

### <a name="udp-packet-send"></a><span data-ttu-id="228cd-845">Invio pacchetti UDP</span><span class="sxs-lookup"><span data-stu-id="228cd-845">UDP Packet Send</span></span>

<span data-ttu-id="228cd-846">L'invio di dati UDP su reti IP viene eseguito facilmente chiamando la funzione \***nx_udp_socket_send** _.</span><span class="sxs-lookup"><span data-stu-id="228cd-846">Sending UDP data over IP networks is easily accomplished by calling the \***nx_udp_socket_send** _ function.</span></span> <span data-ttu-id="228cd-847">Il chiamante deve impostare la versione IP nel campo _IP Address \*.</span><span class="sxs-lookup"><span data-stu-id="228cd-847">The caller must set the IP version in the _IP address\* field.</span></span> <span data-ttu-id="228cd-848">NetX determinerà l'indirizzo di origine migliore per i pacchetti UDP trasmessi in base all'indirizzo IP di destinazione.</span><span class="sxs-lookup"><span data-stu-id="228cd-848">NetX will determine the best source address for transmitted UDP packets based on the destination IP address.</span></span> <span data-ttu-id="228cd-849">Questo servizio posiziona un'intestazione UDP davanti ai dati del pacchetto e la invia alla rete usando una routine di invio IP interna.</span><span class="sxs-lookup"><span data-stu-id="228cd-849">This service places a UDP header in front of the packet data and sends it out onto the network using an internal IP send routine.</span></span> <span data-ttu-id="228cd-850">Non vi è alcuna sospensione di thread per l'invio di pacchetti UDP perché tutte le trasmissioni di pacchetti UDP vengono elaborate immediatamente.</span><span class="sxs-lookup"><span data-stu-id="228cd-850">There is no thread suspension on sending UDP packets because all UDP packet transmissions are processed immediately.</span></span>

<span data-ttu-id="228cd-851">Per le destinazioni multicast o broadcast, l'applicazione deve specificare l'indirizzo IP di origine da usare se il dispositivo NetX dispone di più indirizzi IP tra cui scegliere.</span><span class="sxs-lookup"><span data-stu-id="228cd-851">For multicast or broadcast destinations, the application should specify the source IP address to use if the NetX device has multiple IP addresses to choose from.</span></span> <span data-ttu-id="228cd-852">Questa operazione può essere eseguita con i servizi ***nx_udp_socket_interface_send.***</span><span class="sxs-lookup"><span data-stu-id="228cd-852">This can be done with the services ***nx_udp_socket_interface_send.***</span></span>

> [!IMPORTANT]
> <span data-ttu-id="228cd-853">*Se **nx_udp_socket_send** viene usato per la trasmissione di pacchetti broadcast o multicast, l'indirizzo IP della prima interfaccia viene usato come indirizzo di origine.*</span><span class="sxs-lookup"><span data-stu-id="228cd-853">*If **nx_udp_socket_send** is used for transmitting multicast or broadcast packets, the IP address of the first interface is used as source address.*</span></span>

> [!IMPORTANT]
> <span data-ttu-id="228cd-854">*Se per questo socket è abilitata la logica di checksum UDP, l'operazione di checksum viene eseguita nel contesto del thread chiamante, senza bloccare l'accesso alle strutture di dati UDP o IP.*</span><span class="sxs-lookup"><span data-stu-id="228cd-854">*If UDP checksum logic is enabled for this socket, the checksum operation is performed in the context of the calling thread, without blocking access to the UDP or IP data structures.*</span></span>

> [!NOTE]
> <span data-ttu-id="228cd-855">*I dati di payload UDP che risiedono nella struttura di **NX_PACKET** devono trovarsi su un confine di parola lungo. L'applicazione deve lasciare spazio sufficiente tra il puntatore anteposto e il puntatore di avvio dati per NetX per inserire le intestazioni dei supporti UDP, IP e fisici.*</span><span class="sxs-lookup"><span data-stu-id="228cd-855">*The UDP payload data residing in the **NX_PACKET** structure should reside on a long-word boundary. The application needs to leave sufficient space between the prepend pointer and the data start pointer for NetX to place the UDP, IP, and physical media headers.*</span></span>

### <a name="udp-packet-receive"></a><span data-ttu-id="228cd-856">Ricezione pacchetti UDP</span><span class="sxs-lookup"><span data-stu-id="228cd-856">UDP Packet Receive</span></span>

<span data-ttu-id="228cd-857">I thread dell'applicazione possono ricevere pacchetti UDP da un socket particolare chiamando ***nx_udp_socket_receive***.</span><span class="sxs-lookup"><span data-stu-id="228cd-857">Application threads may receive UDP packets from a particular socket by calling ***nx_udp_socket_receive***.</span></span> <span data-ttu-id="228cd-858">La funzione di ricezione socket recapita il pacchetto meno recente nella coda di ricezione del socket.</span><span class="sxs-lookup"><span data-stu-id="228cd-858">The socket receive function delivers the oldest packet on the socket's receive queue.</span></span> <span data-ttu-id="228cd-859">Se non sono presenti pacchetti nella coda di ricezione, il thread chiamante può sospendere (con un timeout facoltativo) finché non arriva un pacchetto.</span><span class="sxs-lookup"><span data-stu-id="228cd-859">If there are no packets on the receive queue, the calling thread can suspend (with an optional timeout) until a packet arrives.</span></span>

<span data-ttu-id="228cd-860">L'elaborazione dei pacchetti di ricezione UDP (in genere chiamata dal gestore di interrupt di ricezione del driver di rete) è responsabile del posizionamento del pacchetto nella coda di ricezione del socket UDP o del recapito al primo thread sospeso in attesa di un pacchetto.</span><span class="sxs-lookup"><span data-stu-id="228cd-860">The UDP receive packet processing (usually called from the network driver's receive interrupt handler) is responsible for either placing the packet on the UDP socket's receive queue or delivering it to the first suspended thread waiting for a packet.</span></span> <span data-ttu-id="228cd-861">Se il pacchetto viene accodato, l'elaborazione della ricezione controlla anche la profondità massima della coda di ricezione associata al socket.</span><span class="sxs-lookup"><span data-stu-id="228cd-861">If the packet is queued, the receive processing also checks the maximum receive queue depth associated with the socket.</span></span> <span data-ttu-id="228cd-862">Se il pacchetto appena accodato supera la profondità della coda, il pacchetto meno recente nella coda viene eliminato.</span><span class="sxs-lookup"><span data-stu-id="228cd-862">If this newly queued packet exceeds the queue depth, the oldest packet in the queue is discarded.</span></span>

### <a name="udp-receive-notify"></a><span data-ttu-id="228cd-863">Ricezione notifica UDP</span><span class="sxs-lookup"><span data-stu-id="228cd-863">UDP Receive Notify</span></span>

<span data-ttu-id="228cd-864">Se il thread dell'applicazione deve elaborare i dati ricevuti da più di un socket, è necessario usare la funzione ***nx_udp_socket_receive_notify*** .</span><span class="sxs-lookup"><span data-stu-id="228cd-864">If the application thread needs to process received data from more than one socket, the ***nx_udp_socket_receive_notify*** function should be used.</span></span> <span data-ttu-id="228cd-865">Questa funzione registra una funzione di callback del pacchetto di ricezione per il socket.</span><span class="sxs-lookup"><span data-stu-id="228cd-865">This function registers a receive packet callback function for the socket.</span></span> <span data-ttu-id="228cd-866">Ogni volta che viene ricevuto un pacchetto nel socket, viene eseguita la funzione di callback.</span><span class="sxs-lookup"><span data-stu-id="228cd-866">Whenever a packet is received on the socket, the callback function is executed.</span></span>

<span data-ttu-id="228cd-867">Il contenuto della funzione di callback è specifico dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="228cd-867">The contents of the callback function is application-specific.</span></span> <span data-ttu-id="228cd-868">Tuttavia, sarebbe più probabile che contengano la logica per informare il thread di elaborazione che un pacchetto è ora disponibile nel socket corrispondente.</span><span class="sxs-lookup"><span data-stu-id="228cd-868">However, it would most likely contain logic to inform the processing thread that a packet is now available on the corresponding socket.</span></span>

### <a name="peer-address-and-port"></a><span data-ttu-id="228cd-869">Indirizzo e porta peer</span><span class="sxs-lookup"><span data-stu-id="228cd-869">Peer Address and Port</span></span>

<span data-ttu-id="228cd-870">Alla ricezione di un pacchetto UDP, l'applicazione può trovare l'indirizzo IP e il numero di porta del mittente usando il ***nx_udp_packet_info_extract*** del servizio.</span><span class="sxs-lookup"><span data-stu-id="228cd-870">On receiving a UDP packet, application may find the sender's IP address and port number by using the service ***nx_udp_packet_info_extract***.</span></span> <span data-ttu-id="228cd-871">In seguito all'esito positivo, questo servizio fornisce informazioni sull'indirizzo IP del mittente, sul numero di porta del mittente e sull'interfaccia locale tramite cui è stato ricevuto il pacchetto.</span><span class="sxs-lookup"><span data-stu-id="228cd-871">On successful return, this service provides information on the sender's IP address, sender's port number, and the local interface through which the packet was received.</span></span>

### <a name="thread-suspension"></a><span data-ttu-id="228cd-872">Sospensione thread</span><span class="sxs-lookup"><span data-stu-id="228cd-872">Thread Suspension</span></span>

<span data-ttu-id="228cd-873">Come indicato in precedenza, i thread dell'applicazione possono sospendere il tentativo di ricezione di un pacchetto UDP su una determinata porta UDP.</span><span class="sxs-lookup"><span data-stu-id="228cd-873">As mentioned previously, application threads can suspend while attempting to receive a UDP packet on a particular UDP port.</span></span> <span data-ttu-id="228cd-874">Dopo la ricezione di un pacchetto su tale porta, questo viene assegnato al primo thread sospeso e il thread viene quindi ripreso.</span><span class="sxs-lookup"><span data-stu-id="228cd-874">After a packet is received on that port, it is given to the first thread suspended and that thread is then resumed.</span></span> <span data-ttu-id="228cd-875">Un timeout facoltativo è disponibile quando si sospende un pacchetto di ricezione UDP, una funzionalità disponibile per la maggior parte dei servizi NetX.</span><span class="sxs-lookup"><span data-stu-id="228cd-875">An optional timeout is available when suspending on a UDP receive packet, a feature available for most NetX services.</span></span>

### <a name="udp-socket-statistics-and-errors"></a><span data-ttu-id="228cd-876">Statistiche ed errori di socket UDP</span><span class="sxs-lookup"><span data-stu-id="228cd-876">UDP Socket Statistics and Errors</span></span>

<span data-ttu-id="228cd-877">Se abilitata, il software socket UDP NetX tiene traccia di diverse statistiche ed errori che possono essere utili per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="228cd-877">If enabled, the NetX UDP socket software keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="228cd-878">Per ogni istanza IP/UDP vengono mantenute le statistiche e i report degli errori seguenti:</span><span class="sxs-lookup"><span data-stu-id="228cd-878">The following statistics and error reports are maintained for each IP/UDP instance:</span></span>

- <span data-ttu-id="228cd-879">Totale pacchetti UDP inviati</span><span class="sxs-lookup"><span data-stu-id="228cd-879">Total UDP Packets Sent</span></span>
- <span data-ttu-id="228cd-880">Totale byte UDP inviati</span><span class="sxs-lookup"><span data-stu-id="228cd-880">Total UDP Bytes Sent</span></span>
- <span data-ttu-id="228cd-881">Totale pacchetti UDP ricevuti</span><span class="sxs-lookup"><span data-stu-id="228cd-881">Total UDP Packets Received</span></span>
- <span data-ttu-id="228cd-882">Totale byte UDP ricevuti</span><span class="sxs-lookup"><span data-stu-id="228cd-882">Total UDP Bytes Received</span></span>
- <span data-ttu-id="228cd-883">Totale pacchetti UDP non validi</span><span class="sxs-lookup"><span data-stu-id="228cd-883">Total UDP Invalid Packets</span></span>
- <span data-ttu-id="228cd-884">Totale pacchetti di ricezione UDP eliminati</span><span class="sxs-lookup"><span data-stu-id="228cd-884">Total UDP Receive Packets Dropped</span></span>
- <span data-ttu-id="228cd-885">Totale errori di checksum di ricezione UDP</span><span class="sxs-lookup"><span data-stu-id="228cd-885">Total UDP Receive Checksum Errors</span></span>
- <span data-ttu-id="228cd-886">Pacchetti socket UDP inviati</span><span class="sxs-lookup"><span data-stu-id="228cd-886">UDP Socket Packets Sent</span></span>
- <span data-ttu-id="228cd-887">Byte socket UDP inviati</span><span class="sxs-lookup"><span data-stu-id="228cd-887">UDP Socket Bytes Sent</span></span>
- <span data-ttu-id="228cd-888">Pacchetti socket UDP ricevuti</span><span class="sxs-lookup"><span data-stu-id="228cd-888">UDP Socket Packets Received</span></span>
- <span data-ttu-id="228cd-889">Byte socket UDP ricevuti</span><span class="sxs-lookup"><span data-stu-id="228cd-889">UDP Socket Bytes Received</span></span>
- <span data-ttu-id="228cd-890">Pacchetti socket UDP in coda</span><span class="sxs-lookup"><span data-stu-id="228cd-890">UDP Socket Packets Queued</span></span>
- <span data-ttu-id="228cd-891">Pacchetti di ricezione socket UDP eliminati</span><span class="sxs-lookup"><span data-stu-id="228cd-891">UDP Socket Receive Packets Dropped</span></span>
- <span data-ttu-id="228cd-892">Errori di checksum del socket UDP</span><span class="sxs-lookup"><span data-stu-id="228cd-892">UDP Socket Checksum Errors</span></span>

<span data-ttu-id="228cd-893">Tutte le statistiche e i report degli errori sono disponibili per l'applicazione con il servizio ***nx_udp_info_get*** per le statistiche UDP accumulate su tutti i socket UDP e il servizio ***nx_udp_socket_info_get*** per le statistiche UDP sul socket UDP specificato.</span><span class="sxs-lookup"><span data-stu-id="228cd-893">All these statistics and error reports are available to the application with the ***nx_udp_info_get*** service for UDP statistics amassed over all UDP sockets, and the ***nx_udp_socket_info_get*** service for UDP statistics on the specified UDP socket.</span></span>

### <a name="udp-socket-control-block-nx_udp_socket"></a><span data-ttu-id="228cd-894">NX_UDP_SOCKET blocco di controllo socket UDP</span><span class="sxs-lookup"><span data-stu-id="228cd-894">UDP Socket Control Block NX_UDP_SOCKET</span></span>

<span data-ttu-id="228cd-895">Le caratteristiche di ogni socket UDP si trovano nel blocco di controllo **NX_UDP_SOCKET** associato.</span><span class="sxs-lookup"><span data-stu-id="228cd-895">The characteristics of each UDP socket are found in the associated **NX_UDP_SOCKET** control block.</span></span> <span data-ttu-id="228cd-896">Contiene informazioni utili, ad esempio il collegamento alla struttura dei dati IP, l'interfaccia di rete per i percorsi di invio e ricezione, la porta associata e la coda dei pacchetti di ricezione.</span><span class="sxs-lookup"><span data-stu-id="228cd-896">It contains useful information such as the link to the IP data structure, the network interface for the sending and receiving paths, the bound port, and the receive packet queue.</span></span> <span data-ttu-id="228cd-897">Questa struttura viene definita nel file **_nx_api. h_** .</span><span class="sxs-lookup"><span data-stu-id="228cd-897">This structure is defined in the **_nx_api.h_** file.</span></span>

## <a name="transmission-control-protocol-tcp"></a><span data-ttu-id="228cd-898">Transmission Control Protocol (TCP)</span><span class="sxs-lookup"><span data-stu-id="228cd-898">Transmission Control Protocol (TCP)</span></span>

<span data-ttu-id="228cd-899">Il Transmission Control Protocol (TCP) fornisce un trasferimento dei dati di flusso affidabile tra due membri di rete (RFC 793).</span><span class="sxs-lookup"><span data-stu-id="228cd-899">The Transmission Control Protocol (TCP) provides reliable stream data transfer between two network members (RFC 793).</span></span> <span data-ttu-id="228cd-900">Tutti i dati inviati da un membro della rete vengono verificati e riconosciuti dal membro di destinazione.</span><span class="sxs-lookup"><span data-stu-id="228cd-900">All data sent from one network member are verified and acknowledged by the receiving member.</span></span> <span data-ttu-id="228cd-901">Inoltre, i due membri devono avere stabilito una connessione prima del trasferimento dei dati.</span><span class="sxs-lookup"><span data-stu-id="228cd-901">In addition, the two members must have established a connection prior to any data transfer.</span></span> <span data-ttu-id="228cd-902">Il risultato è il trasferimento affidabile dei dati; Tuttavia, richiede un sovraccarico sostanziale rispetto al trasferimento dei dati UDP descritto in precedenza.</span><span class="sxs-lookup"><span data-stu-id="228cd-902">All this results in reliable data transfer; however, it does require substantially more overhead than the previously described UDP data transfer.</span></span>

### <a name="tcp-header"></a><span data-ttu-id="228cd-903">Intestazione TCP</span><span class="sxs-lookup"><span data-stu-id="228cd-903">TCP Header</span></span>

<span data-ttu-id="228cd-904">Sulla trasmissione, l'intestazione TCP viene posizionata davanti ai dati dell'utente.</span><span class="sxs-lookup"><span data-stu-id="228cd-904">On transmission, TCP header is placed in front of the data from the user.</span></span> <span data-ttu-id="228cd-905">Alla ricezione, l'intestazione TCP viene rimossa dal pacchetto in ingresso, lasciando solo i dati utente disponibili per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="228cd-905">On reception, TCP header is removed from the incoming packet, leaving only the user data available to the application.</span></span> <span data-ttu-id="228cd-906">TCP utilizza il protocollo IP per inviare e ricevere pacchetti, ovvero è presente un'intestazione IP davanti all'intestazione TCP quando il pacchetto si trova nella rete.</span><span class="sxs-lookup"><span data-stu-id="228cd-906">TCP utilizes the IP protocol to send and receive packets, which means there is an IP header in front of the TCP header when the packet is on the network.</span></span> <span data-ttu-id="228cd-907">Nella figura 10 è illustrato il formato dell'intestazione TCP.</span><span class="sxs-lookup"><span data-stu-id="228cd-907">Figure 10 shows the format of the TCP header.</span></span>

![Intestazione TCP](./media/user-guide/tcp-header.png)

<span data-ttu-id="228cd-909">**FIGURA 10. Intestazione TCP**</span><span class="sxs-lookup"><span data-stu-id="228cd-909">**FIGURE 10. TCP Header**</span></span>

<span data-ttu-id="228cd-910">Di seguito viene descritto il formato dell'intestazione TCP:</span><span class="sxs-lookup"><span data-stu-id="228cd-910">The following describes the TCP header format:</span></span>

| <span data-ttu-id="228cd-911">Campo di intestazione</span><span class="sxs-lookup"><span data-stu-id="228cd-911">Header Field</span></span> | <span data-ttu-id="228cd-912">Scopo</span><span class="sxs-lookup"><span data-stu-id="228cd-912">Purpose</span></span> |
|---|---|
| <span data-ttu-id="228cd-913">numero di porta di origine a 16 bit</span><span class="sxs-lookup"><span data-stu-id="228cd-913">16-bit source port number</span></span> | <span data-ttu-id="228cd-914">Questo campo contiene la porta a cui viene inviato il pacchetto TCP.</span><span class="sxs-lookup"><span data-stu-id="228cd-914">This field contains the port the TCP packet is being sent out on.</span></span> <span data-ttu-id="228cd-915">Le porte TCP valide sono comprese tra 1 e 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="228cd-915">Valid TCP ports range from 1 through 0xFFFF.</span></span> |
| <span data-ttu-id="228cd-916">numero porta di destinazione a 16 bit</span><span class="sxs-lookup"><span data-stu-id="228cd-916">16-bit destination port number</span></span> | <span data-ttu-id="228cd-917">Questo campo contiene la porta TCP a cui viene inviato il pacchetto.</span><span class="sxs-lookup"><span data-stu-id="228cd-917">This field contains the TCP port the packet is being sent to.</span></span> <span data-ttu-id="228cd-918">Le porte TCP valide sono comprese tra 1 e 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="228cd-918">Valid TCP ports range from 1 through 0xFFFF.</span></span> |
| <span data-ttu-id="228cd-919">numero di sequenza a 32 bit</span><span class="sxs-lookup"><span data-stu-id="228cd-919">32-bit sequence number</span></span> | <span data-ttu-id="228cd-920">Questo campo contiene il numero di sequenza per i dati inviati da questa entità finale della connessione.</span><span class="sxs-lookup"><span data-stu-id="228cd-920">This field contains the sequence number for data sent from this end of the connection.</span></span> <span data-ttu-id="228cd-921">La sequenza originale viene stabilita durante la sequenza di connessione iniziale tra due nodi TCP.</span><span class="sxs-lookup"><span data-stu-id="228cd-921">The original sequence is established during the initial connection sequence between two TCP nodes.</span></span> <span data-ttu-id="228cd-922">Ogni trasferimento di dati da tale punto genera un incremento del numero di sequenza in base alla quantità di byte inviati.</span><span class="sxs-lookup"><span data-stu-id="228cd-922">Every data transfer from that point results in an increment of the sequence number by the amount bytes sent.</span></span> |
| <span data-ttu-id="228cd-923">numero di riconoscimento a 32 bit</span><span class="sxs-lookup"><span data-stu-id="228cd-923">32-bit acknowledgement number</span></span> | <span data-ttu-id="228cd-924">Questo campo contiene il numero di sequenza corrispondente all'ultimo byte ricevuto da questo lato della connessione.</span><span class="sxs-lookup"><span data-stu-id="228cd-924">This field contains the sequence number corresponding to the last byte received by this side of the connection.</span></span> <span data-ttu-id="228cd-925">Viene utilizzato per determinare se i dati inviati in precedenza sono stati ricevuti correttamente dall'altra entità finale della connessione.</span><span class="sxs-lookup"><span data-stu-id="228cd-925">This is used to determine whether or not data previously sent has successfully been received by the other end of the connection.</span></span> |
| <span data-ttu-id="228cd-926">lunghezza intestazione a 4 bit</span><span class="sxs-lookup"><span data-stu-id="228cd-926">4-bit header length</span></span>           | <span data-ttu-id="228cd-927">Questo campo contiene il numero di parole a 32 bit nell'intestazione TCP.</span><span class="sxs-lookup"><span data-stu-id="228cd-927">This field contains the number of 32-bit words in the TCP header.</span></span> <span data-ttu-id="228cd-928">Se nell'intestazione TCP non è presente alcuna opzione, il campo è 5.</span><span class="sxs-lookup"><span data-stu-id="228cd-928">If no options are present in the TCP header, this field is 5.</span></span> |
| <span data-ttu-id="228cd-929">bit di codice a 6 bit</span><span class="sxs-lookup"><span data-stu-id="228cd-929">6-bit code bits</span></span>               | <span data-ttu-id="228cd-930">Questo campo contiene i sei bit di codice diversi usati per indicare le varie informazioni di controllo associate alla connessione.</span><span class="sxs-lookup"><span data-stu-id="228cd-930">This field contains the six different code bits used to indicate various control information associated with the connection.</span></span> <span data-ttu-id="228cd-931">I bit del controllo vengono definiti come segue:</span><span class="sxs-lookup"><span data-stu-id="228cd-931">The control bits are defined as follows:</span></span> |



| <span data-ttu-id="228cd-932">Nome</span><span class="sxs-lookup"><span data-stu-id="228cd-932">Name</span></span> | <span data-ttu-id="228cd-933">bit</span><span class="sxs-lookup"><span data-stu-id="228cd-933">Bit</span></span> | <span data-ttu-id="228cd-934">Significato</span><span class="sxs-lookup"><span data-stu-id="228cd-934">Meaning</span></span>                                                     |
|------|-----|-------------------------------------------------------------|
| <span data-ttu-id="228cd-935">URG</span><span class="sxs-lookup"><span data-stu-id="228cd-935">URG</span></span>  | <span data-ttu-id="228cd-936">21</span><span class="sxs-lookup"><span data-stu-id="228cd-936">21</span></span>  | <span data-ttu-id="228cd-937">Dati urgenti presenti</span><span class="sxs-lookup"><span data-stu-id="228cd-937">Urgent data present</span></span>                                         |
| <span data-ttu-id="228cd-938">ACK</span><span class="sxs-lookup"><span data-stu-id="228cd-938">ACK</span></span>  | <span data-ttu-id="228cd-939">20</span><span class="sxs-lookup"><span data-stu-id="228cd-939">20</span></span>  | <span data-ttu-id="228cd-940">Il numero di riconoscimento è valido</span><span class="sxs-lookup"><span data-stu-id="228cd-940">Acknowledgement number is valid</span></span>                             |
| <span data-ttu-id="228cd-941">PSH</span><span class="sxs-lookup"><span data-stu-id="228cd-941">PSH</span></span>  | <span data-ttu-id="228cd-942">19</span><span class="sxs-lookup"><span data-stu-id="228cd-942">19</span></span>  | <span data-ttu-id="228cd-943">Gestisci immediatamente questi dati</span><span class="sxs-lookup"><span data-stu-id="228cd-943">Handle this data immediately</span></span>                                |
| <span data-ttu-id="228cd-944">RST</span><span class="sxs-lookup"><span data-stu-id="228cd-944">RST</span></span>  | <span data-ttu-id="228cd-945">18</span><span class="sxs-lookup"><span data-stu-id="228cd-945">18</span></span>  | <span data-ttu-id="228cd-946">Reimposta la connessione</span><span class="sxs-lookup"><span data-stu-id="228cd-946">Reset the connection</span></span>                                        |
| <span data-ttu-id="228cd-947">SYN</span><span class="sxs-lookup"><span data-stu-id="228cd-947">SYN</span></span>  | <span data-ttu-id="228cd-948">17</span><span class="sxs-lookup"><span data-stu-id="228cd-948">17</span></span>  | <span data-ttu-id="228cd-949">Sincronizzare i numeri di sequenza (usati per stabilire la connessione)</span><span class="sxs-lookup"><span data-stu-id="228cd-949">Synchronize sequence numbers (used to establish connection)</span></span> |
| <span data-ttu-id="228cd-950">FIN</span><span class="sxs-lookup"><span data-stu-id="228cd-950">FIN</span></span>  | <span data-ttu-id="228cd-951">16</span><span class="sxs-lookup"><span data-stu-id="228cd-951">16</span></span>  | <span data-ttu-id="228cd-952">Il mittente è terminato con la trasmissione (usata per chiudere la connessione)</span><span class="sxs-lookup"><span data-stu-id="228cd-952">Sender is finished with transmit (used to close connection)</span></span> |

<span data-ttu-id="228cd-953">**finestra a 16 bit**</span><span class="sxs-lookup"><span data-stu-id="228cd-953">**16-bit window**</span></span>

<span data-ttu-id="228cd-954">Questo campo viene usato per il controllo di flusso.</span><span class="sxs-lookup"><span data-stu-id="228cd-954">This field is used for flow control.</span></span> <span data-ttu-id="228cd-955">Contiene la quantità di byte che il socket può attualmente ricevere.</span><span class="sxs-lookup"><span data-stu-id="228cd-955">It contains the amount of bytes the socket can currently receive.</span></span> <span data-ttu-id="228cd-956">Questo viene essenzialmente usato per il controllo di flusso.</span><span class="sxs-lookup"><span data-stu-id="228cd-956">This basically is used for flow control.</span></span> <span data-ttu-id="228cd-957">Il mittente è responsabile di assicurarsi che i dati da inviare vengano inseriti nella finestra annunciata del destinatario.</span><span class="sxs-lookup"><span data-stu-id="228cd-957">The sender is responsible for making sure the data to send will fit into the receiver’s advertised window.</span></span>

| <span data-ttu-id="228cd-958">**Campo di intestazione**</span><span class="sxs-lookup"><span data-stu-id="228cd-958">**Header Field**</span></span>          | <span data-ttu-id="228cd-959">**Scopo**</span><span class="sxs-lookup"><span data-stu-id="228cd-959">**Purpose**</span></span> |
| ------------------------- | --- |
| <span data-ttu-id="228cd-960">**checksum TCP a 16 bit**</span><span class="sxs-lookup"><span data-stu-id="228cd-960">**16-bit TCP checksum**</span></span>   | <span data-ttu-id="228cd-961">Questo campo contiene il checksum a 16 bit per il pacchetto, tra cui l'intestazione TCP, l'area dati del pacchetto e l'intestazione pseudo-IP.</span><span class="sxs-lookup"><span data-stu-id="228cd-961">This field contains the 16-bit checksum for the packet including the TCP header, the packet data area, and the pseudo IP header.</span></span>                |
| <span data-ttu-id="228cd-962">**Puntatore urgente a 16 bit**</span><span class="sxs-lookup"><span data-stu-id="228cd-962">**16-bit urgent pointer**</span></span> | <span data-ttu-id="228cd-963">Questo campo contiene l'offset positivo dell'ultimo byte dei dati urgenti.</span><span class="sxs-lookup"><span data-stu-id="228cd-963">This field contains the positive offset of the last byte of the urgent data.</span></span> <span data-ttu-id="228cd-964">Questo campo è valido solo se il bit di codice URG è impostato nell'intestazione.</span><span class="sxs-lookup"><span data-stu-id="228cd-964">This field is only valid if the URG code bit is set in the header.</span></span> |

> [!IMPORTANT]
> <span data-ttu-id="228cd-965">*È previsto che tutte le intestazioni nell'implementazione TCP/IP siano in formato big endian. In questo formato, il byte più significativo della parola risiede nell'indirizzo di byte più basso.*</span><span class="sxs-lookup"><span data-stu-id="228cd-965">*All headers in the TCP/IP implementation are expected to be in big endian format. In this format, the most significant byte of the word resides at the lowest byte address.*</span></span>

### <a name="tcp-enable"></a><span data-ttu-id="228cd-966">Abilitazione TCP</span><span class="sxs-lookup"><span data-stu-id="228cd-966">TCP Enable</span></span>

<span data-ttu-id="228cd-967">Prima che le connessioni TCP e le trasmissioni di pacchetti siano possibili, l'applicazione deve prima abilitare TCP chiamando il servizio nx_tcp_enable.</span><span class="sxs-lookup"><span data-stu-id="228cd-967">Before TCP connections and packet transmissions are possible, the application must first enable TCP by calling the nx_tcp_enable service.</span></span> <span data-ttu-id="228cd-968">Dopo l'abilitazione, l'applicazione è gratuita per accedere a tutti i servizi TCP.</span><span class="sxs-lookup"><span data-stu-id="228cd-968">After enabled, the application is free to access all TCP services.</span></span>

### <a name="tcp-socket-create"></a><span data-ttu-id="228cd-969">Creazione socket TCP</span><span class="sxs-lookup"><span data-stu-id="228cd-969">TCP Socket Create</span></span>

<span data-ttu-id="228cd-970">I socket TCP vengono creati durante l'inizializzazione o durante la fase di esecuzione dai thread dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="228cd-970">TCP sockets are created either during initialization or during runtime by application threads.</span></span> <span data-ttu-id="228cd-971">Il tipo di servizio, la durata (TTL) e le dimensioni della finestra sono definiti dal servizio ***nx_tcp_socket_create*** .</span><span class="sxs-lookup"><span data-stu-id="228cd-971">The initial type of service, time to live, and window size are defined by the ***nx_tcp_socket_create*** service.</span></span> <span data-ttu-id="228cd-972">Non sono previsti limiti per il numero di socket TCP in un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="228cd-972">There are no limits on the number of TCP sockets in an application.</span></span>

### <a name="tcp-checksum"></a><span data-ttu-id="228cd-973">Checksum TCP</span><span class="sxs-lookup"><span data-stu-id="228cd-973">TCP Checksum</span></span>

<span data-ttu-id="228cd-974">TCP specifica un checksum a 16 bit a complemento di uno che copre la pseudo intestazione IP, costituita dall'indirizzo IP di origine, dall'indirizzo IP di destinazione e dalla parola IP di protocollo/lunghezza, l'intestazione TCP e i dati del pacchetto TCP.</span><span class="sxs-lookup"><span data-stu-id="228cd-974">TCP specifies a one’s complement 16-bit checksum that covers the IP pseudo header, (consisting of the source IP address, destination IP address, and the protocol/length IP word), the TCP header, and the TCP packet data.</span></span>

<span data-ttu-id="228cd-975">Alcuni controller di rete sono in grado di eseguire il calcolo e la convalida del checksum TCP nell'hardware.</span><span class="sxs-lookup"><span data-stu-id="228cd-975">Certain network controllers are able to perform TCP checksum computation and validation in hardware.</span></span> <span data-ttu-id="228cd-976">Per tali sistemi, le applicazioni potrebbero voler usare la logica di checksum hardware il più possibile per ridurre il sovraccarico di Runtime.</span><span class="sxs-lookup"><span data-stu-id="228cd-976">For such systems, applications may want to use hardware checksum logic as much as possible to reduce runtime overhead.</span></span> <span data-ttu-id="228cd-977">Le applicazioni possono disabilitare completamente la logica di calcolo del checksum TCP dalla libreria NetX in fase di compilazione definendo **NX_DISABLE_TCP_TX_CHECKSUM** e **NX_DISABLE_TCP_RX_CHECKSUM**.</span><span class="sxs-lookup"><span data-stu-id="228cd-977">Applications may disable TCP checksum computation logic from the NetX library altogether at build time by defining **NX_DISABLE_TCP_TX_CHECKSUM** and **NX_DISABLE_TCP_RX_CHECKSUM**.</span></span> <span data-ttu-id="228cd-978">In questo modo, il codice di checksum TCP non viene compilato in.</span><span class="sxs-lookup"><span data-stu-id="228cd-978">This way, the TCP checksum code is not compiled in.</span></span>

### <a name="tcp-port"></a><span data-ttu-id="228cd-979">Porta TCP</span><span class="sxs-lookup"><span data-stu-id="228cd-979">TCP Port</span></span>

<span data-ttu-id="228cd-980">Una porta TCP è un punto di connessione logico nel protocollo TCP.</span><span class="sxs-lookup"><span data-stu-id="228cd-980">A TCP port is a logical connection point in the TCP protocol.</span></span> <span data-ttu-id="228cd-981">Nel componente TCP di NetX sono presenti 65.535 porte valide, comprese tra 1 e 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="228cd-981">There are 65,535 valid ports in the TCP component of NetX, ranging from 1 through 0xFFFF.</span></span> <span data-ttu-id="228cd-982">Diversamente da UDP, in cui i dati di una porta possono essere inviati a qualsiasi altra porta di destinazione, una porta TCP è connessa a un'altra porta TCP specifica e solo quando viene stabilita la connessione può essere effettuato il trasferimento dei dati, e solo tra le due porte che costituiscono la connessione.</span><span class="sxs-lookup"><span data-stu-id="228cd-982">Unlike UDP in which data from one port can be sent to any other destination port, a TCP port is connected to another specific TCP port, and only when this connection is established can any data transfer take place—and only between the two ports making up the connection.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="228cd-983">*Le porte TCP sono completamente separate dalle porte UDP; ad esempio, la porta UDP numero 1 non ha alcuna relazione con la porta TCP numero 1.*</span><span class="sxs-lookup"><span data-stu-id="228cd-983">*TCP ports are completely separate from UDP ports; e.g., UDP port number 1 has no relation to TCP port number 1.*</span></span>

## <a name="client-server-model"></a><span data-ttu-id="228cd-984">Modello di Client-Server</span><span class="sxs-lookup"><span data-stu-id="228cd-984">Client-Server Model</span></span>

<span data-ttu-id="228cd-985">Per usare TCP per il trasferimento dei dati, è prima necessario stabilire una connessione tra i due socket TCP.</span><span class="sxs-lookup"><span data-stu-id="228cd-985">To use TCP for data transfer, a connection must first be established between the two TCP sockets.</span></span> <span data-ttu-id="228cd-986">La creazione della connessione viene eseguita in modalità client-server.</span><span class="sxs-lookup"><span data-stu-id="228cd-986">The establishment of the connection is done in a client-server fashion.</span></span> <span data-ttu-id="228cd-987">Il lato client della connessione è il lato che avvia la connessione, mentre il lato server è semplicemente in attesa delle richieste di connessione client prima che venga eseguita qualsiasi elaborazione.</span><span class="sxs-lookup"><span data-stu-id="228cd-987">The client side of the connection is the side that initiates the connection, while the server side simply waits for client connection requests before any processing is done.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="228cd-988">*Per i dispositivi multihome, NetX determina automaticamente l'indirizzo di origine da usare per la connessione e l'indirizzo hop successivo in base all'indirizzo IP di destinazione della connessione.*</span><span class="sxs-lookup"><span data-stu-id="228cd-988">*For multihome devices, NetX automatically determines the source address to use for the connection, and the next hop address based on the destination IP address of the connection.*</span></span>

### <a name="tcp-socket-state-machine"></a><span data-ttu-id="228cd-989">Macchina a stati socket TCP</span><span class="sxs-lookup"><span data-stu-id="228cd-989">TCP Socket State Machine</span></span>

<span data-ttu-id="228cd-990">La connessione tra due socket TCP (un client e un server) è complessa e viene gestita in modo analogo a una macchina a Stati.</span><span class="sxs-lookup"><span data-stu-id="228cd-990">The connection between two TCP sockets (one client and one server) is complex and is managed in a state machine manner.</span></span> <span data-ttu-id="228cd-991">Ogni socket TCP viene avviato in uno stato chiuso.</span><span class="sxs-lookup"><span data-stu-id="228cd-991">Each TCP socket starts in a CLOSED state.</span></span> <span data-ttu-id="228cd-992">Tramite gli eventi di connessione viene eseguita la migrazione della macchina a stati di ogni socket nello stato stabilito, ovvero la posizione in cui viene eseguita la maggior parte del trasferimento dei dati in TCP.</span><span class="sxs-lookup"><span data-stu-id="228cd-992">Through connection events each socket's state machine migrates into the ESTABLISHED state, which is where the bulk of the data transfer in TCP takes place.</span></span> <span data-ttu-id="228cd-993">Quando un lato della connessione non desidera più inviare dati, si disconnette.</span><span class="sxs-lookup"><span data-stu-id="228cd-993">When one side of the connection no longer wishes to send data, it disconnects.</span></span> <span data-ttu-id="228cd-994">Dopo la disconnessione dell'altro lato, il socket TCP torna allo stato CLOSED.</span><span class="sxs-lookup"><span data-stu-id="228cd-994">After the other side disconnects, eventually the TCP socket returns to the CLOSED state.</span></span> <span data-ttu-id="228cd-995">Questo processo viene ripetuto ogni volta che un client e un server TCP stabiliscono e chiudono una connessione.</span><span class="sxs-lookup"><span data-stu-id="228cd-995">This process repeats each time a TCP client and server establish and close a connection.</span></span> <span data-ttu-id="228cd-996">La figura 11 Mostra i vari Stati della macchina a stati TCP.</span><span class="sxs-lookup"><span data-stu-id="228cd-996">Figure 11 shows the various states of the TCP state machine.</span></span>

![Stati della macchina a stati TCP](./media/user-guide/states-tcp-state-machine.png)

### <a name="figure-11-states-of-the-tcp-state-machine"></a><span data-ttu-id="228cd-998">FIGURA 11.</span><span class="sxs-lookup"><span data-stu-id="228cd-998">FIGURE 11.</span></span> <span data-ttu-id="228cd-999">Stati della macchina a stati TCP</span><span class="sxs-lookup"><span data-stu-id="228cd-999">States of the TCP State Machine</span></span>

### <a name="tcp-client-connection"></a><span data-ttu-id="228cd-1000">Connessione client TCP</span><span class="sxs-lookup"><span data-stu-id="228cd-1000">TCP Client Connection</span></span>

<span data-ttu-id="228cd-1001">Come indicato in precedenza, il lato client della connessione TCP avvia una richiesta di connessione a un server TCP.</span><span class="sxs-lookup"><span data-stu-id="228cd-1001">As mentioned previously, the client side of the TCP connection initiates a connection request to a TCP server.</span></span> <span data-ttu-id="228cd-1002">Prima di poter effettuare una richiesta di connessione, è necessario abilitare il protocollo TCP nell'istanza IP del client.</span><span class="sxs-lookup"><span data-stu-id="228cd-1002">Before a connection request can be made, TCP must be enabled on the client IP instance.</span></span> <span data-ttu-id="228cd-1003">Inoltre, il socket TCP del client deve essere creato successivamente con il servizio ***nx_tcp_socket_create** _ e associato a una porta tramite il servizio _*_nx_tcp_client_socket_bind_\*_ .</span><span class="sxs-lookup"><span data-stu-id="228cd-1003">In addition, the client TCP socket must next be created with the ***nx_tcp_socket_create** _ service and bound to a port via the _*_nx_tcp_client_socket_bind_\*_ service.</span></span> <span data-ttu-id="228cd-1004">Dopo aver associato il socket client, il servizio _ *_nx_tcp_client_socket_connect_*\* viene usato per stabilire una connessione con un server TCP.</span><span class="sxs-lookup"><span data-stu-id="228cd-1004">After the client socket is bound, the _ *_nx_tcp_client_socket_connect_*\* service is used to establish a connection with a TCP server.</span></span> <span data-ttu-id="228cd-1005">Si noti che il socket deve trovarsi in uno stato chiuso per avviare un tentativo di connessione.</span><span class="sxs-lookup"><span data-stu-id="228cd-1005">Note the socket must be in a CLOSED state to initiate a connection attempt.</span></span> <span data-ttu-id="228cd-1006">Stabilire la connessione inizia con NetX che emette un pacchetto SYN e quindi attende un pacchetto SYN ACK dal server, che indica l'accettazione della richiesta di connessione.</span><span class="sxs-lookup"><span data-stu-id="228cd-1006">Establishing the connection starts with NetX issuing a SYN packet and then waiting for a SYN ACK packet back from the server, which signifies acceptance of the connection request.</span></span> <span data-ttu-id="228cd-1007">Dopo la ricezione dell'ACK SYN, NetX risponde con un pacchetto ACK e promuove lo stato stabilito del socket client.</span><span class="sxs-lookup"><span data-stu-id="228cd-1007">After the SYN ACK is received, NetX responds with an ACK packet and promotes the client socket to the ESTABLISHED state.</span></span>

### <a name="tcp-client-disconnection"></a><span data-ttu-id="228cd-1008">Disconnessione del client TCP</span><span class="sxs-lookup"><span data-stu-id="228cd-1008">TCP Client Disconnection</span></span>

<span data-ttu-id="228cd-1009">La chiusura della connessione viene eseguita chiamando ***nx_tcp_socket_disconnect***.</span><span class="sxs-lookup"><span data-stu-id="228cd-1009">Closing the connection is accomplished by calling ***nx_tcp_socket_disconnect***.</span></span> <span data-ttu-id="228cd-1010">Se non viene specificata alcuna sospensione, il socket client invia un pacchetto RST al socket del server e posiziona il socket nello stato CLOSED.</span><span class="sxs-lookup"><span data-stu-id="228cd-1010">If no suspension is specified, the client socket sends a RST packet to the server socket and places the socket in the CLOSED state.</span></span> <span data-ttu-id="228cd-1011">In caso contrario, se viene richiesta una sospensione, viene eseguito il protocollo di disconnessione TCP completo, come indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="228cd-1011">Otherwise, if a suspension is requested, the full TCP disconnect protocol is performed, as follows:</span></span>

- <span data-ttu-id="228cd-1012">Se il server ha avviato in precedenza una richiesta di disconnessione (il socket client ha già ricevuto un pacchetto FIN, ha risposto con un ACK ed è nello stato di attesa di chiusura), NetX promuove lo stato del socket TCP del client all'ultimo stato ACK e invia un pacchetto FIN.</span><span class="sxs-lookup"><span data-stu-id="228cd-1012">If the server previously initiated a disconnect request (the client socket has already received a FIN packet, responded with an ACK, and is in the CLOSE WAIT state), NetX promotes the client TCP socket state to the LAST ACK state and sends a FIN packet.</span></span> <span data-ttu-id="228cd-1013">Attende quindi un ACK dal server prima di completare la disconnessione e di entrare nello stato CLOSED.</span><span class="sxs-lookup"><span data-stu-id="228cd-1013">It then waits for an ACK from the server before completing the disconnect and entering the CLOSED state.</span></span>

- <span data-ttu-id="228cd-1014">Se invece il client è il primo ad avviare una richiesta di disconnessione (il server non si è disconnesso e il socket si trova ancora nello stato stabilito), NetX Invia un pacchetto FIN per avviare la disconnessione e attende la ricezione di una pinna e di un ACK dal server prima di completare la disconnessione e di collocare il socket in uno stato chiuso.</span><span class="sxs-lookup"><span data-stu-id="228cd-1014">If on the other hand, the client is the first to initiate a disconnect request (the server has not disconnected and the socket is still in the ESTABLISHED state), NetX sends a FIN packet to initiate the disconnect and waits to receive a FIN and an ACK from the server before completing the disconnect and placing the socket in a CLOSED state.</span></span>

<span data-ttu-id="228cd-1015">Se nella coda di trasmissione del socket sono ancora presenti pacchetti, NetX sospende il timeout specificato per consentire la conferma dei pacchetti.</span><span class="sxs-lookup"><span data-stu-id="228cd-1015">If there are still packets on the socket transmit queue, NetX suspends for the specified timeout to allow the packets to be acknowledged.</span></span> <span data-ttu-id="228cd-1016">Se il timeout scade, NetX svuota la coda di trasmissione del socket client.</span><span class="sxs-lookup"><span data-stu-id="228cd-1016">If the timeout expires, NetX empties the transmit queue of the client socket.</span></span>

<span data-ttu-id="228cd-1017">Per disassociare la porta dal socket client, l'applicazione chiama ***nx_tcp_client_socket_unbind***.</span><span class="sxs-lookup"><span data-stu-id="228cd-1017">To unbind the port from the client socket, the application calls ***nx_tcp_client_socket_unbind***.</span></span> <span data-ttu-id="228cd-1018">Il socket deve trovarsi in uno stato chiuso o nel processo di disconnessione (ad esempio, lo stato di attesa programmato) prima che la porta venga rilasciata; in caso contrario, viene restituito un errore.</span><span class="sxs-lookup"><span data-stu-id="228cd-1018">The socket must be in a CLOSED state or in the process of disconnecting (i.e., TIMED WAIT state) before the port is released; otherwise, an error is returned.</span></span>

<span data-ttu-id="228cd-1019">Infine, se l'applicazione non necessita più del socket client, chiama ***nx_tcp_socket_delete*** per eliminare il socket.</span><span class="sxs-lookup"><span data-stu-id="228cd-1019">Finally, if the application no longer needs the client socket, it calls ***nx_tcp_socket_delete*** to delete the socket.</span></span>

### <a name="tcp-server-connection"></a><span data-ttu-id="228cd-1020">Connessione al server TCP</span><span class="sxs-lookup"><span data-stu-id="228cd-1020">TCP Server Connection</span></span>

<span data-ttu-id="228cd-1021">Il lato server di una connessione TCP è passivo; ovvero, il server attende che un client avvii una richiesta di connessione.</span><span class="sxs-lookup"><span data-stu-id="228cd-1021">The server side of a TCP connection is passive; i.e., the server waits for a client to initiate connection request.</span></span> <span data-ttu-id="228cd-1022">Per accettare una connessione client, è prima necessario abilitare TCP sull'istanza IP chiamando il servizio \***nx_tcp_enable** _.</span><span class="sxs-lookup"><span data-stu-id="228cd-1022">To accept a client connection, TCP must first be enabled on the IP instance by calling the service \***nx_tcp_enable** _.</span></span> <span data-ttu-id="228cd-1023">Successivamente, l'applicazione deve creare un socket TCP usando il servizio _ \*_nx_tcp_socket_create_\*\*.</span><span class="sxs-lookup"><span data-stu-id="228cd-1023">Next, the application must create a TCP socket using the _ *_nx_tcp_socket_create_*\* service.</span></span>

<span data-ttu-id="228cd-1024">Il socket del server deve essere configurato anche per l'ascolto delle richieste di connessione.</span><span class="sxs-lookup"><span data-stu-id="228cd-1024">The server socket must also be set up for listening for connection requests.</span></span> <span data-ttu-id="228cd-1025">Questa operazione viene eseguita tramite il servizio ***nx_tcp_server_socket_listen*** .</span><span class="sxs-lookup"><span data-stu-id="228cd-1025">This is achieved by using the ***nx_tcp_server_socket_listen*** service.</span></span> <span data-ttu-id="228cd-1026">Questo servizio posiziona il socket del server nello stato di ascolto e associa la porta del server specificata al socket.</span><span class="sxs-lookup"><span data-stu-id="228cd-1026">This service places the server socket in the LISTEN state and binds the specified server port to the socket.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="228cd-1027">*Per impostare una routine di callback di ascolto del socket, l'applicazione specifica la funzione di callback appropriata per l'argomento tcp_listen_callback del servizio di **nx_tcp_server_socket_listen** . Questa funzione di callback dell'applicazione viene quindi eseguita da NetX ogni volta che viene richiesta una nuova connessione sulla porta del server. L'elaborazione nel callback è sotto il controllo dell'applicazione.*</span><span class="sxs-lookup"><span data-stu-id="228cd-1027">*To set a socket listen callback routine the application specifies the appropriate callback function for the tcp_listen_callback argument of the **nx_tcp_server_socket_listen** service. This application callback function is then executed by NetX whenever a new connection is requested on this server port. The processing in the callback is under application control.*</span></span>

<span data-ttu-id="228cd-1028">Per accettare le richieste di connessione client, l'applicazione chiama il servizio \***nx_tcp_server_socket_accept** _.</span><span class="sxs-lookup"><span data-stu-id="228cd-1028">To accept client connection requests, the application calls the \***nx_tcp_server_socket_accept** _ service.</span></span> <span data-ttu-id="228cd-1029">Il socket del server deve essere in uno stato di attesa o in uno stato SYN ricevuto (ovvero, il server è in stato di ascolto e ha ricevuto un pacchetto SYN da un client che ha richiesto una connessione) per chiamare il servizio Accept.</span><span class="sxs-lookup"><span data-stu-id="228cd-1029">The server socket must either be in a LISTEN state or a SYN RECEIVED state (i.e., the server is in the LISTEN state and has received a SYN packet from a client requesting a connection) to call the accept service.</span></span> <span data-ttu-id="228cd-1030">Uno stato restituito correttamente da _ *_nx_tcp_server_socket_accept_*\* indica che la connessione è stata configurata e che il socket del server si trova nello stato stabilita.</span><span class="sxs-lookup"><span data-stu-id="228cd-1030">A successful return status from _ *_nx_tcp_server_socket_accept_*\* indicates the connection has been set up and the server socket is in the ESTABLISHED state.</span></span>

<span data-ttu-id="228cd-1031">Dopo che il socket del server dispone di una connessione valida, le richieste di connessione client aggiuntive vengono accodate fino alla profondità specificata dal *listen_queue_size*, passate al servizio \***nx_tcp_server_socket_listen** _.</span><span class="sxs-lookup"><span data-stu-id="228cd-1031">After the server socket has a valid connection, additional client connection requests are queued up to the depth specified by the *listen_queue_size*, passed into the \***nx_tcp_server_socket_listen** _ service.</span></span> <span data-ttu-id="228cd-1032">Per elaborare le connessioni successive su una porta del server, l'applicazione deve chiamare _ *_nx_tcp_server_socket_relisten_*\* con un socket disponibile, ovvero un socket in uno stato chiuso.</span><span class="sxs-lookup"><span data-stu-id="228cd-1032">In order to process subsequent connections on a server port, the application must call _ *_nx_tcp_server_socket_relisten_*\* with an available socket (i.e., a socket in a CLOSED state).</span></span> <span data-ttu-id="228cd-1033">Si noti che è possibile usare lo stesso socket del server se la connessione precedente associata al socket è terminata e lo stato del socket è CLOSED.</span><span class="sxs-lookup"><span data-stu-id="228cd-1033">Note that the same server socket could be used if the previous connection associated with the socket is now finished and the socket is in the CLOSED state.</span></span>

### <a name="tcp-server-disconnection"></a><span data-ttu-id="228cd-1034">Disconnessione del server TCP</span><span class="sxs-lookup"><span data-stu-id="228cd-1034">TCP Server Disconnection</span></span>

<span data-ttu-id="228cd-1035">La chiusura della connessione viene eseguita chiamando ***nx_tcp_socket_disconnect***.</span><span class="sxs-lookup"><span data-stu-id="228cd-1035">Closing the connection is accomplished by calling ***nx_tcp_socket_disconnect***.</span></span> <span data-ttu-id="228cd-1036">Se non viene specificata alcuna sospensione, il socket del server invia un pacchetto RST al socket client e posiziona il socket nello stato CLOSED.</span><span class="sxs-lookup"><span data-stu-id="228cd-1036">If no suspension is specified, the server socket sends a RST packet to the client socket and places the socket in the CLOSED state.</span></span> <span data-ttu-id="228cd-1037">In caso contrario, se viene richiesta una sospensione, viene eseguito il protocollo di disconnessione TCP completo, come indicato di seguito: |</span><span class="sxs-lookup"><span data-stu-id="228cd-1037">Otherwise, if a suspension is requested, the full TCP disconnect protocol is performed, as follows: |</span></span>

- <span data-ttu-id="228cd-1038">Se il client ha avviato in precedenza una richiesta di disconnessione (il socket del server ha già ricevuto un pacchetto FIN, ha risposto con un ACK ed è nello stato di attesa di chiusura), NetX promuove lo stato del socket TCP per l'ultimo stato ACK e invia un pacchetto FIN.</span><span class="sxs-lookup"><span data-stu-id="228cd-1038">If the client previously initiated a disconnect request (the server socket has already received a FIN packet, responded with an ACK, and is in the CLOSE WAIT state), NetX promotes the TCP socket state to the LAST ACK state and sends a FIN packet.</span></span> <span data-ttu-id="228cd-1039">Attende quindi un ACK dal client prima di completare la disconnessione e di entrare nello stato CLOSED.</span><span class="sxs-lookup"><span data-stu-id="228cd-1039">It then waits for an ACK from the client before completing the disconnect and entering the CLOSED state.</span></span>

- <span data-ttu-id="228cd-1040">Se invece il server è il primo ad avviare una richiesta di disconnessione (il client non si è disconnesso e il socket si trova ancora nello stato stabilito), NetX Invia un pacchetto FIN per avviare la disconnessione e attende la ricezione di una pinna e di un ACK dal client prima di completare la disconnessione e di collocare il socket in uno stato chiuso.</span><span class="sxs-lookup"><span data-stu-id="228cd-1040">If on the other hand, the server is the first to initiate a disconnect request (the client has not disconnected and the socket is still in the ESTABLISHED state), NetX sends a FIN packet to initiate the disconnect and waits to receive a FIN and an ACK from the client before completing the disconnect and placing the socket in a CLOSED state.</span></span>

<span data-ttu-id="228cd-1041">Se nella coda di trasmissione del socket sono ancora presenti pacchetti, NetX sospende il timeout specificato per consentire la conferma di tali pacchetti.</span><span class="sxs-lookup"><span data-stu-id="228cd-1041">If there are still packets on the socket transmit queue, NetX suspends for the specified timeout to allow those packets to be acknowledged.</span></span> <span data-ttu-id="228cd-1042">Se il timeout scade, NetX Scarica la coda di trasmissione del socket del server.</span><span class="sxs-lookup"><span data-stu-id="228cd-1042">If the timeout expires, NetX flushes the transmit queue of the server socket.</span></span>

<span data-ttu-id="228cd-1043">Una volta completata l'elaborazione della disconnessione e il socket del server si trova nello stato CLOSED, l'applicazione deve chiamare il servizio ***nx_tcp_server_socket_unaccept*** per terminare l'associazione di questo socket con la porta del server.</span><span class="sxs-lookup"><span data-stu-id="228cd-1043">After the disconnect processing is complete and the server socket is in the CLOSED state, the application must call the ***nx_tcp_server_socket_unaccept*** service to end the association of this socket with the server port.</span></span> <span data-ttu-id="228cd-1044">Si noti che questo servizio deve essere chiamato dall'applicazione anche se ***nx_tcp_socket_disconnect*** o \***nx_tcp_server_socket_accept** _ restituisce uno stato di errore.</span><span class="sxs-lookup"><span data-stu-id="228cd-1044">Note this service must be called by the application even if ***nx_tcp_socket_disconnect*** or \***nx_tcp_server_socket_accept** _ return an error status.</span></span> <span data-ttu-id="228cd-1045">Dopo la restituzione di _ \*_nx_tcp_server_socket_unaccept_\*\*, il socket può essere utilizzato come socket client o server o anche eliminato se non è più necessario.</span><span class="sxs-lookup"><span data-stu-id="228cd-1045">After the _ *_nx_tcp_server_socket_unaccept_*\* returns, the socket can be used as a client or server socket, or even deleted if it is no longer needed.</span></span> <span data-ttu-id="228cd-1046">Se si desidera accettare un'altra connessione client sulla stessa porta del server, è necessario chiamare il servizio ***nx_tcp_server_socket_relisten*** su questo socket.</span><span class="sxs-lookup"><span data-stu-id="228cd-1046">If accepting another client connection on the same server port is desired, the ***nx_tcp_server_socket_relisten*** service should be called on this socket.</span></span>

<span data-ttu-id="228cd-1047">Nel segmento di codice seguente viene illustrata la sequenza di chiamate utilizzate da un server TCP tipico:</span><span class="sxs-lookup"><span data-stu-id="228cd-1047">The following code segment illustrates the sequence of calls a typical TCP server uses:</span></span>

```c
/* Set up a previously created TCP socket to listen on port 12 */

nx_tcp_server_socket_listen()

/* Loop to make a (another) connection. */
while(1) {

    /* Wait for a client socket connection request for 100 ticks. */
    nx_tcp_server_socket_accept();

    /* (Send and receive TCP messages with the TCP client) */

    /* Disconnect the server socket. */
    nx_tcp_socket_disconnect();

    /* Remove this server socket from listening on the port. */

    nx_tcp_server_socket_unaccept(&server_socket);

    /* Set up server socket to relisten on the same port for the next
    client. */
    nx_tcp_server_socket_relisten();
}
```

### <a name="mss-validation"></a><span data-ttu-id="228cd-1048">Convalida MSS</span><span class="sxs-lookup"><span data-stu-id="228cd-1048">MSS Validation</span></span>

<span data-ttu-id="228cd-1049">La dimensione massima del segmento (MSS) è la quantità massima di byte che un host TCP può ricevere senza essere frammentato dal livello IP sottostante.</span><span class="sxs-lookup"><span data-stu-id="228cd-1049">The Maximum Segment Size (MSS) is the maximum amount of bytes a TCP host can receive without being fragmented by the underlying IP layer.</span></span> <span data-ttu-id="228cd-1050">Durante la fase di creazione della connessione TCP, entrambe le terminazioni scambiano il proprio valore TCP MSS, in modo che il mittente non invii un segmento di dati TCP maggiore della MSS del destinatario.</span><span class="sxs-lookup"><span data-stu-id="228cd-1050">During TCP connection establishment phase, both ends exchanges its own TCP MSS value, so that the sender does not send a TCP data segment that is larger than the receiver's MSS.</span></span> <span data-ttu-id="228cd-1051">Il modulo NetX TCP convaliderà facoltativamente il valore MSS annunciato del peer prima di stabilire una connessione.</span><span class="sxs-lookup"><span data-stu-id="228cd-1051">NetX TCP module will optionally validate its peer's advertised MSS value before establishing a connection.</span></span> <span data-ttu-id="228cd-1052">Per impostazione predefinita, NetX non Abilita un controllo di questo tipo.</span><span class="sxs-lookup"><span data-stu-id="228cd-1052">By default NetX does not enable such a check.</span></span> <span data-ttu-id="228cd-1053">Le applicazioni che desiderano eseguire la convalida MSS definiranno ***NX_ENABLE_TCP_MSS_CHECKING** _ quando compilano la libreria NETX e il valore minimo verrà definito in _*_NX_TCP_MSS_MINIMUM_\*_.</span><span class="sxs-lookup"><span data-stu-id="228cd-1053">Applications wishing to perform MSS validation shall define ***NX_ENABLE_TCP_MSS_CHECKING** _ when building the NetX library, and the minimum value shall be defined in _*_NX_TCP_MSS_MINIMUM_\*_.</span></span> <span data-ttu-id="228cd-1054">Le connessioni TCP in ingresso con valori MSS inferiori a _ *_NX_TCP_MSS_MINIMUM_*\* verranno eliminate.</span><span class="sxs-lookup"><span data-stu-id="228cd-1054">Incoming TCP connections with MSS values below _ *_NX_TCP_MSS_MINIMUM_*\* are dropped.</span></span>

### <a name="stop-listening-on-a-server-port"></a><span data-ttu-id="228cd-1055">Interrompi ascolto su una porta del server</span><span class="sxs-lookup"><span data-stu-id="228cd-1055">Stop Listening on a Server Port</span></span>

<span data-ttu-id="228cd-1056">Se l'applicazione non desidera più restare in ascolto delle richieste di connessione client su una porta del server specificata in precedenza da una chiamata al servizio \***nx_tcp_server_socket_listen** _, l'applicazione chiama semplicemente il servizio _ \*_nx_tcp_server_socket_unlisten_\*\*.</span><span class="sxs-lookup"><span data-stu-id="228cd-1056">If the application no longer wishes to listen for client connection requests on a server port that was previously specified by a call to the ***nx_tcp_server_socket_listen** _ service, the application simply calls the _ *_nx_tcp_server_socket_unlisten_** service.</span></span> <span data-ttu-id="228cd-1057">Questo servizio posiziona tutti i socket in attesa di una connessione nello stato CLOSED e rilascia tutti i pacchetti di richieste di connessione client in coda.</span><span class="sxs-lookup"><span data-stu-id="228cd-1057">This service places any socket waiting for a connection back in the CLOSED state and releases any queued client connection request packets.</span></span>

### <a name="tcp-window-size"></a><span data-ttu-id="228cd-1058">Dimensioni finestra TCP</span><span class="sxs-lookup"><span data-stu-id="228cd-1058">TCP Window Size</span></span>

<span data-ttu-id="228cd-1059">Durante le fasi di installazione e trasferimento dei dati della connessione, ogni porta segnala la quantità di dati che è in grado di gestire, denominata dimensione della finestra.</span><span class="sxs-lookup"><span data-stu-id="228cd-1059">During both the setup and data transfer phases of the connection, each port reports the amount of data it can handle, which is called its window size.</span></span> <span data-ttu-id="228cd-1060">Quando i dati vengono ricevuti ed elaborati, questa dimensione della finestra viene regolata dinamicamente.</span><span class="sxs-lookup"><span data-stu-id="228cd-1060">As data are received and processed, this window size is adjusted dynamically.</span></span> <span data-ttu-id="228cd-1061">In TCP un mittente può inviare solo una quantità di dati che si inserisce nella finestra del destinatario.</span><span class="sxs-lookup"><span data-stu-id="228cd-1061">In TCP, a sender can only send an amount of data that fits into the receiver's window.</span></span> <span data-ttu-id="228cd-1062">In sostanza, le dimensioni della finestra forniscono il controllo di flusso per il trasferimento dei dati in ogni direzione della connessione.</span><span class="sxs-lookup"><span data-stu-id="228cd-1062">In essence, the window size provides flow control for data transfer in each direction of the connection.</span></span>

### <a name="tcp-packet-send"></a><span data-ttu-id="228cd-1063">Invio di pacchetti TCP</span><span class="sxs-lookup"><span data-stu-id="228cd-1063">TCP Packet Send</span></span>

<span data-ttu-id="228cd-1064">L'invio di dati TCP viene eseguito facilmente chiamando la funzione ***nx_tcp_socket_send*** .</span><span class="sxs-lookup"><span data-stu-id="228cd-1064">Sending TCP data is easily accomplished by calling the ***nx_tcp_socket_send*** function.</span></span> <span data-ttu-id="228cd-1065">Se le dimensioni dei dati trasmessi sono maggiori del valore MSS del socket o della dimensione della finestra di ricezione peer corrente, a seconda del valore più piccolo, la logica interna TCP suddivide i dati che rientrano in min (MSS, finestra di ricezione peer) per la trasmissione.</span><span class="sxs-lookup"><span data-stu-id="228cd-1065">If the size of the data being transmitted is larger than the MSS value of the socket or the current peer receive window size, whichever is smaller, TCP internal logic carves off the data that fits into min (MSS, peer receive Window) for transmission.</span></span> <span data-ttu-id="228cd-1066">Questo servizio compila quindi un'intestazione TCP davanti al pacchetto (incluso il calcolo del checksum).</span><span class="sxs-lookup"><span data-stu-id="228cd-1066">This service then builds a TCP header in front of the packet (including the checksum calculation).</span></span> <span data-ttu-id="228cd-1067">Se le dimensioni della finestra del ricevitore non sono pari a zero, il chiamante invierà il maggior numero di dati possibile per riempire le dimensioni della finestra del ricevitore.</span><span class="sxs-lookup"><span data-stu-id="228cd-1067">If the receiver's window size is not zero, the caller will send as much data as it can to fill up the receiver window size.</span></span> <span data-ttu-id="228cd-1068">Se la finestra di ricezione diventa zero, il chiamante potrebbe sospendere e attendere che le dimensioni della finestra del destinatario aumentino sufficiente per l'invio del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="228cd-1068">If the receive window becomes zero, the caller may suspend and wait for the receiver's window size to increase enough for this packet to be sent.</span></span> <span data-ttu-id="228cd-1069">In qualsiasi momento, più thread possono sospendere durante il tentativo di invio di dati tramite lo stesso socket.</span><span class="sxs-lookup"><span data-stu-id="228cd-1069">At any given time, multiple threads may suspend while trying to send data through the same socket.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="228cd-1070">*I dati TCP che risiedono nella struttura di NX_PACKET devono trovarsi su un limite di parole lunghe. Inoltre, è necessario disporre di spazio sufficiente tra il puntatore anteposto e il puntatore di avvio dati per inserire le intestazioni TCP, IP e supporti fisici.*</span><span class="sxs-lookup"><span data-stu-id="228cd-1070">*The TCP data residing in the NX_PACKET structure should reside on a long-word boundary. In addition, there needs to be sufficient space between the prepend pointer and the data start pointer to place the TCP, IP, and physical media headers.*</span></span>

### <a name="tcp-packet-retransmit"></a><span data-ttu-id="228cd-1071">Ritrasmissione del pacchetto TCP</span><span class="sxs-lookup"><span data-stu-id="228cd-1071">TCP Packet Retransmit</span></span>

<span data-ttu-id="228cd-1072">I pacchetti TCP trasmessi in precedenza venivano effettivamente archiviati internamente fino a quando non viene restituito un ACK dall'altro lato della connessione.</span><span class="sxs-lookup"><span data-stu-id="228cd-1072">Previously transmitted TCP packets sent actually stored internally until an ACK is returned from the other side of the connection.</span></span> <span data-ttu-id="228cd-1073">Se i dati trasmessi non vengono riconosciuti entro il periodo di timeout, il pacchetto archiviato viene inviato nuovamente e viene impostato il periodo di timeout successivo.</span><span class="sxs-lookup"><span data-stu-id="228cd-1073">If transmitted data is not acknowledged within the timeout period, the stored packet is re-sent and the next timeout period is set.</span></span> <span data-ttu-id="228cd-1074">Quando viene ricevuto un ACK, vengono infine rilasciati tutti i pacchetti analizzati dal numero di riconoscimento nella coda di trasmissione interna.</span><span class="sxs-lookup"><span data-stu-id="228cd-1074">When an ACK is received, all packets covered by the acknowledgement number in the internal transmit queue are finally released.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="228cd-1075">\* L'applicazione non deve riutilizzare il pacchetto o modificare il contenuto del pacchetto dopo che la funzione \***nx_tcp_socket_send** _ restituisce con NX_SUCCESS.</span><span class="sxs-lookup"><span data-stu-id="228cd-1075">\*Application shall not reuse the packet or alter the contents of the packet after the \***nx_tcp_socket_send** _ function returns with NX_SUCCESS.</span></span> <span data-ttu-id="228cd-1076">Il pacchetto trasmesso viene infine rilasciato dall'elaborazione interna NetX dopo che i dati sono stati riconosciuti dagli altri end._</span><span class="sxs-lookup"><span data-stu-id="228cd-1076">The transmitted packet is eventually released by NetX internal processing after the data is acknowledged by the other end._</span></span>

### <a name="tcp-keepalive"></a><span data-ttu-id="228cd-1077">Keepalive TCP</span><span class="sxs-lookup"><span data-stu-id="228cd-1077">TCP Keepalive</span></span>

<span data-ttu-id="228cd-1078">La funzionalità TCP keepalive consente a un socket di rilevare se il peer si disconnette o meno senza terminazione corretta, ad esempio se il peer si è arrestato in modo anomalo, oppure per impedire a determinate funzionalità di monitoraggio della rete di terminare una connessione per lunghi periodi di inattività.</span><span class="sxs-lookup"><span data-stu-id="228cd-1078">TCP Keepalive feature allows a socket to detect whether or not its peer disconnects without proper termination (for example, the peer crashed), or to prevent certain network monitoring facilities to terminate a connection for long periods of idle.</span></span> <span data-ttu-id="228cd-1079">Il protocollo keepalive TCP funziona inviando periodicamente un frame TCP senza dati e il numero di sequenza impostato su uno inferiore al numero di sequenza corrente.</span><span class="sxs-lookup"><span data-stu-id="228cd-1079">TCP Keepalive works by periodically sending a TCP frame with no data, and the sequence number set to one less than the current sequence number.</span></span> <span data-ttu-id="228cd-1080">Alla ricezione di tale frame TCP keepalive, il destinatario, se ancora attivo, risponde con un ACK per il numero di sequenza corrente.</span><span class="sxs-lookup"><span data-stu-id="228cd-1080">On receiving such TCP Keepalive frame, the recipient, if still alive, responses with an ACK for its current sequence number.</span></span> <span data-ttu-id="228cd-1081">Questa operazione completa la transazione KeepAlive.</span><span class="sxs-lookup"><span data-stu-id="228cd-1081">This completes the keepalive transaction.</span></span>

<span data-ttu-id="228cd-1082">Per impostazione predefinita, la funzionalità KeepAlive non è abilitata.</span><span class="sxs-lookup"><span data-stu-id="228cd-1082">By default the keepalive feature is not enabled.</span></span> <span data-ttu-id="228cd-1083">Per usare questa funzionalità, è necessario compilare la libreria NetX con \***NX_ENABLE_TCP_KEEPALIVE** _ defined.</span><span class="sxs-lookup"><span data-stu-id="228cd-1083">To use this feature, NetX library must be built with \***NX_ENABLE_TCP_KEEPALIVE** _ defined.</span></span> <span data-ttu-id="228cd-1084">Il simbolo _ *_NX_TCP_KEEPALIVE_INITIAL_*\* specifica il numero di secondi di inattività prima dell'avvio del frame KeepAlive.</span><span class="sxs-lookup"><span data-stu-id="228cd-1084">The symbol _ *_NX_TCP_KEEPALIVE_INITIAL_*\* specifies the number of seconds of inactivity before the keepalive frame is initiated.</span></span>

### <a name="tcp-packet-receive"></a><span data-ttu-id="228cd-1085">Ricezione di pacchetti TCP</span><span class="sxs-lookup"><span data-stu-id="228cd-1085">TCP Packet Receive</span></span>

<span data-ttu-id="228cd-1086">L'elaborazione dei pacchetti di ricezione TCP (chiamata dal thread helper IP) è responsabile della gestione di varie azioni di connessione e disconnessione, oltre che dell'elaborazione di riconoscimento della trasmissione.</span><span class="sxs-lookup"><span data-stu-id="228cd-1086">The TCP receive packet processing (called from the IP helper thread) is responsible for handling various connection and disconnection actions as well as transmit acknowledge processing.</span></span> <span data-ttu-id="228cd-1087">Inoltre, l'elaborazione dei pacchetti TCP receive è responsabile dell'inserimento dei pacchetti con i dati di ricezione nella coda di ricezione del socket TCP appropriato o del recapito del pacchetto al primo thread sospeso in attesa di un pacchetto.</span><span class="sxs-lookup"><span data-stu-id="228cd-1087">In addition, the TCP receive packet processing is responsible for placing packets with receive data on the appropriate TCP socket's receive queue or delivering the packet to the first suspended thread waiting for a packet.</span></span>

### <a name="tcp-receive-notify"></a><span data-ttu-id="228cd-1088">Notifica di ricezione TCP</span><span class="sxs-lookup"><span data-stu-id="228cd-1088">TCP Receive Notify</span></span>

<span data-ttu-id="228cd-1089">Se il thread dell'applicazione deve elaborare i dati ricevuti da più di un socket, è necessario usare la funzione ***nx_tcp_socket_receive_notify*** .</span><span class="sxs-lookup"><span data-stu-id="228cd-1089">If the application thread needs to process received data from more than one socket, the ***nx_tcp_socket_receive_notify*** function should be used.</span></span> <span data-ttu-id="228cd-1090">Questa funzione registra una funzione di callback del pacchetto di ricezione per il socket.</span><span class="sxs-lookup"><span data-stu-id="228cd-1090">This function registers a receive packet callback function for the socket.</span></span> <span data-ttu-id="228cd-1091">Ogni volta che viene ricevuto un pacchetto nel socket, viene eseguita la funzione di callback.</span><span class="sxs-lookup"><span data-stu-id="228cd-1091">Whenever a packet is received on the socket, the callback function is executed.</span></span>

<span data-ttu-id="228cd-1092">Il contenuto della funzione di callback è specifico dell'applicazione. Tuttavia, la funzione conterrebbe probabilmente la logica per informare il thread di elaborazione che un pacchetto è disponibile nel socket corrispondente.</span><span class="sxs-lookup"><span data-stu-id="228cd-1092">The contents of the callback function are application-specific; however, the function would most likely contain logic to inform the processing thread that a packet is available on the corresponding socket.</span></span>

### <a name="thread-suspension"></a><span data-ttu-id="228cd-1093">Sospensione thread</span><span class="sxs-lookup"><span data-stu-id="228cd-1093">Thread Suspension</span></span>

<span data-ttu-id="228cd-1094">Come indicato in precedenza, i thread dell'applicazione possono sospendere il tentativo di ricevere dati da una determinata porta TCP.</span><span class="sxs-lookup"><span data-stu-id="228cd-1094">As mentioned previously, application threads can suspend while attempting to receive data from a particular TCP port.</span></span> <span data-ttu-id="228cd-1095">Dopo la ricezione di un pacchetto su tale porta, questo viene assegnato al primo thread sospeso e il thread viene quindi ripreso.</span><span class="sxs-lookup"><span data-stu-id="228cd-1095">After a packet is received on that port, it is given to the first thread suspended and that thread is then resumed.</span></span> <span data-ttu-id="228cd-1096">Un timeout facoltativo è disponibile quando si sospende un pacchetto di ricezione TCP, una funzionalità disponibile per la maggior parte dei servizi NetX.</span><span class="sxs-lookup"><span data-stu-id="228cd-1096">An optional timeout is available when suspending on a TCP receive packet, a feature available for most NetX services.</span></span>

<span data-ttu-id="228cd-1097">La sospensione dei thread è disponibile anche per la connessione (client e server), l'associazione client e i servizi di disconnessione.</span><span class="sxs-lookup"><span data-stu-id="228cd-1097">Thread suspension is also available for connection (both client and server), client binding, and disconnection services.</span></span>

### <a name="tcp-socket-statistics-and-errors"></a><span data-ttu-id="228cd-1098">Statistiche ed errori del socket TCP</span><span class="sxs-lookup"><span data-stu-id="228cd-1098">TCP Socket Statistics and Errors</span></span>

<span data-ttu-id="228cd-1099">Se abilitata, il software socket TCP NetX tiene traccia di diverse statistiche ed errori che possono essere utili per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="228cd-1099">If enabled, the NetX TCP socket software keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="228cd-1100">Per ogni istanza IP/TCP vengono mantenute le statistiche e i report degli errori seguenti:</span><span class="sxs-lookup"><span data-stu-id="228cd-1100">The following statistics and error reports are maintained for each IP/TCP instance:</span></span>

- <span data-ttu-id="228cd-1101">Totale pacchetti TCP inviati</span><span class="sxs-lookup"><span data-stu-id="228cd-1101">Total TCP Packets Sent</span></span>
- <span data-ttu-id="228cd-1102">Totale byte TCP inviati</span><span class="sxs-lookup"><span data-stu-id="228cd-1102">Total TCP Bytes Sent</span></span>
- <span data-ttu-id="228cd-1103">Totale pacchetti TCP ricevuti</span><span class="sxs-lookup"><span data-stu-id="228cd-1103">Total TCP Packets Received</span></span>
- <span data-ttu-id="228cd-1104">Totale byte TCP ricevuti</span><span class="sxs-lookup"><span data-stu-id="228cd-1104">Total TCP Bytes Received</span></span>
- <span data-ttu-id="228cd-1105">Totale pacchetti TCP non validi</span><span class="sxs-lookup"><span data-stu-id="228cd-1105">Total TCP Invalid Packets</span></span>
- <span data-ttu-id="228cd-1106">Totale pacchetti di ricezione TCP eliminati</span><span class="sxs-lookup"><span data-stu-id="228cd-1106">Total TCP Receive Packets Dropped</span></span>
- <span data-ttu-id="228cd-1107">Totale errori di checksum di ricezione TCP</span><span class="sxs-lookup"><span data-stu-id="228cd-1107">Total TCP Receive Checksum Errors</span></span>
- <span data-ttu-id="228cd-1108">Totale connessioni TCP</span><span class="sxs-lookup"><span data-stu-id="228cd-1108">Total TCP Connections</span></span>
- <span data-ttu-id="228cd-1109">Totale disconnessioni TCP</span><span class="sxs-lookup"><span data-stu-id="228cd-1109">Total TCP Disconnections</span></span>
- <span data-ttu-id="228cd-1110">Totale connessioni TCP eliminate</span><span class="sxs-lookup"><span data-stu-id="228cd-1110">Total TCP Connections Dropped</span></span>
- <span data-ttu-id="228cd-1111">Totale ritrasmissioni dei pacchetti TCP</span><span class="sxs-lookup"><span data-stu-id="228cd-1111">Total TCP Packet Retransmits</span></span>
- <span data-ttu-id="228cd-1112">Pacchetti socket TCP inviati</span><span class="sxs-lookup"><span data-stu-id="228cd-1112">TCP Socket Packets Sent</span></span>
- <span data-ttu-id="228cd-1113">Byte socket TCP inviati</span><span class="sxs-lookup"><span data-stu-id="228cd-1113">TCP Socket Bytes Sent</span></span>
- <span data-ttu-id="228cd-1114">Pacchetti socket TCP ricevuti</span><span class="sxs-lookup"><span data-stu-id="228cd-1114">TCP Socket Packets Received</span></span>
- <span data-ttu-id="228cd-1115">Byte socket TCP ricevuti</span><span class="sxs-lookup"><span data-stu-id="228cd-1115">TCP Socket Bytes Received</span></span>
- <span data-ttu-id="228cd-1116">Ritrasmette i pacchetti socket TCP</span><span class="sxs-lookup"><span data-stu-id="228cd-1116">TCP Socket Packet Retransmits</span></span>
- <span data-ttu-id="228cd-1117">Pacchetti socket TCP in coda</span><span class="sxs-lookup"><span data-stu-id="228cd-1117">TCP Socket Packets Queued</span></span>
- <span data-ttu-id="228cd-1118">Errori di checksum del socket TCP</span><span class="sxs-lookup"><span data-stu-id="228cd-1118">TCP Socket Checksum Errors</span></span>
- <span data-ttu-id="228cd-1119">Stato socket TCP</span><span class="sxs-lookup"><span data-stu-id="228cd-1119">TCP Socket State</span></span>
- <span data-ttu-id="228cd-1120">Profondità coda di trasmissione socket TCP</span><span class="sxs-lookup"><span data-stu-id="228cd-1120">TCP Socket Transmit Queue Depth</span></span>
- <span data-ttu-id="228cd-1121">Dimensioni finestra di trasmissione socket TCP</span><span class="sxs-lookup"><span data-stu-id="228cd-1121">TCP Socket Transmit Window Size</span></span>
- <span data-ttu-id="228cd-1122">Dimensioni della finestra di ricezione socket TCP</span><span class="sxs-lookup"><span data-stu-id="228cd-1122">TCP Socket Receive Window Size</span></span>

<span data-ttu-id="228cd-1123">Tutte le statistiche e i report degli errori sono disponibili per l'applicazione con il servizio ***nx_tcp_info_get** _ per le statistiche TCP totali e il servizio _ *_nx_tcp_socket_info_get_** per le statistiche TCP per socket.</span><span class="sxs-lookup"><span data-stu-id="228cd-1123">All these statistics and error reports are available to the application with the ***nx_tcp_info_get** _ service for total TCP statistics and the _ *_nx_tcp_socket_info_get_** service for TCP statistics per socket.</span></span>

## <a name="tcp-socket-control-block-nx_tcp_socket"></a><span data-ttu-id="228cd-1124">NX_TCP_SOCKET blocco di controllo socket TCP</span><span class="sxs-lookup"><span data-stu-id="228cd-1124">TCP Socket Control Block NX_TCP_SOCKET</span></span>

<span data-ttu-id="228cd-1125">Le caratteristiche di ogni socket TCP si trovano nel blocco di controllo *NX_TCP_SOCKET* associato, che contiene informazioni utili, ad esempio il collegamento alla struttura dei dati IP, l'interfaccia di connessione di rete, la porta associata e la coda dei pacchetti di ricezione.</span><span class="sxs-lookup"><span data-stu-id="228cd-1125">The characteristics of each TCP socket are found in the associated *NX_TCP_SOCKET* control block, which contains useful information such as the link to the IP data structure, the network connection interface, the bound port, and the receive packet queue.</span></span> <span data-ttu-id="228cd-1126">Questa struttura viene definita nel file ***nx_api. h*** .</span><span class="sxs-lookup"><span data-stu-id="228cd-1126">This structure is defined in the ***nx_api.h*** file.</span></span>
