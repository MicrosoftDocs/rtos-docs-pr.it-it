---
title: Capitolo 1-Introduzione al server DHCP NetX di Azure RTO
description: L'applicazione stabilisce la comunicazione con il server DHCP NetX di Azure RTO per richiedere e ottenere dinamicamente un indirizzo IP.
author: philmea
ms.author: philmea
ms.date: 06/04/2020
ms.topic: article
ms.service: rtos
ms.openlocfilehash: 17438a20ad3da64c88c3d6bb19a4887c2c6e354e
ms.sourcegitcommit: e3d42e1f2920ec9cb002634b542bc20754f9544e
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/22/2021
ms.locfileid: "104822697"
---
# <a name="chapter-1---introduction-to-azure-rtos-netx-dhcp-server"></a><span data-ttu-id="f25e1-103">Capitolo 1-Introduzione al server DHCP NetX di Azure RTO</span><span class="sxs-lookup"><span data-stu-id="f25e1-103">Chapter 1 - Introduction to Azure RTOS NetX DHCP Server</span></span>

<span data-ttu-id="f25e1-104">In NetX, l'indirizzo IP dell'applicazione è uno dei parametri specificati per la chiamata al servizio *nx_ip_create* .</span><span class="sxs-lookup"><span data-stu-id="f25e1-104">In NetX, the application's IP address is one of the supplied parameters to the *nx_ip_create* service call.</span></span> <span data-ttu-id="f25e1-105">La fornitura dell'indirizzo IP non costituisce un problema se l'indirizzo IP è noto all'applicazione, in modo statico o tramite la configurazione dell'utente.</span><span class="sxs-lookup"><span data-stu-id="f25e1-105">Supplying the IP address poses no problem if the IP address is known to the application, either statically or through user configuration.</span></span> <span data-ttu-id="f25e1-106">Tuttavia, esistono alcuni casi in cui l'applicazione non è in grado di conoscere il proprio indirizzo IP.</span><span class="sxs-lookup"><span data-stu-id="f25e1-106">However, there are some instances where the application doesn't know or care what its IP address is.</span></span> <span data-ttu-id="f25e1-107">In tali situazioni, è necessario specificare un indirizzo IP zero per la funzione *nx_ip_create* e l'applicazione stabilisce la comunicazione con il server DHCP NETX di Azure RTO per richiedere e ottenere dinamicamente un indirizzo IP.</span><span class="sxs-lookup"><span data-stu-id="f25e1-107">In such situations, a zero IP address should be supplied to the *nx_ip_create* function and the application establishes communication with its Azure RTOS NetX DHCP server to dynamically request and obtain an IP address.</span></span>

## <a name="dynamic-ip-address-assignment"></a><span data-ttu-id="f25e1-108">Assegnazione di indirizzi IP dinamici</span><span class="sxs-lookup"><span data-stu-id="f25e1-108">Dynamic IP Address Assignment</span></span>

<span data-ttu-id="f25e1-109">Il servizio di base usato per ottenere un indirizzo IP dinamico dalla rete è il protocollo RARP (Reverse Address Resolution Protocol).</span><span class="sxs-lookup"><span data-stu-id="f25e1-109">The basic service used to obtain a dynamic IP address from the network is the Reverse Address Resolution Protocol (RARP).</span></span> <span data-ttu-id="f25e1-110">Questo protocollo è simile a ARP, ad eccezione del fatto che è stato progettato per ottenere un indirizzo IP per se stesso anziché per trovare l'indirizzo MAC per un altro nodo di rete.</span><span class="sxs-lookup"><span data-stu-id="f25e1-110">This protocol is similar to ARP, except it is designed to obtain an IP address for itself instead of finding the MAC address for another network node.</span></span> <span data-ttu-id="f25e1-111">Il messaggio RARP di basso livello viene trasmesso sulla rete locale ed è responsabilità di un server nella rete rispondere con una risposta RARP, che contiene un indirizzo IP allocato dinamicamente.</span><span class="sxs-lookup"><span data-stu-id="f25e1-111">The low-level RARP message is broadcast on the local network and it is the responsibility of a server on the network to respond with an RARP response, which contains a dynamically allocated IP address.</span></span>

<span data-ttu-id="f25e1-112">Sebbene RARP fornisca un servizio per l'allocazione dinamica di indirizzi IP, presenta diversi difetti.</span><span class="sxs-lookup"><span data-stu-id="f25e1-112">Although RARP provides a service for dynamic allocation of IP addresses, it has several shortcomings.</span></span> <span data-ttu-id="f25e1-113">Il difetto più evidente è che il RARP fornisce solo l'allocazione dinamica dell'indirizzo IP.</span><span class="sxs-lookup"><span data-stu-id="f25e1-113">The most glaring deficiency is that RARP only provides dynamic allocation of the IP address.</span></span> <span data-ttu-id="f25e1-114">Nella maggior parte dei casi, è necessario disporre di altre informazioni per consentire a un dispositivo di partecipare correttamente a una rete.</span><span class="sxs-lookup"><span data-stu-id="f25e1-114">In most situations, more information is necessary in order for a device to properly participate on a network.</span></span> <span data-ttu-id="f25e1-115">Oltre a un indirizzo IP, per la maggior parte dei dispositivi sono necessari il network mask e l'indirizzo IP del gateway.</span><span class="sxs-lookup"><span data-stu-id="f25e1-115">In addition to an IP address, most devices need the network mask and the gateway IP address.</span></span> <span data-ttu-id="f25e1-116">Potrebbe essere necessario anche l'indirizzo IP di un server DNS e altre informazioni sulla rete.</span><span class="sxs-lookup"><span data-stu-id="f25e1-116">The IP address of a DNS server and other network information may also be needed.</span></span> <span data-ttu-id="f25e1-117">RARP non è in grado di fornire queste informazioni.</span><span class="sxs-lookup"><span data-stu-id="f25e1-117">RARP does not have the ability to provide this information.</span></span>

## <a name="rarp-alternatives"></a><span data-ttu-id="f25e1-118">Alternative RARP</span><span class="sxs-lookup"><span data-stu-id="f25e1-118">RARP Alternatives</span></span>

<span data-ttu-id="f25e1-119">Per ovviare alle carenze di RARP, i ricercatori hanno sviluppato un meccanismo di allocazione indirizzi IP più completo denominato BOOTP (Bootstrap Protocol).</span><span class="sxs-lookup"><span data-stu-id="f25e1-119">In order to overcome the deficiencies of RARP, researchers developed a more comprehensive IP address allocation mechanism called the Bootstrap Protocol (BOOTP).</span></span> <span data-ttu-id="f25e1-120">Questo protocollo è in grado di allocare dinamicamente un indirizzo IP e di fornire altre informazioni importanti sulla rete.</span><span class="sxs-lookup"><span data-stu-id="f25e1-120">This protocol has the ability to dynamically allocate an IP address and also provide additional important network information.</span></span> <span data-ttu-id="f25e1-121">Tuttavia, BOOTP presenta lo svantaggio di essere progettato per le configurazioni di rete statiche.</span><span class="sxs-lookup"><span data-stu-id="f25e1-121">However, BOOTP has the drawback of being designed for static network configurations.</span></span> <span data-ttu-id="f25e1-122">Non consente l'assegnazione di indirizzi rapidi o automatici.</span><span class="sxs-lookup"><span data-stu-id="f25e1-122">It does not allow for quick or automated address assignment.</span></span>

<span data-ttu-id="f25e1-123">Questo è il punto in cui il Dynamic Host Configuration Protocol (DHCP) è estremamente utile.</span><span class="sxs-lookup"><span data-stu-id="f25e1-123">This is where the Dynamic Host Configuration Protocol (DHCP) is extremely useful.</span></span> <span data-ttu-id="f25e1-124">DHCP è progettato per estendere le funzionalità di base di BOOTP per includere l'allocazione del server IP completamente automatizzata e l'allocazione di indirizzi IP completamente dinamica tramite il "leasing" di un indirizzo IP a un client per un periodo di tempo specificato.</span><span class="sxs-lookup"><span data-stu-id="f25e1-124">DHCP is designed to extend the basic functionality of BOOTP to include completely automated IP server allocation and completely dynamic IP address allocation through "leasing" an IP address to a client for a specified period of time.</span></span> <span data-ttu-id="f25e1-125">DHCP può inoltre essere configurato in modo da allocare gli indirizzi IP in modo statico, ad esempio BOOTP.</span><span class="sxs-lookup"><span data-stu-id="f25e1-125">DHCP can also be configured to allocate IP addresses in a static manner like BOOTP.</span></span>

## <a name="dhcp-messages"></a><span data-ttu-id="f25e1-126">Messaggi DHCP</span><span class="sxs-lookup"><span data-stu-id="f25e1-126">DHCP Messages</span></span>

<span data-ttu-id="f25e1-127">Sebbene DHCP migliori significativamente la funzionalità di BOOTP, DHCP usa lo stesso formato di messaggio BOOTP e supporta le stesse opzioni del fornitore di BOOTP.</span><span class="sxs-lookup"><span data-stu-id="f25e1-127">Although DHCP greatly enhances the functionality of BOOTP, DHCP uses the same message format as BOOTP and supports the same vendor options as BOOTP.</span></span> <span data-ttu-id="f25e1-128">Per eseguire la funzione, DHCP introduce sette nuove opzioni specifiche di DHCP, come indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="f25e1-128">In order to perform its function, DHCP introduces seven new DHCP-specific options, as follows:</span></span>

| <span data-ttu-id="f25e1-129">Opzione</span><span class="sxs-lookup"><span data-stu-id="f25e1-129">Option</span></span>     | <span data-ttu-id="f25e1-130">Valore</span><span class="sxs-lookup"><span data-stu-id="f25e1-130">Value</span></span> | <span data-ttu-id="f25e1-131">Origine</span><span class="sxs-lookup"><span data-stu-id="f25e1-131">Origin</span></span>                |
| ---------- | ----- | --------------------- |
| <span data-ttu-id="f25e1-132">INDIVIDUARE</span><span class="sxs-lookup"><span data-stu-id="f25e1-132">DISCOVER</span></span>   | <span data-ttu-id="f25e1-133">(1)</span><span class="sxs-lookup"><span data-stu-id="f25e1-133">(1)</span></span>   | <span data-ttu-id="f25e1-134">(inviato dal client DHCP)</span><span class="sxs-lookup"><span data-stu-id="f25e1-134">(sent by DHCP Client)</span></span> |
| <span data-ttu-id="f25e1-135">OFFERTA</span><span class="sxs-lookup"><span data-stu-id="f25e1-135">OFFER</span></span>      | <span data-ttu-id="f25e1-136">(2)</span><span class="sxs-lookup"><span data-stu-id="f25e1-136">(2)</span></span>   | <span data-ttu-id="f25e1-137">(inviato dal server DHCP)</span><span class="sxs-lookup"><span data-stu-id="f25e1-137">(sent by DHCP Server)</span></span> |
| <span data-ttu-id="f25e1-138">RICHIESTA</span><span class="sxs-lookup"><span data-stu-id="f25e1-138">REQUEST</span></span>    | <span data-ttu-id="f25e1-139">(3)</span><span class="sxs-lookup"><span data-stu-id="f25e1-139">(3)</span></span>   | <span data-ttu-id="f25e1-140">(inviato dal client DHCP)</span><span class="sxs-lookup"><span data-stu-id="f25e1-140">(sent by DHCP Client)</span></span> |
| <span data-ttu-id="f25e1-141">DECLINO</span><span class="sxs-lookup"><span data-stu-id="f25e1-141">DECLINE</span></span>    | <span data-ttu-id="f25e1-142">(4)</span><span class="sxs-lookup"><span data-stu-id="f25e1-142">(4)</span></span>   | <span data-ttu-id="f25e1-143">(inviato dal client DHCP)</span><span class="sxs-lookup"><span data-stu-id="f25e1-143">(sent by DHCP Client)</span></span> |
| <span data-ttu-id="f25e1-144">ACK</span><span class="sxs-lookup"><span data-stu-id="f25e1-144">ACK</span></span>        | <span data-ttu-id="f25e1-145">(5)</span><span class="sxs-lookup"><span data-stu-id="f25e1-145">(5)</span></span>   | <span data-ttu-id="f25e1-146">(inviato dal server DHCP)</span><span class="sxs-lookup"><span data-stu-id="f25e1-146">(sent by DHCP Server)</span></span> |
| <span data-ttu-id="f25e1-147">NACK</span><span class="sxs-lookup"><span data-stu-id="f25e1-147">NACK</span></span>       | <span data-ttu-id="f25e1-148"> (6)</span><span class="sxs-lookup"><span data-stu-id="f25e1-148">(6)</span></span>   | <span data-ttu-id="f25e1-149">(inviato dal server DHCP)</span><span class="sxs-lookup"><span data-stu-id="f25e1-149">(sent by DHCP Server)</span></span> |
| <span data-ttu-id="f25e1-150">RELEASE</span><span class="sxs-lookup"><span data-stu-id="f25e1-150">RELEASE</span></span>    | <span data-ttu-id="f25e1-151">(7)</span><span class="sxs-lookup"><span data-stu-id="f25e1-151">(7)</span></span>   | <span data-ttu-id="f25e1-152">(inviato dal client DHCP)</span><span class="sxs-lookup"><span data-stu-id="f25e1-152">(sent by DHCP Client)</span></span> |
| <span data-ttu-id="f25e1-153">INFORMARE</span><span class="sxs-lookup"><span data-stu-id="f25e1-153">INFORM</span></span>     | <span data-ttu-id="f25e1-154">(8)</span><span class="sxs-lookup"><span data-stu-id="f25e1-154">(8)</span></span>   | <span data-ttu-id="f25e1-155">(inviato dal client DHCP)</span><span class="sxs-lookup"><span data-stu-id="f25e1-155">(sent by DHCP Client)</span></span> |
| <span data-ttu-id="f25e1-156">FORCERENEW</span><span class="sxs-lookup"><span data-stu-id="f25e1-156">FORCERENEW</span></span> | <span data-ttu-id="f25e1-157">(9)</span><span class="sxs-lookup"><span data-stu-id="f25e1-157">(9)</span></span>   | <span data-ttu-id="f25e1-158">(inviato dal client DHCP)</span><span class="sxs-lookup"><span data-stu-id="f25e1-158">(sent by DHCP Client)</span></span> |

## <a name="dhcp-communication"></a><span data-ttu-id="f25e1-159">Comunicazione DHCP</span><span class="sxs-lookup"><span data-stu-id="f25e1-159">DHCP Communication</span></span>

<span data-ttu-id="f25e1-160">Il server DHCP utilizza il protocollo UDP per ricevere le richieste dei client DHCP e trasmettere le risposte.</span><span class="sxs-lookup"><span data-stu-id="f25e1-160">The DHCP Server utilizes the UDP protocol to receive DHCP Client requests and transmit responses.</span></span> <span data-ttu-id="f25e1-161">Prima di avere un indirizzo IP, i messaggi UDP che contengono le informazioni DHCP vengono inviati e ricevuti tramite l'indirizzo di trasmissione IP di 255.255.255.255.</span><span class="sxs-lookup"><span data-stu-id="f25e1-161">Prior to having an IP address, UDP messages carrying the DHCP information are sent and received by utilizing the IP broadcast address of 255.255.255.255.</span></span> <span data-ttu-id="f25e1-162">Tuttavia, se il client conosce l'indirizzo del server DHCP, può inviare messaggi DHCP utilizzando messaggi unicast.</span><span class="sxs-lookup"><span data-stu-id="f25e1-162">However, if the Client knows the address of the DHCP Server it may send DHCP messages using unicast messages.</span></span>

## <a name="dhcp-server-state-machine"></a><span data-ttu-id="f25e1-163">Macchina a Stati del server DHCP</span><span class="sxs-lookup"><span data-stu-id="f25e1-163">DHCP Server State Machine</span></span>

<span data-ttu-id="f25e1-164">Il server DHCP viene implementato come macchina a stati in due passaggi elaborata da un thread DHCP interno creato durante *nx_dhcp_server_create* elaborazione.</span><span class="sxs-lookup"><span data-stu-id="f25e1-164">The DHCP Server is implemented as a two-step state machine processed by an internal DHCP thread that is created during *nx_dhcp_server_create* processing.</span></span> <span data-ttu-id="f25e1-165">Lo stato principale del server DHCP è 1) la ricezione di un messaggio di individuazione da un client DHCP e 2) la ricezione di un messaggio di richiesta.</span><span class="sxs-lookup"><span data-stu-id="f25e1-165">The main states of DHCP Server are 1) receiving a DISCOVER message from a DHCP client and 2) receiving a REQUEST message.</span></span>

<span data-ttu-id="f25e1-166">Di seguito sono riportati gli Stati client DHCP corrispondenti:</span><span class="sxs-lookup"><span data-stu-id="f25e1-166">Below are the corresponding DHCP Client states:</span></span>

- <span data-ttu-id="f25e1-167">**NX_DHCP_STATE_BOOT**: a partire da un indirizzo IP precedente</span><span class="sxs-lookup"><span data-stu-id="f25e1-167">**NX_DHCP_STATE_BOOT**: Starting with a previous IP address</span></span>
- <span data-ttu-id="f25e1-168">**NX_DHCP_STATE_INIT**: a partire da nessun valore dell'indirizzo IP precedente</span><span class="sxs-lookup"><span data-stu-id="f25e1-168">**NX_DHCP_STATE_INIT**: Starting with no previous IP address value</span></span>
- <span data-ttu-id="f25e1-169">**NX_DHCP_STATE_SELECTING**: in attesa di una risposta da un server DHCP</span><span class="sxs-lookup"><span data-stu-id="f25e1-169">**NX_DHCP_STATE_SELECTING**: Waiting for a response from any DHCP server</span></span>
- <span data-ttu-id="f25e1-170">**NX_DHCP_STATE_REQUESTING**: server DHCP identificato, richiesta di indirizzi IP inviata</span><span class="sxs-lookup"><span data-stu-id="f25e1-170">**NX_DHCP_STATE_REQUESTING**: DHCP Server identified, IP address request sent</span></span>
- <span data-ttu-id="f25e1-171">**NX_DHCP_STATE_BOUND**: lease di indirizzi IP DHCP stabilito</span><span class="sxs-lookup"><span data-stu-id="f25e1-171">**NX_DHCP_STATE_BOUND**: DHCP IP Address lease established</span></span>
- <span data-ttu-id="f25e1-172">**NX_DHCP_STATE_RENEWING**: tempo di rinnovo del lease di indirizzi IP DHCP scaduto, richiesta di rinnovo</span><span class="sxs-lookup"><span data-stu-id="f25e1-172">**NX_DHCP_STATE_RENEWING**: DHCP IP Address lease renewal time elapsed, renewal requested</span></span>
- <span data-ttu-id="f25e1-173">**NX_DHCP_STATE_REBINDING**: tempo di riassociazione lease di indirizzi IP DHCP scaduto, richiesta di rinnovo</span><span class="sxs-lookup"><span data-stu-id="f25e1-173">**NX_DHCP_STATE_REBINDING**: DHCP IP Address lease rebind time elapsed, renewal requested</span></span>
- <span data-ttu-id="f25e1-174">**NX_DHCP_STATE_FORCERENEW**: lease degli indirizzi IP DHCP stabilito, forzare il rinnovo del server o dell'applicazione</span><span class="sxs-lookup"><span data-stu-id="f25e1-174">**NX_DHCP_STATE_FORCERENEW**: DHCP IP Address lease established, force renewal by server or by application</span></span>
- <span data-ttu-id="f25e1-175">**NX_DHCP_STATE_FAILED**: non è stato trovato alcun server o non è stata ricevuta alcuna risposta dal server</span><span class="sxs-lookup"><span data-stu-id="f25e1-175">**NX_DHCP_STATE_FAILED**: No server found or no response from server received</span></span>

## <a name="dhcp-additional-parameters"></a><span data-ttu-id="f25e1-176">Parametri aggiuntivi DHCP</span><span class="sxs-lookup"><span data-stu-id="f25e1-176">DHCP Additional Parameters</span></span>

<span data-ttu-id="f25e1-177">Il server DHCP di NetX dispone di un elenco predefinito di parametri di opzione impostati nell'opzione configurabile NX_DHCP_DEFAULT_SERVER_OPTION_LISTin *nx_dhcp_server. h* per fornire ai client DHCP i parametri di configurazione di rete comuni/critici, ad esempio l'indirizzo del router o del gateway e il server DNS per il client DHCP.</span><span class="sxs-lookup"><span data-stu-id="f25e1-177">The NetX DHCP Server has a default list of option parameters which is set in the configurable option NX_DHCP_DEFAULT_SERVER_OPTION_LISTin *nx_dhcp_server.h* to supply DHCP Clients with common/critical network configuration parameters e.g. router or gateway address and DNS server for the DHCP Client.</span></span>

## <a name="dhcp-rfcs"></a><span data-ttu-id="f25e1-178">RFC DHCP</span><span class="sxs-lookup"><span data-stu-id="f25e1-178">DHCP RFCs</span></span>

<span data-ttu-id="f25e1-179">Il server DHCP NetX è conforme a RFC2132, RFC2131 e RFC correlate.</span><span class="sxs-lookup"><span data-stu-id="f25e1-179">NetX DHCP Server is compliant with RFC2132, RFC2131, and related RFCs.</span></span>
