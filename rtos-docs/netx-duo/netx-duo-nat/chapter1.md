---
title: Capitolo 1-Introduzione a Network Address Translation
description: IP Network Address Translation (NAT) è stato sviluppato originariamente per risolvere il problema di un numero limitato di indirizzi IPv4 Internet.
author: philmea
ms.author: philmea
ms.date: 07/14/2020
ms.topic: article
ms.service: rtos
ms.openlocfilehash: 3d01aa6f68e21ea82f65a59a19c4f5c7958a6b92
ms.sourcegitcommit: e3d42e1f2920ec9cb002634b542bc20754f9544e
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/22/2021
ms.locfileid: "104821773"
---
# <a name="chapter-1---an-introduction-to-network-address-translation"></a><span data-ttu-id="63398-103">Capitolo 1-Introduzione a Network Address Translation</span><span class="sxs-lookup"><span data-stu-id="63398-103">Chapter 1 - An introduction to Network Address Translation</span></span>

## <a name="the-need-for-network-address-translation"></a><span data-ttu-id="63398-104">Necessità della traduzione degli indirizzi di rete</span><span class="sxs-lookup"><span data-stu-id="63398-104">The Need for Network Address Translation</span></span>

<span data-ttu-id="63398-105">IP Network Address Translation (NAT) è stato sviluppato originariamente per risolvere il problema di un numero limitato di indirizzi IPv4 Internet.</span><span class="sxs-lookup"><span data-stu-id="63398-105">IP Network Address Translation (NAT) was originally developed to solve the problem of a limited number of Internet IPv4 addresses.</span></span> <span data-ttu-id="63398-106">La necessità di NAT si verifica quando più dispositivi devono accedere a Internet, ma solo un indirizzo Internet IPv4 viene assegnato dal provider di servizi Internet (ISP).</span><span class="sxs-lookup"><span data-stu-id="63398-106">The need for NAT arises when multiple devices need to access the Internet but only one IPv4 Internet address is assigned by the Internet Service Provider (ISP).</span></span>

<span data-ttu-id="63398-107">Esistono anche altri vantaggi dell'uso di NAT.</span><span class="sxs-lookup"><span data-stu-id="63398-107">There are other benefits of using NAT as well.</span></span> <span data-ttu-id="63398-108">La topologia di rete all'esterno del dominio locale può variare in molti modi.</span><span class="sxs-lookup"><span data-stu-id="63398-108">Network topology outside the local domain can change in many ways.</span></span> <span data-ttu-id="63398-109">I clienti possono modificare i provider, i backbone aziendali possono essere riorganizzati oppure i provider possono essere Uniti o divisi.</span><span class="sxs-lookup"><span data-stu-id="63398-109">Customers may change providers, company backbones may be reorganized, or providers may merge or split.</span></span> <span data-ttu-id="63398-110">Ogni volta che la topologia esterna viene modificata, è necessario modificare anche le assegnazioni di indirizzi per gli host all'interno del dominio locale in modo da riflettere queste modifiche esterne.</span><span class="sxs-lookup"><span data-stu-id="63398-110">Whenever the external topology changes, address assignments for hosts within the local domain must also change to reflect these external changes.</span></span> <span data-ttu-id="63398-111">Le modifiche di questo tipo possono essere nascoste dagli utenti all'interno del dominio centralizzando le modifiche a un singolo router di traduzione degli indirizzi.</span><span class="sxs-lookup"><span data-stu-id="63398-111">Changes of this type can be hidden from users within the domain by centralizing changes to a single address translation router.</span></span> <span data-ttu-id="63398-112">NAT consente l'accesso per gli host locali alla rete Internet pubblica e li protegge dall'accesso diretto dall'esterno.</span><span class="sxs-lookup"><span data-stu-id="63398-112">NAT enables access for local hosts to the public Internet and protects them from direct access from the outside.</span></span> <span data-ttu-id="63398-113">Le organizzazioni con una configurazione di rete prevalentemente per uso interno, con la necessità di un accesso esterno occasionale sono ottimi candidati per questo schema.</span><span class="sxs-lookup"><span data-stu-id="63398-113">Organizations with a network setup predominantly for internal use, with a need for occasional external access are good candidates for this scheme.</span></span>

## <a name="basic-nat-and-network-address-port-translation"></a><span data-ttu-id="63398-114">Traduzione di base NAT e porta indirizzo di rete</span><span class="sxs-lookup"><span data-stu-id="63398-114">Basic NAT and Network Address Port Translation</span></span>

<span data-ttu-id="63398-115">Un router abilitato per NAT viene installato tra la rete pubblica e la rete privata.</span><span class="sxs-lookup"><span data-stu-id="63398-115">A NAT-enabled router is installed between the public network and the private network.</span></span> <span data-ttu-id="63398-116">Il ruolo del router abilitato per NAT è la conversione tra gli indirizzi IPv4 privati interni e l'indirizzo IPv4 pubblico assegnato, in modo che tutti i dispositivi nella rete privata possano condividere lo stesso indirizzo IPv4 pubblico.</span><span class="sxs-lookup"><span data-stu-id="63398-116">The role of the NAT-enabled router is to translate between the internal private IPv4 addresses and the assigned public IPv4 address, so all the devices on the private network are able to share the same public IPv4 address.</span></span>

<span data-ttu-id="63398-117">Nell'implementazione di base di NAT, il router NAT ' è proprietario ' di uno o più indirizzi IP registrati a livello globale diverso dal proprio indirizzo IP.</span><span class="sxs-lookup"><span data-stu-id="63398-117">In the basic implementation of NAT, the NAT router ‘owns’ one or more globally registered IP addresses different from its own IP address.</span></span> <span data-ttu-id="63398-118">Questi indirizzi globali sono disponibili per l'assegnazione a host nella propria rete privata in modo statico o dinamico.</span><span class="sxs-lookup"><span data-stu-id="63398-118">These global addresses are available to assign to hosts on its private network either statically or dynamically.</span></span> <span data-ttu-id="63398-119">NAPT, o la conversione di porta dell'indirizzo di rete, è una variante di NAT di base, in cui Network Address Translation viene esteso in modo da includere un identificatore di "trasporto".</span><span class="sxs-lookup"><span data-stu-id="63398-119">NAPT, or Network Address Port Translation, is a variation of basic NAT, where network address translation is extended to include a ‘transport’ identifier.</span></span> <span data-ttu-id="63398-120">Generalmente questo è il numero di porta per i pacchetti TCP e UDP e l'ID di query per i pacchetti ICMP.</span><span class="sxs-lookup"><span data-stu-id="63398-120">Most typically this is the port number for TCP and UDP packets, and the Query ID for ICMP packets.</span></span>

<span data-ttu-id="63398-121">Le connessioni tra i confini NAT vengono in genere avviate dagli host nella rete privata che inviano pacchetti in uscita a un host esterno.</span><span class="sxs-lookup"><span data-stu-id="63398-121">Connections across the NAT boundary are typically initiated by hosts on the private network sending outbound packets to an external host.</span></span> <span data-ttu-id="63398-122">A questi host vengono in genere assegnati indirizzi IP *dinamici* (temporanei) a questo scopo.</span><span class="sxs-lookup"><span data-stu-id="63398-122">These hosts are usually assigned *dynamic* (temporary) IP addresses for this purpose.</span></span> <span data-ttu-id="63398-123">Tuttavia, è anche possibile che le connessioni siano avviate nella direzione opposta se la rete privata ha "Server", ad esempio server HTTP o FTP che accetteranno le richieste client dalla rete esterna.</span><span class="sxs-lookup"><span data-stu-id="63398-123">However, it is also possible to have connections initiated in the opposite direction if the private network has ‘servers’ e.g. HTTP or FTP servers that will accept Client requests from the external network.</span></span> <span data-ttu-id="63398-124">NAT assegna in genere questi host locali a un indirizzo IP *statico* (permanente): porta.</span><span class="sxs-lookup"><span data-stu-id="63398-124">NAT will typically assign these local hosts a *static* (permanent) IP address:port.</span></span>

## <a name="how-network-address-translation-works"></a><span data-ttu-id="63398-125">Funzionamento della traduzione degli indirizzi di rete</span><span class="sxs-lookup"><span data-stu-id="63398-125">How Network Address Translation Works</span></span>

<span data-ttu-id="63398-126">Una configurazione di rete tipica con un router abilitato per NAT è illustrata nella figura 1.</span><span class="sxs-lookup"><span data-stu-id="63398-126">A typical network setup with a NAT-enabled router is illustrated in Figure 1.</span></span>

![Una configurazione di rete tipica con un router abilitato per NAT](media/image2.png)

<span data-ttu-id="63398-128">**Figura 1: configurazione di rete tipica con un router abilitato per NAT**</span><span class="sxs-lookup"><span data-stu-id="63398-128">**Figure 1 - A typical network setup with a NAT-enabled router**</span></span>

<span data-ttu-id="63398-129">Un router abilitato per NAT ha in genere due interfacce di rete.</span><span class="sxs-lookup"><span data-stu-id="63398-129">A NAT-enabled router typically has two network interfaces.</span></span> <span data-ttu-id="63398-130">Un'interfaccia è connessa alla rete Internet pubblica; l'altra è connessa alla rete privata.</span><span class="sxs-lookup"><span data-stu-id="63398-130">One interface is connected to the public Internet; the other is connected to the private network.</span></span> <span data-ttu-id="63398-131">Un tipico router in questa configurazione è responsabile del routing di datagrammi IP tra la rete privata e la rete pubblica in base all'indirizzo IP di destinazione.</span><span class="sxs-lookup"><span data-stu-id="63398-131">A typical router in this setup is responsible for routing IP datagrams between the private network and the public network based on destination IP address.</span></span> <span data-ttu-id="63398-132">Un router abilitato per NAT esegue la conversione degli indirizzi prima di instradare un datagramma IPv4 tra l'interfaccia pubblica e quella privata.</span><span class="sxs-lookup"><span data-stu-id="63398-132">A NAT-enabled router performs address translation before routing an IPv4 datagram between the public and the private interface.</span></span> <span data-ttu-id="63398-133">Viene stabilita una traduzione per ogni sessione TCP o UDP, in base all'indirizzo di origine interno, al numero di porta di origine e all'indirizzo di destinazione esterno e al numero di porta di destinazione.</span><span class="sxs-lookup"><span data-stu-id="63398-133">A translation is established for each TCP or UDP session, based the internal source address, source port number, and external destination address and destination port number.</span></span> <span data-ttu-id="63398-134">Per il datagramma di richiesta e risposta echo ICMP, viene usato l'ID di query ICMP anziché il numero di porta.</span><span class="sxs-lookup"><span data-stu-id="63398-134">For ICMP echo request and response datagram, the ICMP query ID is used instead of the port number.</span></span>

<span data-ttu-id="63398-135">Per illustrare un'implementazione tipica della traduzione degli indirizzi di rete, si consideri una configurazione di rete nella figura 2.</span><span class="sxs-lookup"><span data-stu-id="63398-135">To illustrate a typical implementation of Network Address Translation, let us consider a network setup in Figure 2.</span></span>

![Un'implementazione tipica della traduzione degli indirizzi di rete](media/image3.png)

<span data-ttu-id="63398-137">**Figura 2: implementazione tipica della traduzione degli indirizzi di rete**</span><span class="sxs-lookup"><span data-stu-id="63398-137">**Figure 2 - A typical implementation of Network Address Translation**</span></span>

<span data-ttu-id="63398-138">In questo scenario, il router NAT connette la rete privata a sinistra e la rete pubblica a destra.</span><span class="sxs-lookup"><span data-stu-id="63398-138">In this scenario, the NAT router connects the private network to the left, and the public network to the right.</span></span> <span data-ttu-id="63398-139">Si supponga sul lato rete pubblica, l'indirizzo IP dell'interfaccia del router NAT è 202.151.25.14; nell'interfaccia di rete privata, il router NAT usa l'indirizzo IP 192.168.1.254.</span><span class="sxs-lookup"><span data-stu-id="63398-139">Let’s assume on the public network side, the NAT router interface IP address is 202.151.25.14; on the private network interface, the NAT router uses the IP address 192.168.1.254.</span></span> <span data-ttu-id="63398-140">Un nodo nella rete privata avvia una connessione TCP con un server Web su Internet.</span><span class="sxs-lookup"><span data-stu-id="63398-140">A node on the private network initiates a TCP connection with a web server on the Internet.</span></span>

<span data-ttu-id="63398-141">Nella figura 3 viene illustrata una visualizzazione di alto livello del processo di conversione degli indirizzi di rete.</span><span class="sxs-lookup"><span data-stu-id="63398-141">Figure 3 shows a high-level view of the Network Address Translation process.</span></span>

![Una visualizzazione di alto livello del processo di traduzione degli indirizzi di rete](media/image4.png)

<span data-ttu-id="63398-143">**Figura 3: Panoramica generale del processo di conversione degli indirizzi di rete**</span><span class="sxs-lookup"><span data-stu-id="63398-143">**Figure 3 - A high-level view of the Network Address Translation process**</span></span>

1. <span data-ttu-id="63398-144">Il client trasmette un messaggio TCP SYN al server Web.</span><span class="sxs-lookup"><span data-stu-id="63398-144">Client transmits a TCP SYN message to the web server.</span></span> <span data-ttu-id="63398-145">L'indirizzo del mittente è 192.168.1.15, numero di porta 6732; l'indirizzo di destinazione è 128.15.54.3, numero di porta 80.</span><span class="sxs-lookup"><span data-stu-id="63398-145">The sender address is 192.168.1.15, port number 6732; the destination address is 128.15.54.3, port number 80.</span></span>
1. <span data-ttu-id="63398-146">Il pacchetto dal client viene ricevuto sull'interfaccia di rete privata dal router NAT.</span><span class="sxs-lookup"><span data-stu-id="63398-146">The packet from the Client is received on the private network interface by the NAT router.</span></span> <span data-ttu-id="63398-147">La regola del traffico in uscita si applica al pacchetto: l'indirizzo del mittente (client) viene convertito nell'indirizzo IP pubblico del router NAT 202.15.25.14 e il numero di porta di origine del mittente (client) viene convertito nel numero di porta TCP 2015 sull'interfaccia pubblica.</span><span class="sxs-lookup"><span data-stu-id="63398-147">The outbound traffic rule applies to the packet: the sender’s (Client’s) address is translated to the NAT router’s public IP address 202.15.25.14, and sender (Client) source port number is translated to the TCP port number 2015 on the public interface.</span></span>
1. <span data-ttu-id="63398-148">Il pacchetto viene quindi trasmesso su Internet e infine raggiunge l'host di destinazione 128.15.54.3.</span><span class="sxs-lookup"><span data-stu-id="63398-148">The packet is then transmitted over the Internet and ultimately reaches its destination host 128.15.54.3.</span></span> <span data-ttu-id="63398-149">Si noti che sul lato ricevente, in base all'indirizzo di origine del livello IP e al numero di porta del livello TCP, il pacchetto sembra avere origine da 202.151.24.14, numero di porta 2015.</span><span class="sxs-lookup"><span data-stu-id="63398-149">Notice that on the receiving side, based on the IP layer source address and TCP layer port number, the packet appears to have originated from 202.151.24.14, port number 2015.</span></span>
   <span data-ttu-id="63398-150">Nella figura 4 viene illustrato il processo NAT sul percorso di ritorno.</span><span class="sxs-lookup"><span data-stu-id="63398-150">Figure 4 shows the NAT process on the return path.</span></span>

   ![Processo NAT nel percorso di ritorno](media/image5.png)

   <span data-ttu-id="63398-152">**Figura 4-processo NAT sul percorso di ritorno**</span><span class="sxs-lookup"><span data-stu-id="63398-152">**Figure 4 - NAT process on the return path**</span></span>
1. <span data-ttu-id="63398-153">In questo scenario, l'host Internet 128.15.54.3 Invia un pacchetto di risposta con l'indirizzo Internet del router NAT come destinazione.</span><span class="sxs-lookup"><span data-stu-id="63398-153">In this scenario, the Internet host 128.15.54.3 sends a response packet with the NAT router’s Internet address as its destination.</span></span>
1. <span data-ttu-id="63398-154">Il pacchetto raggiunge il router NAT.</span><span class="sxs-lookup"><span data-stu-id="63398-154">The packet reaches the NAT router.</span></span> <span data-ttu-id="63398-155">Poiché si tratta di un pacchetto in-bound, vengono applicate le regole di conversione in ingresso: l'indirizzo di destinazione viene modificato di nuovo nell'indirizzo IP del mittente originale (client): 192.168.1.15, porta di destinazione numero 6732.</span><span class="sxs-lookup"><span data-stu-id="63398-155">Since this is an in-bound packet, the in-bound translation rules apply: the destination address is changed back to the original sender’s (Client’s) IP address: 192.168.1.15, destination port number 6732.</span></span>
1. <span data-ttu-id="63398-156">Il pacchetto viene quindi inviato al client tramite l'interfaccia connessa alla rete interna.</span><span class="sxs-lookup"><span data-stu-id="63398-156">The packet is then forwarded to the Client through the interface that is connected to the internal network.</span></span>

<span data-ttu-id="63398-157">In questo modo l'indirizzo di rete Internet e il numero di porta del mittente non vengono esposti ad altri host nella rete Internet pubblica.</span><span class="sxs-lookup"><span data-stu-id="63398-157">In this manner the internet network address and port number of the sender is not exposed to other hosts on the public Internet.</span></span>

## <a name="netx-duo-nat-features"></a><span data-ttu-id="63398-158">Funzionalità NAT di NetX Duo</span><span class="sxs-lookup"><span data-stu-id="63398-158">NetX Duo NAT Features</span></span>

<span data-ttu-id="63398-159">Quando l'istanza NAT viene creata utilizzando *nx_nat_create* chiamata, viene creata la tabella di conversione NAT.</span><span class="sxs-lookup"><span data-stu-id="63398-159">When the NAT instance is created using *nx_nat_create* call, the NAT translation table is created.</span></span>

```C
UINT nx_nat_create(NX_NAT_DEVICE *nat_ptr, NX_IP *ip_ptr,
    UINT global_interface_index,
    VOID *dynamic_cache_memory,
    UINT dynamic_cache_size);
```

<span data-ttu-id="63398-160">Per tenere traccia delle traduzioni degli indirizzi di rete per tutte le connessioni attive tra reti locali ed esterne, il router NetX Duo abilitato NAT gestisce una tabella di traduzione con informazioni su ogni connessione host privata che include l'indirizzo IP di origine e di destinazione e il numero di porta.</span><span class="sxs-lookup"><span data-stu-id="63398-160">To keep track of the network address translations for all active connections between local and external networks, the NetX Duo NAT-enabled router maintains a translation table with information about each private host connection which includes source and destination IP address and port number.</span></span>

<span data-ttu-id="63398-161">Il percorso della tabella di conversione ("cache") viene impostato con il puntatore dynamic_cache_memory.</span><span class="sxs-lookup"><span data-stu-id="63398-161">The location of this translation table (“cache”) is set with the dynamic_cache_memory pointer.</span></span> <span data-ttu-id="63398-162">Quest'area deve essere uno spazio del buffer allineato a 4 byte.</span><span class="sxs-lookup"><span data-stu-id="63398-162">This area must be a 4 byte aligned buffer space.</span></span> <span data-ttu-id="63398-163">La dimensione della tabella (o numero di voci) viene determinata dividendo la dimensione della cache dynamic_cache_size per la dimensione di una voce della tabella NAT.</span><span class="sxs-lookup"><span data-stu-id="63398-163">The size of the table (or number of entries) is determined by dividing the cache size dynamic_cache_size by the size of a NAT table entry.</span></span> <span data-ttu-id="63398-164">La tabella deve essere sufficientemente grande per il numero minimo di voci specificato da **NX_NAT_MIN_ENTRY_COUNT definito in *nx_nat. h*. Il valore predefinito è 3.**</span><span class="sxs-lookup"><span data-stu-id="63398-164">The table must be large enough for the minimal number of entries specified by **NX_NAT_MIN_ENTRY_COUNT which is defined in *nx_nat.h*. The default value is 3.**</span></span>

<span data-ttu-id="63398-165">Il timeout per tutte le voci dinamiche nella tabella di conversione NAT NetX Duo viene inizializzato in NX_NAT_ENTRY_RESPONSE_TIMEOUT definito in *nx_nat. h*.</span><span class="sxs-lookup"><span data-stu-id="63398-165">The timeout for all dynamic entries in the NetX Duo NAT translation table are initialized to NX_NAT_ENTRY_RESPONSE_TIMEOUT which is defined in *nx_nat.h*.</span></span> <span data-ttu-id="63398-166">Il valore predefinito è 4 minuti (o 240 cicli di sistema per un processore a 100 mHz) come consigliato da RFC 2663.</span><span class="sxs-lookup"><span data-stu-id="63398-166">The default value is 4 minutes (or 240 system ticks for a 100 mHz processor) as recommended by RFC 2663.</span></span> <span data-ttu-id="63398-167">Ogni volta che NetX Duo NAT riceve o Invia un pacchetto corrispondente a una voce dinamica nella tabella, reimposta il timeout della voce per NX_NAT_ENTRY_RESPONSE_TIMEOUT.</span><span class="sxs-lookup"><span data-stu-id="63398-167">Each time NetX Duo NAT receives or sends a packet matching a dynamic entry in the table it resets that entry’s time out to NX_NAT_ENTRY_RESPONSE_TIMEOUT.</span></span> <span data-ttu-id="63398-168">Quando si esegue una ricerca nella tabella, NetX Duo NAT controllerà anche la tabella per le voci scadute ed eliminarle.</span><span class="sxs-lookup"><span data-stu-id="63398-168">When searching the table, NetX Duo NAT will also check the table for expired entries and delete them.</span></span>

<span data-ttu-id="63398-169">Per creare voci in ingresso come statiche nella tabella, ad esempio per i server della rete locale, NetX Duo NAT fornisce il servizio *nx_nat_inbound_entry_create* .</span><span class="sxs-lookup"><span data-stu-id="63398-169">To create inbound entries as static in the table e.g. for servers on the local network, NetX Duo NAT provides the *nx_nat_inbound_entry_create* service.</span></span> <span data-ttu-id="63398-170">Se una voce della tabella definisce la connessione host locale come statica, non scade mai.</span><span class="sxs-lookup"><span data-stu-id="63398-170">If a table entry defines the local host connection as static, it never expires.</span></span>

```C
UINT nx_nat_inbound_entry_create(NX_NAT_DEVICE *nat_ptr,
    NX_NAT_TRANSLATION_ENTRY *entry_ptr,
    ULONG local_ip_address, USHORT external_port,
    USHORT local_port, UCHAR protocol);
```

<span data-ttu-id="63398-171">Questo servizio è descritto più dettagliatamente nel [capitolo 4-Descrizione dei servizi](chapter4.md)</span><span class="sxs-lookup"><span data-stu-id="63398-171">This service is described in more detail in [Chapter 4 - Description of Services](chapter4.md)</span></span>

<span data-ttu-id="63398-172">In fase di esecuzione, se la tabella di traduzione è piena e non è possibile aggiungere altre voci, NetX Duo NAT invierà una notifica all'applicazione NAT con un callback completo della cache se ne è stata registrata una con l'istanza NAT.</span><span class="sxs-lookup"><span data-stu-id="63398-172">During runtime, if the translation table is full and no more entries can be added, NetX Duo NAT will notify the NAT application with a cache full callback if one is registered with the NAT instance.</span></span> <span data-ttu-id="63398-173">Questa operazione viene eseguita usando il servizio *nx_nat_cache_notify_set* :</span><span class="sxs-lookup"><span data-stu-id="63398-173">This is done using the *nx_nat_cache_notify_set* service:</span></span>

```C
UINT nx_nat_cache_notify_set(NX_NAT_DEVICE *nat_ptr,
    VOID (*cache_full_notify_cb)(NX_NAT_DEVICE *nat_ptr));
```

<span data-ttu-id="63398-174">Per ulteriori informazioni su questo servizio, vedere il [capitolo 4-Descrizione dei servizi](chapter4.md) .</span><span class="sxs-lookup"><span data-stu-id="63398-174">See [Chapter 4 - Description of Services](chapter4.md) for more details about this service.</span></span>

## <a name="nat-packet-processing-in-netx-duo"></a><span data-ttu-id="63398-175">Elaborazione di pacchetti NAT in NetX Duo</span><span class="sxs-lookup"><span data-stu-id="63398-175">NAT Packet Processing in NetX Duo</span></span>

<span data-ttu-id="63398-176">NetX Duo NAT è progettato per l'uso in un router IPv4.</span><span class="sxs-lookup"><span data-stu-id="63398-176">NetX Duo NAT is intended for use on an IPv4 router.</span></span> <span data-ttu-id="63398-177">Per il funzionamento di NAT, è necessario configurare NetX Duo per inoltrare i pacchetti al server NAT.</span><span class="sxs-lookup"><span data-stu-id="63398-177">For NAT to work, NetX Duo must be configured for forwarding packets to the NAT server.</span></span> <span data-ttu-id="63398-178">Per informazioni su come eseguire questa operazione, vedere il capitolo 2 sull'installazione di NetX Duo NAT.</span><span class="sxs-lookup"><span data-stu-id="63398-178">See Chapter 2 on NetX Duo NAT installation for how to do so.</span></span> <span data-ttu-id="63398-179">Il server NAT indica quindi se verrà usato (tenta di inviare) il pacchetto a un host in una delle sue reti.</span><span class="sxs-lookup"><span data-stu-id="63398-179">The NAT server then indicates if it will ‘consume’ (attempt to forward) the packet to a host on either of its networks.</span></span> <span data-ttu-id="63398-180">Se non utilizzerà il pacchetto, il pacchetto viene restituito a NetX Duo per elaborare il pacchetto come normalmente.</span><span class="sxs-lookup"><span data-stu-id="63398-180">If it will not consume the packet, the packet is ‘returned’ to NetX Duo to process the packet as it normally would.</span></span>

<span data-ttu-id="63398-181">Quando il server NAT riceve un pacchetto da inoltrare da NetX Duo, determina se il pacchetto è in ingresso o in uscita.</span><span class="sxs-lookup"><span data-stu-id="63398-181">When the NAT server receives a packet to forward from NetX Duo, it determines if the packet is inbound or outbound.</span></span>

<span data-ttu-id="63398-182">Per i pacchetti in uscita, il server NAT controlla la porta e l'indirizzo di origine dell'intestazione IP del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="63398-182">For outbound packets, the NAT server checks the packet IP header source address and port.</span></span> <span data-ttu-id="63398-183">Se la tabella di conversione non contiene una voce per un pacchetto inviato in precedenza da questo host per la stessa destinazione, NAT creerà una nuova voce che conterrà un indirizzo IP di origine globale univoco: porta per la connessione e modificherà le intestazioni dei pacchetti con il nuovo indirizzo IP: porta prima di inviarlo alla rete esterna.</span><span class="sxs-lookup"><span data-stu-id="63398-183">If the translation table does not contain an entry for a packet previously sent by this host for the same destination, NAT will create a new entry which will contain a unique global source IP address:port for the connection, and modify the packet headers with this new IP address:port before sending it onto the external network.</span></span>

<span data-ttu-id="63398-184">Per i pacchetti in ingresso, il server NAT cerca una voce precedente nella relativa tabella di conversione con un indirizzo IP esterno: porta corrispondente all'indirizzo IP di destinazione del pacchetto: porta.</span><span class="sxs-lookup"><span data-stu-id="63398-184">For inbound packets, the NAT server looks for a previous entry in its translation table with an external IP address: port matching the packet destination IP address: port.</span></span> <span data-ttu-id="63398-185">Se non viene trovata alcuna corrispondenza, il pacchetto verrà scartato a meno che l'indirizzo di destinazione: porta non sia l'indirizzo esterno per il server nella rete locale.</span><span class="sxs-lookup"><span data-stu-id="63398-185">If no match is found, it will discard the packet unless the destination address: port is the external address for server on the local network.</span></span> <span data-ttu-id="63398-186">Se trova una corrispondenza, sostituisce l'indirizzo IP di destinazione esterno dell'intestazione del pacchetto: porta con indirizzo IP privato: porta e invia il pacchetto nella rete locale all'host privato previsto.</span><span class="sxs-lookup"><span data-stu-id="63398-186">If it does find a match, it will replace the packet header’s external destination IP address: port with the private IP address: port and send the packet onto the local network to the intended private host.</span></span>

<span data-ttu-id="63398-187">NetX Duo NAT utilizza un intervallo di porte di conversione TCP, UDP e ICMP per la creazione di indirizzi locali univoci: connessioni porta per gli host locali che si connettono agli host esterni.</span><span class="sxs-lookup"><span data-stu-id="63398-187">NetX Duo NAT uses a range of TCP, UDP and ICMP translation ports for creating unique local address: port connections for local hosts connecting with outside hosts.</span></span> <span data-ttu-id="63398-188">Le opzioni configurabili dall'utente seguenti, definite in *nx_nat. h,* definiscono l'intervallo per ogni protocollo:</span><span class="sxs-lookup"><span data-stu-id="63398-188">The following user configurable options, defined in *nx_nat.h,* define the range for each protocol:</span></span>

```C
NX_NAT_START_TCP_PORT

NX_NAT_END_TCP_PORT

NX_NAT_START_UDP_PORT

NX_NAT_END_UDP_PORT

NX_NAT_START_ICMP_QUERY_ID

NX_NAT_END_ICMP_QUERY_ID
```

## <a name="nat-requirements-and-constraints"></a><span data-ttu-id="63398-189">Requisiti e vincoli NAT</span><span class="sxs-lookup"><span data-stu-id="63398-189">NAT Requirements and Constraints</span></span>

<span data-ttu-id="63398-190">NetX Duo NAT richiede NetX Duo 5,8 o versione successiva.</span><span class="sxs-lookup"><span data-stu-id="63398-190">NetX Duo NAT requires NetX Duo 5.8 or later.</span></span> <span data-ttu-id="63398-191">Per l'applicazione NAT è richiesta la creazione di una singola istanza IP e di un'interfaccia per la rete fisica interna ed esterna.</span><span class="sxs-lookup"><span data-stu-id="63398-191">The NAT application requires creation of a single IP instance and an interface to the internal and external physical network.</span></span>

<span data-ttu-id="63398-192">Vincoli</span><span class="sxs-lookup"><span data-stu-id="63398-192">Constraints:</span></span>

- <span data-ttu-id="63398-193">NetX Duo NAT supporta TCP, UDP e ICMP.</span><span class="sxs-lookup"><span data-stu-id="63398-193">NetX Duo NAT supports TCP, UDP and ICMP.</span></span> <span data-ttu-id="63398-194">IGMP non è supportato.</span><span class="sxs-lookup"><span data-stu-id="63398-194">IGMP is not supported.</span></span>
- <span data-ttu-id="63398-195">NetX Duo NAT non supporta l'indirizzamento IPv6.</span><span class="sxs-lookup"><span data-stu-id="63398-195">NetX Duo NAT does not support IPv6 addressing.</span></span>
- <span data-ttu-id="63398-196">NetX Duo NAT non include servizi DNS o DHCP, sebbene NetX Duo NAT possa integrare tali servizi con le relative operazioni NAT.</span><span class="sxs-lookup"><span data-stu-id="63398-196">NetX Duo NAT does not include DNS or DHCP services, although NetX Duo NAT can integrate those services with its NAT operations.</span></span>

## <a name="rfcs-supported-by-netx-duo-nat"></a><span data-ttu-id="63398-197">RFC supportate da NetX Duo NAT</span><span class="sxs-lookup"><span data-stu-id="63398-197">RFCs Supported by NetX Duo NAT</span></span>

<span data-ttu-id="63398-198">L'implementazione NAT di NetX duo si basa sulle informazioni presentate nei seguenti RFC:</span><span class="sxs-lookup"><span data-stu-id="63398-198">NetX Duo NAT implementation is based on information presented in the following RFCs:</span></span>

- <span data-ttu-id="63398-199">RFC 2663: terminologia e considerazioni su IP Network Address Translator (NAT)</span><span class="sxs-lookup"><span data-stu-id="63398-199">RFC 2663: IP Network Address Translator (NAT) Terminology and Considerations</span></span>
- <span data-ttu-id="63398-200">RFC 3022: tradizionale indirizzo IP netowrk Translator (NAT tradizionale)</span><span class="sxs-lookup"><span data-stu-id="63398-200">RFC 3022: Traditional IP Netowrk Address Translator (Traditional NAT)</span></span>
- <span data-ttu-id="63398-201">RFC 4787: requisiti di comportamento NAT (Network Address Translation) per UDP unicast</span><span class="sxs-lookup"><span data-stu-id="63398-201">RFC 4787: Network Address Translation (NAT) Behavioral Requirements for Unicast UDP</span></span>
