---
title: Capitolo 3-componenti funzionali di Azure RTO NetX Duo
description: Questo capitolo contiene una descrizione dello stack TCP/IP di Azure RTO NetX Duo a prestazioni elevate dal punto di vista funzionale.
author: philmea
ms.author: philmea
ms.date: 05/19/2020
ms.topic: article
ms.service: rtos
ms.openlocfilehash: 07e51643c828afc8e6c0b968e78380316e84ccd7
ms.sourcegitcommit: e3d42e1f2920ec9cb002634b542bc20754f9544e
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/22/2021
ms.locfileid: "104822115"
---
# <a name="chapter-3---functional-components-of-azure-rtos-netx-duo"></a><span data-ttu-id="613a9-103">Capitolo 3-componenti funzionali di Azure RTO NetX Duo</span><span class="sxs-lookup"><span data-stu-id="613a9-103">Chapter 3 - Functional Components of Azure RTOS NetX Duo</span></span>

<span data-ttu-id="613a9-104">Questo capitolo contiene una descrizione dello stack TCP/IP di Azure RTO NetX Duo a prestazioni elevate dal punto di vista funzionale.</span><span class="sxs-lookup"><span data-stu-id="613a9-104">This chapter contains a description of the high- performance Azure RTOS NetX Duo TCP/IP stack from a functional perspective.</span></span> 

## <a name="execution-overview"></a><span data-ttu-id="613a9-105">Panoramica dell'esecuzione</span><span class="sxs-lookup"><span data-stu-id="613a9-105">Execution Overview</span></span>

<span data-ttu-id="613a9-106">Esistono cinque tipi di esecuzione del programma all'interno di un'applicazione NetX Duo: inizializzazione, chiamate di interfaccia dell'applicazione, thread IP interno, timer periodici IP e driver di rete.</span><span class="sxs-lookup"><span data-stu-id="613a9-106">There are five types of program execution within a NetX Duo application: initialization, application interface calls, internal IP thread, IP periodic timers, and the network driver.</span></span>

> [!NOTE]
> <span data-ttu-id="613a9-107">*NetX Duo presuppone l'esistenza di ThreadX e dipende dall'esecuzione del thread, dalla sospensione, dai timer periodici e dalle strutture di esclusione reciproca.*</span><span class="sxs-lookup"><span data-stu-id="613a9-107">*NetX Duo assumes the existence of ThreadX and depends on its thread execution, suspension, periodic timers, and mutual exclusion facilities.*</span></span>

### <a name="initialization"></a><span data-ttu-id="613a9-108">Inizializzazione</span><span class="sxs-lookup"><span data-stu-id="613a9-108">Initialization</span></span>

<span data-ttu-id="613a9-109">Il servizio \***nx_system_initialize** _ deve essere chiamato prima di chiamare qualsiasi altro servizio NETX Duo.</span><span class="sxs-lookup"><span data-stu-id="613a9-109">The service \***nx_system_initialize** _ must be called before any other NetX Duo service is called.</span></span> <span data-ttu-id="613a9-110">L'inizializzazione del sistema può essere chiamata dalla funzione ThreadX _ *_tx_application_define_*\* o dai thread dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-110">System initialization can be called either from the ThreadX _ *_tx_application_define_*\* function or from application threads.</span></span>

<span data-ttu-id="613a9-111">Dopo che \***nx_system_initialize** _ restituisce, il sistema è pronto per la creazione di pool di pacchetti e istanze IP.</span><span class="sxs-lookup"><span data-stu-id="613a9-111">After \***nx_system_initialize** _ returns, the system is ready to create packet pools and IP instances.</span></span> <span data-ttu-id="613a9-112">Poiché la creazione di un'istanza IP richiede un pool di pacchetti predefinito, è necessario che esista almeno un pool di pacchetti NetX duo prima di creare un'istanza IP.</span><span class="sxs-lookup"><span data-stu-id="613a9-112">Because creating an IP instance requires a default packet pool, at least one NetX Duo packet pool must exist prior to creating an IP instance.</span></span> <span data-ttu-id="613a9-113">La creazione di pool di pacchetti e istanze IP è consentita dalla funzione di inizializzazione ThreadX _ *_tx_application_define_*\* e dai thread dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-113">Creating packet pools and IP instances are allowed from the ThreadX initialization function _ *_tx_application_define_*\* and from application threads.</span></span>

<span data-ttu-id="613a9-114">Internamente, la creazione di un'istanza IP viene eseguita in due parti: la prima parte viene eseguita nel contesto del chiamante, dal ***tx_application_define*** o dal contesto del thread dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-114">Internally, creating an IP instance is accomplished in two parts: The first part is done within the context of the caller, either from ***tx_application_define*** or from an application thread's context.</span></span> <span data-ttu-id="613a9-115">Ciò include la configurazione della struttura dei dati IP e la creazione di varie risorse IP, incluso il thread IP interno.</span><span class="sxs-lookup"><span data-stu-id="613a9-115">This includes setting up the IP data structure and creating various IP resources, including the internal IP thread.</span></span> <span data-ttu-id="613a9-116">La seconda parte viene eseguita durante l'esecuzione iniziale dal thread IP interno.</span><span class="sxs-lookup"><span data-stu-id="613a9-116">The second part is performed during the initial execution from the internal IP thread.</span></span> <span data-ttu-id="613a9-117">Questo è il punto in cui il driver di rete, fornito durante la prima parte della creazione dell'IP, viene chiamato per la prima volta.</span><span class="sxs-lookup"><span data-stu-id="613a9-117">This is where the network driver, supplied during the first part of IP creation, is first called.</span></span> <span data-ttu-id="613a9-118">La chiamata del driver di rete dal thread IP interno consente al driver di eseguire operazioni di I/O e di sospendere durante l'elaborazione dell'inizializzazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-118">Calling the network driver from the internal IP thread enables the driver to perform I/O and suspend during its initialization processing.</span></span>

<span data-ttu-id="613a9-119">Quando il driver di rete viene restituito dalla relativa elaborazione di inizializzazione, la creazione dell'indirizzo IP è stata completata.</span><span class="sxs-lookup"><span data-stu-id="613a9-119">When the network driver returns from its initialization processing, the IP creation is complete.</span></span>

<span data-ttu-id="613a9-120">Per l'inizializzazione di IPv6 in NetX Duo sono necessari alcuni altri servizi NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="613a9-120">Initialization of IPv6 in NetX Duo requires a few additional NetX Duo services.</span></span> <span data-ttu-id="613a9-121">Sono descritte più dettagliatamente nella sezione [IPv6 in NETX Duo](#ipv6-in-netx-duo) più avanti in questo capitolo.</span><span class="sxs-lookup"><span data-stu-id="613a9-121">These are described in greater detail in the section [IPv6 in NetX Duo](#ipv6-in-netx-duo) later in this chapter.</span></span>

> [!NOTE]
> <span data-ttu-id="613a9-122">*Il **nx_ip_status_check** del servizio NETX Duo è disponibile per ottenere informazioni sull'istanza IP e lo stato dell'interfaccia principale. Tali informazioni di stato includono se il collegamento è stato inizializzato, abilitato e l'indirizzo IP è stato risolto. Queste informazioni vengono usate per sincronizzare i thread dell'applicazione che richiedono l'uso di un'istanza IP appena creata. Per i sistemi multihome, vedere [supporto multihome](#multihome-support). **nx_ip_interface_status_check** è disponibile per ottenere 3information sull'interfaccia specificata.*</span><span class="sxs-lookup"><span data-stu-id="613a9-122">*The NetX Duo service **nx_ip_status_check** is available to obtain information on the IP instance and its primary interface status. Such status information includes whether or not the link is initialized, enabled and IP address is resolved. This information is used to synchronize application threads needing to use a newly created IP instance. For multihome systems, see [Multihome Support](#multihome-support). **nx_ip_interface_status_check** is available to obtain 3information on the specified interface.*</span></span>

### <a name="application-interface-calls"></a><span data-ttu-id="613a9-123">Chiamate dell'interfaccia dell'applicazione</span><span class="sxs-lookup"><span data-stu-id="613a9-123">Application Interface Calls</span></span>

<span data-ttu-id="613a9-124">Le chiamate dall'applicazione vengono eseguite in gran parte dai thread dell'applicazione in esecuzione in ThreadX RTO.</span><span class="sxs-lookup"><span data-stu-id="613a9-124">Calls from the application are largely made from application threads running under the ThreadX RTOS.</span></span> <span data-ttu-id="613a9-125">Tuttavia, alcuni servizi di inizializzazione, creazione e abilitazione possono essere chiamati da ***tx_application_define***.</span><span class="sxs-lookup"><span data-stu-id="613a9-125">However, some initialization, create, and enable services may be called from ***tx_application_define***.</span></span> <span data-ttu-id="613a9-126">Le sezioni "consentito da" del [capitolo 4-Descrizione dei servizi di Azure RTO NETX Duo](chapter4.md) indicano da quale può essere chiamato ogni servizio NETX Duo.</span><span class="sxs-lookup"><span data-stu-id="613a9-126">The "Allowed From" sections in [Chapter 4 - Description of Azure RTOS NetX Duo Services](chapter4.md) indicate from which each NetX Duo service can be called.</span></span>

<span data-ttu-id="613a9-127">Nella maggior parte dei casi, l'elaborazione di attività intensive, ad esempio il calcolo dei checksum, viene eseguita nel contesto del thread chiamante, senza bloccare l'accesso ad altri thread all'istanza IP.</span><span class="sxs-lookup"><span data-stu-id="613a9-127">For the most part, processing intensive activities such as computing checksums is done within the calling thread's context—without blocking access of other threads to the IP instance.</span></span> <span data-ttu-id="613a9-128">Ad esempio, sulla trasmissione, il calcolo del checksum UDP viene eseguito all'interno del servizio \***nx_udp_socket_send** _, prima di chiamare la funzione di invio IP sottostante.</span><span class="sxs-lookup"><span data-stu-id="613a9-128">For example, on transmission, the UDP checksum calculation is performed inside the \***nx_udp_socket_send** _ service, prior to calling the underlying IP send function.</span></span> <span data-ttu-id="613a9-129">In un pacchetto ricevuto, il checksum UDP viene calcolato nel servizio _ \*_nx_udp_socket_receive_\*\*, eseguito nell'oggetto del thread dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-129">On a received packet, the UDP checksum is calculated in the _ *_nx_udp_socket_receive_*\* service, executed in the  of the application thread.</span></span> <span data-ttu-id="613a9-130">Ciò consente di impedire il blocco delle richieste di rete di thread con priorità più alta a causa dell'elaborazione di calcoli di checksum intensivi nei thread con priorità più bassa.</span><span class="sxs-lookup"><span data-stu-id="613a9-130">This helps prevent stalling network requests of higher-priority threads because of processing intensive checksum computation in lower-priority threads.</span></span>

<span data-ttu-id="613a9-131">I valori, ad esempio gli indirizzi IP e i numeri di porta, vengono passati alle API nell'ordine dei byte dell'host.</span><span class="sxs-lookup"><span data-stu-id="613a9-131">Values, such as IP addresses and port numbers, are passed to APIs in host byte order.</span></span> <span data-ttu-id="613a9-132">Internamente, questi valori vengono archiviati anche nell'ordine dei byte dell'host.</span><span class="sxs-lookup"><span data-stu-id="613a9-132">Internally these values are stored in host byte order as well.</span></span> <span data-ttu-id="613a9-133">Ciò consente agli sviluppatori di visualizzare facilmente i valori tramite un debugger.</span><span class="sxs-lookup"><span data-stu-id="613a9-133">This allows developers to easily view the values via a debugger.</span></span> <span data-ttu-id="613a9-134">Quando questi valori vengono programmati in un frame per la trasmissione, vengono convertiti in ordine byte di rete.</span><span class="sxs-lookup"><span data-stu-id="613a9-134">When these values are programmed into a frame for transmission, they are converted to network byte order.</span></span>

### <a name="internal-ip-thread"></a><span data-ttu-id="613a9-135">Thread IP interno</span><span class="sxs-lookup"><span data-stu-id="613a9-135">Internal IP Thread</span></span>

<span data-ttu-id="613a9-136">Come indicato in precedenza, ogni istanza IP in NetX Duo dispone di un proprio thread.</span><span class="sxs-lookup"><span data-stu-id="613a9-136">As mentioned, each IP instance in NetX Duo has its own thread.</span></span> <span data-ttu-id="613a9-137">La priorità e le dimensioni dello stack del thread IP interno sono definite nel servizio ***nx_ip_create*** .</span><span class="sxs-lookup"><span data-stu-id="613a9-137">The priority and stack size of the internal IP thread is defined in the ***nx_ip_create*** service.</span></span> <span data-ttu-id="613a9-138">Il thread IP interno viene creato in modalità pronta per l'esecuzione.</span><span class="sxs-lookup"><span data-stu-id="613a9-138">The internal IP thread is created in a ready-to-execute mode.</span></span> <span data-ttu-id="613a9-139">Se il thread IP ha una priorità più elevata rispetto al thread chiamante, è possibile che si verifichi la precedenza all'interno della chiamata di creazione IP.</span><span class="sxs-lookup"><span data-stu-id="613a9-139">If the IP thread has a higher priority than the calling thread, preemption may occur inside the IP create call.</span></span>

<span data-ttu-id="613a9-140">Il punto di ingresso del thread IP interno si trova nella funzione interna _ ***nx_ip_thread_entry***.</span><span class="sxs-lookup"><span data-stu-id="613a9-140">The entry point of the internal IP thread is at the internal function _ ***nx_ip_thread_entry***.</span></span> <span data-ttu-id="613a9-141">Quando viene avviato, il thread IP interno completa innanzitutto l'inizializzazione del driver di rete, che consiste nell'effettuare tre chiamate al driver di rete specifico dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-141">When started, the internal IP thread first completes network driver initialization, which consists of making three calls to the application-specific network driver.</span></span> <span data-ttu-id="613a9-142">La prima chiamata consiste nel connettersi al driver di rete all'istanza IP, seguita da una chiamata di inizializzazione, che consente al driver di rete di passare attraverso il processo di inizializzazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-142">The first call is to attach the network driver to the IP instance, followed by an initialization call, which allows the network driver to go through the initialization process.</span></span> <span data-ttu-id="613a9-143">Dopo che il driver di rete è stato restituito dall'inizializzazione (potrebbe sospendere in attesa della corretta configurazione dell'hardware), il thread IP interno chiama di nuovo il driver di rete per abilitare il collegamento.</span><span class="sxs-lookup"><span data-stu-id="613a9-143">After the network driver returns from initialization (it may suspend while waiting for the hardware to be properly set up), the internal IP thread calls the network driver again to enable the link.</span></span> <span data-ttu-id="613a9-144">Quando il driver di rete viene restituito dalla chiamata di attivazione del collegamento, il thread IP interno immette un controllo del ciclo Forever per i vari eventi che richiedono l'elaborazione per questa istanza IP.</span><span class="sxs-lookup"><span data-stu-id="613a9-144">After the network driver returns from the link enable call, the internal IP thread enters a forever loop checking for various events that need processing for this IP instance.</span></span> <span data-ttu-id="613a9-145">Gli eventi elaborati in questo ciclo includono la ricezione di pacchetti IP posticipati, l'assembly dei frammenti di pacchetti IP, l'elaborazione dei ping ICMP, l'elaborazione IGMP, l'elaborazione della coda di pacchetti TCP, l'elaborazione periodica TCP, i timeout degli assembly dei frammenti IP e l'elaborazione periodica di IGMP.</span><span class="sxs-lookup"><span data-stu-id="613a9-145">Events processed in this loop include deferred IP packet reception, IP packet fragment assembly, ICMP ping processing, IGMP processing, TCP packet queue processing, TCP periodic processing, IP fragment assembly timeouts, and IGMP periodic processing.</span></span> <span data-ttu-id="613a9-146">Gli eventi includono inoltre le attività di risoluzione degli indirizzi. Elaborazione di pacchetti ARP e elaborazione periodica ARP in IPv4, rilevamento di indirizzi duplicati, richiesta router e individuazione vicina in IPv6.</span><span class="sxs-lookup"><span data-stu-id="613a9-146">Events also include address resolution activities; ARP packet processing and ARP periodic processing in IPv4, Duplicate Address Detection, Router Solicitation, and Neighbor Discovery in IPv6.</span></span>

> [!CAUTION]
> <span data-ttu-id="613a9-147">*Le funzioni di callback di NetX Duo, inclusi i callback di ascolto e disconnessione, vengono chiamate dal thread IP interno, non dal thread chiamante originale. È necessario che l'applicazione non venga sospesa all'interno di una funzione di callback NetX Duo.*</span><span class="sxs-lookup"><span data-stu-id="613a9-147">*The NetX Duo callback functions, including listen and disconnect callbacks, are called from the internal IP thread—not the original calling thread. The application must take care not to suspend inside any NetX Duo callback function.*</span></span>

### <a name="ip-periodic-timers"></a><span data-ttu-id="613a9-148">Timer periodici IP</span><span class="sxs-lookup"><span data-stu-id="613a9-148">IP Periodic Timers</span></span>

<span data-ttu-id="613a9-149">Per ogni istanza IP sono usati due timer periodici ThreadX.</span><span class="sxs-lookup"><span data-stu-id="613a9-149">There are two ThreadX periodic timers used for each IP instance.</span></span> <span data-ttu-id="613a9-150">Il primo è un timer di un secondo per ARP, IGMP, TCP timeout e anche l'elaborazione del frammento IP del riassemblaggio.</span><span class="sxs-lookup"><span data-stu-id="613a9-150">The first one is a one-second timer for ARP, IGMP, TCP timeout, and it also drives IP fragment reassemble processing.</span></span> <span data-ttu-id="613a9-151">Il secondo timer è un timer di 100 ms per guidare il timeout di ritrasmissione TCP e le operazioni correlate a IPv6.</span><span class="sxs-lookup"><span data-stu-id="613a9-151">The second timer is a 100ms timer to drive the TCP retransmission timeout and IPv6-related operations.</span></span>

### <a name="network-driver"></a><span data-ttu-id="613a9-152">Driver di rete</span><span class="sxs-lookup"><span data-stu-id="613a9-152">Network Driver</span></span>

<span data-ttu-id="613a9-153">Ogni istanza IP in NetX duo ha un'interfaccia primaria, identificata dal driver di dispositivo specificato nel servizio ***nx_ip_create*** .</span><span class="sxs-lookup"><span data-stu-id="613a9-153">Each IP instance in NetX Duo has a primary interface, which is identified by its device driver specified in the ***nx_ip_create*** service.</span></span> <span data-ttu-id="613a9-154">Il driver di rete è responsabile della gestione di varie richieste NetX Duo, tra cui la trasmissione di pacchetti, la ricezione di pacchetti e le richieste di stato e controllo.</span><span class="sxs-lookup"><span data-stu-id="613a9-154">The network driver is responsible for handling various NetX Duo requests, including packet transmission, packet reception, and requests for status and control.</span></span> 

<span data-ttu-id="613a9-155">Per un sistema multi-Home, l'istanza IP dispone di più interfacce, ciascuna con un driver di rete associato che esegue queste attività per la rispettiva interfaccia.</span><span class="sxs-lookup"><span data-stu-id="613a9-155">For a multi-home system, the IP instance has multiple interfaces, each with an associated network driver that performs these tasks for the respective interface.</span></span>

<span data-ttu-id="613a9-156">Il driver di rete deve inoltre gestire gli eventi asincroni che si verificano sui supporti.</span><span class="sxs-lookup"><span data-stu-id="613a9-156">The network driver must also handle asynchronous events occurring on the media.</span></span> <span data-ttu-id="613a9-157">Gli eventi asincroni dai supporti includono la ricezione di pacchetti, il completamento della trasmissione del pacchetto e le modifiche dello stato.</span><span class="sxs-lookup"><span data-stu-id="613a9-157">Asynchronous events from the media include packet reception, packet transmission completion, and status changes.</span></span> <span data-ttu-id="613a9-158">NetX Duo fornisce al driver di rete numerose funzioni di accesso per gestire vari eventi.</span><span class="sxs-lookup"><span data-stu-id="613a9-158">NetX Duo provides the network driver with several access functions to handle various events.</span></span> <span data-ttu-id="613a9-159">Queste funzioni sono progettate per essere chiamate dalla parte di routine del servizio di interrupt del driver di rete.</span><span class="sxs-lookup"><span data-stu-id="613a9-159">These functions are designed to be called from the  interrupt service routine portion of the network driver.</span></span> <span data-ttu-id="613a9-160">Per le reti IPv4, il driver di rete deve inoltrare tutti i pacchetti ARP ricevuti al ***_nx_arp_packet_deferred_receive*** funzione interna.</span><span class="sxs-lookup"><span data-stu-id="613a9-160">For IPv4 networks, the network driver should forward all ARP packets received to the ***_nx_arp_packet_deferred_receive*** internal function.</span></span> <span data-ttu-id="613a9-161">Tutti i pacchetti RARP devono essere inoltrati alla funzione \***_nx_rarp_packet_deferred_receive** _ interna.</span><span class="sxs-lookup"><span data-stu-id="613a9-161">All RARP packets should be forwarded to \***_nx_rarp_packet_deferred_receive** _ internal function.</span></span> <span data-ttu-id="613a9-162">Sono disponibili due opzioni per i pacchetti IP.</span><span class="sxs-lookup"><span data-stu-id="613a9-162">There are two options for IP packets.</span></span> <span data-ttu-id="613a9-163">Se è necessario inviare rapidamente i pacchetti IP, i pacchetti IP in ingresso devono essere inoltrati a _ *_ _nx_ip_packet_receive_* _ per l'elaborazione immediata.</span><span class="sxs-lookup"><span data-stu-id="613a9-163">If fast dispatch of IP packets is required, incoming IP packets should be forwarded to _ *_ _nx_ip_packet_receive_* _ for immediate processing.</span></span> <span data-ttu-id="613a9-164">Ciò migliora notevolmente le prestazioni di NetX Duo nella gestione dei pacchetti IP.</span><span class="sxs-lookup"><span data-stu-id="613a9-164">This greatly improves NetX Duo performance in handling IP packets.</span></span> <span data-ttu-id="613a9-165">In caso contrario, è necessario inoltrare i pacchetti IP a _ \*_ _nx_ip_packet_deferred_receive_\*\*.</span><span class="sxs-lookup"><span data-stu-id="613a9-165">Otherwise, forwarding IP packets to _ *_ _nx_ip_packet_deferred_receive_*\* should be done.</span></span> <span data-ttu-id="613a9-166">Questo servizio posiziona il pacchetto IP nella coda di elaborazione posticipata, dove viene quindi gestito dal thread IP interno, che comporta la quantità minima di tempo di elaborazione ISR.</span><span class="sxs-lookup"><span data-stu-id="613a9-166">This service places the IP packet in the deferred processing queue where it is then handled by the internal IP thread, which results in the least amount of ISR processing time.</span></span>

<span data-ttu-id="613a9-167">Il driver di rete può anche rinviare l'elaborazione di interrupt per esaurire il contesto del thread IP.</span><span class="sxs-lookup"><span data-stu-id="613a9-167">The network driver can also defer interrupt processing to run out of the context of the IP thread.</span></span> <span data-ttu-id="613a9-168">In questa modalità, l'ISR deve salvare le informazioni necessarie, chiamare la funzione interna ***_nx_ip_driver_deferred_processing*** e confermare il controller di interrupt.</span><span class="sxs-lookup"><span data-stu-id="613a9-168">In this mode, the ISR shall save the necessary information, call the internal function ***_nx_ip_driver_deferred_processing***, and acknowledge the interrupt controller.</span></span> <span data-ttu-id="613a9-169">Questo servizio invia una notifica al thread IP per pianificare un callback al driver di dispositivo per completare il processo dell'evento che ha causato l'interruzione.</span><span class="sxs-lookup"><span data-stu-id="613a9-169">This service notifies IP thread to schedule a callback to the device driver to complete the process of the event that causes the interrupt.</span></span>

<span data-ttu-id="613a9-170">Alcuni controller di rete sono in grado di eseguire il calcolo e la convalida del checksum dell'intestazione TCP/IP nell'hardware, senza occupare risorse di CPU utili.</span><span class="sxs-lookup"><span data-stu-id="613a9-170">Some network controllers are capable of performing TCP/IP header checksum computation and validation in hardware, without taking up valuable CPU resources.</span></span> <span data-ttu-id="613a9-171">Per sfruttare i vantaggi della funzionalità hardware Capability, NetX Duo fornisce opzioni per abilitare o disabilitare diversi calcoli di checksum software in fase di compilazione, nonché per attivare o disattivare il calcolo dei checksum in fase di esecuzione, se il driver di dispositivo è in grado di comunicare con il livello IP relativo alle funzionalità hardware.</span><span class="sxs-lookup"><span data-stu-id="613a9-171">To take advantage of the hardware capability feature, NetX Duo provides options to enable or disable various software checksum computation at compilation time, as well as turning on or off checksum computation at run time, if the device driver is able to communicate with the IP layer about is hardware capabilities.</span></span> <span data-ttu-id="613a9-172">Per informazioni più dettagliate sulla scrittura di driver di rete NetX Duo, vedere il [capitolo 5-driver di rete di Azure RTO NETX Duo](chapter5.md) .</span><span class="sxs-lookup"><span data-stu-id="613a9-172">See [Chapter 5 - Azure RTOS NetX Duo Network Drivers](chapter5.md) for more detailed information on writing NetX Duo network drivers.</span></span>

### <a name="multihome-support"></a><span data-ttu-id="613a9-173">Supporto multihome</span><span class="sxs-lookup"><span data-stu-id="613a9-173">Multihome Support</span></span>

<span data-ttu-id="613a9-174">NetX Duo supporta i sistemi connessi a più dispositivi fisici usando una singola istanza IP.</span><span class="sxs-lookup"><span data-stu-id="613a9-174">NetX Duo supports systems connected to multiple physical devices using a single IP instance.</span></span> <span data-ttu-id="613a9-175">Ogni interfaccia fisica viene assegnata a un blocco di controllo dell'interfaccia nell'istanza IP.</span><span class="sxs-lookup"><span data-stu-id="613a9-175">Each physical interface is assigned to an interface control block in the IP instance.</span></span> <span data-ttu-id="613a9-176">Le applicazioni che vogliono usare un sistema multihome devono definire il valore per \***NX_MAX_PHSYCIAL_INTERFACES** _ al numero di dispositivi fisici collegati al sistema e ricompilare la libreria NETX Duo.</span><span class="sxs-lookup"><span data-stu-id="613a9-176">Applications wishing to use a multihome system must define the value for \***NX_MAX_PHSYCIAL_INTERFACES** _ to the number of physical devices attached to the system, and rebuild NetX Duo library.</span></span> <span data-ttu-id="613a9-177">Per impostazione predefinita _ *_NX_MAX_PHYSICAL_INTERFACES_*\* è impostato su uno, creando un blocco di controllo dell'interfaccia nell'istanza IP.</span><span class="sxs-lookup"><span data-stu-id="613a9-177">By default _ *_NX_MAX_PHYSICAL_INTERFACES_*\* is set to one, creating one interface control block in the IP instance.</span></span>

<span data-ttu-id="613a9-178">L'applicazione NetX duo crea una singola istanza IP per il dispositivo primario usando il servizio \***nx_ip_create** _.</span><span class="sxs-lookup"><span data-stu-id="613a9-178">The NetX Duo application creates a single IP instance for the primary device using the \***nx_ip_create** _ service.</span></span> <span data-ttu-id="613a9-179">Per ogni dispositivo di rete aggiuntivo, l'applicazione connette il dispositivo all'istanza IP usando il servizio _ \*_nx_ip_interface_attach_\*\*.</span><span class="sxs-lookup"><span data-stu-id="613a9-179">For each additional network devices, the application attaches the device to the IP instance using the _ *_nx_ip_interface_attach_*\* service.</span></span>

<span data-ttu-id="613a9-180">Ogni struttura di interfaccia di rete contiene un subset di informazioni di rete sull'interfaccia di rete contenuta nel blocco di controllo IP, tra cui indirizzo IPv4 dell'interfaccia, subnet mask, dimensioni MTU IP e informazioni sugli indirizzi del livello MAC.</span><span class="sxs-lookup"><span data-stu-id="613a9-180">Each network interface structure contains a subset of network information about the network interface that is contained in the IP control block, including interface IPv4 address, subnet mask, IP MTU size, and MAC-layer address information.</span></span>

> [!NOTE]
> <span data-ttu-id="613a9-181">*NetX Duo con supporto multihome è compatibile con le versioni precedenti di NetX Duo. I servizi che non accettano informazioni esplicite sull'interfaccia vengono predefiniti per il dispositivo di rete primario.*</span><span class="sxs-lookup"><span data-stu-id="613a9-181">*NetX Duo with multihome support is backward compatible with earlier versions of NetX Duo. Services that do not take explicit interface information default to the primary network device.*</span></span>

<span data-ttu-id="613a9-182">L'interfaccia primaria ha indice zero nell'elenco di istanze IP.</span><span class="sxs-lookup"><span data-stu-id="613a9-182">The primary interface has index zero in the IP instance list.</span></span> <span data-ttu-id="613a9-183">A ogni dispositivo successivo collegato all'istanza IP viene assegnato l'indice successivo.</span><span class="sxs-lookup"><span data-stu-id="613a9-183">Each subsequent device attached to the IP instance is assigned the next index.</span></span>

<span data-ttu-id="613a9-184">Tutti i servizi del protocollo di livello superiore per i quali è abilitata l'istanza IP, inclusi TCP, UDP, ICMP e IGMP, sono disponibili per tutti i dispositivi collegati.</span><span class="sxs-lookup"><span data-stu-id="613a9-184">All upper layer protocol services for which the IP instance is enabled, including TCP, UDP, ICMP, and IGMP, are available to all the attached devices.</span></span>

<span data-ttu-id="613a9-185">Nella maggior parte dei casi, NetX Duo può determinare l'indirizzo di origine migliore da usare durante la trasmissione di un pacchetto.</span><span class="sxs-lookup"><span data-stu-id="613a9-185">In most cases, NetX Duo can determine the best source address to use when transmitting a packet.</span></span> <span data-ttu-id="613a9-186">La selezione dell'indirizzo di origine è basata sull'indirizzo di destinazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-186">The source address selection is based on the destination address.</span></span> <span data-ttu-id="613a9-187">Sono stati aggiunti i servizi NetX Duo per consentire alle applicazioni di specificare un indirizzo di origine specifico da usare, nei casi in cui l'indirizzo di destinazione non può essere determinato da quello più adatto.</span><span class="sxs-lookup"><span data-stu-id="613a9-187">NetX Duo services are added to allow applications to specify a specific source address to use, in cases where the most suitable one cannot be determined by the destination address.</span></span> <span data-ttu-id="613a9-188">Un esempio è costituito da un sistema multihome, un'applicazione deve inviare un pacchetto a una trasmissione IPv4 o a indirizzi di destinazione multicast.</span><span class="sxs-lookup"><span data-stu-id="613a9-188">An example would be in a multihome system, an application needs to send a packet to an IPv4 broadcast or multicast destination addresses.</span></span>

<span data-ttu-id="613a9-189">I servizi specifici per lo sviluppo di applicazioni multihome includono quanto segue:</span><span class="sxs-lookup"><span data-stu-id="613a9-189">Services specifically for developing multihome applications include the following:</span></span>

- <span data-ttu-id="613a9-190">*nx_igmp_multicast_interface_join*</span><span class="sxs-lookup"><span data-stu-id="613a9-190">*nx_igmp_multicast_interface_join*</span></span>
- <span data-ttu-id="613a9-191">*nx_igmp_multicast_interface_leave*</span><span class="sxs-lookup"><span data-stu-id="613a9-191">*nx_igmp_multicast_interface_leave*</span></span>
- <span data-ttu-id="613a9-192">*nx_ip_driver_interface_direct_command*</span><span class="sxs-lookup"><span data-stu-id="613a9-192">*nx_ip_driver_interface_direct_command*</span></span>
- <span data-ttu-id="613a9-193">*nx_ip_interface_address_get*</span><span class="sxs-lookup"><span data-stu-id="613a9-193">*nx_ip_interface_address_get*</span></span>
- <span data-ttu-id="613a9-194">*nx_ip_interface_address_mapping_configure*</span><span class="sxs-lookup"><span data-stu-id="613a9-194">*nx_ip_interface_address_mapping_configure*</span></span>
- <span data-ttu-id="613a9-195">*nx_ip_interface_address_set*</span><span class="sxs-lookup"><span data-stu-id="613a9-195">*nx_ip_interface_address_set*</span></span>  
- <span data-ttu-id="613a9-196">*nx_ip_interface_attach*</span><span class="sxs-lookup"><span data-stu-id="613a9-196">*nx_ip_interface_attach*</span></span>
- <span data-ttu-id="613a9-197">*nx_ip_interface_capability_get*</span><span class="sxs-lookup"><span data-stu-id="613a9-197">*nx_ip_interface_capability_get*</span></span> 
- <span data-ttu-id="613a9-198">*nx_ip_interface_capability_set*</span><span class="sxs-lookup"><span data-stu-id="613a9-198">*nx_ip_interface_capability_set*</span></span>
- <span data-ttu-id="613a9-199">*nx_ip_interface_detach*</span><span class="sxs-lookup"><span data-stu-id="613a9-199">*nx_ip_interface_detach*</span></span>
- <span data-ttu-id="613a9-200">*nx_ip_interface_info_get*</span><span class="sxs-lookup"><span data-stu-id="613a9-200">*nx_ip_interface_info_get*</span></span>
- <span data-ttu-id="613a9-201">*nx_ip_interface_mtu_set*</span><span class="sxs-lookup"><span data-stu-id="613a9-201">*nx_ip_interface_mtu_set*</span></span>
- <span data-ttu-id="613a9-202">*nx_ip_interface_physical_address_get*</span><span class="sxs-lookup"><span data-stu-id="613a9-202">*nx_ip_interface_physical_address_get*</span></span>
- <span data-ttu-id="613a9-203">*nx_ip_interface_physical_address_set*</span><span class="sxs-lookup"><span data-stu-id="613a9-203">*nx_ip_interface_physical_address_set*</span></span>
- <span data-ttu-id="613a9-204">*nx_ip_interface_status_check*</span><span class="sxs-lookup"><span data-stu-id="613a9-204">*nx_ip_interface_status_check*</span></span>
- <span data-ttu-id="613a9-205">*nx_ip_raw_packet_source_send*</span><span class="sxs-lookup"><span data-stu-id="613a9-205">*nx_ip_raw_packet_source_send*</span></span>
- <span data-ttu-id="613a9-206">*nx_ipv4_multicast_interface_join*</span><span class="sxs-lookup"><span data-stu-id="613a9-206">*nx_ipv4_multicast_interface_join*</span></span>
- <span data-ttu-id="613a9-207">*nx_ipv4_multicast_interface_leave*</span><span class="sxs-lookup"><span data-stu-id="613a9-207">*nx_ipv4_multicast_interface_leave*</span></span>
- <span data-ttu-id="613a9-208">*nx_udp_socket_source_send*</span><span class="sxs-lookup"><span data-stu-id="613a9-208">*nx_udp_socket_source_send*</span></span>
- <span data-ttu-id="613a9-209">*nxd_ipv6_multicast_interface_join*</span><span class="sxs-lookup"><span data-stu-id="613a9-209">*nxd_ipv6_multicast_interface_join*</span></span>
- <span data-ttu-id="613a9-210">*nxd_ipv6_multicast_interface_leave*</span><span class="sxs-lookup"><span data-stu-id="613a9-210">*nxd_ipv6_multicast_interface_leave*</span></span> 
- <span data-ttu-id="613a9-211">*nxd_udp_socket_source_send*</span><span class="sxs-lookup"><span data-stu-id="613a9-211">*nxd_udp_socket_source_send*</span></span>
- <span data-ttu-id="613a9-212">*nxd_icmp_source_ping*</span><span class="sxs-lookup"><span data-stu-id="613a9-212">*nxd_icmp_source_ping*</span></span>
- <span data-ttu-id="613a9-213">*nxd_ip_raw_packet_source_send*</span><span class="sxs-lookup"><span data-stu-id="613a9-213">*nxd_ip_raw_packet_source_send*</span></span>
- <span data-ttu-id="613a9-214">*nxd_udp_socket_source_send*</span><span class="sxs-lookup"><span data-stu-id="613a9-214">*nxd_udp_socket_source_send*</span></span>

<span data-ttu-id="613a9-215">Questi servizi sono descritti in modo più dettagliato nella [Descrizione dei servizi NETX Duo](chapter4.md).</span><span class="sxs-lookup"><span data-stu-id="613a9-215">These services are explained in greater detail in [Description of NetX Duo Services](chapter4.md).</span></span>

### <a name="loopback-interface"></a><span data-ttu-id="613a9-216">Interfaccia loopback</span><span class="sxs-lookup"><span data-stu-id="613a9-216">Loopback Interface</span></span>

<span data-ttu-id="613a9-217">L'interfaccia di loopback è un'interfaccia di rete speciale senza collegamento fisico associato a.</span><span class="sxs-lookup"><span data-stu-id="613a9-217">The loopback interface is a special network interface without an physical link attached to.</span></span> <span data-ttu-id="613a9-218">L'interfaccia di loopback consente alle applicazioni di comunicare utilizzando l'indirizzo di loopback IPv4 127.0.0.1 per utilizzare un'interfaccia di loopback logica, assicurarsi che l'opzione configurabile ***NX_DISABLE_LOOPBACK_INTERFACE*** non sia impostata.</span><span class="sxs-lookup"><span data-stu-id="613a9-218">The loopback interface allows applications to communicate using the IPv4 loopback address 127.0.0.1 To utilize a logical loopback interface, ensure the configurable option ***NX_DISABLE_LOOPBACK_INTERFACE*** is not set.</span></span>

### <a name="interface-control-blocks"></a><span data-ttu-id="613a9-219">Blocchi di controllo dell'interfaccia</span><span class="sxs-lookup"><span data-stu-id="613a9-219">Interface Control Blocks</span></span>

<span data-ttu-id="613a9-220">Il numero di blocchi di controllo dell'interfaccia nell'istanza IP è il numero di interfacce fisiche (definite da \***NX_MAX_PHYSICAL_INTERFACES** _) più l'interfaccia di loopback se abilitata.</span><span class="sxs-lookup"><span data-stu-id="613a9-220">The number of interface control blocks in the IP instance is the number of physical interfaces (defined by \***NX_MAX_PHYSICAL_INTERFACES** _) plus the loopback interface if it is enabled.</span></span> <span data-ttu-id="613a9-221">Il numero totale di interfacce è definito in _ *_NX_MAX_IP_INTERFACES_* \*.</span><span class="sxs-lookup"><span data-stu-id="613a9-221">The total number of interfaces is defined in _\*_NX_MAX_IP_INTERFACES_\*\*.</span></span>

## <a name="protocol-layering"></a><span data-ttu-id="613a9-222">Layering del protocollo</span><span class="sxs-lookup"><span data-stu-id="613a9-222">Protocol Layering</span></span>

<span data-ttu-id="613a9-223">Il protocollo TCP/IP implementato da NetX Duo è un protocollo a più livelli, che significa che i protocolli più complessi sono basati su protocolli sottostanti più semplici.</span><span class="sxs-lookup"><span data-stu-id="613a9-223">The TCP/IP implemented by NetX Duo is a layered protocol, which means more complex protocols are built on top of simpler underlying protocols.</span></span> <span data-ttu-id="613a9-224">In TCP/IP, il protocollo di livello più basso si trova a *livello di collegamento* e viene gestito dal driver di rete.</span><span class="sxs-lookup"><span data-stu-id="613a9-224">In TCP/IP, the lowest layer protocol is at the *link level* and is handled by the network driver.</span></span> <span data-ttu-id="613a9-225">Questo livello è in genere destinato a Ethernet, ma può anche essere Fiber, seriale o praticamente qualsiasi supporto fisico.</span><span class="sxs-lookup"><span data-stu-id="613a9-225">This level is typically targeted towards Ethernet, but it could also be fiber, serial, or virtually any physical media.</span></span>

<span data-ttu-id="613a9-226">Sopra il livello di collegamento è il *livello di rete*.</span><span class="sxs-lookup"><span data-stu-id="613a9-226">On top of the link layer is the *network layer*.</span></span> <span data-ttu-id="613a9-227">In TCP/IP, questo è l'indirizzo IP, che è essenzialmente responsabile dell'invio e della ricezione di pacchetti semplici, in modo ottimale, in tutta la rete.</span><span class="sxs-lookup"><span data-stu-id="613a9-227">In TCP/IP, this is the IP, which is basically responsible for sending and receiving simple packets—in a best-effort manner—across the network.</span></span> <span data-ttu-id="613a9-228">I protocolli di tipo gestione come ICMP e IGMP vengono in genere categorizzati anche come livelli di rete, anche se si basano su IP per l'invio e la ricezione.</span><span class="sxs-lookup"><span data-stu-id="613a9-228">Management-type protocols like ICMP and IGMP are typically also categorized as network layers, even though they rely on IP for sending and receiving.</span></span>

<span data-ttu-id="613a9-229">Il *livello di trasporto* è posizionato sopra il livello di rete.</span><span class="sxs-lookup"><span data-stu-id="613a9-229">The *transport layer* rests on top of the network layer.</span></span> <span data-ttu-id="613a9-230">Questo livello è responsabile della gestione del flusso di dati tra gli host nella rete.</span><span class="sxs-lookup"><span data-stu-id="613a9-230">This layer is responsible for managing the flow of data between hosts on the network.</span></span> <span data-ttu-id="613a9-231">Sono disponibili due tipi di servizi di trasporto supportati da NetX Duo: UDP e TCP.</span><span class="sxs-lookup"><span data-stu-id="613a9-231">There are two types of transport services supported by NetX Duo: UDP and TCP.</span></span> <span data-ttu-id="613a9-232">I servizi UDP garantiscono l'invio e la ricezione dei dati tra due host senza connessione, mentre TCP fornisce un servizio affidabile orientato alla connessione tra due entità host.</span><span class="sxs-lookup"><span data-stu-id="613a9-232">UDP services provide best-effort sending and receiving of data between two hosts in a connectionless manner, while TCP provides reliable connection-oriented service between two host entities.</span></span>

<span data-ttu-id="613a9-233">Questo livello viene riflesso nei pacchetti di dati di rete effettivi.</span><span class="sxs-lookup"><span data-stu-id="613a9-233">This layering is reflected in the actual network data packets.</span></span> <span data-ttu-id="613a9-234">Ogni livello in TCP/IP contiene un blocco di informazioni denominato intestazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-234">Each layer in TCP/IP contains a block of information called a header.</span></span> <span data-ttu-id="613a9-235">Questa tecnica relativa ai dati circostanti (e possibilmente alle informazioni sul protocollo) con un'intestazione viene in genere chiamata incapsulamento dei dati.</span><span class="sxs-lookup"><span data-stu-id="613a9-235">This technique of surrounding data (and possibly protocol information) with a header is typically called data encapsulation.</span></span> <span data-ttu-id="613a9-236">Nella figura 1 viene illustrato un esempio di livello NetX Duo e nella figura 2 viene illustrato l'incapsulamento dei dati risultante per i dati UDP inviati.</span><span class="sxs-lookup"><span data-stu-id="613a9-236">Figure 1 shows an example of NetX Duo layering and Figure 2 shows the resulting data encapsulation for UDP data being sent.</span></span>

![Layering del protocollo](./media/user-guide/image12.jpg)

<span data-ttu-id="613a9-238">**FIGURA 1. Layering del protocollo**</span><span class="sxs-lookup"><span data-stu-id="613a9-238">**FIGURE 1. Protocol Layering**</span></span>

## <a name="packet-pools"></a><span data-ttu-id="613a9-239">Pool di pacchetti</span><span class="sxs-lookup"><span data-stu-id="613a9-239">Packet Pools</span></span>

<span data-ttu-id="613a9-240">L'allocazione di pacchetti in modo rapido e deterministico è sempre una sfida nelle applicazioni di rete in tempo reale.</span><span class="sxs-lookup"><span data-stu-id="613a9-240">Allocating packets in a fast and deterministic manner is always a challenge in real-time networking applications.</span></span> <span data-ttu-id="613a9-241">Tenendo presente questo aspetto, NetX Duo fornisce la possibilità di creare e gestire più pool di pacchetti di rete a dimensione fissa.</span><span class="sxs-lookup"><span data-stu-id="613a9-241">With this in mind, NetX Duo provides the ability to create and manage multiple pools of fixed-size network packets.</span></span>

<span data-ttu-id="613a9-242">Poiché i pool di pacchetti NetX Duo sono costituiti da blocchi di memoria a dimensione fissa, non si verificano mai problemi di frammentazione interna.</span><span class="sxs-lookup"><span data-stu-id="613a9-242">Because NetX Duo packet pools consist of fixed-size memory blocks, there are never any internal fragmentation problems.</span></span> <span data-ttu-id="613a9-243">Naturalmente, la frammentazione causa comportamenti intrinsecamente non deterministici.</span><span class="sxs-lookup"><span data-stu-id="613a9-243">Of course, fragmentation causes behavior that is inherently nondeterministic.</span></span> <span data-ttu-id="613a9-244">Inoltre, il tempo necessario per allocare e liberare un pacchetto NetX Duo equivale a una semplice manipolazione di elenchi collegati.</span><span class="sxs-lookup"><span data-stu-id="613a9-244">In addition, the time required to allocate and free a NetX Duo packet amounts to simple linked-list manipulation.</span></span> <span data-ttu-id="613a9-245">Inoltre, l'allocazione e la deallocazione dei pacchetti vengono eseguite all'inizio dell'elenco disponibile.</span><span class="sxs-lookup"><span data-stu-id="613a9-245">Furthermore, packet allocation and deallocation is done at the head of the available list.</span></span> <span data-ttu-id="613a9-246">In questo modo si fornisce l'elaborazione dell'elenco collegato più veloce possibile.</span><span class="sxs-lookup"><span data-stu-id="613a9-246">This provides the fastest possible linked list processing.</span></span>

![Incapsulamento dei dati UDP](./media/user-guide/image13.png)

<span data-ttu-id="613a9-248">**FIGURA 2. Incapsulamento dei dati UDP**</span><span class="sxs-lookup"><span data-stu-id="613a9-248">**FIGURE 2. UDP Data Encapsulation**</span></span>

<span data-ttu-id="613a9-249">La mancanza di flessibilità è in genere lo svantaggio principale dei pool di pacchetti a dimensione fissa.</span><span class="sxs-lookup"><span data-stu-id="613a9-249">Lack of flexibility is typically the main drawback of fixed-size packet pools.</span></span> <span data-ttu-id="613a9-250">Determinare le dimensioni del payload dei pacchetti ottimali che gestiscono anche il pacchetto in ingresso peggiore è un'attività difficile.</span><span class="sxs-lookup"><span data-stu-id="613a9-250">Determining the optimal packet payload size that also handles the worst-case incoming packet is a difficult task.</span></span> <span data-ttu-id="613a9-251">I pacchetti NetX Duo affrontano questo problema con una funzionalità facoltativa denominata concatenamento dei pacchetti.</span><span class="sxs-lookup"><span data-stu-id="613a9-251">NetX Duo packets address this problem with an optional feature called packet chaining.</span></span> <span data-ttu-id="613a9-252">Un pacchetto di rete effettivo può essere composto da uno o più pacchetti NetX Duo collegati tra loro.</span><span class="sxs-lookup"><span data-stu-id="613a9-252">An actual network packet can be made of one or more NetX Duo packets linked together.</span></span> <span data-ttu-id="613a9-253">Inoltre, l'intestazione del pacchetto mantiene un puntatore all'inizio del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="613a9-253">In addition, the packet header maintains a pointer to the top of the packet.</span></span> <span data-ttu-id="613a9-254">Quando vengono aggiunti altri protocolli, questo puntatore viene semplicemente spostato all'indietro e la nuova intestazione viene scritta direttamente davanti ai dati.</span><span class="sxs-lookup"><span data-stu-id="613a9-254">As additional protocols are added, this pointer is simply moved backwards and the new header is written directly in front of the data.</span></span> <span data-ttu-id="613a9-255">Senza la tecnologia flessibile dei pacchetti, lo stack dovrebbe allocare un altro buffer e copiare i dati in un nuovo buffer con la nuova intestazione, che sta elaborando in modo intensivo.</span><span class="sxs-lookup"><span data-stu-id="613a9-255">Without the flexible packet technology, the stack would have to allocate another buffer and copy the data into a new buffer with the new header, which is processing intensive.</span></span>

<span data-ttu-id="613a9-256">Poiché le dimensioni del payload del pacchetto sono fisse per un determinato pool di pacchetti, i dati dell'applicazione più grandi delle dimensioni del payload richiederebbero più pacchetti concatenati.</span><span class="sxs-lookup"><span data-stu-id="613a9-256">Since each packet payload size is fixed for a given packet pool, application data larger than the payload size would require multiple packets chained together.</span></span> <span data-ttu-id="613a9-257">Quando si compila un pacchetto con dati utente, l'applicazione utilizzerà il servizio ***nx_packet_data_append***.</span><span class="sxs-lookup"><span data-stu-id="613a9-257">When filling a packet with user data, the application shall use the service ***nx_packet_data_append***.</span></span> <span data-ttu-id="613a9-258">Questo servizio sposta i dati dell'applicazione in un pacchetto.</span><span class="sxs-lookup"><span data-stu-id="613a9-258">This service moves application data into a packet.</span></span> <span data-ttu-id="613a9-259">Nei casi in cui un pacchetto non è sufficiente per contenere i dati utente, vengono allocati pacchetti aggiuntivi per archiviare i dati utente.</span><span class="sxs-lookup"><span data-stu-id="613a9-259">In situations where a packet is not enough to hold user data, additional packets are allocated to store user data.</span></span> <span data-ttu-id="613a9-260">Per utilizzare il concatenamento dei pacchetti, il driver deve essere in grado di ricevere o trasmettere da pacchetti concatenati.</span><span class="sxs-lookup"><span data-stu-id="613a9-260">To use packet chaining, the driver must be able to receive into or transmit from chained packets.</span></span>

<span data-ttu-id="613a9-261">Per i sistemi incorporati che non devono utilizzare la funzionalità di concatenamento dei pacchetti, la libreria NetX Duo può essere compilata con \***NX_DISABLE_PACKET_CHAIN** _ per rimuovere la logica di concatenamento dei pacchetti.</span><span class="sxs-lookup"><span data-stu-id="613a9-261">For embedded systems that do not need to use the packet chaining feature, the NetX Duo library can be built with \***NX_DISABLE_PACKET_CHAIN** _ to remove the packet chaining logic.</span></span> <span data-ttu-id="613a9-262">Si noti che la frammentazione IP e la funzionalità di riassemblaggio potrebbero dover utilizzare la funzionalità dei pacchetti concatenati.</span><span class="sxs-lookup"><span data-stu-id="613a9-262">Note that the IP fragmentation and reassembly feature may need to utilize the chained packet feature.</span></span> <span data-ttu-id="613a9-263">Di conseguenza, la definizione di _*_NX_DISABLE_PACKET_CHAIN_*_ richiede anche la definizione di _ \*_NX_DISABLE_FRAGMENTATION_\*\*.</span><span class="sxs-lookup"><span data-stu-id="613a9-263">Therefore defining _*_NX_DISABLE_PACKET_CHAIN_*_ requires _ *_NX_DISABLE_FRAGMENTATION_*\* also be defined.</span></span> 

<span data-ttu-id="613a9-264">Ogni pool di memoria del pacchetto NetX Duo è una risorsa pubblica.</span><span class="sxs-lookup"><span data-stu-id="613a9-264">Each NetX Duo packet memory pool is a public resource.</span></span> <span data-ttu-id="613a9-265">NetX Duo non pone vincoli sulla modalità di utilizzo di pool di pacchetti.</span><span class="sxs-lookup"><span data-stu-id="613a9-265">NetX Duo places no constraints on how packet pools are used.</span></span> 

### <a name="packet-pool-memory-area"></a><span data-ttu-id="613a9-266">Area memoria pool di pacchetti</span><span class="sxs-lookup"><span data-stu-id="613a9-266">Packet Pool Memory Area</span></span>

<span data-ttu-id="613a9-267">L'area di memoria per il pool di pacchetti viene specificata durante la creazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-267">The memory area for the packet pool is specified during creation.</span></span> <span data-ttu-id="613a9-268">Analogamente ad altre aree di memoria per gli oggetti ThreadX e NetX Duo, può trovarsi in qualsiasi punto dello spazio degli indirizzi della destinazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-268">Like other memory areas for ThreadX and NetX Duo objects, it can be located anywhere in the target's address space.</span></span> 

<span data-ttu-id="613a9-269">Si tratta di una funzionalità importante grazie alla notevole flessibilità offerta dall'applicazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-269">This is an important feature because of the considerable flexibility it gives the application.</span></span> <span data-ttu-id="613a9-270">Si supponga, ad esempio, che un prodotto di comunicazione disponga di un'area di memoria ad alta velocità per i buffer di rete.</span><span class="sxs-lookup"><span data-stu-id="613a9-270">For example, suppose that a communication product has a high-speed memory area for network buffers.</span></span> <span data-ttu-id="613a9-271">Questa area di memoria è facilmente utilizzabile rendendola in un pool di memoria pacchetti NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="613a9-271">This memory area is easily utilized by making it into a NetX Duo packet memory pool.</span></span>

### <a name="creating-packet-pools"></a><span data-ttu-id="613a9-272">Creazione di pool di pacchetti</span><span class="sxs-lookup"><span data-stu-id="613a9-272">Creating Packet Pools</span></span>

<span data-ttu-id="613a9-273">I pool di pacchetti vengono creati durante l'inizializzazione o durante la fase di esecuzione dai thread dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-273">Packet pools are created either during initialization or during runtime by  application threads.</span></span> <span data-ttu-id="613a9-274">Non sono previsti limiti per il numero di pool di memoria pacchetti in un'applicazione NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="613a9-274">There are no limits on the number of packet memory pools in a NetX Duo application.</span></span>

### <a name="dual-packet-pool"></a><span data-ttu-id="613a9-275">Pool di pacchetti doppio</span><span class="sxs-lookup"><span data-stu-id="613a9-275">Dual Packet Pool</span></span>

<span data-ttu-id="613a9-276">In genere, le dimensioni del payload del pool di pacchetti IP predefinito sono sufficienti a supportare le dimensioni dei fotogrammi fino alla MTU dell'interfaccia di rete.</span><span class="sxs-lookup"><span data-stu-id="613a9-276">Typically the payload size of the default IP packet pool is large enough to accommodate frame size up to the network interface MTU.</span></span> <span data-ttu-id="613a9-277">Durante il normale funzionamento, il thread IP deve inviare messaggi quali ARP, i messaggi di controllo TCP, i messaggi IGMP, i messaggi ICMPv6.</span><span class="sxs-lookup"><span data-stu-id="613a9-277">During normal operation, the IP thread needs to send messages such as ARP, TCP control messages, IGMP messages, ICMPv6 messages.</span></span> <span data-ttu-id="613a9-278">Questi messaggi usano i pacchetti allocati dal pool di pacchetti predefinito nell'istanza IP.</span><span class="sxs-lookup"><span data-stu-id="613a9-278">These messages use the packets allocated from the default packet pool in the IP instance.</span></span> <span data-ttu-id="613a9-279">In un sistema con vincoli di memoria in cui la quantità di memoria disponibile per il pool di pacchetti è limitata, l'uso di un singolo pool di pacchetti (con le dimensioni del payload elevato per la corrispondenza delle dimensioni MTU) potrebbe non essere una soluzione ottimale.</span><span class="sxs-lookup"><span data-stu-id="613a9-279">On a memory-constrained system where the amount of memory available for packet pool is limited, using a single packet pool (with the large payload size to match MTU size) may not be an optimal solution.</span></span> <span data-ttu-id="613a9-280">NetX Duo consente all'applicazione di installare un pool di pacchetti ausiliario, in cui le dimensioni del payload sono inferiori.</span><span class="sxs-lookup"><span data-stu-id="613a9-280">NetX Duo allows application to install an auxiliary packet pool, where the payload size is smaller.</span></span> <span data-ttu-id="613a9-281">Una volta installato il pool di pacchetti ausiliario, il thread helper IP alloca i pacchetti dal pool di pacchetti predefinito o dal pool ausiliario, a seconda delle dimensioni del messaggio trasmesso.</span><span class="sxs-lookup"><span data-stu-id="613a9-281">Once the auxiliary packet pool is installed, the IP helper thread would allocate packets from either the default packet pool or the auxiliary pool, depending on the size of the message it transmits.</span></span> <span data-ttu-id="613a9-282">Per un pool di pacchetti ausiliari, le dimensioni del payload di 200 byte funzionano con la maggior parte dei messaggi trasmessi dal thread helper IP.</span><span class="sxs-lookup"><span data-stu-id="613a9-282">For an auxiliary packet pool, a payload size of 200 bytes would work with most of the messages the IP helper thread transmits.</span></span>

<span data-ttu-id="613a9-283">Per impostazione predefinita, la libreria NetX Duo è compilata senza abilitare il pool di pacchetti doppio.</span><span class="sxs-lookup"><span data-stu-id="613a9-283">By default NetX Duo library is built without enabling dual packet pool.</span></span> <span data-ttu-id="613a9-284">Per abilitare la funzionalità, compilare la libreria con \***NX_DUAL_PACKET_POOL_ENABLE** _ defined.</span><span class="sxs-lookup"><span data-stu-id="613a9-284">To enable the feature, build the library with \***NX_DUAL_PACKET_POOL_ENABLE** _ defined.</span></span> <span data-ttu-id="613a9-285">Il pool di pacchetti ausiliario può essere impostato chiamando _ *_nx_ip_auxiliary_packet_pool_set_* \*.</span><span class="sxs-lookup"><span data-stu-id="613a9-285">Then the auxiliary packet pool can be set by calling _\*_nx_ip_auxiliary_packet_pool_set_\*\*.</span></span>

<span data-ttu-id="613a9-286">È anche possibile creare più di un pool di pacchetti.</span><span class="sxs-lookup"><span data-stu-id="613a9-286">There is also the option of creating more than one packet pool.</span></span> <span data-ttu-id="613a9-287">Ad esempio, un pool di pacchetti di trasmissione viene creato con una dimensione ottimale del payload per le dimensioni dei messaggi previsti.</span><span class="sxs-lookup"><span data-stu-id="613a9-287">For example a transmit packet pool is created with optimal payload size for expected message sizes.</span></span> <span data-ttu-id="613a9-288">Un pool di pacchetti di ricezione viene creato nel driver con le dimensioni del payload impostate sul valore MTU del driver, perché non è possibile stimare le dimensioni dei pacchetti ricevuti.</span><span class="sxs-lookup"><span data-stu-id="613a9-288">A receive packet pool is created in the driver with a payload size set to the driver MTU, since one cannot predict the size of received packets.</span></span>

### <a name="packet-header-nx_packet"></a><span data-ttu-id="613a9-289">NX_PACKET intestazione pacchetto</span><span class="sxs-lookup"><span data-stu-id="613a9-289">Packet Header NX_PACKET</span></span>   
<span data-ttu-id="613a9-290">Per impostazione predefinita, NetX Duo posiziona l'intestazione del pacchetto immediatamente prima dell'area del payload del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="613a9-290">By default, NetX Duo places the packet header immediately before the packet payload area.</span></span> <span data-ttu-id="613a9-291">Il pool di memoria pacchetti è fondamentalmente una serie di pacchetti, ovvero le intestazioni seguite immediatamente dal payload del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="613a9-291">The packet memory pool is basically a series of packets— headers followed immediately by the packet payload.</span></span> <span data-ttu-id="613a9-292">L'intestazione del pacchetto (***NX_PACKET***) e il layout del pool di pacchetti sono illustrati nella figura 3.</span><span class="sxs-lookup"><span data-stu-id="613a9-292">The packet header (***NX_PACKET***) and the layout of the packet pool are pictured in Figure 3.</span></span>

<span data-ttu-id="613a9-293">Per i driver dei dispositivi di rete che sono in grado di eseguire zero operazioni di copia, in genere l'indirizzo iniziale dell'area del payload del pacchetto viene programmato nella logica DMA.</span><span class="sxs-lookup"><span data-stu-id="613a9-293">For network devices driver that are able to perform zero copy operations, typically the starting address of the packet payload area is programmed into the DMA logic.</span></span> <span data-ttu-id="613a9-294">Alcuni motori DMA hanno requisiti di allineamento nell'area del payload.</span><span class="sxs-lookup"><span data-stu-id="613a9-294">Certain DMA engines have alignment requirement on the payload area.</span></span> <span data-ttu-id="613a9-295">Per rendere l'indirizzo iniziale dell'area di payload allineato correttamente per il motore DMA o l'operazione della cache, l'utente può definire il simbolo ***NX_PACKET_ALIGNMENT***.</span><span class="sxs-lookup"><span data-stu-id="613a9-295">To make the starting address of the payload area align properly for the DMA engine, or the cache operation, the user can define the symbol ***NX_PACKET_ALIGNMENT***.</span></span>

> [!WARNING]
> <span data-ttu-id="613a9-296">*È importante che il driver di rete usi la funzione **nx_packet_transmit_release** al termine della trasmissione di un pacchetto. Questa funzione verifica che il pacchetto non faccia parte di una coda di output TCP prima che venga effettivamente inserito nel pool disponibile.*</span><span class="sxs-lookup"><span data-stu-id="613a9-296">*It is important for the network driver to use the **nx_packet_transmit_release** function when transmission of a packet is complete. This function checks to make sure the packet is not part of a TCP output queue before it is actually placed back in the available pool.*</span></span>

![Layout dell'intestazione e del pool di pacchetti](./media/user-guide/image14.jpg)

<span data-ttu-id="613a9-298">**FIGURA 3. Layout dell'intestazione e del pool di pacchetti**</span><span class="sxs-lookup"><span data-stu-id="613a9-298">**FIGURE 3. Packet Header and Packet Pool Layout**</span></span>

<span data-ttu-id="613a9-299">I campi dell'intestazione del pacchetto sono definiti nel modo seguente.</span><span class="sxs-lookup"><span data-stu-id="613a9-299">The fields of the packet header are defined as follows.</span></span> <span data-ttu-id="613a9-300">Si noti che questa tabella non è un elenco completo di tutti i membri della struttura *NX_PACKET* .</span><span class="sxs-lookup"><span data-stu-id="613a9-300">Note that this table is not a comprehensive list of all the members in the *NX_PACKET* structure.</span></span>

|<span data-ttu-id="613a9-301">Intestazione pacchetto</span><span class="sxs-lookup"><span data-stu-id="613a9-301">Packet header</span></span> | <span data-ttu-id="613a9-302">Scopo</span><span class="sxs-lookup"><span data-stu-id="613a9-302">Purpose</span></span> |
|---|---|
|<span data-ttu-id="613a9-303">***nx_packet_pool_owner***</span><span class="sxs-lookup"><span data-stu-id="613a9-303">***nx_packet_pool_owner***</span></span>|<span data-ttu-id="613a9-304">Questo campo fa riferimento al pool di pacchetti proprietario del pacchetto specifico.</span><span class="sxs-lookup"><span data-stu-id="613a9-304">This field points to the packet pool that owns this particular packet.</span></span> <span data-ttu-id="613a9-305">Quando il pacchetto viene rilasciato, viene rilasciato a questo particolare pool.</span><span class="sxs-lookup"><span data-stu-id="613a9-305">When the packet is released, it is released to this particular pool.</span></span> <span data-ttu-id="613a9-306">Con la proprietà del pool all'interno di ogni pacchetto, è possibile che un datagramma si estenda su più pacchetti da più pool di pacchetti.</span><span class="sxs-lookup"><span data-stu-id="613a9-306">With the pool ownership inside each packet, it is possible for a datagram to span multiple packets from multiple packet pools.</span></span>|
|<span data-ttu-id="613a9-307">\***nx_packet_next** _</span><span class="sxs-lookup"><span data-stu-id="613a9-307">\***nx_packet_next** _</span></span>|<span data-ttu-id="613a9-308">Questo campo fa riferimento al pacchetto successivo all'interno dello stesso frame.</span><span class="sxs-lookup"><span data-stu-id="613a9-308">This field points to the next packet within the same frame.</span></span> <span data-ttu-id="613a9-309">Se è NULL, non sono presenti pacchetti aggiuntivi che fanno parte del frame.</span><span class="sxs-lookup"><span data-stu-id="613a9-309">If NULL, there are no additional packets that are part of the frame.</span></span> <span data-ttu-id="613a9-310">Questo campo viene usato anche per contenere pacchetti frammentati fino a quando non è possibile riassemblare l'intero pacchetto.</span><span class="sxs-lookup"><span data-stu-id="613a9-310">This field is also used to hold fragmented packets until the entire packet can be re-assembled.</span></span> <span data-ttu-id="613a9-311">viene rimosso se _ *_NX_DISABLE_PACKET_CHAIN_* \* è definito.</span><span class="sxs-lookup"><span data-stu-id="613a9-311">it is removed if _\*_NX_DISABLE_PACKET_CHAIN_\*\*is defined.</span></span>|
|<span data-ttu-id="613a9-312">\***nx_packet_last** _</span><span class="sxs-lookup"><span data-stu-id="613a9-312">\***nx_packet_last** _</span></span>|<span data-ttu-id="613a9-313">Questo campo punta all'ultimo pacchetto all'interno dello stesso pacchetto di rete.</span><span class="sxs-lookup"><span data-stu-id="613a9-313">This field points to the last packet within the same network packet.</span></span> <span data-ttu-id="613a9-314">Se NULL, questo pacchetto rappresenta l'intero pacchetto di rete.</span><span class="sxs-lookup"><span data-stu-id="613a9-314">If NULL, this packet represents the entire network packet.</span></span> <span data-ttu-id="613a9-315">Questo campo viene rimosso se _ *_NX_DISABLE_PACKET_CHAIN_* \* è definito.</span><span class="sxs-lookup"><span data-stu-id="613a9-315">This field is removed if _\*_NX_DISABLE_PACKET_CHAIN_\*\*is defined.</span></span>|
|<span data-ttu-id="613a9-316">\***nx_packet_length** _</span><span class="sxs-lookup"><span data-stu-id="613a9-316">\***nx_packet_length** _</span></span>| <span data-ttu-id="613a9-317">Questo campo contiene il numero totale di byte nell'intero pacchetto di rete, incluso il totale di tutti i byte in tutti i pacchetti concatenati dal membro _nx_packet_next \*.</span><span class="sxs-lookup"><span data-stu-id="613a9-317">This field contains the total number of bytes in the entire network packet, including the total of all bytes in all packets chained together by the _nx_packet_next\*member.</span></span>|
|<span data-ttu-id="613a9-318">***nx_packet_ip_interface***</span><span class="sxs-lookup"><span data-stu-id="613a9-318">***nx_packet_ip_interface***</span></span>| <span data-ttu-id="613a9-319">Questo campo è il blocco di controllo dell'interfaccia che viene assegnato al pacchetto quando viene ricevuto dal driver di interfaccia e da NetX Duo per i pacchetti in uscita.</span><span class="sxs-lookup"><span data-stu-id="613a9-319">This field is the interface control block which is assigned to the packet when it is received by the interface driver, and by NetX Duo for outgoing packets.</span></span> <span data-ttu-id="613a9-320">Un blocco di controllo dell'interfaccia descrive l'interfaccia, ad esempio l'indirizzo di rete, l'indirizzo MAC, l'indirizzo IP e lo stato dell'interfaccia, ad esempio collegamento abilitato e mapping fisico obbligatorio.</span><span class="sxs-lookup"><span data-stu-id="613a9-320">An interface control block describes the interface e.g. network address, MAC address, IP address and interface status such as link enabled and physical mapping required.</span></span>|
|<span data-ttu-id="613a9-321">\***nx_packet_data_start** _</span><span class="sxs-lookup"><span data-stu-id="613a9-321">\***nx_packet_data_start** _</span></span>| <span data-ttu-id="613a9-322">Questo campo punta all'inizio dell'area del payload fisico del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="613a9-322">This field points to the start of the physical payload area of this packet.</span></span> <span data-ttu-id="613a9-323">Non è necessario che si trovi immediatamente dopo l'intestazione NX_PACKET, ma è l'impostazione predefinita per il servizio _ \*_nx_packet_pool_create_\*\*.</span><span class="sxs-lookup"><span data-stu-id="613a9-323">It does not have to be immediately following the NX_PACKET header, but that is the default for the _ *_nx_packet_pool_create_*\* service.</span></span>|
|<span data-ttu-id="613a9-324">\***nx_packet_data_end** _</span><span class="sxs-lookup"><span data-stu-id="613a9-324">\***nx_packet_data_end** _</span></span>|<span data-ttu-id="613a9-325">Questo campo punta alla fine dell'area del payload fisico del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="613a9-325">This field points to the end of the physical payload area of this packet.</span></span> <span data-ttu-id="613a9-326">La differenza tra questo campo e il campo _nx_packet_data_start \* rappresenta le dimensioni del payload.</span><span class="sxs-lookup"><span data-stu-id="613a9-326">The difference between this field and the _nx_packet_data_start\* field represents the payload size.</span></span>|
|<span data-ttu-id="613a9-327">\***nx_packet_prepend_ptr** _</span><span class="sxs-lookup"><span data-stu-id="613a9-327">\***nx_packet_prepend_ptr** _</span></span>|<span data-ttu-id="613a9-328">Questo campo fa riferimento alla posizione in cui vengono aggiunti i dati dei pacchetti, ovvero l'intestazione del protocollo o i dati effettivi, davanti ai dati dei pacchetti esistenti (se presenti) nell'area del payload del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="613a9-328">This field points to the location of where packet data, either protocol header or actual data, is added in front of the existing packet data (if any) in the packet payload area.</span></span> <span data-ttu-id="613a9-329">Deve essere maggiore o uguale alla posizione del puntatore _nx_packet_data_start \* e minore o uguale al puntatore di *nx_packet_append_ptr* .</span><span class="sxs-lookup"><span data-stu-id="613a9-329">It must be greater than or equal to the _nx_packet_data_start\* pointer location and less than or equal to the *nx_packet_append_ptr* pointer.</span></span>|
> [!CAUTION]
> <span data-ttu-id="613a9-330">*Per motivi di prestazioni, NetX Duo presuppone che, quando il pacchetto viene passato ai servizi di NetX Duo per la trasmissione, il puntatore anteposto punti all'indirizzo allineato a parole lunghe.*</span><span class="sxs-lookup"><span data-stu-id="613a9-330">*For performance reasons, NetX Duo assumes that when the packet is passed into NetX Duo services for transmission, the prepend pointer points to long word aligned address.*</span></span>

|   |   |
|---|---|
|<span data-ttu-id="613a9-331">\***nx_packet_append_ptr** _</span><span class="sxs-lookup"><span data-stu-id="613a9-331">\***nx_packet_append_ptr** _</span></span>|<span data-ttu-id="613a9-332">Questo campo punta alla fine dei dati attualmente presenti nell'area del payload del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="613a9-332">This field points to the end of the data currently in the packet payload area.</span></span> <span data-ttu-id="613a9-333">Deve trovarsi tra la posizione di memoria a cui punta _nx_packet_prepend_ptr \* e *nx_packet_data_end.*</span><span class="sxs-lookup"><span data-stu-id="613a9-333">It must be in between the memory location pointed to by _nx_packet_prepend_ptr\* and *nx_packet_data_end.*</span></span> <span data-ttu-id="613a9-334">La differenza tra questo campo e il campo *nx_packet_prepend_ptr* rappresenta la quantità di dati in questo pacchetto.</span><span class="sxs-lookup"><span data-stu-id="613a9-334">The difference between this field and the *nx_packet_prepend_ptr* field represents the amount of data in this packet.</span></span>|
|<span data-ttu-id="613a9-335">\***nx_packet_packet_pad** _</span><span class="sxs-lookup"><span data-stu-id="613a9-335">\***nx_packet_packet_pad** _</span></span>|<span data-ttu-id="613a9-336">Questo campo definisce la lunghezza del riempimento in parole a 4 byte per ottenere il requisito di allineamento desiderato.</span><span class="sxs-lookup"><span data-stu-id="613a9-336">This fields defines the length of padding in 4-byte words to achieve the desired alignment requirement.</span></span> <span data-ttu-id="613a9-337">Questo campo viene rimosso se _*_NX_PACKET_HEADER_PAD_*_ non è definito.</span><span class="sxs-lookup"><span data-stu-id="613a9-337">This field is removed if _*_NX_PACKET_HEADER_PAD_*_ is not defined.</span></span> <span data-ttu-id="613a9-338">In alternativa, è possibile usare _*_NX_PACKET_ALIGNMENT_*_ anziché definire _nx_packet_header_pad. \*</span><span class="sxs-lookup"><span data-stu-id="613a9-338">Alternatively _*_NX_PACKET_ALIGNMENT_*_ can be used instead of defining _nx_packet_header_pad.\*</span></span>|

### <a name="packet-header-offsets"></a><span data-ttu-id="613a9-339">Offset dell'intestazione del pacchetto</span><span class="sxs-lookup"><span data-stu-id="613a9-339">Packet Header Offsets</span></span>

<span data-ttu-id="613a9-340">Le dimensioni dell'intestazione del pacchetto sono definite in modo da consentire spazio sufficiente per contenere le dimensioni dell'intestazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-340">Packet header size is defined to allow enough room  to accommodate the size of the header.</span></span> <span data-ttu-id="613a9-341">Il servizio ***nx_packet_allocate*** viene utilizzato per allocare un pacchetto e per regolare il puntatore anteposto nel pacchetto in base al tipo di pacchetto specificato.</span><span class="sxs-lookup"><span data-stu-id="613a9-341">The ***nx_packet_allocate*** service is used to allocate a packet and adjusts the prepend pointer in the packet according to the type of packet specified.</span></span> <span data-ttu-id="613a9-342">Il tipo di pacchetto indica a NetX Duo l'offset necessario per inserire l'intestazione del protocollo, ad esempio UDP, TCP o ICMP, davanti ai dati del protocollo.</span><span class="sxs-lookup"><span data-stu-id="613a9-342">The packet type tells NetX Duo the offset required for inserting the protocol header (such as UDP, TCP, or ICMP) in front of the protocol data.</span></span>

<span data-ttu-id="613a9-343">I tipi seguenti sono definiti in NetX Duo per prendere in considerazione l'intestazione IP e l'intestazione del livello fisico (Ethernet) nel pacchetto.</span><span class="sxs-lookup"><span data-stu-id="613a9-343">The following types are defined in NetX Duo to take into account the IP header and physical layer (Ethernet) header in the packet.</span></span> <span data-ttu-id="613a9-344">Nel secondo caso, si presuppone che sia 16 byte tenendo in considerazione l'allineamento richiesto di 4 byte.</span><span class="sxs-lookup"><span data-stu-id="613a9-344">In the latter case, it is assumed to be 16 bytes taking the required 4-byte alignment into consideration.</span></span> <span data-ttu-id="613a9-345">I pacchetti IPv4 sono ancora definiti in NetX Duo per le applicazioni per l'allocazione di pacchetti per reti IPv4.</span><span class="sxs-lookup"><span data-stu-id="613a9-345">IPv4 packets are still defined in NetX Duo for applications to allocate packets for IPv4 networks.</span></span> <span data-ttu-id="613a9-346">Si noti che se la libreria NetX Duo è compilata con IPv6 abilitato, i tipi di pacchetti generici (ad esempio NX_IP_PACKET) vengono mappati alla versione IPv6.</span><span class="sxs-lookup"><span data-stu-id="613a9-346">Note that if the NetX Duo library is built with IPv6 enabled, the generic packet types (such as NX_IP_PACKET) are mapped to the IPv6 version.</span></span> <span data-ttu-id="613a9-347">Se la libreria NetX Duo è compilata senza IPv6 abilitato, viene eseguito il mapping di questi tipi di pacchetti generici alla versione IPv4.</span><span class="sxs-lookup"><span data-stu-id="613a9-347">If the NetX Duo Library is built without IPv6 enabled, these generic packet types are mapped to the IPv4 version.</span></span>

<span data-ttu-id="613a9-348">La tabella seguente illustra i simboli definiti con IPv6 abilitato:</span><span class="sxs-lookup"><span data-stu-id="613a9-348">The following table shows symbols defined with IPv6 enabled:</span></span>

|<span data-ttu-id="613a9-349">**Tipo di pacchetto**</span><span class="sxs-lookup"><span data-stu-id="613a9-349">**Packet Type**</span></span> |<span data-ttu-id="613a9-350">**Valore**</span><span class="sxs-lookup"><span data-stu-id="613a9-350">**Value**</span></span> |
|---|---|
|<span data-ttu-id="613a9-351">NX_IPv6_PACKET (NX_IP_PACKET)</span><span class="sxs-lookup"><span data-stu-id="613a9-351">NX_IPv6_PACKET (NX_IP_PACKET)</span></span> | <span data-ttu-id="613a9-352">0x38</span><span class="sxs-lookup"><span data-stu-id="613a9-352">0x38</span></span> |
|<span data-ttu-id="613a9-353">NX_UDPv6_PACKET (NX_UDP_PACKET)</span><span class="sxs-lookup"><span data-stu-id="613a9-353">NX_UDPv6_PACKET (NX_UDP_PACKET)</span></span> |<span data-ttu-id="613a9-354">0x40</span><span class="sxs-lookup"><span data-stu-id="613a9-354">0x40</span></span> |
|<span data-ttu-id="613a9-355">NX_TCPv6_PACKET (NX_TCP_PACKET)</span><span class="sxs-lookup"><span data-stu-id="613a9-355">NX_TCPv6_PACKET (NX_TCP_PACKET)</span></span> |<span data-ttu-id="613a9-356">0x4c</span><span class="sxs-lookup"><span data-stu-id="613a9-356">0x4c</span></span> |
|<span data-ttu-id="613a9-357">NX_IPv4_PACKET</span><span class="sxs-lookup"><span data-stu-id="613a9-357">NX_IPv4_PACKET</span></span> |<span data-ttu-id="613a9-358">0x24</span><span class="sxs-lookup"><span data-stu-id="613a9-358">0x24</span></span> |
|<span data-ttu-id="613a9-359">NX_IPv4_UDP_PACKET</span><span class="sxs-lookup"><span data-stu-id="613a9-359">NX_IPv4_UDP_PACKET</span></span> |<span data-ttu-id="613a9-360">0x2c</span><span class="sxs-lookup"><span data-stu-id="613a9-360">0x2c</span></span> |
|<span data-ttu-id="613a9-361">NX_IPv4_TCP_PACKET</span><span class="sxs-lookup"><span data-stu-id="613a9-361">NX_IPv4_TCP_PACKET</span></span> |<span data-ttu-id="613a9-362">0x38</span><span class="sxs-lookup"><span data-stu-id="613a9-362">0x38</span></span> |

<span data-ttu-id="613a9-363">La tabella seguente illustra i simboli definiti con IPv6 disabilitato:</span><span class="sxs-lookup"><span data-stu-id="613a9-363">The following table shows symbols defined with IPv6 disabled:</span></span>

|<span data-ttu-id="613a9-364">**Tipo di pacchetto**</span><span class="sxs-lookup"><span data-stu-id="613a9-364">**Packet Type**</span></span> |<span data-ttu-id="613a9-365">**Valore**</span><span class="sxs-lookup"><span data-stu-id="613a9-365">**Value**</span></span> |
|---|---|
|<span data-ttu-id="613a9-366">NX_IPv4_PACKET (NX_IP_PACKET)</span><span class="sxs-lookup"><span data-stu-id="613a9-366">NX_IPv4_PACKET (NX_IP_PACKET)</span></span> |<span data-ttu-id="613a9-367">0x24</span><span class="sxs-lookup"><span data-stu-id="613a9-367">0x24</span></span> |
|<span data-ttu-id="613a9-368">NX_IPv4_UDP_PACKET (NX_UDP_PACKET)</span><span class="sxs-lookup"><span data-stu-id="613a9-368">NX_IPv4_UDP_PACKET (NX_UDP_PACKET)</span></span> |<span data-ttu-id="613a9-369">0x2c</span><span class="sxs-lookup"><span data-stu-id="613a9-369">0x2c</span></span> |
|<span data-ttu-id="613a9-370">NX_IPv4_TCP_PACKET (NX_TCP_PACKET)</span><span class="sxs-lookup"><span data-stu-id="613a9-370">NX_IPv4_TCP_PACKET (NX_TCP_PACKET)</span></span> |<span data-ttu-id="613a9-371">0x38</span><span class="sxs-lookup"><span data-stu-id="613a9-371">0x38</span></span> |

<span data-ttu-id="613a9-372">Si noti che questi valori vengono modificati se *NX_IPSEC_ENABLE* viene definito.</span><span class="sxs-lookup"><span data-stu-id="613a9-372">Note that these values will change if *NX_IPSEC_ENABLE* is defined.</span></span> <span data-ttu-id="613a9-373">Per le applicazioni che utilizzano IPsec, vedere la guida dell'utente di NetX Duo IPsec per ulteriori informazioni.</span><span class="sxs-lookup"><span data-stu-id="613a9-373">For application using IPsec, refer to NetX Duo IPsec User Guide for more information.</span></span>

### <a name="pool-capacity"></a><span data-ttu-id="613a9-374">Capacità pool</span><span class="sxs-lookup"><span data-stu-id="613a9-374">Pool Capacity</span></span>

<span data-ttu-id="613a9-375">Il numero di pacchetti in un pool di pacchetti è una funzione delle dimensioni del payload e il numero totale di byte nell'area di memoria fornita al servizio di creazione del pool di pacchetti.</span><span class="sxs-lookup"><span data-stu-id="613a9-375">The number of packets in a packet pool is a function of the payload size and the total number of bytes in the memory area supplied to the packet pool create service.</span></span> <span data-ttu-id="613a9-376">La capacità del pool viene calcolata dividendo le dimensioni del pacchetto (incluse le dimensioni dell'intestazione NX_PACKET, le dimensioni del payload e l'allineamento appropriato) nel numero totale di byte nell'area di memoria specificata.</span><span class="sxs-lookup"><span data-stu-id="613a9-376">The capacity of the pool is calculated by dividing the packet size (including the size of the NX_PACKET header, the payload size, and proper alignment) into the total number of bytes in the supplied memory area.</span></span>

### <a name="payload-area-alignment"></a><span data-ttu-id="613a9-377">Allineamento area payload</span><span class="sxs-lookup"><span data-stu-id="613a9-377">Payload Area Alignment</span></span>

<span data-ttu-id="613a9-378">La progettazione di pool di pacchetti in NetX Duo supporta la copia zero.</span><span class="sxs-lookup"><span data-stu-id="613a9-378">Packet pool design in NetX Duo supports zero-copy.</span></span> <span data-ttu-id="613a9-379">A livello di driver di dispositivo, il driver è in grado di assegnare l'area di payload direttamente nei descrittori del buffer per la ricezione dei dati.</span><span class="sxs-lookup"><span data-stu-id="613a9-379">At the device driver level, the driver is able to assign the payload area directly into buffer descriptors for data reception.</span></span> <span data-ttu-id="613a9-380">A volte il motore DMA o il meccanismo di sincronizzazione della cache richiede che l'indirizzo iniziale dell'area del payload disponga di un determinato requisito di allineamento.</span><span class="sxs-lookup"><span data-stu-id="613a9-380">Sometimes the DMA engine or the cache synchronization mechanism requires the starting address of the payload area to have a certain alignment requirement.</span></span> <span data-ttu-id="613a9-381">Questa operazione può essere eseguita definendo il requisito di allineamento desiderato (in byte) in ***NX_PACKET_ALIGNMENT***.</span><span class="sxs-lookup"><span data-stu-id="613a9-381">This can be achieved by defining the desired alignment requirement (in bytes) in ***NX_PACKET_ALIGNMENT***.</span></span> <span data-ttu-id="613a9-382">Quando si crea un pool di pacchetti, l'indirizzo iniziale dell'area del payload verrà allineato a questo valore.</span><span class="sxs-lookup"><span data-stu-id="613a9-382">When creating a packet pool, the starting address of the payload area will aligned to this value.</span></span> <span data-ttu-id="613a9-383">Per impostazione predefinita, l'indirizzo iniziale è allineato a 4 byte.</span><span class="sxs-lookup"><span data-stu-id="613a9-383">By default, starting address is 4-byte aligned.</span></span>

### <a name="thread-suspension"></a><span data-ttu-id="613a9-384">Sospensione thread</span><span class="sxs-lookup"><span data-stu-id="613a9-384">Thread Suspension</span></span>

<span data-ttu-id="613a9-385">I thread dell'applicazione possono sospendere l'attesa di un pacchetto da un pool vuoto.</span><span class="sxs-lookup"><span data-stu-id="613a9-385">Application threads can suspend while waiting for a packet from an empty pool.</span></span> <span data-ttu-id="613a9-386">Quando un pacchetto viene restituito al pool, al thread sospeso viene assegnato questo pacchetto e ripreso.</span><span class="sxs-lookup"><span data-stu-id="613a9-386">When a packet is returned to the pool, the suspended thread is given this packet and resumed.</span></span>

<span data-ttu-id="613a9-387">Se più thread sono sospesi nello stesso pool di pacchetti, vengono ripresi nell'ordine in cui sono stati sospesi (FIFO).</span><span class="sxs-lookup"><span data-stu-id="613a9-387">If multiple threads are suspended on the same packet pool, they  resumed in the order they were suspended (FIFO).</span></span>

### <a name="pool-statistics-and-errors"></a><span data-ttu-id="613a9-388">Statistiche ed errori del pool</span><span class="sxs-lookup"><span data-stu-id="613a9-388">Pool Statistics and Errors</span></span>

<span data-ttu-id="613a9-389">Se abilitata, il software di gestione pacchetti NetX Duo tiene traccia di diverse statistiche ed errori che possono risultare utili per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-389">If enabled, the NetX Duo packet management software keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="613a9-390">Per i pool di pacchetti vengono mantenute le statistiche e i report degli errori seguenti:</span><span class="sxs-lookup"><span data-stu-id="613a9-390">The following statistics and error reports are maintained for packet pools:</span></span>

- <span data-ttu-id="613a9-391">Totale pacchetti nel pool</span><span class="sxs-lookup"><span data-stu-id="613a9-391">Total Packets in Pool</span></span>
- <span data-ttu-id="613a9-392">Pacchetti disponibili nel pool</span><span class="sxs-lookup"><span data-stu-id="613a9-392">Free Packets in Pool</span></span>
- <span data-ttu-id="613a9-393">Totale allocazioni pacchetti</span><span class="sxs-lookup"><span data-stu-id="613a9-393">Total Packet Allocations</span></span>
- <span data-ttu-id="613a9-394">Richieste di allocazione vuote del pool</span><span class="sxs-lookup"><span data-stu-id="613a9-394">Pool Empty Allocation Requests</span></span>
- <span data-ttu-id="613a9-395">Sospensioni di allocazione vuote del pool</span><span class="sxs-lookup"><span data-stu-id="613a9-395">Pool Empty Allocation Suspensions</span></span>
- <span data-ttu-id="613a9-396">Versioni di pacchetti non valide</span><span class="sxs-lookup"><span data-stu-id="613a9-396">Invalid Packet Releases</span></span>

<span data-ttu-id="613a9-397">Tutte le statistiche e le segnalazioni degli errori, ad eccezione del numero totale e dei pacchetti gratuiti nel pool, sono compilate nella libreria NetX Duo, a meno che non sia definito \***NX_DISABLE_PACKET_INFO** _.</span><span class="sxs-lookup"><span data-stu-id="613a9-397">All of these statistics and error reports, except for total and free packet count in pool, are built into NetX Duo library unless \***NX_DISABLE_PACKET_INFO** _ is defined.</span></span> <span data-ttu-id="613a9-398">Questi dati sono disponibili per l'applicazione con il servizio _ \*_nx_packet_pool_info_get_\*\*.</span><span class="sxs-lookup"><span data-stu-id="613a9-398">This data is available to the application with the _ *_nx_packet_pool_info_get_*\* service.</span></span>

### <a name="packet-pool-control-block-nx_packet_pool"></a><span data-ttu-id="613a9-399">Blocco di controllo del pool di pacchetti NX_PACKET_POOL</span><span class="sxs-lookup"><span data-stu-id="613a9-399">Packet Pool Control Block NX_PACKET_POOL</span></span>

<span data-ttu-id="613a9-400">Le caratteristiche di ogni pool di memoria dei pacchetti sono disponibili nel relativo blocco di controllo.</span><span class="sxs-lookup"><span data-stu-id="613a9-400">The characteristics of each packet memory pool are found in its control block.</span></span> <span data-ttu-id="613a9-401">Contiene informazioni utili, ad esempio l'elenco collegato di pacchetti gratuiti, il numero di pacchetti disponibili e le dimensioni del payload per i pacchetti in questo pool.</span><span class="sxs-lookup"><span data-stu-id="613a9-401">It contains useful information such as the linked list of free packets, the number of free packets, and the payload size for packets in this pool.</span></span> <span data-ttu-id="613a9-402">Questa struttura viene definita nel file ***nx_api. h*** .</span><span class="sxs-lookup"><span data-stu-id="613a9-402">This structure is defined in the ***nx_api.h*** file.</span></span>

<span data-ttu-id="613a9-403">I blocchi di controllo del pool di pacchetti possono trovarsi in qualsiasi punto della memoria, ma è più comune fare in modo che il controllo blocchi una struttura globale definendola al di fuori dell'ambito di qualsiasi funzione.</span><span class="sxs-lookup"><span data-stu-id="613a9-403">Packet pool control blocks can be located anywhere in memory, but it is most common to make the control block a global structure by defining it outside the scope of any function.</span></span>

## <a name="ipv4-protocol"></a><span data-ttu-id="613a9-404">Protocollo IPv4</span><span class="sxs-lookup"><span data-stu-id="613a9-404">IPv4 Protocol</span></span>

<span data-ttu-id="613a9-405">Il componente IP (Internet Protocol) di NetX Duo è responsabile dell'invio e della ricezione di pacchetti IPv4 su Internet.</span><span class="sxs-lookup"><span data-stu-id="613a9-405">The Internet Protocol (IP) component of NetX Duo is responsible for sending and receiving IPv4 packets on the Internet.</span></span> <span data-ttu-id="613a9-406">In NetX Duo è il componente responsabile dell'invio e della ricezione di messaggi TCP, UDP, ICMP e IGMP, usando il driver di rete sottostante.</span><span class="sxs-lookup"><span data-stu-id="613a9-406">In NetX Duo, it is the component ultimately responsible for sending and receiving TCP, UDP, ICMP, and IGMP messages, utilizing the underlying network driver.</span></span>

<span data-ttu-id="613a9-407">NetX Duo supporta sia il protocollo IPv4 (RFC 791) che il protocollo IPv6 (RFC 2460).</span><span class="sxs-lookup"><span data-stu-id="613a9-407">NetX Duo supports both IPv4 protocol (RFC 791) and IPv6 protocol (RFC 2460).</span></span> <span data-ttu-id="613a9-408">In questa sezione viene illustrato il protocollo IPv4.</span><span class="sxs-lookup"><span data-stu-id="613a9-408">This section discusses IPv4.</span></span> <span data-ttu-id="613a9-409">IPv6 verrà illustrato nella sezione successiva.</span><span class="sxs-lookup"><span data-stu-id="613a9-409">IPv6 is discussed in the next section.</span></span>

### <a name="ipv4-addresses"></a><span data-ttu-id="613a9-410">Indirizzi IPv4</span><span class="sxs-lookup"><span data-stu-id="613a9-410">IPv4 Addresses</span></span>

<span data-ttu-id="613a9-411">Ogni host su Internet dispone di un identificatore univoco a 32 bit denominato indirizzo IP.</span><span class="sxs-lookup"><span data-stu-id="613a9-411">Each host on the Internet has a unique 32-bit identifier called an IP address.</span></span> <span data-ttu-id="613a9-412">Sono disponibili cinque classi di indirizzi IPv4, come illustrato nella figura 4.</span><span class="sxs-lookup"><span data-stu-id="613a9-412">There are five classes of IPv4 addresses as described in Figure 4.</span></span> <span data-ttu-id="613a9-413">Gli intervalli delle cinque classi di indirizzi IPv4 sono i seguenti:</span><span class="sxs-lookup"><span data-stu-id="613a9-413">The ranges of the five IPv4 address classes are as follows:</span></span>

|<span data-ttu-id="613a9-414">Classe</span><span class="sxs-lookup"><span data-stu-id="613a9-414">Class</span></span>|<span data-ttu-id="613a9-415">Range</span><span class="sxs-lookup"><span data-stu-id="613a9-415">Range</span></span>|
|---|---|
|<span data-ttu-id="613a9-416">A</span><span class="sxs-lookup"><span data-stu-id="613a9-416">A</span></span> |<span data-ttu-id="613a9-417">da 0.0.0.0 a 127.255.255.255</span><span class="sxs-lookup"><span data-stu-id="613a9-417">0.0.0.0 to 127.255.255.255</span></span>|
|<span data-ttu-id="613a9-418">B</span><span class="sxs-lookup"><span data-stu-id="613a9-418">B</span></span> |<span data-ttu-id="613a9-419">da 128.0.0.0 a 191.255.255.255</span><span class="sxs-lookup"><span data-stu-id="613a9-419">128.0.0.0 to 191.255.255.255</span></span>|
|<span data-ttu-id="613a9-420">C</span><span class="sxs-lookup"><span data-stu-id="613a9-420">C</span></span> |<span data-ttu-id="613a9-421">da 192.0.0.0 a 223.255.255.255</span><span class="sxs-lookup"><span data-stu-id="613a9-421">192.0.0.0 to 223.255.255.255</span></span>|
|<span data-ttu-id="613a9-422">D</span><span class="sxs-lookup"><span data-stu-id="613a9-422">D</span></span> |<span data-ttu-id="613a9-423">da 224.0.0.0 a 239.255.255.255</span><span class="sxs-lookup"><span data-stu-id="613a9-423">224.0.0.0 to 239.255.255.255</span></span>|
|<span data-ttu-id="613a9-424">E</span><span class="sxs-lookup"><span data-stu-id="613a9-424">E</span></span> |<span data-ttu-id="613a9-425">da 240.0.0.0 a 247.255.255.255</span><span class="sxs-lookup"><span data-stu-id="613a9-425">240.0.0.0 to 247.255.255.255</span></span>|

![Diagramma della struttura di indirizzi IPv4.](./media/user-guide/ipv4-address-structure.png)

### <a name="figure-4-ipv4-address-structure"></a><span data-ttu-id="613a9-427">FIGURA 4.</span><span class="sxs-lookup"><span data-stu-id="613a9-427">FIGURE 4.</span></span> <span data-ttu-id="613a9-428">Struttura degli indirizzi IPv4</span><span class="sxs-lookup"><span data-stu-id="613a9-428">IPv4 Address Structure</span></span>

<span data-ttu-id="613a9-429">Sono disponibili anche tre tipi di specifiche degli indirizzi: *unicast*, *broadcast* e *multicast*.</span><span class="sxs-lookup"><span data-stu-id="613a9-429">There are also three types of address specifications: *unicast*, *broadcast*, and *multicast*.</span></span> <span data-ttu-id="613a9-430">Gli indirizzi unicast sono gli indirizzi IPv4 che identificano un host specifico su Internet.</span><span class="sxs-lookup"><span data-stu-id="613a9-430">Unicast addresses are those IPv4 addresses that identify a specific host on the Internet.</span></span> <span data-ttu-id="613a9-431">Gli indirizzi unicast possono essere un indirizzo IPv4 di origine o di destinazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-431">Unicast addresses can be either a source or a destination IPv4 address.</span></span> <span data-ttu-id="613a9-432">Un indirizzo di trasmissione identifica tutti gli host in una rete o una subnet specifica e può essere utilizzato solo come indirizzi di destinazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-432">A broadcast address identifies all hosts on a specific network or sub-network and can only be used as destination addresses.</span></span> <span data-ttu-id="613a9-433">Gli indirizzi broadcast vengono specificati con la parte dell'ID host dell'indirizzo impostato su uno.</span><span class="sxs-lookup"><span data-stu-id="613a9-433">Broadcast addresses are specified by having the host ID portion of the address set to ones.</span></span> <span data-ttu-id="613a9-434">Indirizzi multicast (classe D) specificare un gruppo dinamico di host su Internet.</span><span class="sxs-lookup"><span data-stu-id="613a9-434">Multicast addresses (Class D) specify a dynamic group of hosts on the Internet.</span></span> <span data-ttu-id="613a9-435">I membri del gruppo multicast possono partecipare e lasciare ogni volta che desiderano.</span><span class="sxs-lookup"><span data-stu-id="613a9-435">Members of the multicast group may join and leave whenever they wish.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="613a9-436">*Solo i protocolli senza connessione come UDP su IPv4 possono utilizzare la trasmissione e la funzionalità di broadcast limitata del gruppo multicast.*</span><span class="sxs-lookup"><span data-stu-id="613a9-436">*Only connectionless protocols like UDP over IPv4 can utilize broadcast and the limited broadcast capability of the multicast group.*</span></span>

> [!IMPORTANT]
> <span data-ttu-id="613a9-437">\* La macro *ip_address* è definita in \***nx_api. h** _.</span><span class="sxs-lookup"><span data-stu-id="613a9-437">\*The macro *IP_ADDRESS* is defined in \***nx_api.h** _.</span></span> <span data-ttu-id="613a9-438">Consente di specificare facilmente gli indirizzi IPv4 usando le virgole anziché i punti.</span><span class="sxs-lookup"><span data-stu-id="613a9-438">It allows easy specification of IPv4 addresses using commas instead of a periods.</span></span> <span data-ttu-id="613a9-439">Ad esempio, _IP_ADDRESS (128, 0, 0, 0) \* specifica il primo indirizzo della classe B illustrato nella figura 4. \*</span><span class="sxs-lookup"><span data-stu-id="613a9-439">For example, _IP_ADDRESS(128,0,0,0)\* specifies the first class B address shown in Figure 4.\*</span></span>

### <a name="ipv4-gateway-address"></a><span data-ttu-id="613a9-440">Indirizzo IPv4 gateway</span><span class="sxs-lookup"><span data-stu-id="613a9-440">IPv4 Gateway Address</span></span>

<span data-ttu-id="613a9-441">I gateway di rete assistono gli host sulle proprie reti per inoltrare pacchetti destinati a destinazioni esterne al dominio locale.</span><span class="sxs-lookup"><span data-stu-id="613a9-441">Network gateways assist hosts on their networks to relay packets destined to destinations outside the local domain.</span></span> <span data-ttu-id="613a9-442">Ogni nodo ha una certa conoscenza dell'hop successivo da inviare a, ovvero la destinazione di uno degli elementi adiacenti o tramite una tabella di routing statica preprogrammata.</span><span class="sxs-lookup"><span data-stu-id="613a9-442">Each node has some knowledge of which next hop to send to, either the destination one of its neighbors, or through a pre-programmed static routing table.</span></span> <span data-ttu-id="613a9-443">Tuttavia, se questi approcci hanno esito negativo, il nodo deve inoltrare il pacchetto al gateway predefinito, con una migliore conoscenza su come instradare il pacchetto alla relativa destinazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-443">However if these approaches fail, the node should forward the packet to its default gateway which has better knowledge on how to route the packet to its destination.</span></span> <span data-ttu-id="613a9-444">Si noti che il gateway predefinito deve essere direttamente accessibile tramite una delle interfacce fisiche collegate all'istanza IP.</span><span class="sxs-lookup"><span data-stu-id="613a9-444">Note that the default gateway must be directly accessible through one of the physical interfaces attached to the IP instance.</span></span> <span data-ttu-id="613a9-445">L'applicazione chiama \***nx_ip_gateway_address_set** _ per configurare l'indirizzo del gateway predefinito IPv4.</span><span class="sxs-lookup"><span data-stu-id="613a9-445">The application calls \***nx_ip_gateway_address_set** _ to configure IPv4 default gateway address.</span></span> <span data-ttu-id="613a9-446">Usare il _*_nx_ip_gateway_address_get_*_ di servizio per recuperare le impostazioni correnti del gateway IPv4.</span><span class="sxs-lookup"><span data-stu-id="613a9-446">Use the service _*_nx_ip_gateway_address_get_*_ to retrieve the current IPv4 gateway settings.</span></span> <span data-ttu-id="613a9-447">Per cancellare l'impostazione del gateway, l'applicazione deve usare il servizio _ \*_nx_ip_gateway_address_clear_\*\*.</span><span class="sxs-lookup"><span data-stu-id="613a9-447">Application shall use the service _ *_nx_ip_gateway_address_clear_*\* to clear the gateway setting.</span></span>

### <a name="ipv4-header"></a><span data-ttu-id="613a9-448">Intestazione IPv4</span><span class="sxs-lookup"><span data-stu-id="613a9-448">IPv4 Header</span></span>

<span data-ttu-id="613a9-449">Per ogni pacchetto IPv4 da inviare su Internet, è necessario che disponga di un'intestazione IPv4.</span><span class="sxs-lookup"><span data-stu-id="613a9-449">For any IPv4 packet to be sent on the Internet, it must have an IPv4 header.</span></span> <span data-ttu-id="613a9-450">Quando protocolli di livello superiore (UDP, TCP, ICMP o IGMP) chiamano il componente IP per inviare un pacchetto, il modulo di trasmissione IPv4 inserisce un'intestazione IPv4 davanti ai dati.</span><span class="sxs-lookup"><span data-stu-id="613a9-450">When higher-level protocols (UDP, TCP, ICMP, or IGMP) call the IP component to send a packet, the IPv4 transmit module places an IPv4 header in front of the data.</span></span> <span data-ttu-id="613a9-451">Viceversa, quando i pacchetti IP vengono ricevuti dalla rete, il componente IP rimuove l'intestazione IPv4 dal pacchetto prima del recapito ai protocolli di livello superiore.</span><span class="sxs-lookup"><span data-stu-id="613a9-451">Conversely, when IP packets are received from the network, the IP component removes the IPv4 header from the packet before delivery to the higher-level protocols.</span></span> <span data-ttu-id="613a9-452">La figura 5 Mostra il formato dell'intestazione IP.</span><span class="sxs-lookup"><span data-stu-id="613a9-452">Figure 5 shows the format of the IP header.</span></span>

![Formato dell'intestazione IPv4](./media/user-guide/ipv4-header-format.png)

### <a name="figure-5-ipv4-header-format"></a><span data-ttu-id="613a9-454">FIGURA 5.</span><span class="sxs-lookup"><span data-stu-id="613a9-454">FIGURE 5.</span></span> <span data-ttu-id="613a9-455">Formato dell'intestazione IPv4</span><span class="sxs-lookup"><span data-stu-id="613a9-455">IPv4 Header Format</span></span>

> [!IMPORTANT]
> <span data-ttu-id="613a9-456">*È previsto che tutte le intestazioni nell'implementazione TCP/IP siano in formato **Big Endian** . In questo formato, il byte più significativo della parola risiede nell'indirizzo di byte più basso. Ad esempio, la versione a 4 bit e la lunghezza dell'intestazione a 4 bit dell'intestazione IP devono trovarsi sul primo byte dell'intestazione.*</span><span class="sxs-lookup"><span data-stu-id="613a9-456">*All headers in the TCP/IP implementation are expected to be in **big endian** format. In this format, the most significant byte of the word resides at the lowest byte address. For example, the 4-bit version and the 4-bit header length of the IP header must be located on the first byte of the header.*</span></span>

<span data-ttu-id="613a9-457">I campi dell'intestazione IPv4 sono definiti come segue:</span><span class="sxs-lookup"><span data-stu-id="613a9-457">The fields of the IPv4 header are defined as follows:</span></span>

|<span data-ttu-id="613a9-458">&nbsp;Campo di intestazione IPv4 &nbsp;</span><span class="sxs-lookup"><span data-stu-id="613a9-458">IPv4&nbsp;Header&nbsp;Field</span></span> |<span data-ttu-id="613a9-459">Scopo</span><span class="sxs-lookup"><span data-stu-id="613a9-459">Purpose</span></span> |
|---|---|
|<span data-ttu-id="613a9-460">***versione a 4 bit***</span><span class="sxs-lookup"><span data-stu-id="613a9-460">***4-bit version***</span></span> |<span data-ttu-id="613a9-461">Questo campo contiene la versione di IP rappresentata da questa intestazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-461">This field contains the version of IP this header represents.</span></span> <span data-ttu-id="613a9-462">Per IP versione 4, che è supportata da NetX Duo, il valore di questo campo è 4.</span><span class="sxs-lookup"><span data-stu-id="613a9-462">For IP version 4, which is what NetX Duo supports, the value of this field is 4.</span></span> |
|<span data-ttu-id="613a9-463">***lunghezza intestazione a 4 bit***</span><span class="sxs-lookup"><span data-stu-id="613a9-463">***4-bit header length***</span></span> |<span data-ttu-id="613a9-464">Questo campo specifica il numero di parole a 32 bit nell'intestazione IP.</span><span class="sxs-lookup"><span data-stu-id="613a9-464">This field specifies the number of 32-bit words in the IP header.</span></span> <span data-ttu-id="613a9-465">Se non sono presenti parole di opzione, il valore per questo campo è 5.</span><span class="sxs-lookup"><span data-stu-id="613a9-465">If no option words are present, the value for this field is 5.</span></span> |
|<span data-ttu-id="613a9-466">***tipo di servizio (TOS) a 8 bit***</span><span class="sxs-lookup"><span data-stu-id="613a9-466">***8-bit type of service (TOS)***</span></span> |<span data-ttu-id="613a9-467">Questo campo specifica il tipo di servizio richiesto per il pacchetto IP.</span><span class="sxs-lookup"><span data-stu-id="613a9-467">This field specifies the type of service requested for this IP packet.</span></span> <span data-ttu-id="613a9-468">Le richieste valide sono le seguenti:</span><span class="sxs-lookup"><span data-stu-id="613a9-468">Valid requests are as follows:</span></span><br /><span data-ttu-id="613a9-469">-Normale: 0x00</span><span class="sxs-lookup"><span data-stu-id="613a9-469">- Normal: 0x00</span></span> <br /><span data-ttu-id="613a9-470">-Ritardo minimo: 0x00</span><span class="sxs-lookup"><span data-stu-id="613a9-470">- Minimum Delay: 0x00</span></span><br /><span data-ttu-id="613a9-471">-Dati massimi: 0x08</span><span class="sxs-lookup"><span data-stu-id="613a9-471">- Maximum Data: 0x08</span></span><br /><span data-ttu-id="613a9-472">-Massima affidabilità: 0x04</span><span class="sxs-lookup"><span data-stu-id="613a9-472">- Maximum Reliability: 0x04</span></span><br /><span data-ttu-id="613a9-473">-Costo minimo: 0x02</span><span class="sxs-lookup"><span data-stu-id="613a9-473">- Minimum Cost: 0x02</span></span> |
|<span data-ttu-id="613a9-474">***Lunghezza totale a 16 bit***</span><span class="sxs-lookup"><span data-stu-id="613a9-474">***16-bit total length***</span></span> |<span data-ttu-id="613a9-475">Questo campo contiene la lunghezza totale del datagramma IP in byte, inclusa l'intestazione IP.</span><span class="sxs-lookup"><span data-stu-id="613a9-475">This field contains the total length of the IP datagram in bytes, including the IP header.</span></span> <span data-ttu-id="613a9-476">Un datagramma IP è l'unità di base delle informazioni disponibili in una rete Internet TCP/IP.</span><span class="sxs-lookup"><span data-stu-id="613a9-476">An IP datagram is the basic unit of information found on a TCP/IP Internet.</span></span> <span data-ttu-id="613a9-477">Contiene un indirizzo di origine e di destinazione oltre ai dati.</span><span class="sxs-lookup"><span data-stu-id="613a9-477">It contains a destination and source address in addition to data.</span></span> <span data-ttu-id="613a9-478">Poiché si tratta di un campo a 16 bit, le dimensioni massime di un datagramma IP sono pari a 65.535 byte.</span><span class="sxs-lookup"><span data-stu-id="613a9-478">Because it is a 16-bit field, the maximum size of an IP datagram is 65,535 bytes.</span></span>|
|<span data-ttu-id="613a9-479">***identificazione a 16 bit***</span><span class="sxs-lookup"><span data-stu-id="613a9-479">***16-bit identification***</span></span> |<span data-ttu-id="613a9-480">Il campo è un numero usato per identificare in modo univoco ogni datagramma IP inviato da un host.</span><span class="sxs-lookup"><span data-stu-id="613a9-480">The field is a number used to uniquely identify each IP datagram sent from a host.</span></span> <span data-ttu-id="613a9-481">Questo numero viene in genere incrementato dopo l'invio di un datagramma IP.</span><span class="sxs-lookup"><span data-stu-id="613a9-481">This number is typically incremented after an IP datagram is sent.</span></span> <span data-ttu-id="613a9-482">È particolarmente utile per assemblare frammenti di pacchetti IP ricevuti.</span><span class="sxs-lookup"><span data-stu-id="613a9-482">It is especially useful in assembling received IP packet fragments.</span></span>|
|<span data-ttu-id="613a9-483">***flag a 3 bit***</span><span class="sxs-lookup"><span data-stu-id="613a9-483">***3-bit flags***</span></span> |<span data-ttu-id="613a9-484">Questo campo contiene informazioni sulla frammentazione IP.</span><span class="sxs-lookup"><span data-stu-id="613a9-484">This field contains IP fragmentation information.</span></span> <span data-ttu-id="613a9-485">Il bit 14 è il bit "not Fragment".</span><span class="sxs-lookup"><span data-stu-id="613a9-485">Bit 14 is the "don't fragment" bit.</span></span> <span data-ttu-id="613a9-486">Se questo bit è impostato, il datagramma IP in uscita non verrà frammentato.</span><span class="sxs-lookup"><span data-stu-id="613a9-486">If this bit is set, the outgoing IP datagram will not be fragmented.</span></span> <span data-ttu-id="613a9-487">Il bit 13 è il bit "More Fragments".</span><span class="sxs-lookup"><span data-stu-id="613a9-487">Bit 13 is the "more fragments" bit.</span></span> <span data-ttu-id="613a9-488">Se questo bit è impostato, sono presenti più frammenti.</span><span class="sxs-lookup"><span data-stu-id="613a9-488">If this bit is set, there are more fragments.</span></span> <span data-ttu-id="613a9-489">Se questo bit è chiaro, questo è l'ultimo frammento del pacchetto IP.</span><span class="sxs-lookup"><span data-stu-id="613a9-489">If this bit is clear, this is the last fragment of the IP packet.</span></span>|
|<span data-ttu-id="613a9-490">***offset frammento a 13 bit***</span><span class="sxs-lookup"><span data-stu-id="613a9-490">***13-bit fragment offset***</span></span> |<span data-ttu-id="613a9-491">Questo campo contiene i 13 bit superiori dell'offset del frammento.</span><span class="sxs-lookup"><span data-stu-id="613a9-491">This field contains the upper 13-bits of the fragment offset.</span></span> <span data-ttu-id="613a9-492">Per questo motivo, gli offset dei frammenti sono consentiti solo su limiti di 8 byte.</span><span class="sxs-lookup"><span data-stu-id="613a9-492">Because of this, fragment offsets are only allowed on 8-byte boundaries.</span></span> <span data-ttu-id="613a9-493">Il primo frammento di un datagramma IP frammentato avrà un set di bit "più frammenti" e un offset pari a 0.</span><span class="sxs-lookup"><span data-stu-id="613a9-493">The first fragment of a fragmented IP datagram will have the "more fragments" bit set and have an offset of 0.</span></span>|
|<span data-ttu-id="613a9-494">***durata (TTL) a 8 bit***</span><span class="sxs-lookup"><span data-stu-id="613a9-494">***8-bit time to live (TTL)***</span></span> |<span data-ttu-id="613a9-495">Questo campo contiene il numero di router che questo datagramma può superare, che sostanzialmente limita la durata del datagramma.</span><span class="sxs-lookup"><span data-stu-id="613a9-495">This field contains the number of routers this datagram can pass, which basically limits the lifetime of the datagram.</span></span>|
|<span data-ttu-id="613a9-496">***protocollo a 8 bit***</span><span class="sxs-lookup"><span data-stu-id="613a9-496">***8-bit protocol***</span></span>|<span data-ttu-id="613a9-497">Questo campo specifica il protocollo che usa il datagramma IP.</span><span class="sxs-lookup"><span data-stu-id="613a9-497">This field specifies which protocol is using the IP datagram.</span></span> <span data-ttu-id="613a9-498">Di seguito è riportato un elenco di protocolli validi e dei relativi valori:</span><span class="sxs-lookup"><span data-stu-id="613a9-498">The following is a list of valid protocols and their values:</span></span><br /><span data-ttu-id="613a9-499">-ICMP: 0x01</span><span class="sxs-lookup"><span data-stu-id="613a9-499">- ICMP: 0x01</span></span> <br /><span data-ttu-id="613a9-500">-IGMP: 0x02</span><span class="sxs-lookup"><span data-stu-id="613a9-500">- IGMP: 0x02</span></span><br /><span data-ttu-id="613a9-501">-TCP: 0X06</span><span class="sxs-lookup"><span data-stu-id="613a9-501">- TCP: 0X06</span></span><br /><span data-ttu-id="613a9-502">-UDP: 0X11</span><span class="sxs-lookup"><span data-stu-id="613a9-502">- UDP: 0X11</span></span> |
|<span data-ttu-id="613a9-503">***checksum a 16 bit***</span><span class="sxs-lookup"><span data-stu-id="613a9-503">***16-bit checksum***</span></span> |<span data-ttu-id="613a9-504">Questo campo contiene il checksum a 16 bit che copre solo l'intestazione IP.</span><span class="sxs-lookup"><span data-stu-id="613a9-504">This field contains the 16-bit checksum that covers the IP header only.</span></span> <span data-ttu-id="613a9-505">Nei protocolli di livello superiore sono presenti checksum aggiuntivi che coprono il payload IP.</span><span class="sxs-lookup"><span data-stu-id="613a9-505">There are additional checksums in the higher level protocols that cover the IP payload.</span></span> |
|<span data-ttu-id="613a9-506">***Indirizzo IP di origine a 32 bit***</span><span class="sxs-lookup"><span data-stu-id="613a9-506">***32-bit source IP address***</span></span> |<span data-ttu-id="613a9-507">Questo campo contiene l'indirizzo IP del mittente ed è sempre un indirizzo host.</span><span class="sxs-lookup"><span data-stu-id="613a9-507">This field contains the IP address of the sender and is always a host address.</span></span> |
|<span data-ttu-id="613a9-508">***Indirizzo IP di destinazione a 32 bit***</span><span class="sxs-lookup"><span data-stu-id="613a9-508">***32-bit destination IP address***</span></span> |<span data-ttu-id="613a9-509">Questo campo contiene l'indirizzo IP del destinatario o dei ricevitori se l'indirizzo è un indirizzo broadcast o multicast.</span><span class="sxs-lookup"><span data-stu-id="613a9-509">This field contains the IP address of the receiver or receivers if the address is a broadcast or multicast address.</span></span> |

### <a name="creating-ip-instances"></a><span data-ttu-id="613a9-510">Creazione di istanze IP</span><span class="sxs-lookup"><span data-stu-id="613a9-510">Creating IP Instances</span></span>

<span data-ttu-id="613a9-511">Le istanze IP vengono create durante l'inizializzazione o durante la fase di esecuzione dai thread dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-511">IP instances are created either during initialization or during runtime by application threads.</span></span> <span data-ttu-id="613a9-512">L'indirizzo IPv4 iniziale, network mask, il pool di pacchetti predefinito, il driver multimediale e la memoria e la priorità del thread IP interno vengono definiti dal servizio ***nx_ip_create*** anche se l'applicazione intende utilizzare solo reti IPv6.</span><span class="sxs-lookup"><span data-stu-id="613a9-512">The initial IPv4 address, network mask, default packet pool, media driver, and memory and priority of the internal IP thread are defined by the ***nx_ip_create*** service even if the application intends to use IPv6 networks only.</span></span> <span data-ttu-id="613a9-513">Se l'applicazione Inizializza l'istanza IP con il relativo indirizzo IPv4 impostato su un indirizzo non valido (0.0.0.0), si presuppone che l'indirizzo dell'interfaccia venga risolto dalla configurazione manuale in un secondo momento, tramite RARP o tramite DHCP o protocolli simili.</span><span class="sxs-lookup"><span data-stu-id="613a9-513">If the application initializes the IP instance with its IPv4 address set to an invalid address(0.0.0.0), it is assumed that the interface address is going to resolved by manual configuration later, via RARP, or through DHCP or similar protocols.</span></span>

<span data-ttu-id="613a9-514">Per i sistemi con più interfacce di rete, l'interfaccia principale viene designata quando si chiama \***nx_ip_create** _.</span><span class="sxs-lookup"><span data-stu-id="613a9-514">For systems with multiple network interfaces, the primary interface is designated when calling \***nx_ip_create** _.</span></span> <span data-ttu-id="613a9-515">Ogni interfaccia aggiuntiva può essere collegata alla stessa istanza IP chiamando _ *_nx_ip_interface_attach_* \*.</span><span class="sxs-lookup"><span data-stu-id="613a9-515">Each additional interface can be attached to the same IP instance by calling _\*_nx_ip_interface_attach_\*\*.</span></span> <span data-ttu-id="613a9-516">Questo servizio archivia informazioni sull'interfaccia di rete (ad esempio indirizzo IP, network mask) nel blocco di controllo dell'interfaccia e associa l'istanza del driver al blocco di controllo dell'interfaccia nell'istanza IP.</span><span class="sxs-lookup"><span data-stu-id="613a9-516">This service stores information about the network interface (such as IP address, network mask) in the interface control block, and associates the driver instance with the interface control block in the IP instance.</span></span> <span data-ttu-id="613a9-517">Quando il driver riceve un pacchetto di dati, deve archiviare le informazioni sull'interfaccia nella struttura NX_PACKET prima di inoltrarle alla logica di ricezione IP.</span><span class="sxs-lookup"><span data-stu-id="613a9-517">As the driver receives a data packet, it needs to store the interface information in the NX_PACKET structure before forwarding it to the IP receive logic.</span></span> <span data-ttu-id="613a9-518">Nota è necessario che un'istanza IP sia già stata creata prima di eseguire il fissaggio di qualsiasi interfaccia.</span><span class="sxs-lookup"><span data-stu-id="613a9-518">Note an IP instance must already be created before attaching any interfaces.</span></span>

<span data-ttu-id="613a9-519">I servizi IPv6 non vengono avviati dopo aver chiamato \***nx_ip_create** _.</span><span class="sxs-lookup"><span data-stu-id="613a9-519">IPv6 services are not started after calling \***nx_ip_create** _.</span></span> <span data-ttu-id="613a9-520">Le applicazioni che desiderano utilizzare i servizi IPv6 devono chiamare il servizio _ *_nx_ipv6_enable_*\* per avviare IPv6.</span><span class="sxs-lookup"><span data-stu-id="613a9-520">Applications wishing to use IPv6 services must call the service _ *_nx_ipv6_enable_*\* to start IPv6.</span></span>

<span data-ttu-id="613a9-521">Nella rete IPv6 ogni interfaccia in un'istanza IP può avere più indirizzi globali IPv6.</span><span class="sxs-lookup"><span data-stu-id="613a9-521">On the IPv6 network, each interface in an IP instance may have multiple IPv6 global addresses.</span></span> <span data-ttu-id="613a9-522">Oltre a usare DHCPv6 per l'assegnazione di indirizzi IPv6, un dispositivo può usare anche la configurazione automatica degli indirizzi senza stato.</span><span class="sxs-lookup"><span data-stu-id="613a9-522">In addition to using DHCPv6 for IPv6 address assignment, a device may also use Stateless Address Autoconfiguration.</span></span> <span data-ttu-id="613a9-523">Ulteriori informazioni sono disponibili nelle sezioni "blocco di controllo IP" e "risoluzione degli indirizzi IPv6" più avanti in questo capitolo.</span><span class="sxs-lookup"><span data-stu-id="613a9-523">More information is available in the "IP Control Block" and "IPv6 Address Resolution" sections later in this chapter.</span></span>

### <a name="ip-send"></a><span data-ttu-id="613a9-524">Invio IP</span><span class="sxs-lookup"><span data-stu-id="613a9-524">IP Send</span></span>

<span data-ttu-id="613a9-525">L'elaborazione dell'invio IP in NetX Duo è molto semplificata.</span><span class="sxs-lookup"><span data-stu-id="613a9-525">The IP send processing in NetX Duo is very streamlined.</span></span> <span data-ttu-id="613a9-526">Il puntatore anteposto nel pacchetto viene spostato all'indietro per contenere l'intestazione IP.</span><span class="sxs-lookup"><span data-stu-id="613a9-526">The prepend pointer in the packet is moved backwards to accommodate the IP header.</span></span> <span data-ttu-id="613a9-527">L'intestazione IP viene completata (con tutte le opzioni specificate dal livello del protocollo chiamante), il checksum IP viene calcolato in linea (solo per i pacchetti IPv4) e il pacchetto viene inviato al driver di rete associato.</span><span class="sxs-lookup"><span data-stu-id="613a9-527">The IP header is completed (with all the options specified by the calling protocol layer), the IP checksum is computed in-line (for IPv4 packets only), and the packet is dispatched to the associated network driver.</span></span> <span data-ttu-id="613a9-528">Inoltre, la frammentazione in uscita è coordinata anche all'interno dell'elaborazione di trasmissione IP.</span><span class="sxs-lookup"><span data-stu-id="613a9-528">In addition, outgoing fragmentation is also coordinated from within the IP send processing.</span></span>

<span data-ttu-id="613a9-529">Per IPv4, NetX Duo avvia le richieste ARP se è necessario un mapping fisico per l'indirizzo IP di destinazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-529">For IPv4, NetX Duo initiates ARP requests if physical mapping is needed for the destination IP address.</span></span> <span data-ttu-id="613a9-530">IPv6 usa l'individuazione Neighbor per il mapping IPv6-address-tophysical-Address.</span><span class="sxs-lookup"><span data-stu-id="613a9-530">IPv6 uses Neighbor Discovery for IPv6-address-tophysical-address mapping.</span></span>

> [!NOTE]
> <span data-ttu-id="613a9-531">*Per la connettività IPv4, i pacchetti che richiedono la risoluzione degli indirizzi IP (ad esempio, il mapping fisico) vengono accodati nella coda ARP finché il numero di pacchetti in coda non supera la profondità della coda ARP (definita dal simbolo **NX_ARP_MAX_QUEUE_DEPTH**). Se viene raggiunta la profondità della coda, NetX Duo rimuoverà il pacchetto meno recente nella coda e continuerà ad attendere la risoluzione degli indirizzi per i pacchetti rimanenti accodati. D'altra parte, se non viene risolta una voce ARP, i pacchetti in sospeso sulla voce ARP vengono rilasciati al timeout della voce ARP.*</span><span class="sxs-lookup"><span data-stu-id="613a9-531">*For IPv4 connectivity, packets that require IP address resolution (i.e., physical mapping) are enqueued on the ARP queue until the number of packets queued exceeds the ARP queue depth (defined by the symbol **NX_ARP_MAX_QUEUE_DEPTH**). If the queue depth is reached, NetX Duo will remove the oldest packet on the queue and continue waiting for address resolution for the remaining packets enqueued. On the other hand, if an ARP entry is not resolved, the pending packets on the ARP entry are released upon ARP entry timeout.*</span></span>

<span data-ttu-id="613a9-532">Per i sistemi con più interfacce di rete, NetX Duo sceglie un'interfaccia basata sull'indirizzo IP di destinazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-532">For systems with multiple network interfaces, NetX Duo chooses an interface based on the destination IP address.</span></span> <span data-ttu-id="613a9-533">La procedura seguente si applica al processo di selezione:</span><span class="sxs-lookup"><span data-stu-id="613a9-533">The following procedure applies to the selection process:</span></span>

1. <span data-ttu-id="613a9-534">Se il mittente specifica un'interfaccia in uscita e l'interfaccia è valida, usare tale interfaccia.</span><span class="sxs-lookup"><span data-stu-id="613a9-534">If the sender specifies an outgoing interface and the interface is valid, use that interface.</span></span>
2. <span data-ttu-id="613a9-535">Se un indirizzo di destinazione è broadcast IPv4 o multicast, viene utilizzata la prima interfaccia fisica abilitata.</span><span class="sxs-lookup"><span data-stu-id="613a9-535">If a destination address is IPv4 broadcast or multicast, the first enabled physical interface is used.</span></span>
3. <span data-ttu-id="613a9-536">Se l'indirizzo di destinazione viene trovato nella tabella di routing statica, viene utilizzata l'interfaccia associata al gateway.</span><span class="sxs-lookup"><span data-stu-id="613a9-536">If the destination address is found in the static routing table, the interface associated with the gateway is used.</span></span>
4. <span data-ttu-id="613a9-537">Se la destinazione è on-link, viene utilizzata l'interfaccia di collegamento.</span><span class="sxs-lookup"><span data-stu-id="613a9-537">If the destination is on-link, the on-link interface is used.</span></span>
5. <span data-ttu-id="613a9-538">Se l'indirizzo di destinazione è un indirizzo locale del collegamento (169.254.0.0/16), viene utilizzata la prima interfaccia valida.</span><span class="sxs-lookup"><span data-stu-id="613a9-538">If the destination address is a link-local address (169.254.0.0/16), the first valid interface is used.</span></span>
6. <span data-ttu-id="613a9-539">Se è configurato il gateway predefinito, usare l'interfaccia associata al gateway predefinito per trasmettere il pacchetto.</span><span class="sxs-lookup"><span data-stu-id="613a9-539">If the default gateway is configured, use the interface associated with the default gateway to transmit the packet.</span></span>
7. <span data-ttu-id="613a9-540">Infine, se uno degli indirizzi IP dell'interfaccia validi è indirizzo locale del collegamento (169.254.0.0/16), questa interfaccia viene utilizzata come indirizzo di origine per la trasmissione.</span><span class="sxs-lookup"><span data-stu-id="613a9-540">Finally, if one of the valid interface IP address is link-local address (169.254.0.0/16), this interface is used as source address for the transmission.</span></span>
8. <span data-ttu-id="613a9-541">Il pacchetto di output viene eliminato se non si verificano errori.</span><span class="sxs-lookup"><span data-stu-id="613a9-541">The output packet is dropped if all above fails.</span></span>

### <a name="ip-receive"></a><span data-ttu-id="613a9-542">Ricezione IP</span><span class="sxs-lookup"><span data-stu-id="613a9-542">IP Receive</span></span>

<span data-ttu-id="613a9-543">L'elaborazione di ricezione IP viene chiamata dal driver di rete o dal thread IP interno (per l'elaborazione dei pacchetti nella coda di pacchetti ricevuta posticipata).</span><span class="sxs-lookup"><span data-stu-id="613a9-543">The IP receive processing is either called from the network driver or the internal IP thread (for processing packets on the deferred received packet queue).</span></span> <span data-ttu-id="613a9-544">L'elaborazione di ricezione IP esamina il campo protocollo e tenta di inviare il pacchetto al componente protocollo appropriato.</span><span class="sxs-lookup"><span data-stu-id="613a9-544">The IP receive processing examines the protocol field and attempts to dispatch the packet to the proper protocol component.</span></span> <span data-ttu-id="613a9-545">Prima che il pacchetto venga effettivamente inviato, l'intestazione IP viene rimossa facendo avanzare il puntatore anteposto oltre l'intestazione IP.</span><span class="sxs-lookup"><span data-stu-id="613a9-545">Before the packet is actually dispatched, the IP header is removed by advancing the prepend pointer past the IP header.</span></span>

<span data-ttu-id="613a9-546">L'elaborazione della ricezione IP rileva inoltre i pacchetti IP frammentati ed esegue i passaggi necessari per riassemblarli se la frammentazione è abilitata.</span><span class="sxs-lookup"><span data-stu-id="613a9-546">IP receive processing also detects fragmented IP packets and performs the necessary steps to reassemble them if fragmentation is enabled.</span></span> <span data-ttu-id="613a9-547">Se la frammentazione è necessaria ma non abilitata, il pacchetto viene eliminato.</span><span class="sxs-lookup"><span data-stu-id="613a9-547">If fragmentation is needed but not enabled, the packet is dropped.</span></span>

<span data-ttu-id="613a9-548">NetX Duo determina l'interfaccia di rete appropriata in base all'interfaccia specificata nel pacchetto.</span><span class="sxs-lookup"><span data-stu-id="613a9-548">NetX Duo determines the appropriate network interface based on the interface specified in the packet.</span></span> <span data-ttu-id="613a9-549">Se l'interfaccia del pacchetto è NULL, NetX Duo imposta come valore predefinito l'interfaccia primaria.</span><span class="sxs-lookup"><span data-stu-id="613a9-549">If the packet interface is NULL, NetX Duo defaults to the primary interface.</span></span> <span data-ttu-id="613a9-550">Questa operazione viene eseguita per garantire la compatibilità con i driver Ethernet NetX Duo legacy.</span><span class="sxs-lookup"><span data-stu-id="613a9-550">This is done to guarantee compatibility with legacy NetX Duo Ethernet drivers.</span></span>

### <a name="raw-ip-send"></a><span data-ttu-id="613a9-551">Invio IP non elaborato</span><span class="sxs-lookup"><span data-stu-id="613a9-551">Raw IP Send</span></span>

<span data-ttu-id="613a9-552">Un pacchetto IP non elaborato è un frame IP che contiene il payload del protocollo di livello superiore non direttamente supportato (ed elaborato) da NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="613a9-552">A raw IP packet is an IP frame that contains upper layer protocol payload not directly supported (and processed) by NetX Duo.</span></span> <span data-ttu-id="613a9-553">Un pacchetto non elaborato consente agli sviluppatori di definire le proprie applicazioni basate su IP.</span><span class="sxs-lookup"><span data-stu-id="613a9-553">A raw packet allows developers to define their own IP-based applications.</span></span> <span data-ttu-id="613a9-554">Un'applicazione può inviare pacchetti IP non elaborati direttamente usando il servizio ***nxd_ip_raw_packet_send** _ se l'elaborazione di pacchetti IP non elaborati è stata abilitata con il servizio di _*_nx_ip_raw_packet_enabled_\*_ .</span><span class="sxs-lookup"><span data-stu-id="613a9-554">An application may send raw IP packets directly using the ***nxd_ip_raw_packet_send** _ service if raw IP packet processing has been enabled with the _*_nx_ip_raw_packet_enabled_\*_ service.</span></span> <span data-ttu-id="613a9-555">Quando si trasmette un pacchetto unicast in una rete IPv6, NetX Duo determina automaticamente l'indirizzo IPv6 di origine migliore da usare per inviare i pacchetti in base all'indirizzo di destinazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-555">When transmitting a unicast packet on an IPv6 network, NetX Duo automatically determines the best source IPv6 address to use to send the packets out on, based on the destination address.</span></span> <span data-ttu-id="613a9-556">Se l'indirizzo di destinazione è un indirizzo multicast (o broadcast per IPv4), tuttavia, NetX Duo utilizzerà per impostazione predefinita la prima interfaccia (primaria).</span><span class="sxs-lookup"><span data-stu-id="613a9-556">If the destination address is a multicast (or broadcast for IPv4) address, however, NetX Duo will default to the first (primary) interface.</span></span> <span data-ttu-id="613a9-557">Pertanto, per inviare tali pacchetti alle interfacce secondarie, l'applicazione deve usare il servizio _ *_nx_ip_raw_packet_source_send_*\* per specificare l'indirizzo di origine da usare per il pacchetto in uscita.</span><span class="sxs-lookup"><span data-stu-id="613a9-557">Therefore, to send such packets out on secondary interfaces, the application must use the _ *_nx_ip_raw_packet_source_send_*\* service to specify the source address to use for the outgoing packet.</span></span>

### <a name="raw-ip-receive"></a><span data-ttu-id="613a9-558">Ricezione di indirizzi IP non elaborati</span><span class="sxs-lookup"><span data-stu-id="613a9-558">Raw IP Receive</span></span>

<span data-ttu-id="613a9-559">Se l'elaborazione dei pacchetti IP non elaborati è abilitata, l'applicazione può ricevere pacchetti IP non elaborati tramite il servizio \***nx_ip_raw_packet_receive** _.</span><span class="sxs-lookup"><span data-stu-id="613a9-559">If raw IP packet processing is enabled, the application may receive raw IP packets through the \***nx_ip_raw_packet_receive** _ service.</span></span> <span data-ttu-id="613a9-560">Tutti i pacchetti in ingresso vengono elaborati in base al protocollo specificato nell'intestazione IP.</span><span class="sxs-lookup"><span data-stu-id="613a9-560">All incoming packets are processed according to the protocol specified in the IP header.</span></span> <span data-ttu-id="613a9-561">Se il protocollo specifica UDP, TCP, IGMP o ICMP, NetX Duo elaborerà il pacchetto utilizzando il gestore appropriato per il tipo di protocollo del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="613a9-561">If the protocol specifies UDP, TCP, IGMP or ICMP, NetX Duo will process the packet using the appropriate handler for the packet protocol type.</span></span> <span data-ttu-id="613a9-562">Se il protocollo non è uno di questi protocolli e la ricezione di indirizzi IP non elaborati è abilitata, il pacchetto in arrivo verrà inserito nella coda dei pacchetti non elaborati in attesa che l'applicazione la riceva tramite il _servizio \*_nx_ip_raw_packet_receive_\*\*. I thread dell'applicazione possono inoltre sospendere con un timeout facoltativo durante l'attesa di un pacchetto IP non elaborato. Il numero di pacchetti che è possibile accodare nella coda dei pacchetti non elaborati è limitato. Il valore massimo è definito in \***NX_IP_RAW_MAX_QUEUE_DEPTH**, il_ cui valore predefinito è 20.</span><span class="sxs-lookup"><span data-stu-id="613a9-562">If the protocol is not one of these protocols, and raw IP receive is enabled, the incoming packet will be put into the raw packet queue waiting for the application to receive it via the _*_nx_ip_raw_packet_receive_*\* service. In addition, application threads may suspend with an optional timeout while waiting for a raw IP packet. The number of packets that can be queued on the raw packet queue is limited. The maximum value is defined in \***NX_IP_RAW_MAX_QUEUE_DEPTH**_, whose default value is 20.</span></span> <span data-ttu-id="613a9-563">Un'applicazione può modificare il valore massimo chiamando il servizio _ \*_nx_ip_raw_receive_queue_max_set_\*\*.</span><span class="sxs-lookup"><span data-stu-id="613a9-563">An application may change the maximum value by calling the _ *_nx_ip_raw_receive_queue_max_set_*\* service.</span></span>

<span data-ttu-id="613a9-564">In alternativa, la libreria NetX Duo può essere compilata con \*\**NX_ENABLE_IP_RAW_PACKET_FILTER *.**</span><span class="sxs-lookup"><span data-stu-id="613a9-564">Alternatively, the NetX Duo library may be built with \***NX_ENABLE_IP_RAW_PACKET_FILTER\*.**</span></span> <span data-ttu-id="613a9-565">In questa modalità di funzionamento, l'applicazione fornisce una funzione di callback che viene richiamata ogni volta che viene ricevuto un pacchetto con un tipo di protocollo non gestito.</span><span class="sxs-lookup"><span data-stu-id="613a9-565">In this mode of operation, the application provides a callback function that is invoked every time a packet with an unhandled protocol type is received.</span></span> <span data-ttu-id="613a9-566">La logica di ricezione IP invia il pacchetto alla routine di filtro di ricezione dei pacchetti non elaborati definita dall'utente.</span><span class="sxs-lookup"><span data-stu-id="613a9-566">The IP receive logic forwards the packet to the user-defined raw packet receive filter routine.</span></span> <span data-ttu-id="613a9-567">La routine di filtro decide se memorizzare o meno il pacchetto non elaborato per un processo futuro.</span><span class="sxs-lookup"><span data-stu-id="613a9-567">The filter routine decides whether or not to keep the raw packet for future process.</span></span> <span data-ttu-id="613a9-568">Il valore restituito dalla routine di callback indica se il pacchetto è stato elaborato dal filtro di ricezione dei pacchetti non elaborati.</span><span class="sxs-lookup"><span data-stu-id="613a9-568">The return value from the callback routine indicates whether the packet has been processed by the raw packet receive filter.</span></span> <span data-ttu-id="613a9-569">Se il pacchetto viene elaborato dalla funzione di callback, il pacchetto deve essere rilasciato dopo che l'applicazione è stata eseguita con il pacchetto.</span><span class="sxs-lookup"><span data-stu-id="613a9-569">If the packet is processed by the callback function, the packet should be released after the application is done with the packet.</span></span> <span data-ttu-id="613a9-570">In caso contrario, NetX Duo è responsabile del rilascio del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="613a9-570">Otherwise, NetX Duo is responsible for releasing the packet.</span></span> <span data-ttu-id="613a9-571">Per ulteriori informazioni sull'utilizzo della funzione di filtro dei pacchetti non elaborati, fare riferimento al **_nx_ip_raw_packet_filter_set_** .</span><span class="sxs-lookup"><span data-stu-id="613a9-571">Refer to the **_nx_ip_raw_packet_filter_set_** for more information on how to use the raw packet filter function.</span></span>

> [!NOTE]
> <span data-ttu-id="613a9-572">\* La funzione wrapper BSD per NetX duo si basa sulla funzione di filtro dei pacchetti non elaborati per gestire i socket non elaborati BSD.</span><span class="sxs-lookup"><span data-stu-id="613a9-572">\*The BSD wrapper function for NetX Duo relies on the raw packet filter function to handle BSD raw sockets.</span></span> <span data-ttu-id="613a9-573">Per supportare il socket non elaborato nel wrapper BSD, è pertanto necessario compilare la libreria NetX Duo con ***NX_ENABLE_IP_RAW_PACKET_FILTER** _ defined e l'applicazione non deve usare il _*_nx_ip_raw_packet_filter_set_\*_ per installare il proprio filtro pacchetti non elaborati Functions._</span><span class="sxs-lookup"><span data-stu-id="613a9-573">Therefore, to support raw socket in the BSD wrapper, the NetX Duo library must be built with ***NX_ENABLE_IP_RAW_PACKET_FILTER** _ defined, and the application should not use the _*_nx_ip_raw_packet_filter_set_\*_ to install its own raw packet filter functions._</span></span>

### <a name="default-packet-pool"></a><span data-ttu-id="613a9-574">Pool di pacchetti predefinito</span><span class="sxs-lookup"><span data-stu-id="613a9-574">Default Packet Pool</span></span>

<span data-ttu-id="613a9-575">A ogni istanza IP viene assegnato un pool di pacchetti predefinito durante la creazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-575">Each IP instance is given a default packet pool during creation.</span></span> <span data-ttu-id="613a9-576">Questo pool di pacchetti viene utilizzato per allocare pacchetti per ARP, RARP, ICMP, IGMP, diversi pacchetti di controllo TCP (SYN, ACK e così via), individuazione router adiacenti, individuazione router e rilevamento di indirizzi duplicati.</span><span class="sxs-lookup"><span data-stu-id="613a9-576">This packet pool is used to allocate packets for ARP, RARP, ICMP, IGMP, various TCP control packets (SYN, ACK, and so on), Neighbor Discovery, Router Discovery, and Duplicate Address Detection.</span></span> <span data-ttu-id="613a9-577">Se il pool di pacchetti predefinito è vuoto quando NetX Duo deve allocare un pacchetto, NetX Duo potrebbe dover interrompere l'operazione specifica e restituirà un messaggio di errore, se possibile.</span><span class="sxs-lookup"><span data-stu-id="613a9-577">If the default packet pool is empty when NetX Duo needs to allocate a packet, NetX Duo may have to abort the particular operation, and will return an error message if possible.</span></span>

### <a name="ip-helper-thread"></a><span data-ttu-id="613a9-578">Thread helper IP</span><span class="sxs-lookup"><span data-stu-id="613a9-578">IP Helper Thread</span></span>

<span data-ttu-id="613a9-579">Ogni istanza IP ha un thread helper.</span><span class="sxs-lookup"><span data-stu-id="613a9-579">Each IP instance has a helper thread.</span></span> <span data-ttu-id="613a9-580">Questo thread è responsabile della gestione di tutte le operazioni di elaborazione dei pacchetti posticipate e di tutte le elaborazioni periodiche.</span><span class="sxs-lookup"><span data-stu-id="613a9-580">This thread is responsible for handling all deferred packet processing and all periodic processing.</span></span> <span data-ttu-id="613a9-581">Il thread helper IP viene creato in ***nx_ip_create.*** Questo è il punto in cui al thread viene assegnato lo stack e la priorità.</span><span class="sxs-lookup"><span data-stu-id="613a9-581">The IP helper thread is created in ***nx_ip_create.*** This is where the thread is given its stack and priority.</span></span> <span data-ttu-id="613a9-582">Si noti che la prima elaborazione nel thread helper IP consiste nel completare l'inizializzazione del driver di rete associata al servizio di creazione IP.</span><span class="sxs-lookup"><span data-stu-id="613a9-582">Note that the first processing in the IP helper thread is to finish the network driver initialization associated with the IP create service.</span></span> <span data-ttu-id="613a9-583">Al termine dell'inizializzazione del driver di rete, il thread di supporto avvia un ciclo infinito per elaborare le richieste periodiche e del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="613a9-583">After the network driver initialization is complete, the helper thread starts an endless loop to process packet and periodic requests.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="613a9-584">*Se si verifica un comportamento inspiegabile all'interno del thread helper IP, l'aumento delle dimensioni dello stack durante il servizio di creazione IP è il primo passaggio di debug. Se lo stack è troppo piccolo, il thread helper IP potrebbe probabilmente sovrascrivere la memoria, che potrebbe causare problemi insoliti.*</span><span class="sxs-lookup"><span data-stu-id="613a9-584">*If unexplained behavior is seen within the IP helper thread, increasing its stack size during the IP create service is the first debugging step. If the stack is too small, the IP helper thread could possibly be overwriting memory, which may cause unusual problems.*</span></span>

### <a name="thread-suspension"></a><span data-ttu-id="613a9-585">Sospensione thread</span><span class="sxs-lookup"><span data-stu-id="613a9-585">Thread Suspension</span></span>

<span data-ttu-id="613a9-586">I thread dell'applicazione possono sospendere il tentativo di ricevere pacchetti IP non elaborati.</span><span class="sxs-lookup"><span data-stu-id="613a9-586">Application threads can suspend while attempting to receive raw IP packets.</span></span> <span data-ttu-id="613a9-587">Dopo la ricezione di un pacchetto non elaborato, il nuovo pacchetto viene assegnato al primo thread sospeso e il thread viene ripreso.</span><span class="sxs-lookup"><span data-stu-id="613a9-587">After a raw packet is received, the new packet is given to the first thread suspended and that thread is resumed.</span></span> <span data-ttu-id="613a9-588">I servizi NetX Duo per la ricezione di pacchetti hanno tutti un timeout di sospensione facoltativo.</span><span class="sxs-lookup"><span data-stu-id="613a9-588">NetX Duo services for receiving packets all have an optional suspension timeout.</span></span> <span data-ttu-id="613a9-589">Quando viene ricevuto un pacchetto o il timeout scade, il thread dell'applicazione viene ripreso con lo stato di completamento appropriato.</span><span class="sxs-lookup"><span data-stu-id="613a9-589">When a packet is received or the timeout expires, the application thread is resumed with the appropriate completion status.</span></span>

### <a name="ip-statistics-and-errors"></a><span data-ttu-id="613a9-590">Statistiche IP ed errori</span><span class="sxs-lookup"><span data-stu-id="613a9-590">IP Statistics and Errors</span></span>

<span data-ttu-id="613a9-591">Se abilitata, NetX Duo tiene traccia di diverse statistiche ed errori che possono essere utili per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-591">If enabled, the NetX Duo keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="613a9-592">Per ogni istanza IP vengono mantenute le statistiche e i report degli errori seguenti:</span><span class="sxs-lookup"><span data-stu-id="613a9-592">The following statistics and error reports are maintained for each IP instance:</span></span>

- <span data-ttu-id="613a9-593">Totale pacchetti IP inviati</span><span class="sxs-lookup"><span data-stu-id="613a9-593">Total IP Packets Sent</span></span>
- <span data-ttu-id="613a9-594">Totale byte IP inviati</span><span class="sxs-lookup"><span data-stu-id="613a9-594">Total IP Bytes Sent</span></span>
- <span data-ttu-id="613a9-595">Totale pacchetti IP ricevuti</span><span class="sxs-lookup"><span data-stu-id="613a9-595">Total IP Packets Received</span></span>
- <span data-ttu-id="613a9-596">Totale byte IP ricevuti</span><span class="sxs-lookup"><span data-stu-id="613a9-596">Total IP Bytes Received</span></span>
- <span data-ttu-id="613a9-597">Totale pacchetti IP non validi</span><span class="sxs-lookup"><span data-stu-id="613a9-597">Total IP Invalid Packets</span></span>
- <span data-ttu-id="613a9-598">Totale pacchetti di ricezione IP eliminati</span><span class="sxs-lookup"><span data-stu-id="613a9-598">Total IP Receive Packets Dropped</span></span>
- <span data-ttu-id="613a9-599">Totale errori di checksum di ricezione IP</span><span class="sxs-lookup"><span data-stu-id="613a9-599">Total IP Receive Checksum Errors</span></span>
- <span data-ttu-id="613a9-600">Totale pacchetti di invio IP eliminati</span><span class="sxs-lookup"><span data-stu-id="613a9-600">Total IP Send Packets Dropped</span></span>
- <span data-ttu-id="613a9-601">Totale frammenti IP inviati</span><span class="sxs-lookup"><span data-stu-id="613a9-601">Total IP Fragments Sent</span></span>
- <span data-ttu-id="613a9-602">Totale frammenti IP ricevuti</span><span class="sxs-lookup"><span data-stu-id="613a9-602">Total IP Fragments Received</span></span>

<span data-ttu-id="613a9-603">Tutte le statistiche e i report degli errori sono disponibili per l'applicazione con il servizio ***nx_ip_info_get***.</span><span class="sxs-lookup"><span data-stu-id="613a9-603">All of these statistics and error reports are available to the application with the ***nx_ip_info_get*** service.</span></span>

### <a name="ip-control-block-nx_ip"></a><span data-ttu-id="613a9-604">NX_IP del blocco di controllo IP</span><span class="sxs-lookup"><span data-stu-id="613a9-604">IP Control Block NX_IP</span></span>

<span data-ttu-id="613a9-605">Le caratteristiche di ogni istanza IP si trovano nel relativo blocco di controllo.</span><span class="sxs-lookup"><span data-stu-id="613a9-605">The characteristics of each IP instance are found in its control block.</span></span> <span data-ttu-id="613a9-606">Contiene informazioni utili quali gli indirizzi IP e le maschere di rete di ogni dispositivo di rete e una tabella di indirizzi IP adiacenti e mapping di indirizzi hardware fisici.</span><span class="sxs-lookup"><span data-stu-id="613a9-606">It contains useful information such as the IP addresses and network masks of each network device, and a table of neighbor IP and physical hardware address mapping.</span></span> <span data-ttu-id="613a9-607">Questa struttura viene definita nel _file \***nx_api. h**.</span><span class="sxs-lookup"><span data-stu-id="613a9-607">This structure is defined in the \***nx_api.h** _file.</span></span> <span data-ttu-id="613a9-608">Se IPv6 è abilitato, contiene anche una matrice di indirizzi IPv6, il cui numero è specificato dall'opzione configurabile dall'utente _ *_NX_MAX_IPV6_ADDRESSES_* \*.</span><span class="sxs-lookup"><span data-stu-id="613a9-608">If IPv6 is enabled, it also contains an array of IPv6 address, the number of which is specified by the user configurable option _\*_NX_MAX_IPV6_ADDRESSES_\*\*.</span></span> <span data-ttu-id="613a9-609">Il valore predefinito consente a ogni interfaccia di rete fisica di avere tre indirizzi IPv6.</span><span class="sxs-lookup"><span data-stu-id="613a9-609">The default value allows each physical network interface to have three IPv6 addresses.</span></span>

<span data-ttu-id="613a9-610">I blocchi di controllo dell'istanza IP possono trovarsi in qualsiasi punto della memoria, ma è più comune fare in modo che il controllo blocchi una struttura globale definendola al di fuori dell'ambito di qualsiasi funzione.</span><span class="sxs-lookup"><span data-stu-id="613a9-610">IP instance control blocks can be located anywhere in memory, but it is most common to make the control block a global structure by defining it outside the scope of any function.</span></span>

### <a name="static-ipv4-routing"></a><span data-ttu-id="613a9-611">Routing IPv4 statico</span><span class="sxs-lookup"><span data-stu-id="613a9-611">Static IPv4 Routing</span></span>

<span data-ttu-id="613a9-612">La funzionalità di routing statico consente a un'applicazione di specificare una rete IPv4 e l'indirizzo hop successivo per indirizzi IP di destinazione specifici fuori rete.</span><span class="sxs-lookup"><span data-stu-id="613a9-612">The static routing feature allows an application to specify an IPv4 network and next hop address for specific out of network destination IP addresses.</span></span> <span data-ttu-id="613a9-613">Se il routing statico è abilitato, NetX Duo Cerca nella tabella di routing statica una voce corrispondente all'indirizzo di destinazione del pacchetto da inviare.</span><span class="sxs-lookup"><span data-stu-id="613a9-613">If static routing is enabled, NetX Duo searches through the static routing table for an entry matching the destination address of the packet to send.</span></span> <span data-ttu-id="613a9-614">Se non viene trovata alcuna corrispondenza, NetX Duo Cerca nell'elenco di interfacce fisiche e sceglie un indirizzo IP di origine e un indirizzo hop successivo in base all'indirizzo IP di destinazione e al network mask.</span><span class="sxs-lookup"><span data-stu-id="613a9-614">If no match is found, NetX Duo searches through the list of physical interfaces and chooses a source IP address and next hop address based on the destination IP address and the network mask.</span></span> <span data-ttu-id="613a9-615">Se la destinazione non corrisponde ad alcuno degli indirizzi IP dei driver di rete collegati all'istanza IP, NetX Duo sceglie un'interfaccia connessa direttamente al gateway predefinito e usa l'indirizzo IP dell'interfaccia come indirizzo di origine e il gateway predefinito come hop successivo.</span><span class="sxs-lookup"><span data-stu-id="613a9-615">If the destination does not match any of the IP addresses of the network drivers attached to the IP instance, NetX Duo chooses an interface that is directly connected to the default gateway, and uses the IP address of the interface as source address, and the default gateway as the next hop.</span></span>

<span data-ttu-id="613a9-616">Le voci possono essere aggiunte e rimosse dalla tabella di routing statica usando rispettivamente i servizi \***nx_ip_static_route_add** _ e _ \*_nx_ip_static_route_delete_\*\*.</span><span class="sxs-lookup"><span data-stu-id="613a9-616">Entries can be added and removed from the static routing table using the ***nx_ip_static_route_add** _ and _ *_nx_ip_static_route_delete_** services, respectively.</span></span> <span data-ttu-id="613a9-617">Per utilizzare il routing statico, l'applicazione host deve abilitare questa funzionalità definendo ***NX_ENABLE_IP_STATIC_ROUTING.***</span><span class="sxs-lookup"><span data-stu-id="613a9-617">To use static routing, the host application must enable this feature by defining ***NX_ENABLE_IP_STATIC_ROUTING.***</span></span>

> [!NOTE]
> <span data-ttu-id="613a9-618">*Quando si aggiunge una voce alla tabella di routing statica, NetX duo controlla la presenza di una voce corrispondente per l'indirizzo di destinazione specificato già nella tabella. Se ne esiste uno, fornisce la preferenza alla voce con la rete più piccola (prefisso più lungo) nell'network mask.*</span><span class="sxs-lookup"><span data-stu-id="613a9-618">*When adding an entry to the static routing table, NetX Duo checks for a matching entry for the specified destination address already in the table. If one exists, it gives preference to the entry with the smaller network (longer prefix) in the network mask.*</span></span>

### <a name="ipv4-forwarding"></a><span data-ttu-id="613a9-619">Inoltri IPv4</span><span class="sxs-lookup"><span data-stu-id="613a9-619">IPv4 Forwarding</span></span>

<span data-ttu-id="613a9-620">Se il pacchetto IPv4 in ingresso non è destinato a questo nodo e la funzionalità di invio IPv4 è abilitata, NetX Duo tenta di inviare il pacchetto tramite le altre interfacce.</span><span class="sxs-lookup"><span data-stu-id="613a9-620">If the incoming IPv4 packet is not destined for this node and IPv4 forwarding feature is enabled, NetX Duo attempts to forward the packet out via the other interfaces.</span></span>  

### <a name="ip-fragmentation"></a><span data-ttu-id="613a9-621">Frammentazione IP</span><span class="sxs-lookup"><span data-stu-id="613a9-621">IP Fragmentation</span></span>

<span data-ttu-id="613a9-622">Il dispositivo di rete potrebbe avere limiti per le dimensioni dei pacchetti in uscita.</span><span class="sxs-lookup"><span data-stu-id="613a9-622">The network device may have limits on the size of outgoing packets.</span></span> <span data-ttu-id="613a9-623">Questo limite è denominato MTU (Maximum Transmission Unit).</span><span class="sxs-lookup"><span data-stu-id="613a9-623">This limit is called the maximum transmission unit (MTU).</span></span> <span data-ttu-id="613a9-624">MTU IP è la dimensione massima del frame IP che un driver del livello di collegamento è in grado di trasmettere senza frammentazione del pacchetto IP.</span><span class="sxs-lookup"><span data-stu-id="613a9-624">IP MTU is the largest IP frame size a link layer driver is able to transmit without fragmenting the IP packet.</span></span> <span data-ttu-id="613a9-625">Durante la fase di inizializzazione di un driver di dispositivo, il modulo driver deve configurare le dimensioni MTU IP tramite il servizio ***nx_ip_interface_mtu_set.***</span><span class="sxs-lookup"><span data-stu-id="613a9-625">During a device driver initialization phase, the driver module must configure its IP MTU size via the service ***nx_ip_interface_mtu_set.***</span></span>

<span data-ttu-id="613a9-626">Sebbene non sia consigliabile, l'applicazione può generare datagrammi di dimensioni superiori rispetto alla MTU IP sottostante supportata dal dispositivo.</span><span class="sxs-lookup"><span data-stu-id="613a9-626">Although not recommended, the application may generate datagrams larger than the underlying IP MTU supported by the device.</span></span> <span data-ttu-id="613a9-627">Prima di trasmettere tale datagramma IP, il livello IP deve frammentare questi pacchetti.</span><span class="sxs-lookup"><span data-stu-id="613a9-627">Before transmitting such IP datagram, the IP layer must fragment these packets.</span></span> <span data-ttu-id="613a9-628">Alla ricezione di frame IP frammentati, l'estremità ricevente deve archiviare tutti i frame IP frammentati con lo stesso ID di frammentazione e riassemblarli nell'ordine.</span><span class="sxs-lookup"><span data-stu-id="613a9-628">On receiving fragmented IP frames, the receiving end must store all fragmented IP frames with the same fragmentation ID, and reassemble them in order.</span></span> <span data-ttu-id="613a9-629">Se la logica di ricezione IP non è in grado di raccogliere tutti i frammenti per ripristinare il frame IP originale nel tempo, vengono rilasciati tutti i frammenti.</span><span class="sxs-lookup"><span data-stu-id="613a9-629">If the IP receive logic is unable to collect all the fragments to restore the original IP frame in time, all the fragments are released.</span></span> <span data-ttu-id="613a9-630">È il protocollo di livello superiore per rilevare tale perdita di pacchetti e ripristinarla.</span><span class="sxs-lookup"><span data-stu-id="613a9-630">It is up to the upper layer protocol to detect such packet loss and recover from it.</span></span>

<span data-ttu-id="613a9-631">La frammentazione IP si applica ai pacchetti IPv4 e IPv6.</span><span class="sxs-lookup"><span data-stu-id="613a9-631">The IP fragmentation applies to both IPv4 and IPv6 packets.</span></span>

<span data-ttu-id="613a9-632">Per supportare la frammentazione IP e l'operazione di riassemblaggio, progettazione sistema deve abilitare la funzionalità di frammentazione IP in NetX Duo usando il servizio ***nx_ip_fragment_enable*** .</span><span class="sxs-lookup"><span data-stu-id="613a9-632">In order to support IP fragmentation and reassembly operation, the system designer must enable the IP fragmentation feature in NetX Duo using the ***nx_ip_fragment_enable*** service.</span></span> <span data-ttu-id="613a9-633">Se questa funzionalità non è abilitata, i pacchetti IP frammentati in ingresso vengono eliminati, oltre a pacchetti che superano il MTU del driver di rete.</span><span class="sxs-lookup"><span data-stu-id="613a9-633">If this feature is not enabled, incoming fragmented IP packets are discarded, as well as packets that exceed the network driver's MTU.</span></span>

> [!NOTE]
> <span data-ttu-id="613a9-634">\* La logica di frammentazione IP può essere rimossa completamente definendo \***NX_DISABLE_FRAGMENTATION** _ quando si compila la libreria NETX Duo.</span><span class="sxs-lookup"><span data-stu-id="613a9-634">\*The IP Fragmentation logic can be removed completely by defining \***NX_DISABLE_FRAGMENTATION** _ when building the NetX Duo library.</span></span> <span data-ttu-id="613a9-635">Questa operazione consente di ridurre le dimensioni del codice di NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="613a9-635">Doing so helps reduce the code size of NetX Duo.</span></span> <span data-ttu-id="613a9-636">Si noti che in questo caso le funzioni di frammentazione/riassemblaggio IPv4 e IPv6 sono disabled._</span><span class="sxs-lookup"><span data-stu-id="613a9-636">Note that in this situation, both the IPv4 and IPv6 fragmentation/reassembly functions are disabled._</span></span>

> [!NOTE]
> <span data-ttu-id="613a9-637">*Se **NX_DISABLE_CHAINED_PACKET** è definito, la frammentazione IP deve essere disabilitata.*</span><span class="sxs-lookup"><span data-stu-id="613a9-637">*If **NX_DISABLE_CHAINED_PACKET** is defined, IP fragmentation must be disabled.*</span></span>

> [!NOTE]
> <span data-ttu-id="613a9-638">*In una rete IPv6, i router non frammentano un datagramma se la dimensione del datagramma supera la dimensione MTU minima. Pertanto, spetta al dispositivo mittente determinare il valore MTU minimo tra l'origine e la destinazione e assicurarsi che la dimensione del datagramma IP non superi il valore MTU del percorso. In NetX Duo è possibile abilitare l'individuazione MTU del percorso IPv6 compilando la libreria NetX Duo con il simbolo **NX_ENABLE_IPV6_PATH_MTU_DISCOVERY** definito.*</span><span class="sxs-lookup"><span data-stu-id="613a9-638">*In an IPv6 network, routers do not fragment a datagram if the size of the datagram exceeds its minimum MTU size. Therefore, it is up to the sending device to determine the minimum MTU between the source and the destination, and to ensure the IP datagram size does not exceed the path MTU. In NetX Duo, IPv6 PATH MTU discovery can be enabled by building NetX Duo library with the symbol **NX_ENABLE_IPV6_PATH_MTU_DISCOVERY** defined.*</span></span>

## <a name="address-resolution-protocol-arp-in-ipv4"></a><span data-ttu-id="613a9-639">ARP (Address Resolution Protocol) in IPv4</span><span class="sxs-lookup"><span data-stu-id="613a9-639">Address Resolution Protocol (ARP) in IPv4</span></span>

<span data-ttu-id="613a9-640">Il protocollo ARP (Address Resolution Protocol) è responsabile del mapping dinamico degli indirizzi IPv4 a 32 bit a quelli del supporto fisico sottostante (RFC 826).</span><span class="sxs-lookup"><span data-stu-id="613a9-640">The Address Resolution Protocol (ARP) is responsible for dynamically mapping 32-bit IPv4 addresses to those of the underlying physical media (RFC 826).</span></span> <span data-ttu-id="613a9-641">Ethernet è il supporto fisico più comune e supporta gli indirizzi a 48 bit.</span><span class="sxs-lookup"><span data-stu-id="613a9-641">Ethernet is the most typical physical media, and it supports 48-bit addresses.</span></span> <span data-ttu-id="613a9-642">La necessità di ARP è determinata dal driver di rete fornito al servizio \***nx_ip_create** _.</span><span class="sxs-lookup"><span data-stu-id="613a9-642">The need for ARP is determined by the network driver supplied to the \***nx_ip_create** _ service.</span></span> <span data-ttu-id="613a9-643">Se è necessario il mapping fisico, il driver di rete deve usare il servizio _ *_nx_interface_address_mapping_needed_*\* per configurare correttamente l'interfaccia del driver.</span><span class="sxs-lookup"><span data-stu-id="613a9-643">If physical mapping is required, the network driver must use the _ *_nx_interface_address_mapping_needed_*\* service to configure the driver interface properly.</span></span>

### <a name="arp-enable"></a><span data-ttu-id="613a9-644">Abilitazione ARP</span><span class="sxs-lookup"><span data-stu-id="613a9-644">ARP Enable</span></span>

<span data-ttu-id="613a9-645">Per il corretto funzionamento di ARP, l'applicazione deve prima essere abilitata dall'applicazione con il servizio ***nx_arp_enable*** .</span><span class="sxs-lookup"><span data-stu-id="613a9-645">For ARP to function properly, it must first be enabled by the application with the ***nx_arp_enable*** service.</span></span> <span data-ttu-id="613a9-646">Questo servizio configura varie strutture di dati per l'elaborazione ARP, inclusa la creazione di un'area della cache ARP dalla memoria fornita al servizio di abilitazione ARP.</span><span class="sxs-lookup"><span data-stu-id="613a9-646">This service sets up various data structures for ARP processing, including the creation of an ARP cache area from the memory supplied to the ARP enable service.</span></span>

### <a name="arp-cache"></a><span data-ttu-id="613a9-647">Cache ARP</span><span class="sxs-lookup"><span data-stu-id="613a9-647">ARP Cache</span></span>

<span data-ttu-id="613a9-648">La cache ARP può essere visualizzata come una matrice di strutture di dati di mapping ARP interne.</span><span class="sxs-lookup"><span data-stu-id="613a9-648">The ARP cache can be viewed as an array of internal ARP mapping data structures.</span></span> <span data-ttu-id="613a9-649">Ogni struttura interna è in grado di gestire la relazione tra un indirizzo IP e un indirizzo hardware fisico.</span><span class="sxs-lookup"><span data-stu-id="613a9-649">Each internal structure is capable of maintaining the relationship between an IP address and a physical hardware address.</span></span> <span data-ttu-id="613a9-650">Ogni struttura di dati dispone inoltre di puntatori di collegamento, in modo che possa essere parte di più elenchi collegati.</span><span class="sxs-lookup"><span data-stu-id="613a9-650">In addition, each data structure has link pointers so it can be part of multiple linked lists.</span></span>

<span data-ttu-id="613a9-651">L'applicazione può cercare un indirizzo IP dalla cache ARP specificando l'indirizzo MAC hardware usando il servizio \***nx_arp_ip_address_find** _ se il mapping esiste nella tabella ARP.</span><span class="sxs-lookup"><span data-stu-id="613a9-651">Application can look up an IP address from the ARP cache by supplying hardware MAC address using the service \***nx_arp_ip_address_find** _ if the mapping exists in the ARP table.</span></span> <span data-ttu-id="613a9-652">Analogamente, il servizio _ *_nx_arp_hardware_address_find_*\* restituisce l'indirizzo Mac per un determinato indirizzo IP.</span><span class="sxs-lookup"><span data-stu-id="613a9-652">Similarly, the service _ *_nx_arp_hardware_address_find_*\* returns the MAC address for a given IP address.</span></span>

### <a name="arp-dynamic-entries"></a><span data-ttu-id="613a9-653">Voci dinamiche ARP</span><span class="sxs-lookup"><span data-stu-id="613a9-653">ARP Dynamic Entries</span></span>

<span data-ttu-id="613a9-654">Per impostazione predefinita, il servizio ARP Enable inserisce tutte le voci della cache ARP nell'elenco delle voci ARP dinamiche disponibili.</span><span class="sxs-lookup"><span data-stu-id="613a9-654">By default, the ARP enable service places all entries in the ARP cache on the list of available dynamic ARP entries.</span></span> <span data-ttu-id="613a9-655">Una voce ARP dinamica viene allocata da questo elenco di NetX Duo quando viene rilevata una richiesta di invio a un indirizzo IP non mappato.</span><span class="sxs-lookup"><span data-stu-id="613a9-655">A dynamic ARP entry is allocated from this list by NetX Duo when a send request to an unmapped IP address is detected.</span></span> <span data-ttu-id="613a9-656">Dopo l'allocazione, la voce ARP viene configurata e viene inviata una richiesta ARP al supporto fisico.</span><span class="sxs-lookup"><span data-stu-id="613a9-656">After allocation, the ARP entry is set up and an ARP request is sent to the physical media.</span></span>

<span data-ttu-id="613a9-657">È possibile creare una voce dinamica anche dal servizio ***nx_arp_dynamic_entry_set***.</span><span class="sxs-lookup"><span data-stu-id="613a9-657">A dynamic entry can also be created by the service ***nx_arp_dynamic_entry_set***.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="613a9-658">*Se tutte le voci ARP dinamiche sono in uso, la voce ARP usata meno di recente viene sostituita con un nuovo mapping.*</span><span class="sxs-lookup"><span data-stu-id="613a9-658">*If all dynamic ARP entries are in use, the least recently used ARP entry is replaced with a new mapping.*</span></span>

### <a name="arp-static-entries"></a><span data-ttu-id="613a9-659">Voci statiche ARP</span><span class="sxs-lookup"><span data-stu-id="613a9-659">ARP Static Entries</span></span>

<span data-ttu-id="613a9-660">L'applicazione può anche impostare il mapping ARP statico usando l'_service \***nx_arp_static_entry_create**.</span><span class="sxs-lookup"><span data-stu-id="613a9-660">The application can also set up static ARP mapping by using the \***nx_arp_static_entry_create** _service.</span></span> <span data-ttu-id="613a9-661">Questo servizio alloca una voce ARP dall'elenco di voci ARP dinamiche e la inserisce nell'elenco statico con le informazioni di mapping fornite dall'applicazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-661">This service allocates an ARP entry from the dynamic ARP entry list and places it on the static list with the mapping information supplied by the application.</span></span> <span data-ttu-id="613a9-662">Le voci ARP statiche non sono soggette a riutilizzo o invecchiamento.</span><span class="sxs-lookup"><span data-stu-id="613a9-662">Static ARP entries are not subject to reuse or aging.</span></span> <span data-ttu-id="613a9-663">L'applicazione può eliminare una voce statica utilizzando il servizio _*_nx_arp_static_entry_delete_*_.</span><span class="sxs-lookup"><span data-stu-id="613a9-663">The application can delete a static entry by using the service _*_nx_arp_static_entry_delete_*_.</span></span> <span data-ttu-id="613a9-664">Per rimuovere tutte le voci statiche nella tabella ARP, è possibile che l'applicazione utilizzi il servizio _ *_nx_arp_static_entries_delete_* \*.</span><span class="sxs-lookup"><span data-stu-id="613a9-664">To remove all static entries in the ARP table, the application may use the service _\*_nx_arp_static_entries_delete_\*\*.</span></span>

### <a name="automatic-arp-entry"></a><span data-ttu-id="613a9-665">Voce ARP automatica</span><span class="sxs-lookup"><span data-stu-id="613a9-665">Automatic ARP Entry</span></span>

<span data-ttu-id="613a9-666">NetX duo registra il mapping IP/MAC del peer dopo le risposte del peer alla richiesta ARP.</span><span class="sxs-lookup"><span data-stu-id="613a9-666">NetX Duo records the peer's IP/MAC mapping after the peer responses to the ARP request.</span></span> <span data-ttu-id="613a9-667">NetX Duo implementa anche la funzionalità di voce ARP automatica in cui registra il mapping degli indirizzi IP/MAC peer in base alle richieste ARP non richieste dalla rete.</span><span class="sxs-lookup"><span data-stu-id="613a9-667">NetX Duo also implements the automatic ARP entry feature where it records peer IP/MAC address mapping based on unsolicited ARP requests from the network.</span></span> <span data-ttu-id="613a9-668">Questa funzionalità consente di popolare la tabella ARP con le informazioni sul peer, riducendo il ritardo necessario per il ciclo di richiesta/risposta ARP.</span><span class="sxs-lookup"><span data-stu-id="613a9-668">This feature allows the ARP table to be populated with peer information, reducing the delay needed to go through the ARP request/response cycle.</span></span> <span data-ttu-id="613a9-669">Tuttavia, il lato negativo dell'abilitazione di ARP automatico è che la tabella ARP tende a riempirsi rapidamente in una rete occupata con molti nodi sul collegamento locale, il che porterebbe alla sostituzione della voce ARP.</span><span class="sxs-lookup"><span data-stu-id="613a9-669">However the downside with enabling automatic ARP is that the ARP table tend to fill up quickly on a busy network with many nodes on the local link, which would eventually lead to ARP entry replacement.</span></span>

<span data-ttu-id="613a9-670">Questa funzionalità è abilitata per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="613a9-670">This feature is enabled by default.</span></span> <span data-ttu-id="613a9-671">Per disabilitarla, è necessario compilare la libreria NetX Duo con il simbolo ***NX_DISABLE_ARP_AUTO_ENTRY*** definito.</span><span class="sxs-lookup"><span data-stu-id="613a9-671">To disable it, the NetX Duo library must be compiled with the symbol ***NX_DISABLE_ARP_AUTO_ENTRY*** defined.</span></span></p>

### <a name="arp-messages"></a><span data-ttu-id="613a9-672">Messaggi ARP</span><span class="sxs-lookup"><span data-stu-id="613a9-672">ARP Messages</span></span>

<span data-ttu-id="613a9-673">Come indicato in precedenza, viene inviato un messaggio di richiesta ARP quando l'attività IP rileva che il mapping è necessario per un indirizzo IP.</span><span class="sxs-lookup"><span data-stu-id="613a9-673">As mentioned previously, an ARP request message is sent when the IP task detects that mapping is needed for an IP address.</span></span> <span data-ttu-id="613a9-674">Le richieste ARP vengono inviate periodicamente (ogni \***NX_ARP_UPDATE_RATE** _ secondi) finché non viene ricevuta una risposta ARP corrispondente.</span><span class="sxs-lookup"><span data-stu-id="613a9-674">ARP requests are sent periodically (every \***NX_ARP_UPDATE_RATE** _ seconds) until a corresponding ARP response is received.</span></span> <span data-ttu-id="613a9-675">Viene eseguito un totale di _ *_NX_ARP_MAXIMUM_RETRIES_*\* richieste ARP prima che il tentativo ARP venga abbandonato.</span><span class="sxs-lookup"><span data-stu-id="613a9-675">A total of _ *_NX_ARP_MAXIMUM_RETRIES_*\* ARP requests are made before the ARP attempt is abandoned.</span></span> <span data-ttu-id="613a9-676">Quando viene ricevuta una risposta ARP, le informazioni sull'indirizzo fisico associate vengono archiviate nella voce ARP presente nella cache.</span><span class="sxs-lookup"><span data-stu-id="613a9-676">When an ARP response is received, the associated physical address information is stored in the ARP entry that is in the cache.</span></span>

<span data-ttu-id="613a9-677">Per i sistemi multihome, NetX Duo determina quale interfaccia inviare le richieste e le risposte ARP in base all'indirizzo di destinazione specificato.</span><span class="sxs-lookup"><span data-stu-id="613a9-677">For multihome systems, NetX Duo determines which interface to send the ARP requests and responses based on destination address specified.</span></span>

> [!NOTE]
> <span data-ttu-id="613a9-678">*I pacchetti IP in uscita vengono accodati mentre NetX Duo attende la risposta ARP. Il numero di pacchetti IP in uscita accodati viene definito dalla costante **NX_ARP_MAX_QUEUE_DEPTH**.*</span><span class="sxs-lookup"><span data-stu-id="613a9-678">*Outgoing IP packets are queued while NetX Duo waits for the ARP response. The number of outgoing IP packets queued is defined by the constant **NX_ARP_MAX_QUEUE_DEPTH**.*</span></span>

<span data-ttu-id="613a9-679">NetX Duo risponde inoltre alle richieste ARP da altri nodi nella rete IPv4 locale.</span><span class="sxs-lookup"><span data-stu-id="613a9-679">NetX Duo also responds to ARP requests from other nodes on the local IPv4 network.</span></span> <span data-ttu-id="613a9-680">Quando viene effettuata una richiesta ARP esterna che corrisponde all'indirizzo IP corrente dell'interfaccia che riceve la richiesta ARP, NetX Duo compila un messaggio di risposta ARP che contiene l'indirizzo fisico corrente.</span><span class="sxs-lookup"><span data-stu-id="613a9-680">When an external ARP request is made that matches the current IP address of the interface that receives the ARP request, NetX Duo builds an ARP response message that contains the current physical address.</span></span>

<span data-ttu-id="613a9-681">I formati delle richieste e delle risposte ARP Ethernet sono illustrati nella figura 6 e sono descritti di seguito.</span><span class="sxs-lookup"><span data-stu-id="613a9-681">The formats of Ethernet ARP requests and responses are shown in Figure 6 and are described below.</span></span>

| <span data-ttu-id="613a9-682">**Campo richiesta/risposta &nbsp;**</span><span class="sxs-lookup"><span data-stu-id="613a9-682">**Request/Response&nbsp;Field**</span></span>         | <span data-ttu-id="613a9-683">**Scopo**</span><span class="sxs-lookup"><span data-stu-id="613a9-683">**Purpose**</span></span>            |
| ---------------------------------- | ---------------------- |
| <span data-ttu-id="613a9-684">***Indirizzo di destinazione Ethernet***</span><span class="sxs-lookup"><span data-stu-id="613a9-684">***Ethernet Destination Address***</span></span> | <span data-ttu-id="613a9-685">Questo campo di 6 byte contiene l'indirizzo di destinazione per la risposta ARP ed è un broadcast (tutti) per le richieste ARP.</span><span class="sxs-lookup"><span data-stu-id="613a9-685">This 6-byte field contains the destination address for the ARP response and is a broadcast (all ones) for ARP requests.</span></span> <span data-ttu-id="613a9-686">Questo campo viene configurato dal driver di rete.</span><span class="sxs-lookup"><span data-stu-id="613a9-686">This field is setup by the network driver.</span></span> 
| <span data-ttu-id="613a9-687">***Indirizzo di origine Ethernet***</span><span class="sxs-lookup"><span data-stu-id="613a9-687">***Ethernet Source Address***</span></span>      | <span data-ttu-id="613a9-688">Questo campo di 6 byte contiene l'indirizzo del mittente della richiesta o della risposta ARP e viene configurato dal driver di rete.</span><span class="sxs-lookup"><span data-stu-id="613a9-688">This 6-byte field contains the address of the sender of the ARP request or response and is set up by the network driver.</span></span> |
| <span data-ttu-id="613a9-689">***Tipo di frame***</span><span class="sxs-lookup"><span data-stu-id="613a9-689">***Frame Type***</span></span> | <span data-ttu-id="613a9-690">Questo campo a 2 byte contiene il tipo di frame Ethernet presente e, per le richieste e le risposte ARP, è uguale a 0x0806.</span><span class="sxs-lookup"><span data-stu-id="613a9-690">This 2-byte field contains the type of Ethernet frame present and, for ARP requests and responses, this is equal to 0x0806.</span></span> <span data-ttu-id="613a9-691">Questo è l'ultimo campo che il driver di rete è responsabile della configurazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-691">This is the last field the network driver is responsible for setting up.</span></span> |
| <span data-ttu-id="613a9-692">***Tipo di hardware***</span><span class="sxs-lookup"><span data-stu-id="613a9-692">***Hardware Type***</span></span> | <span data-ttu-id="613a9-693">Questo campo a 2 byte contiene il tipo di hardware, ovvero 0x0001 per Ethernet.</span><span class="sxs-lookup"><span data-stu-id="613a9-693">This 2-byte field contains the hardware type, which is 0x0001 for Ethernet.</span></span> |
| <span data-ttu-id="613a9-694">***Tipo di protocollo***</span><span class="sxs-lookup"><span data-stu-id="613a9-694">***Protocol Type***</span></span> | <span data-ttu-id="613a9-695">Questo campo a 2 byte contiene il tipo di protocollo, ovvero 0x0800 per gli indirizzi IP.</span><span class="sxs-lookup"><span data-stu-id="613a9-695">This 2-byte field contains the protocol type, which is 0x0800 for IP addresses.</span></span> |
| <span data-ttu-id="613a9-696">***Dimensioni hardware***</span><span class="sxs-lookup"><span data-stu-id="613a9-696">***Hardware Size***</span></span> | <span data-ttu-id="613a9-697">Questo campo a 1 byte contiene le dimensioni degli indirizzi hardware, ovvero 6 per gli indirizzi Ethernet.</span><span class="sxs-lookup"><span data-stu-id="613a9-697">This 1-byte field contains the hardware address size, which is 6 for Ethernet addresses.</span></span> |

![Diagramma del formato del pacchetto ARP.](./media/user-guide/arp-packet-format.png)

<span data-ttu-id="613a9-699">**FIGURA 6. Formato del pacchetto ARP**</span><span class="sxs-lookup"><span data-stu-id="613a9-699">**FIGURE 6. ARP Packet Format**</span></span>

| <span data-ttu-id="613a9-700">Campo richiesta/risposta &nbsp;</span><span class="sxs-lookup"><span data-stu-id="613a9-700">Request/Response&nbsp;Field</span></span> | <span data-ttu-id="613a9-701">Scopo</span><span class="sxs-lookup"><span data-stu-id="613a9-701">Purpose</span></span> |
|---|---|
| <span data-ttu-id="613a9-702">***Dimensioni protocollo***</span><span class="sxs-lookup"><span data-stu-id="613a9-702">***Protocol Size***</span></span> | <span data-ttu-id="613a9-703">Questo campo a 1 byte contiene le dimensioni dell'indirizzo IP, ovvero 4 per gli indirizzi IP.</span><span class="sxs-lookup"><span data-stu-id="613a9-703">This 1-byte field contains the IP address size, which is 4 for IP addresses.</span></span> |
| <span data-ttu-id="613a9-704">***Codice operativo***</span><span class="sxs-lookup"><span data-stu-id="613a9-704">***Operation Code***</span></span> | <span data-ttu-id="613a9-705">Questo campo a 2 byte contiene l'operazione per questo pacchetto ARP.</span><span class="sxs-lookup"><span data-stu-id="613a9-705">This 2-byte field contains the operation for this ARP packet.</span></span> <span data-ttu-id="613a9-706">Una richiesta ARP viene specificata con il valore di 0x0001, mentre una risposta ARP viene rappresentata da un valore di 0x0002.</span><span class="sxs-lookup"><span data-stu-id="613a9-706">An ARP request is specified with the value of 0x0001, while an ARP response is represented by a value of 0x0002.</span></span> |
| <span data-ttu-id="613a9-707">***Indirizzo Ethernet mittente***</span><span class="sxs-lookup"><span data-stu-id="613a9-707">***Sender Ethernet Address***</span></span> | <span data-ttu-id="613a9-708">Questo campo a 6 byte contiene l'indirizzo Ethernet del mittente.</span><span class="sxs-lookup"><span data-stu-id="613a9-708">This 6-byte field contains the sender's Ethernet address.</span></span> |
| <span data-ttu-id="613a9-709">***Indirizzo IP mittente***</span><span class="sxs-lookup"><span data-stu-id="613a9-709">***Sender IP Address***</span></span> | <span data-ttu-id="613a9-710">Questo campo a 4 byte contiene l'indirizzo IP del mittente.</span><span class="sxs-lookup"><span data-stu-id="613a9-710">This 4-byte field contains the sender's IP address.</span></span> |
| <span data-ttu-id="613a9-711">***Indirizzo Ethernet di destinazione***</span><span class="sxs-lookup"><span data-stu-id="613a9-711">***Target Ethernet Address***</span></span> | <span data-ttu-id="613a9-712">Questo campo a 6 byte contiene l'indirizzo Ethernet della destinazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-712">This 6-byte field contains the target's Ethernet address.</span></span> |
| <span data-ttu-id="613a9-713">***Indirizzo IP di destinazione***</span><span class="sxs-lookup"><span data-stu-id="613a9-713">***Target IP Address***</span></span> | <span data-ttu-id="613a9-714">Questo campo a 4 byte contiene l'indirizzo IP della destinazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-714">This 4-byte field contains the target's IP address.</span></span> |

> [!NOTE]
> <span data-ttu-id="613a9-715">*Le richieste e le risposte ARP sono pacchetti a livello Ethernet. Tutti gli altri pacchetti TCP/IP sono incapsulati da un'intestazione del pacchetto IP.*</span><span class="sxs-lookup"><span data-stu-id="613a9-715">*ARP requests and responses are Ethernet-level packets. All other TCP/IP packets are encapsulated by an IP packet header.*</span></span>

> [!NOTE]
> <span data-ttu-id="613a9-716">*È previsto che tutti i messaggi ARP nell'implementazione TCP/IP siano in formato **Big Endian** . In questo formato, il byte più significativo della parola risiede nell'indirizzo di byte più basso.*</span><span class="sxs-lookup"><span data-stu-id="613a9-716">*All ARP messages in the TCP/IP implementation are expected to be in **big endian** format. In this format, the most significant byte of the word resides at the lowest byte address.*</span></span>

### <a name="arp-aging"></a><span data-ttu-id="613a9-717">Durata ARP</span><span class="sxs-lookup"><span data-stu-id="613a9-717">ARP Aging</span></span>

<span data-ttu-id="613a9-718">NetX supporta l'invalidamento automatico della voce ARP dinamica.</span><span class="sxs-lookup"><span data-stu-id="613a9-718">NetX supports automatic dynamic ARP entry invalidation.</span></span><span data-ttu-id="613a9-719">\ ***NX_ARP_EXPIRATION_RATE** _ specifica il numero di secondi per cui un indirizzo IP stabilito per il mapping fisico rimane valido.</span><span class="sxs-lookup"><span data-stu-id="613a9-719">\ ***NX_ARP_EXPIRATION_RATE** _ specifies the number of seconds an established IP address to physical mapping stays valid.</span></span> <span data-ttu-id="613a9-720">Dopo la scadenza, la voce ARP viene rimossa dalla cache ARP.</span><span class="sxs-lookup"><span data-stu-id="613a9-720">After expiration, the ARP entry is removed from the ARP cache.</span></span> <span data-ttu-id="613a9-721">Il tentativo successivo di inviare all'indirizzo IP corrispondente comporterà una nuova richiesta ARP.</span><span class="sxs-lookup"><span data-stu-id="613a9-721">The next attempt to send to the corresponding IP address will result in a new ARP request.</span></span> <span data-ttu-id="613a9-722">Impostando _ *_NX_ARP_EXPIRATION_RATE_*\* su zero, viene disabilitata la durata ARP, che è la configurazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="613a9-722">Setting _ *_NX_ARP_EXPIRATION_RATE_*\* to zero disables ARP aging, which is the default configuration.</span></span>

### <a name="arp-defend"></a><span data-ttu-id="613a9-723">Difesa ARP</span><span class="sxs-lookup"><span data-stu-id="613a9-723">ARP Defend</span></span>

<span data-ttu-id="613a9-724">Quando viene ricevuta una richiesta ARP o un pacchetto di risposta ARP e il mittente ha lo stesso indirizzo IP, che è in conflitto con l'indirizzo IP del nodo, NetX Duo invia una richiesta ARP per tale indirizzo come difesa.</span><span class="sxs-lookup"><span data-stu-id="613a9-724">When an ARP request or ARP response packet is received and the sender has the same IP address, which conflicts with the IP address of this node, NetX Duo sends an ARP request for that address as a defense.</span></span> <span data-ttu-id="613a9-725">Se il pacchetto ARP dei conflitti viene ricevuto più di una volta in 10 secondi, NetX Duo non invia più pacchetti di difesa.</span><span class="sxs-lookup"><span data-stu-id="613a9-725">If the conflict ARP packet is received more than once in 10 seconds, NetX Duo does not send more defend packets.</span></span> <span data-ttu-id="613a9-726">L'intervallo predefinito di 10 secondi può essere ridefinito da \***NX_ARP_DEFEND_INTERVAL** _.</span><span class="sxs-lookup"><span data-stu-id="613a9-726">The default interval 10 seconds can be redefined by \***NX_ARP_DEFEND_INTERVAL** _.</span></span> <span data-ttu-id="613a9-727">Questo comportamento segue i criteri specificati in 2.4 (c) di RFC5227.</span><span class="sxs-lookup"><span data-stu-id="613a9-727">This behavior follows the policy specified in 2.4(c) of RFC5227.</span></span> <span data-ttu-id="613a9-728">Poiché Windows XP ignora l'annuncio ARP come risposta per il probe ARP, l'utente può definire _ *_NX_ARP_DEFEND_BY_REPLY_*\* per inviare la risposta ARP come difesa aggiuntiva.</span><span class="sxs-lookup"><span data-stu-id="613a9-728">Since Windows XP ignores ARP announcement as a response for its ARP probe, user can define _ *_NX_ARP_DEFEND_BY_REPLY_*\* to send ARP response as additional defence.</span></span>

### <a name="arp-statistics-and-errors"></a><span data-ttu-id="613a9-729">Statistiche ed errori ARP</span><span class="sxs-lookup"><span data-stu-id="613a9-729">ARP Statistics and Errors</span></span>

<span data-ttu-id="613a9-730">Se abilitata, il software ARP NetX Duo tiene traccia di diverse statistiche ed errori che possono essere utili per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-730">If enabled, the NetX Duo ARP software keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="613a9-731">Per l'elaborazione ARP di ogni IP vengono mantenute le statistiche e i report degli errori seguenti:</span><span class="sxs-lookup"><span data-stu-id="613a9-731">The following statistics and error reports are maintained for each IP's ARP processing:</span></span>

- <span data-ttu-id="613a9-732">Totale richieste ARP inviate</span><span class="sxs-lookup"><span data-stu-id="613a9-732">Total ARP Requests Sent</span></span>
- <span data-ttu-id="613a9-733">Totale richieste ARP ricevute</span><span class="sxs-lookup"><span data-stu-id="613a9-733">Total ARP Requests Received</span></span>
- <span data-ttu-id="613a9-734">Totale risposte ARP inviate</span><span class="sxs-lookup"><span data-stu-id="613a9-734">Total ARP Responses Sent</span></span> 
- <span data-ttu-id="613a9-735">Totale risposte ARP ricevute</span><span class="sxs-lookup"><span data-stu-id="613a9-735">Total ARP Responses Received</span></span> 
- <span data-ttu-id="613a9-736">Totale voci dinamiche ARP</span><span class="sxs-lookup"><span data-stu-id="613a9-736">Total ARP Dynamic Entries</span></span> 
- <span data-ttu-id="613a9-737">Totale voci statiche ARP</span><span class="sxs-lookup"><span data-stu-id="613a9-737">Total ARP Static Entries</span></span> 
- <span data-ttu-id="613a9-738">Totale voci ARP obsolete</span><span class="sxs-lookup"><span data-stu-id="613a9-738">Total ARP Aged Entries</span></span> 
- <span data-ttu-id="613a9-739">Totale messaggi ARP non validi</span><span class="sxs-lookup"><span data-stu-id="613a9-739">Total ARP Invalid Messages</span></span> 

<span data-ttu-id="613a9-740">Tutte le statistiche e i report degli errori sono disponibili per l'applicazione con il servizio ***nx_arp_info_get*** .</span><span class="sxs-lookup"><span data-stu-id="613a9-740">All these statistics and error reports are available to the application with the ***nx_arp_info_get*** service.</span></span>

## <a name="reverse-address-resolution-protocol-rarp-in-ipv4"></a><span data-ttu-id="613a9-741">Protocollo RARP (Reverse Address Resolution Protocol) in IPv4</span><span class="sxs-lookup"><span data-stu-id="613a9-741">Reverse Address Resolution Protocol (RARP) in IPv4</span></span>

<span data-ttu-id="613a9-742">Il protocollo RARP (inverso Address Resolution Protocol) è il protocollo per la richiesta di assegnazione di rete degli indirizzi IP a 32 bit dell'host (RFC 903).</span><span class="sxs-lookup"><span data-stu-id="613a9-742">The Reverse Address Resolution Protocol (RARP) is the protocol for requesting network assignment of the host's 32-bit IP addresses (RFC 903).</span></span> <span data-ttu-id="613a9-743">Questa operazione viene eseguita tramite una richiesta RARP e continua periodicamente finché un membro di rete non assegna un indirizzo IP all'interfaccia di rete host in una risposta RARP.</span><span class="sxs-lookup"><span data-stu-id="613a9-743">This is done through an RARP request and continues periodically until a network member assigns an IP address to the host network interface in an RARP response.</span></span> <span data-ttu-id="613a9-744">L'applicazione crea un'istanza IP dal servizio ***nx_ip_create*** con un indirizzo IP zero.</span><span class="sxs-lookup"><span data-stu-id="613a9-744">The application creates an IP instance by the service ***nx_ip_create*** with a zero IP address.</span></span> <span data-ttu-id="613a9-745">Se RARP è abilitato dall'applicazione, può usare il protocollo RARP per richiedere un indirizzo IP dal server di rete accessibile tramite l'interfaccia con un indirizzo IP zero.</span><span class="sxs-lookup"><span data-stu-id="613a9-745">If RARP is enabled by the application, it can use the RARP protocol to request an IP address from the network server accessible through the interface that has a zero IP address.</span></span>

### <a name="rarp-enable"></a><span data-ttu-id="613a9-746">Abilitazione di RARP</span><span class="sxs-lookup"><span data-stu-id="613a9-746">RARP Enable</span></span>

<span data-ttu-id="613a9-747">Per usare RARP, l'applicazione deve creare l'istanza IP con un indirizzo IP pari a zero, quindi abilitare RARP usando il servizio ***nx_rarp_enable***.</span><span class="sxs-lookup"><span data-stu-id="613a9-747">To use RARP, the application must create the IP instance with an IP address of zero, then enable RARP using the service ***nx_rarp_enable***.</span></span> <span data-ttu-id="613a9-748">Per i sistemi multihome, almeno un dispositivo di rete associato all'istanza IP deve avere un indirizzo IP uguale a zero.</span><span class="sxs-lookup"><span data-stu-id="613a9-748">For multihome systems, at least one network device associated with the IP instance must have an IP address of zero.</span></span> <span data-ttu-id="613a9-749">L'elaborazione di RARP invia periodicamente messaggi di richiesta RARP per il sistema NetX duo che richiede un indirizzo IP fino a quando non viene ricevuta una risposta RARP valida con l'indirizzo IP di rete designato.</span><span class="sxs-lookup"><span data-stu-id="613a9-749">The RARP processing periodically sends RARP request messages for the NetX Duo system requiring an IP address until a valid RARP reply with the network designated IP address is received.</span></span> <span data-ttu-id="613a9-750">A questo punto, l'elaborazione di RARP è stata completata.</span><span class="sxs-lookup"><span data-stu-id="613a9-750">At this point, RARP processing is complete.</span></span>

<span data-ttu-id="613a9-751">Dopo l'abilitazione di RARP, questo viene disabilitato automaticamente dopo la risoluzione di tutti gli indirizzi di interfaccia.</span><span class="sxs-lookup"><span data-stu-id="613a9-751">After RARP has been enabled, it is disabled automatically after all interface addresses are resolved.</span></span> <span data-ttu-id="613a9-752">L'applicazione può forzare l'interruzione di RARP utilizzando il servizio ***nx_rarp_disable***.</span><span class="sxs-lookup"><span data-stu-id="613a9-752">The application may force RARP to terminate by using the service ***nx_rarp_disable***.</span></span>

### <a name="rarp-request"></a><span data-ttu-id="613a9-753">Richiesta RARP</span><span class="sxs-lookup"><span data-stu-id="613a9-753">RARP Request</span></span>

<span data-ttu-id="613a9-754">Il formato di un pacchetto di richiesta RARP è quasi identico al pacchetto ARP illustrato nella [Figura 6](#arp-messages). L'unica differenza è che il campo tipo di frame è 0x8035 e il campo del *codice operativo* è 3, che designa una richiesta RARP.</span><span class="sxs-lookup"><span data-stu-id="613a9-754">The format of an RARP request packet is almost identical to the ARP packet shown in [Figure 6](#arp-messages).The only difference is the frame type field is 0x8035 and the *Operation Code* field is 3, designating an RARP request.</span></span> <span data-ttu-id="613a9-755">Come indicato in precedenza, le richieste RARP verranno inviate periodicamente (ogni ***NX_RARP_UPDATE_RATE*** secondi) finché non viene ricevuta una risposta RARP con l'indirizzo IP assegnato alla rete.</span><span class="sxs-lookup"><span data-stu-id="613a9-755">As mentioned previously, RARP requests will be sent periodically (every ***NX_RARP_UPDATE_RATE*** seconds) until a RARP reply with the network assigned IP address is received.</span></span>

> [!NOTE]
> <span data-ttu-id="613a9-756">*È previsto che tutti i messaggi RARP nell'implementazione TCP/IP siano in formato **Big Endian** . In questo formato, il byte più significativo della parola risiede nell'indirizzo di byte più basso.*</span><span class="sxs-lookup"><span data-stu-id="613a9-756">*All RARP messages in the TCP/IP implementation are expected to be in **big endian** format. In this format, the most significant byte of the word resides at the lowest byte address.*</span></span>

### <a name="rarp-reply"></a><span data-ttu-id="613a9-757">Risposta RARP</span><span class="sxs-lookup"><span data-stu-id="613a9-757">RARP Reply</span></span>

<span data-ttu-id="613a9-758">I messaggi di risposta RARP vengono ricevuti dalla rete e contengono l'indirizzo IP assegnato alla rete per questo host.</span><span class="sxs-lookup"><span data-stu-id="613a9-758">RARP reply messages are received from the network and contain the network assigned IP address for this host.</span></span> <span data-ttu-id="613a9-759">Il formato di un pacchetto di risposta RARP è quasi identico al pacchetto ARP illustrato nella figura 6.</span><span class="sxs-lookup"><span data-stu-id="613a9-759">The format of an RARP reply packet is almost identical to the ARP packet shown in Figure 6.</span></span> <span data-ttu-id="613a9-760">L'unica differenza è che il campo tipo di frame è 0x8035 e il campo del *codice operativo* è 4, che definisce una risposta RARP.</span><span class="sxs-lookup"><span data-stu-id="613a9-760">The only difference is the frame type field is 0x8035 and the *Operation Code* field is 4, which designates an RARP reply.</span></span> <span data-ttu-id="613a9-761">Dopo la ricezione, l'indirizzo IP viene configurato nell'istanza IP, la richiesta di RARP periodica è disabilitata e l'istanza IP è ora pronta per le normali operazioni di rete.</span><span class="sxs-lookup"><span data-stu-id="613a9-761">After received, the IP address is setup in the IP instance, the periodic RARP request is disabled, and the IP instance is now ready for normal network operation.</span></span>

<span data-ttu-id="613a9-762">Per gli host multihomed, l'indirizzo IP viene applicato all'interfaccia di rete richiedente.</span><span class="sxs-lookup"><span data-stu-id="613a9-762">For multihome hosts, the IP address is applied to the requesting network interface.</span></span> <span data-ttu-id="613a9-763">Se sono presenti altre interfacce di rete che richiedono ancora un'assegnazione di indirizzi IP, il servizio di RARP periodico continua fino a quando non vengono risolte tutte le richieste di indirizzi IP dell'interfaccia.</span><span class="sxs-lookup"><span data-stu-id="613a9-763">If there are other network interfaces still requesting an IP address assignment, the periodic RARP service continues until all interface IP address requests are resolved.</span></span>

> [!NOTE]
> <span data-ttu-id="613a9-764">*L'applicazione non deve usare l'istanza IP fino al completamento dell'elaborazione di RARP. Il **nx_ip_status_check** può essere utilizzato dalle applicazioni per attendere il completamento del RARP. Per i sistemi multihome, l'applicazione non deve usare l'interfaccia richiedente fino al completamento dell'elaborazione di RARP su tale interfaccia. È possibile controllare lo stato dell'indirizzo IP nel dispositivo secondario con il servizio **nx_ip_interface_status_check** .*</span><span class="sxs-lookup"><span data-stu-id="613a9-764">*The application should not use the IP instance until the RARP processing is complete. The **nx_ip_status_check** may be used by applications to wait for the RARP completion. For multihome systems, the application should not use the requesting interface until the RARP processing is complete on that interface. Status of the IP address on the secondary device can be checked with the **nx_ip_interface_status_check** service.*</span></span>

### <a name="rarp-statistics-and-errors"></a><span data-ttu-id="613a9-765">Statistiche ed errori di RARP</span><span class="sxs-lookup"><span data-stu-id="613a9-765">RARP Statistics and Errors</span></span>

<span data-ttu-id="613a9-766">Se abilitata, il software NetX Duo RARP tiene traccia di diverse statistiche ed errori che possono essere utili per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-766">If enabled, the NetX Duo RARP software keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="613a9-767">Per l'elaborazione RARP di ogni IP vengono mantenute le statistiche e i report degli errori seguenti:</span><span class="sxs-lookup"><span data-stu-id="613a9-767">The following statistics and error reports are maintained for each IP's RARP processing:</span></span>

- <span data-ttu-id="613a9-768">Totale richieste RARP inviate</span><span class="sxs-lookup"><span data-stu-id="613a9-768">Total RARP Requests Sent</span></span>
- <span data-ttu-id="613a9-769">Totale risposte RARP ricevute</span><span class="sxs-lookup"><span data-stu-id="613a9-769">Total RARP Responses Received</span></span>
- <span data-ttu-id="613a9-770">Totale messaggi non validi RARP</span><span class="sxs-lookup"><span data-stu-id="613a9-770">Total RARP Invalid Messages</span></span>

<span data-ttu-id="613a9-771">Tutte le statistiche e i report degli errori sono disponibili per l'applicazione con il servizio ***nx_rarp_info_get*** .</span><span class="sxs-lookup"><span data-stu-id="613a9-771">All these statistics and error reports are available to the application with the ***nx_rarp_info_get*** service.</span></span>

## <a name="internet-control-message-protocol-icmp"></a><span data-ttu-id="613a9-772">Internet Control Message Protocol (ICMP)</span><span class="sxs-lookup"><span data-stu-id="613a9-772">Internet Control Message Protocol (ICMP)</span></span>

<span data-ttu-id="613a9-773">Internet Control Message Protocol per IPv4 (ICMP) è limitato al passaggio delle informazioni sugli errori e sul controllo tra i membri della rete IP.</span><span class="sxs-lookup"><span data-stu-id="613a9-773">Internet Control Message Protocol for IPv4 (ICMP) is limited to passing error and control information between IP network members.</span></span> <span data-ttu-id="613a9-774">Internet Control Message Protocol per IPv6 (ICMPv6) gestisce anche le informazioni sugli errori e sui controlli ed è necessario per i protocolli di risoluzione degli indirizzi, ad esempio il rilevamento degli indirizzi duplicati (DAD) e la configurazione automatica degli indirizzi senza stato.</span><span class="sxs-lookup"><span data-stu-id="613a9-774">Internet Control Message Protocol for IPv6 (ICMPv6) also handles error and control information and is required for address resolution protocols such as Duplicate Address Detection (DAD) and stateless address autoconfiguration.</span></span>

<span data-ttu-id="613a9-775">Come la maggior parte degli altri livelli applicazione (ad esempio TCP/IP), i messaggi ICMP e ICMPv6 sono incapsulati da un'intestazione IP con la designazione del protocollo ICMP (o ICMPv6).</span><span class="sxs-lookup"><span data-stu-id="613a9-775">Like most other application layer (e.g., TCP/IP) messages, ICMP and ICMPv6 messages are encapsulated by an IP header with the ICMP (or ICMPv6) protocol designation.</span></span>

### <a name="icmp-statistics-and-errors"></a><span data-ttu-id="613a9-776">Statistiche ed errori ICMP</span><span class="sxs-lookup"><span data-stu-id="613a9-776">ICMP Statistics and Errors</span></span>

<span data-ttu-id="613a9-777">Se abilitata, NetX Duo tiene traccia di diversi errori e statistiche ICMP che possono risultare utili per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-777">If enabled, NetX Duo keeps track of several ICMP statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="613a9-778">Per l'elaborazione ICMP di ogni IP vengono mantenute le statistiche e i report degli errori seguenti:</span><span class="sxs-lookup"><span data-stu-id="613a9-778">The following statistics and error reports are maintained for each IP's ICMP processing:</span></span> 

- <span data-ttu-id="613a9-779">Totale ping ICMP inviati</span><span class="sxs-lookup"><span data-stu-id="613a9-779">Total ICMP Pings Sent</span></span>  
- <span data-ttu-id="613a9-780">Timeout totali ping ICMP</span><span class="sxs-lookup"><span data-stu-id="613a9-780">Total ICMP Ping Timeouts</span></span> 
- <span data-ttu-id="613a9-781">Totale thread ping ICMP sospesi</span><span class="sxs-lookup"><span data-stu-id="613a9-781">Total ICMP Ping Threads Suspended</span></span> 
- <span data-ttu-id="613a9-782">Totale risposte ping ICMP ricevute</span><span class="sxs-lookup"><span data-stu-id="613a9-782">Total ICMP Ping Responses Received</span></span> 
- <span data-ttu-id="613a9-783">Totale errori di checksum ICMP</span><span class="sxs-lookup"><span data-stu-id="613a9-783">Total ICMP Checksum Errors</span></span> 
- <span data-ttu-id="613a9-784">Totale messaggi non gestiti ICMP</span><span class="sxs-lookup"><span data-stu-id="613a9-784">Total ICMP Unhandled Messages</span></span> 

<span data-ttu-id="613a9-785">Tutte le statistiche e i report degli errori sono disponibili per l'applicazione con il servizio ***nx_icmp_info_get*** .</span><span class="sxs-lookup"><span data-stu-id="613a9-785">All these statistics and error reports are available to the application with the ***nx_icmp_info_get*** service.</span></span>

## <a name="icmpv4-services-in-netx-duo"></a><span data-ttu-id="613a9-786">Servizi ICMPv4 in NetX Duo</span><span class="sxs-lookup"><span data-stu-id="613a9-786">ICMPv4 Services in NetX Duo</span></span>

### <a name="icmpv4-enable"></a><span data-ttu-id="613a9-787">Abilitazione di ICMPv4</span><span class="sxs-lookup"><span data-stu-id="613a9-787">ICMPv4 Enable</span></span>

<span data-ttu-id="613a9-788">Prima che i messaggi ICMPv4 possano essere elaborati da NetX Duo, l'applicazione deve chiamare il servizio ***nx_icmp_enable*** per abilitare l'elaborazione del ICMPv4.</span><span class="sxs-lookup"><span data-stu-id="613a9-788">Before ICMPv4 messages can be processed by NetX Duo, the application must call the ***nx_icmp_enable*** service to enable ICMPv4 processing.</span></span> <span data-ttu-id="613a9-789">Al termine di questa operazione, l'applicazione può emettere richieste ping e i pacchetti ping in ingresso del campo.</span><span class="sxs-lookup"><span data-stu-id="613a9-789">After this is done, the application can issue ping requests and field incoming ping packets.</span></span>  

### <a name="icmpv4-echo-request"></a><span data-ttu-id="613a9-790">Richiesta echo ICMPv4</span><span class="sxs-lookup"><span data-stu-id="613a9-790">ICMPv4 Echo Request</span></span>

<span data-ttu-id="613a9-791">Una richiesta echo è un tipo di messaggio ICMPv4 che viene in genere usato per verificare l'esistenza di un nodo specifico nella rete, come identificato dall'indirizzo IP dell'host.</span><span class="sxs-lookup"><span data-stu-id="613a9-791">An echo request is one type of ICMPv4 message that is typically used to check for the existence of a specific node on the network, as identified by its host IP address.</span></span> <span data-ttu-id="613a9-792">Il popolare comando ping viene implementato utilizzando i messaggi ICMP Echo Request/Echo Reply.</span><span class="sxs-lookup"><span data-stu-id="613a9-792">The popular ping command is implemented using ICMP echo request/echo reply messages.</span></span> <span data-ttu-id="613a9-793">Se l'host specifico è presente, lo stack di rete elabora la richiesta e le risposte ping con una risposta ping.</span><span class="sxs-lookup"><span data-stu-id="613a9-793">If the specific host is present, its network stack processes the ping request and responses with a ping response.</span></span> <span data-ttu-id="613a9-794">Figura 7 dettagli del formato del messaggio ping ICMPv4.</span><span class="sxs-lookup"><span data-stu-id="613a9-794">Figure 7 details the ICMPv4 ping message format.</span></span>

![Messaggio ping ICMPv4](./media/user-guide/icmpv4-ping-message.png)  

<span data-ttu-id="613a9-796">**FIGURA 7. Messaggio ping ICMPv4**</span><span class="sxs-lookup"><span data-stu-id="613a9-796">**FIGURE 7. ICMPv4 Ping Message**</span></span>

> [!NOTE]
> <span data-ttu-id="613a9-797">*Tutti i messaggi ICMPv4 nell'implementazione di TCP/IP devono essere nel formato **Big Endian** . In questo formato, il byte più significativo della parola risiede nell'indirizzo di byte più basso.*</span><span class="sxs-lookup"><span data-stu-id="613a9-797">*All ICMPv4 messages in the TCP/IP implementation are expected to be in **big endian** format. In this format, the most significant byte of the word resides at the lowest byte address.*</span></span>

<span data-ttu-id="613a9-798">Di seguito viene descritto il formato dell'intestazione ICMPv4:</span><span class="sxs-lookup"><span data-stu-id="613a9-798">The following describes the ICMPv4 header format:</span></span>

|<span data-ttu-id="613a9-799">Campo di intestazione</span><span class="sxs-lookup"><span data-stu-id="613a9-799">Header Field</span></span> |<span data-ttu-id="613a9-800">Scopo</span><span class="sxs-lookup"><span data-stu-id="613a9-800">Purpose</span></span> |
|---|---|
|<span data-ttu-id="613a9-801">**Tipo**</span><span class="sxs-lookup"><span data-stu-id="613a9-801">**Type**</span></span> |<span data-ttu-id="613a9-802">Questo campo specifica il messaggio ICMPv4 (BITS 31-24).</span><span class="sxs-lookup"><span data-stu-id="613a9-802">This field specifies the ICMPv4 message (bits 31-24).</span></span> <span data-ttu-id="613a9-803">I più comuni sono:</span><span class="sxs-lookup"><span data-stu-id="613a9-803">The most common are:</span></span><br /><span data-ttu-id="613a9-804">-0: risposta echo</span><span class="sxs-lookup"><span data-stu-id="613a9-804">-  0: Echo Reply</span></span><br /><span data-ttu-id="613a9-805">-3: destinazione non raggiungibile</span><span class="sxs-lookup"><span data-stu-id="613a9-805">- 3: Destination Unreachable</span></span><br /><span data-ttu-id="613a9-806">-8: richiesta echo</span><span class="sxs-lookup"><span data-stu-id="613a9-806">- 8: Echo Request</span></span><br /><span data-ttu-id="613a9-807">-11: tempo superato</span><span class="sxs-lookup"><span data-stu-id="613a9-807">- 11: Time Exceeded</span></span><br /><span data-ttu-id="613a9-808">-12: problema del parametro</span><span class="sxs-lookup"><span data-stu-id="613a9-808">- 12: Parameter Problem</span></span> |
|<span data-ttu-id="613a9-809">**Codice**</span><span class="sxs-lookup"><span data-stu-id="613a9-809">**Code**</span></span> |<span data-ttu-id="613a9-810">Questo campo è specifico del contesto nel campo del tipo (BITS 23-16).</span><span class="sxs-lookup"><span data-stu-id="613a9-810">This field is context specific on the type field (bits 23-16).</span></span> <span data-ttu-id="613a9-811">Per una richiesta o una risposta echo il codice è impostato su zero.</span><span class="sxs-lookup"><span data-stu-id="613a9-811">For an echo request or reply the code is set to zero.</span></span>|
|<span data-ttu-id="613a9-812">**Checksum**</span><span class="sxs-lookup"><span data-stu-id="613a9-812">**Checksum**</span></span> |<span data-ttu-id="613a9-813">Questo campo contiene il checksum a 16 bit della somma di complemento a uno del messaggio ICMPv4, inclusa l'intera intestazione ICMPv4 che inizia con il campo tipo.</span><span class="sxs-lookup"><span data-stu-id="613a9-813">This field contains the 16-bit checksum of the one's complement sum of the ICMPv4 message including the entire the ICMPv4 header starting with the Type field.</span></span> <span data-ttu-id="613a9-814">Prima di generare il checksum, il campo checksum viene cancellato.</span><span class="sxs-lookup"><span data-stu-id="613a9-814">Before generating the checksum, the checksum field is cleared.</span></span>|
|<span data-ttu-id="613a9-815">**Identificazione**</span><span class="sxs-lookup"><span data-stu-id="613a9-815">**Identification**</span></span> | <span data-ttu-id="613a9-816">Questo campo contiene un valore ID che identifica l'host. un host deve usare l'ID Estratto da una richiesta ECHO nella risposta ECHO (BITS 31-16).</span><span class="sxs-lookup"><span data-stu-id="613a9-816">This field contains an ID value identifying the host; a host should use the ID extracted from an ECHO request in the ECHO REPLY (bits 31-16).</span></span>|
|<span data-ttu-id="613a9-817">**Numero di sequenza**</span><span class="sxs-lookup"><span data-stu-id="613a9-817">**Sequence number**</span></span> |<span data-ttu-id="613a9-818">Questo campo contiene un valore ID. un host deve usare l'ID Estratto da una richiesta ECHO nella risposta ECHO (BITS 31-16).</span><span class="sxs-lookup"><span data-stu-id="613a9-818">This field contains an ID value; a host should use the ID extracted from an ECHO request in the ECHO REPLY (bits 31-16).</span></span> <span data-ttu-id="613a9-819">Diversamente dal campo identificatore, questo valore verrà modificato in una richiesta echo successiva dallo stesso host (BITS 15-0).</span><span class="sxs-lookup"><span data-stu-id="613a9-819">Unlike the identifier field, this value will change in a subsequent Echo request from the same host (bits 15-0).</span></span>|

### <a name="icmpv4-echo-response"></a><span data-ttu-id="613a9-820">Risposta echo ICMPv4</span><span class="sxs-lookup"><span data-stu-id="613a9-820">ICMPv4 Echo Response</span></span>    
<span data-ttu-id="613a9-821">Una risposta ping è un altro tipo di messaggio ICMP generato internamente dal componente ICMP in risposta a una richiesta ping esterna.</span><span class="sxs-lookup"><span data-stu-id="613a9-821">A ping response is another type of ICMP message that is generated internally by the ICMP component in response to an external ping request.</span></span> <span data-ttu-id="613a9-822">Oltre al riconoscimento, la risposta ping contiene anche una copia dei dati utente forniti nella richiesta ping.</span><span class="sxs-lookup"><span data-stu-id="613a9-822">In addition to acknowledgement, the ping response also contains a copy of the user data supplied in the ping request.</span></span>

### <a name="icmpv4-error-messages"></a><span data-ttu-id="613a9-823">Messaggi di errore ICMPv4</span><span class="sxs-lookup"><span data-stu-id="613a9-823">ICMPv4 Error Messages</span></span>   
<span data-ttu-id="613a9-824">In NetX Duo sono supportati i seguenti messaggi di errore ICMPv4:</span><span class="sxs-lookup"><span data-stu-id="613a9-824">The following ICMPv4 error messages are supported in NetX Duo:</span></span> 
- <span data-ttu-id="613a9-825">Destinazione non raggiungibile</span><span class="sxs-lookup"><span data-stu-id="613a9-825">Destination Unreachable</span></span> 
- <span data-ttu-id="613a9-826">Tempo massimo</span><span class="sxs-lookup"><span data-stu-id="613a9-826">Time Exceed</span></span> 
- <span data-ttu-id="613a9-827">Problema di parametro</span><span class="sxs-lookup"><span data-stu-id="613a9-827">Parameter Problem</span></span>

## <a name="internet-group-management-protocol-igmp"></a><span data-ttu-id="613a9-828">IGMP (Internet Group Management Protocol)</span><span class="sxs-lookup"><span data-stu-id="613a9-828">Internet Group Management Protocol (IGMP)</span></span>

<span data-ttu-id="613a9-829">Il protocollo IGMP (Internet Group Management Protocol) fornisce un dispositivo per comunicare con gli elementi adiacenti e i relativi router che intende ricevere o aggiungere un gruppo multicast IPv4 (RFC 1112 e RFC 2236).</span><span class="sxs-lookup"><span data-stu-id="613a9-829">The Internet Group Management Protocol (IGMP) provides a device to communicate with its neighbors and its routers that it intends to receive, or join, an IPv4 multicast group (RFC 1112 and RFC 2236).</span></span> <span data-ttu-id="613a9-830">Un gruppo multicast è essenzialmente una raccolta dinamica di membri di rete ed è rappresentato da un indirizzo IP di classe D.</span><span class="sxs-lookup"><span data-stu-id="613a9-830">A multicast group is basically a dynamic collection of network members and is represented by a Class D IP address.</span></span> <span data-ttu-id="613a9-831">I membri del gruppo multicast possono uscire in qualsiasi momento e i nuovi membri possono partecipare in qualsiasi momento.</span><span class="sxs-lookup"><span data-stu-id="613a9-831">Members of the multicast group may leave at any time, and new members may join at any time.</span></span> <span data-ttu-id="613a9-832">Il coordinamento necessario per l'aggiunta e l'uscita del gruppo è la responsabilità di IGMP.</span><span class="sxs-lookup"><span data-stu-id="613a9-832">The coordination involved in joining and leaving the group is the responsibility of IGMP.</span></span>

> [!NOTE]
> <span data-ttu-id="613a9-833">*IGMP è progettato solo per i gruppi multicast IPv4. Non può essere utilizzato nella rete IPv6.*</span><span class="sxs-lookup"><span data-stu-id="613a9-833">*IGMP is designed only for IPv4 multicast groups. It cannot be used on the IPv6 network.*</span></span>

### <a name="igmp-enable"></a><span data-ttu-id="613a9-834">Abilitazione IGMP</span><span class="sxs-lookup"><span data-stu-id="613a9-834">IGMP Enable</span></span>     
<span data-ttu-id="613a9-835">Prima che qualsiasi attività multicast possa essere eseguita in NetX Duo, l'applicazione deve chiamare il servizio ***nx_igmp_enable*** .</span><span class="sxs-lookup"><span data-stu-id="613a9-835">Before any multicasting activity can take place in NetX Duo, the application must call the ***nx_igmp_enable*** service.</span></span> <span data-ttu-id="613a9-836">Questo servizio esegue l'inizializzazione IGMP di base per la preparazione delle richieste multicast.</span><span class="sxs-lookup"><span data-stu-id="613a9-836">This service performs basic IGMP initialization in preparation for multicast requests.</span></span>

### <a name="multicast-ipv4-addressing"></a><span data-ttu-id="613a9-837">Indirizzamento IPv4 multicast</span><span class="sxs-lookup"><span data-stu-id="613a9-837">Multicast IPv4 Addressing</span></span>  
<span data-ttu-id="613a9-838">Come indicato in precedenza, gli indirizzi multicast sono effettivamente di classe D indirizzi IP, come illustrato nella [Figura 4](#ipv4-addresses).</span><span class="sxs-lookup"><span data-stu-id="613a9-838">As mentioned previously, multicast addresses are actually Class D IP addresses as shown in [Figure 4](#ipv4-addresses).</span></span> <span data-ttu-id="613a9-839">I 28 bit inferiori dell'indirizzo della classe D corrispondono all'ID del gruppo multicast.</span><span class="sxs-lookup"><span data-stu-id="613a9-839">The lower 28-bits of the Class D address correspond to the multicast group ID.</span></span> <span data-ttu-id="613a9-840">Sono disponibili una serie di indirizzi multicast predefiniti. Tuttavia, l' *Indirizzo All Hosts* (244.0.0.1) è particolarmente importante per l'elaborazione IGMP.</span><span class="sxs-lookup"><span data-stu-id="613a9-840">There are a series of pre-defined multicast addresses; however, the *all hosts address* (244.0.0.1) is particularly important to IGMP processing.</span></span> <span data-ttu-id="613a9-841">L' *indirizzo tutti gli host* viene usato dai router per eseguire una query su tutti i membri multicast per segnalare i gruppi multicast a cui appartengono.</span><span class="sxs-lookup"><span data-stu-id="613a9-841">The *all hosts address* is used by routers to query all multicast members to report on which multicast groups they belong to.</span></span>  

### <a name="physical-address-mapping-in-ipv4"></a><span data-ttu-id="613a9-842">Mapping degli indirizzi fisici in IPv4</span><span class="sxs-lookup"><span data-stu-id="613a9-842">Physical Address Mapping in IPv4</span></span>
<span data-ttu-id="613a9-843">Gli indirizzi multicast della classe D vengono mappati direttamente agli indirizzi Ethernet fisici compresi tra 01.00.5 e 00.00.00 tramite 01.00.5 e 7F. FF. FF.</span><span class="sxs-lookup"><span data-stu-id="613a9-843">Class D multicast addresses map directly to physical Ethernet addresses ranging from 01.00.5e.00.00.00 through 01.00.5e.7f.ff.ff.</span></span> <span data-ttu-id="613a9-844">I 23 bit inferiori della mappa indirizzi IP multicast direttamente ai 23 bit inferiori dell'indirizzo Ethernet.</span><span class="sxs-lookup"><span data-stu-id="613a9-844">The lower 23 bits of the IP multicast address map directly to the lower 23 bits of the Ethernet address.</span></span>

### <a name="multicast-group-join"></a><span data-ttu-id="613a9-845">Join gruppo multicast</span><span class="sxs-lookup"><span data-stu-id="613a9-845">Multicast Group Join</span></span>
<span data-ttu-id="613a9-846">Le applicazioni che devono partecipare a un particolare gruppo multicast possono eseguire questa operazione chiamando il servizio ***nx_igmp_multicast_join*** .</span><span class="sxs-lookup"><span data-stu-id="613a9-846">Applications that need to join a particular multicast group may do so by calling the ***nx_igmp_multicast_join*** service.</span></span> <span data-ttu-id="613a9-847">Questo servizio tiene traccia del numero di richieste da unire in join a questo gruppo multicast.</span><span class="sxs-lookup"><span data-stu-id="613a9-847">This service keeps track of the number of requests to join this multicast group.</span></span> <span data-ttu-id="613a9-848">Se si tratta della prima applicazione requestto join al gruppo multicast, viene inviato un report IGMP sulla rete primaria indicante che l'intenzione di questo host è partecipare al gruppo.</span><span class="sxs-lookup"><span data-stu-id="613a9-848">If this is the first application requestto join the multicast group, an IGMP report is sent out on the primary network indicating this host's intention to join the group.</span></span> <span data-ttu-id="613a9-849">Successivamente, il driver di rete viene chiamato per configurare per l'ascolto dei pacchetti con l'indirizzo Ethernet per questo gruppo multicast.</span><span class="sxs-lookup"><span data-stu-id="613a9-849">Next, the network driver is called to set up for listening for packets with the Ethernet address for this multicast group.</span></span>

<span data-ttu-id="613a9-850">In un sistema multihome, se il gruppo multicast è accessibile tramite un'interfaccia specifica, l'applicazione deve usare il servizio \***nx_igmp_multicast_interface_join** _ invece di _ *_nx_igmp_multicast_join_* \*, che è limitato ai gruppi multicast nella rete primaria.</span><span class="sxs-lookup"><span data-stu-id="613a9-850">In a multihome system, if the multicast group is accessible via a specific interface, application shall use the service ***nx_igmp_multicast_interface_join** _ instead of _*_nx_igmp_multicast_join_\*\*, which is limited to multicast groups on the primary network.</span></span>

### <a name="multicast-group-leave"></a><span data-ttu-id="613a9-851">Uscita gruppo multicast</span><span class="sxs-lookup"><span data-stu-id="613a9-851">Multicast Group Leave</span></span>   
<span data-ttu-id="613a9-852">Le applicazioni che devono lasciare un gruppo multicast precedentemente aggiunto possono eseguire questa operazione chiamando il servizio ***nx_igmp_multicast_leave*** .</span><span class="sxs-lookup"><span data-stu-id="613a9-852">Applications that need to leave a previously joined multicast group may do so by calling the ***nx_igmp_multicast_leave*** service.</span></span> <span data-ttu-id="613a9-853">Questo servizio riduce il numero interno associato al numero di volte in cui è stato aggiunto il gruppo.</span><span class="sxs-lookup"><span data-stu-id="613a9-853">This service reduces the internal count associated with how many times the group was joined.</span></span> <span data-ttu-id="613a9-854">Se non sono presenti richieste di join in attesa per un gruppo, il driver di rete viene chiamato per disabilitare l'ascolto dei pacchetti con l'indirizzo Ethernet del gruppo multicast.</span><span class="sxs-lookup"><span data-stu-id="613a9-854">If there are no outstanding join requests for a group, the network driver is called to disable listening for packets with this multicast group's Ethernet address.</span></span>

### <a name="multicast-loopback"></a><span data-ttu-id="613a9-855">Loopback multicast</span><span class="sxs-lookup"><span data-stu-id="613a9-855">Multicast Loopback</span></span>    
<span data-ttu-id="613a9-856">Un'applicazione potrebbe voler ricevere il traffico multicast originato da una delle origini nello stesso nodo.</span><span class="sxs-lookup"><span data-stu-id="613a9-856">An application may wish to receive multicast traffic originated from one of the sources on the same node.</span></span> <span data-ttu-id="613a9-857">A questo scopo, il componente multicast IP deve avere il loopback abilitato utilizzando il servizio ***nx_igmp_loopback_enable***.</span><span class="sxs-lookup"><span data-stu-id="613a9-857">This requires the IP multicast component to have loopback enabled by using the service ***nx_igmp_loopback_enable***.</span></span>

### <a name="igmp-report-message"></a><span data-ttu-id="613a9-858">Messaggio report IGMP</span><span class="sxs-lookup"><span data-stu-id="613a9-858">IGMP Report Message</span></span>      
<span data-ttu-id="613a9-859">Quando l'applicazione viene aggiunta a un gruppo multicast, viene inviato un messaggio di report IGMP tramite la rete per indicare che l'intenzione dell'host deve essere aggiunta a un particolare gruppo multicast.</span><span class="sxs-lookup"><span data-stu-id="613a9-859">When the application joins a multicast group, an IGMP report message is sent via the network to indicate the host's intention to join a particular multicast group.</span></span> <span data-ttu-id="613a9-860">Il formato del messaggio del report IGMP è illustrato nella figura 8.</span><span class="sxs-lookup"><span data-stu-id="613a9-860">The format of the IGMP report message is shown in Figure 8.</span></span> <span data-ttu-id="613a9-861">L'indirizzo del gruppo multicast viene utilizzato sia per il messaggio di gruppo nel messaggio del report IGMP che per l'indirizzo IP di destinazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-861">The multicast group address is used for both the group message in the IGMP report message and the destination IP address.</span></span>

<span data-ttu-id="613a9-862">Nella figura precedente (Figura 8), l'intestazione IGMP contiene un campo versione/tipo, risposta massima</span><span class="sxs-lookup"><span data-stu-id="613a9-862">In the figure above (Figure 8), the IGMP header contains a version/type field, maximum response</span></span>

![Diagramma di un messaggio di report IGMP.](./media/user-guide/image17.jpg)

<span data-ttu-id="613a9-864">**FIGURA 8. Messaggio report IGMP**</span><span class="sxs-lookup"><span data-stu-id="613a9-864">**FIGURE 8. IGMP Report Message**</span></span>

<span data-ttu-id="613a9-865">Time, un campo checksum e un campo Address gruppo multicast.</span><span class="sxs-lookup"><span data-stu-id="613a9-865">time, a checksum field, and a multicast group address field.</span></span> <span data-ttu-id="613a9-866">Per i messaggi IGMPv1, il campo tempi di risposta massimi è sempre impostato su zero, perché non fa parte del protocollo IGMPv1.</span><span class="sxs-lookup"><span data-stu-id="613a9-866">For IGMPv1 messages, the Maximum Response Time field is always set to zero, as this is not part of the IGMPv1 protocol.</span></span> <span data-ttu-id="613a9-867">Il campo tempo di risposta massimo viene impostato quando l'host riceve un messaggio IGMP di tipo query e viene cancellato quando un host riceve il messaggio del tipo di report di un altro host come definito dal protocollo IGMPv2.</span><span class="sxs-lookup"><span data-stu-id="613a9-867">The Maximum Response Time field is set when the host receives a Query type IGMP message and cleared when a host receives another host's Report type message as defined by the IGMPv2 protocol.</span></span>

<span data-ttu-id="613a9-868">Di seguito viene descritto il formato di intestazione IGMP:</span><span class="sxs-lookup"><span data-stu-id="613a9-868">The following describes the IGMP header format:</span></span>

|<span data-ttu-id="613a9-869">Campo di intestazione</span><span class="sxs-lookup"><span data-stu-id="613a9-869">Header Field</span></span>|<span data-ttu-id="613a9-870">Scopo</span><span class="sxs-lookup"><span data-stu-id="613a9-870">Purpose</span></span>|
|---|---|
|<span data-ttu-id="613a9-871">**Versione**</span><span class="sxs-lookup"><span data-stu-id="613a9-871">**Version**</span></span> |<span data-ttu-id="613a9-872">Questo campo specifica la versione IGMP (BITS 31-28).</span><span class="sxs-lookup"><span data-stu-id="613a9-872">This field specifies the IGMP version (bits 31- 28).</span></span>|
|<span data-ttu-id="613a9-873">**Tipo**</span><span class="sxs-lookup"><span data-stu-id="613a9-873">**Type**</span></span> |<span data-ttu-id="613a9-874">Questo campo specifica il tipo di messaggio IGMP (BITS 27 -24).</span><span class="sxs-lookup"><span data-stu-id="613a9-874">This field specifies the type of IGMP message (bits 27 -24).</span></span>|
|<span data-ttu-id="613a9-875">**Tempo di risposta massimo**</span><span class="sxs-lookup"><span data-stu-id="613a9-875">**Maximum Response Time**</span></span> |<span data-ttu-id="613a9-876">Non utilizzato in IGMP v1.</span><span class="sxs-lookup"><span data-stu-id="613a9-876">Not used in IGMP v1.</span></span> <span data-ttu-id="613a9-877">In IGMP V2 questo campo funge da tempo di risposta massimo.</span><span class="sxs-lookup"><span data-stu-id="613a9-877">In IGMP v2 this field serves as the maximum response time.</span></span>|
|<span data-ttu-id="613a9-878">**Checksum**</span><span class="sxs-lookup"><span data-stu-id="613a9-878">**Checksum**</span></span> |<span data-ttu-id="613a9-879">Questo campo contiene il checksum a 16 bit della somma del complemento a uno del messaggio IGMP che inizia con la versione IGMP (BITS 0-15)</span><span class="sxs-lookup"><span data-stu-id="613a9-879">This field contains the 16-bit checksum of the one's complement sum of the IGMP message starting with the IGMP version (bits 0-15)</span></span>|
|<span data-ttu-id="613a9-880">**Indirizzo del gruppo**</span><span class="sxs-lookup"><span data-stu-id="613a9-880">**Group Address**</span></span> |<span data-ttu-id="613a9-881">Indirizzo IP del gruppo di classe D a 32 bit</span><span class="sxs-lookup"><span data-stu-id="613a9-881">32-bit class D group IP address</span></span>|

<span data-ttu-id="613a9-882">I messaggi di report IGMP vengono inviati anche in risposta ai messaggi di query IGMP inviati da un router multicast.</span><span class="sxs-lookup"><span data-stu-id="613a9-882">IGMP report messages are also sent in response to IGMP query messages sent by a multicast router.</span></span> <span data-ttu-id="613a9-883">I router multicast inviano periodicamente messaggi di query per vedere quali host richiedono ancora l'appartenenza al gruppo.</span><span class="sxs-lookup"><span data-stu-id="613a9-883">Multicast routers periodically send query messages out to see which hosts still require group membership.</span></span> <span data-ttu-id="613a9-884">I messaggi di query hanno lo stesso formato del messaggio di report IGMP illustrato nella figura 8.</span><span class="sxs-lookup"><span data-stu-id="613a9-884">Query messages have the same format as the IGMP Report message shown in Figure 8.</span></span> <span data-ttu-id="613a9-885">Le uniche differenze sono il tipo IGMP è uguale a 1 e il campo Indirizzo gruppo è impostato su 0.</span><span class="sxs-lookup"><span data-stu-id="613a9-885">The only differences are the IGMP type is equal to 1 and the group address field is set to 0.</span></span> <span data-ttu-id="613a9-886">I messaggi di query IGMP vengono inviati all'indirizzo IP *tutti gli host* dal router multicast.</span><span class="sxs-lookup"><span data-stu-id="613a9-886">IGMP Query messages are sent to the *all hosts* IP address by the multicast router.</span></span> <span data-ttu-id="613a9-887">Un host che desidera comunque mantenere l'appartenenza al gruppo risponde inviando un altro messaggio di report IGMP.</span><span class="sxs-lookup"><span data-stu-id="613a9-887">A host that still wishes to maintain group membership responds by sending another IGMP Report message.</span></span>

> [!NOTE]
> <span data-ttu-id="613a9-888">*È previsto che tutti i messaggi nell'implementazione TCP/IP siano in formato **Big Endian** . In questo formato, il byte più significativo della parola risiede nell'indirizzo di byte più basso.*</span><span class="sxs-lookup"><span data-stu-id="613a9-888">*All messages in the TCP/IP implementation are expected to be in **big endian** format. In this format, the most significant byte of the word resides at the lowest byte address.*</span></span>

### <a name="igmp-statistics-and-errors"></a><span data-ttu-id="613a9-889">Statistiche ed errori IGMP</span><span class="sxs-lookup"><span data-stu-id="613a9-889">IGMP Statistics and Errors</span></span>    
<th><p><span data-ttu-id="613a9-890">Se abilitata, il software IGMP NetX Duo tiene traccia di diverse statistiche ed errori che possono essere utili per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-890">If enabled, the NetX Duo IGMP software keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="613a9-891">Per l'elaborazione IGMP di ogni IP vengono mantenute le statistiche e i report degli errori seguenti:</span><span class="sxs-lookup"><span data-stu-id="613a9-891">The following statistics and error reports are maintained for each IP's IGMP processing:</span></span> 

- <span data-ttu-id="613a9-892">Totale report IGMP inviati</span><span class="sxs-lookup"><span data-stu-id="613a9-892">Total IGMP Reports Sent</span></span> 
- <span data-ttu-id="613a9-893">Totale query IGMP ricevute</span><span class="sxs-lookup"><span data-stu-id="613a9-893">Total IGMP Queries Received</span></span> 
- <span data-ttu-id="613a9-894">Totale errori di checksum IGMP</span><span class="sxs-lookup"><span data-stu-id="613a9-894">Total IGMP Checksum Errors</span></span> 
- <span data-ttu-id="613a9-895">Totale gruppi correnti IGMP aggiunti</span><span class="sxs-lookup"><span data-stu-id="613a9-895">Total IGMP Current Groups Joined</span></span> 

<span data-ttu-id="613a9-896">Tutte le statistiche e i report degli errori sono disponibili per l'applicazione con il servizio ***nx_igmp_info_get***.</span><span class="sxs-lookup"><span data-stu-id="613a9-896">All these statistics and error reports are available to the application with the ***nx_igmp_info_get*** service.</span></span> 

### <a name="multicast-without-igmp"></a><span data-ttu-id="613a9-897">Multicast senza IGMP</span><span class="sxs-lookup"><span data-stu-id="613a9-897">Multicast without IGMP</span></span>  
<span data-ttu-id="613a9-898">L'applicazione che prevede il traffico multicast IPv4 può aggiungere un indirizzo di gruppo multicast senza richiamare messaggi IGMP utilizzando il servizio ***nx_ipv4_multicast_interface_join***.</span><span class="sxs-lookup"><span data-stu-id="613a9-898">Application expecting IPv4 multicast traffic can join a multicast group address without invoking IGMP messages by using the service ***nx_ipv4_multicast_interface_join***.</span></span> <span data-ttu-id="613a9-899">Questo servizio indica al livello IPv4 e al driver di interfaccia sottostante di accettare i pacchetti dall'indirizzo multicast IPv4 designato.</span><span class="sxs-lookup"><span data-stu-id="613a9-899">This service instructs the IPv4 layer and the underlying interface driver to accept packets from the designated IPv4 multicast address.</span></span> <span data-ttu-id="613a9-900">Tuttavia, non vengono inviati o elaborati messaggi di gestione gruppi IGMP per questo gruppo.</span><span class="sxs-lookup"><span data-stu-id="613a9-900">However there is no IGMP group management messages being sent or processed for this group.</span></span>

<span data-ttu-id="613a9-901">L'applicazione non vuole più ricevere traffico dal gruppo può usare il servizio ***nx_ipv4_multicast_interface_leave.***</span><span class="sxs-lookup"><span data-stu-id="613a9-901">Application no longer wish to receive traffic from the group can use the service ***nx_ipv4_multicast_interface_leave.***</span></span>

## <a name="ipv6-in-netx-duo"></a><span data-ttu-id="613a9-902">IPv6 in NetX Duo</span><span class="sxs-lookup"><span data-stu-id="613a9-902">IPv6 in NetX Duo</span></span>

### <a name="ipv6-addresses"></a><span data-ttu-id="613a9-903">Indirizzi IPv6</span><span class="sxs-lookup"><span data-stu-id="613a9-903">IPv6 Addresses</span></span>   
<span data-ttu-id="613a9-904">Gli indirizzi IPv6 sono di 128 bit.</span><span class="sxs-lookup"><span data-stu-id="613a9-904">IPv6 addresses are 128 bits.</span></span> <span data-ttu-id="613a9-905">L'architettura dell'indirizzo IPv6 è descritta nella specifica RFC 4291.</span><span class="sxs-lookup"><span data-stu-id="613a9-905">The architecture of IPv6 address is described in RFC 4291.</span></span> <span data-ttu-id="613a9-906">L'indirizzo è diviso in un prefisso contenente i bit più significativi e un indirizzo host contenente i bit inferiori.</span><span class="sxs-lookup"><span data-stu-id="613a9-906">The address is divided into a prefix containing the most significant bits and a host address containing the lower bits.</span></span> <span data-ttu-id="613a9-907">Il prefisso indica il tipo di indirizzo ed è approssimativamente l'equivalente dell'indirizzo di rete nella rete IPv4.</span><span class="sxs-lookup"><span data-stu-id="613a9-907">The prefix indicates the type of address and is roughly the equivalent of the network address in IPv4 network.</span></span>

<span data-ttu-id="613a9-908">IPv6 presenta tre tipi di specifiche di indirizzo: unicast, anycast (non supportato in NetX Duo) e multicast.</span><span class="sxs-lookup"><span data-stu-id="613a9-908">IPv6 has three types of address specifications: unicast, anycast (not supported in NetX Duo), and multicast.</span></span> <span data-ttu-id="613a9-909">Gli indirizzi unicast sono gli indirizzi IP che identificano un host specifico su Internet.</span><span class="sxs-lookup"><span data-stu-id="613a9-909">Unicast addresses are those IP addresses that identify a specific host on the Internet.</span></span> <span data-ttu-id="613a9-910">Gli indirizzi unicast possono essere un indirizzo IP di origine o di destinazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-910">Unicast addresses can be either a source or a destination IP address.</span></span> <span data-ttu-id="613a9-911">Indirizzi multicast specificare un gruppo dinamico di host su Internet.</span><span class="sxs-lookup"><span data-stu-id="613a9-911">Multicast addresses specify a dynamic group of hosts on the Internet.</span></span> <span data-ttu-id="613a9-912">I membri del gruppo multicast possono partecipare e lasciare ogni volta che desiderano.</span><span class="sxs-lookup"><span data-stu-id="613a9-912">Members of the multicast group may join and leave whenever they wish.</span></span>

<span data-ttu-id="613a9-913">IPv6 non dispone dell'equivalente del meccanismo di trasmissione IPv4.</span><span class="sxs-lookup"><span data-stu-id="613a9-913">IPv6 does not have the equivalent of the IPv4 broadcast mechanism.</span></span> <span data-ttu-id="613a9-914">La possibilità di inviare un pacchetto a tutti gli host può essere eseguita inviando un pacchetto al gruppo multicast tutti gli host locale del collegamento.</span><span class="sxs-lookup"><span data-stu-id="613a9-914">The ability to send a packet to all hosts can be achieved by sending a packet to the link-local all hosts multicast group.</span></span>

<span data-ttu-id="613a9-915">IPv6 utilizza indirizzi multicast per eseguire le procedure di individuazione router adiacenti, individuazione router e configurazione automatica degli indirizzi senza stato.</span><span class="sxs-lookup"><span data-stu-id="613a9-915">IPv6 utilizes multicast addresses to perform Neighbor Discovery, Router Discovery, and Stateless Address Auto Configuration procedures.</span></span>

<span data-ttu-id="613a9-916">Esistono due tipi di indirizzi unicast IPv6: collegare indirizzi locali, in genere costruiti combinando il prefisso locale di collegamento noto con l'indirizzo MAC dell'interfaccia e gli indirizzi IP globali, che hanno anche la parte prefisso e la parte dell'ID host.</span><span class="sxs-lookup"><span data-stu-id="613a9-916">There are two types of IPv6 unicast addresses: link local addresses, typically constructed by combining the well-known link local prefix with the interface MAC address, and global IP addresses, which also has the prefix portion and the host ID portion.</span></span> <span data-ttu-id="613a9-917">Un indirizzo globale può essere configurato manualmente oppure tramite la configurazione automatica degli indirizzi senza stato o DHCPv6.</span><span class="sxs-lookup"><span data-stu-id="613a9-917">A global address may be configured manually, or through the Stateless Address Autoconfiguration or DHCPv6.</span></span> <span data-ttu-id="613a9-918">NetX Duo supporta sia l'indirizzo locale del collegamento che l'indirizzo globale.</span><span class="sxs-lookup"><span data-stu-id="613a9-918">NetX Duo supports both link local address and global address.</span></span>

<span data-ttu-id="613a9-919">Per supportare sia i formati IPv4 che IPv6, NetX Duo fornisce un nuovo tipo di dati, NXD_ADDRESS, per contenere gli indirizzi IPv4 e IPv6.</span><span class="sxs-lookup"><span data-stu-id="613a9-919">To accommodate both IPv4 and IPv6 formats, NetX Duo provides a new data type, NXD_ADDRESS, for holding IPv4 and IPv6 addresses.</span></span> <span data-ttu-id="613a9-920">La definizione di questa struttura è illustrata di seguito.</span><span class="sxs-lookup"><span data-stu-id="613a9-920">The definition of this structure is shown below.</span></span> <span data-ttu-id="613a9-921">Il campo Address è un'Unione di indirizzi IPv4 e IPv6.</span><span class="sxs-lookup"><span data-stu-id="613a9-921">The address field is a union of IPv4 and IPv6 addresses.</span></span>

```c
typedef struct NXD_ADDRESS_STRUCT
{
    ULONG nxd_ip_version;
    union
    {
        ULONG v4;
        ULONG v6[4];
    } nxd_ip_address;
} NXD_ADDRESS;
```

<span data-ttu-id="613a9-922">Nella struttura NXD_ADDRESS il primo elemento, *nxd_ip_version*, indica la versione IPv4 o IPv6.</span><span class="sxs-lookup"><span data-stu-id="613a9-922">In the NXD_ADDRESS structure, the first element, *nxd_ip_version*, indicates IPv4 or IPv6 version.</span></span> <span data-ttu-id="613a9-923">I valori supportati sono NX_IP_VERSION_V4 o NX_IP_VERSION_V6.</span><span class="sxs-lookup"><span data-stu-id="613a9-923">Supported values are either NX_IP_VERSION_V4 or NX_IP_VERSION_V6.</span></span> <span data-ttu-id="613a9-924">*nxd_ip_version* indica il campo nell'Unione *nxd_ip_address* da utilizzare come indirizzo IP.</span><span class="sxs-lookup"><span data-stu-id="613a9-924">*nxd_ip_version* indicates which field in the *nxd_ip_address* union to use as the IP address.</span></span> <span data-ttu-id="613a9-925">I servizi API NetX Duo accettano in genere un puntatore alla struttura NXD_ADDRESS come argomento di input, anziché l'indirizzo IP ULONG (32 bit).</span><span class="sxs-lookup"><span data-stu-id="613a9-925">NetX Duo API services typically take a pointer to NXD_ADDRESS structure as input argument in lieu of the ULONG (32 bit) IP address.</span></span>

### <a name="link-local-addresses"></a><span data-ttu-id="613a9-926">Collega indirizzi locali</span><span class="sxs-lookup"><span data-stu-id="613a9-926">Link Local Addresses</span></span>     
<span data-ttu-id="613a9-927">Un indirizzo locale del collegamento è valido solo nella rete locale.</span><span class="sxs-lookup"><span data-stu-id="613a9-927">A link-local address is only valid on the local network.</span></span> <span data-ttu-id="613a9-928">Un dispositivo può inviare e ricevere pacchetti a un altro dispositivo nella stessa rete dopo che è stato assegnato un indirizzo locale collegamento valido.</span><span class="sxs-lookup"><span data-stu-id="613a9-928">A device can send and receive packets to another device on the same network after a valid link local address is assigned to it.</span></span> <span data-ttu-id="613a9-929">Un'applicazione assegna un indirizzo locale rispetto al collegamento chiamando il ***nxd_ipv6_address_set*** del servizio NETX Duo, con il parametro della lunghezza del prefisso impostato su 10.</span><span class="sxs-lookup"><span data-stu-id="613a9-929">An application assigns a link-local address by calling the NetX Duo service ***nxd_ipv6_address_set***, with the prefix length parameter set to 10.</span></span> <span data-ttu-id="613a9-930">L'applicazione può fornire un indirizzo locale al collegamento al servizio oppure può semplicemente usare NX_NULL come indirizzo locale del collegamento e consentire a NetX duo di creare un indirizzo locale del collegamento in base all'indirizzo MAC del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="613a9-930">The application may supply a link-local address to the service, or it may simply use NX_NULL as the link-local address and allow NetX Duo to construct a link-local address based on the device's MAC address.</span></span>

<span data-ttu-id="613a9-931">L'esempio seguente indica a NetX duo di configurare l'indirizzo locale del collegamento con una lunghezza del prefisso pari a 10 nel dispositivo primario (indice 0) usando il relativo indirizzo MAC:</span><span class="sxs-lookup"><span data-stu-id="613a9-931">The following example instructs NetX Duo to configure the link-local address with a prefix length of 10 on the primary device (index 0) using its MAC address:</span></span>

```c
nxd_ipv6_address_set(ip_ptr, 0, NX_NULL, 10, NX_NULL);
```
<span data-ttu-id="613a9-932">Nell'esempio precedente, se l'indirizzo MAC dell'interfaccia è 54:32:10:1A: BC: 67, l'indirizzo locale rispetto al collegamento corrispondente sarà:</span><span class="sxs-lookup"><span data-stu-id="613a9-932">In the example above, if the MAC address of the interface is 54:32:10:1A:BC:67, the corresponding link-local address would be:</span></span>

```c
FE80::5632:10FF:FE1A:BC67
```
<span data-ttu-id="613a9-933">Si noti che la parte relativa all'ID host dell'indirizzo IPv6 (**5632:10FF: FE1A: BC67**) è costituita dall'indirizzo Mac a 6 byte, con le modifiche seguenti:</span><span class="sxs-lookup"><span data-stu-id="613a9-933">Note that the host ID portion of the IPv6 address (**5632:10FF:FE1A:BC67**) is made up of the 6-byte MAC address, with the following modifications:</span></span>

- <span data-ttu-id="613a9-934">**0xFFFE** inserito tra i byte 3 e 4 byte dell'indirizzo Mac</span><span class="sxs-lookup"><span data-stu-id="613a9-934">**0xFFFE** inserted between byte 3 and byte 4 of the MAC address</span></span>
- <span data-ttu-id="613a9-935">Il secondo bit più basso del primo byte dell'indirizzo MAC (U/L bit) è impostato su 1</span><span class="sxs-lookup"><span data-stu-id="613a9-935">Second lowest bit of the first byte of the MAC address (U/L bit) is set to 1</span></span>

<span data-ttu-id="613a9-936">Vedere la specifica RFC 2464 (trasmissione di pacchetti IPv6 su rete Ethernet) per ulteriori informazioni su come costruire la parte host di un indirizzo IPv6 dall'indirizzo MAC dell'interfaccia.</span><span class="sxs-lookup"><span data-stu-id="613a9-936">Refer to RFC 2464 (Transmission of IPv6 Packets over Ethernet Network) for more information on how to construct the host portion of an IPv6 address from its interface MAC address.</span></span>

<span data-ttu-id="613a9-937">Sono disponibili alcuni indirizzi multicast speciali per l'invio di messaggi multicast a uno o più host in IPv6:</span><span class="sxs-lookup"><span data-stu-id="613a9-937">There are a few special multicast addresses for sending multicast messages to one or more hosts in IPv6:</span></span>

| <span data-ttu-id="613a9-938">Group</span><span class="sxs-lookup"><span data-stu-id="613a9-938">Group</span></span>  | <span data-ttu-id="613a9-939">Indirizzo</span><span class="sxs-lookup"><span data-stu-id="613a9-939">Address</span></span>   | <span data-ttu-id="613a9-940">Descrizione</span><span class="sxs-lookup"><span data-stu-id="613a9-940">Description</span></span>  |
|---|---|---|
|<span data-ttu-id="613a9-941">Gruppo tutti i nodi</span><span class="sxs-lookup"><span data-stu-id="613a9-941">All nodes group</span></span> |<span data-ttu-id="613a9-942">**FF02:: 1**</span><span class="sxs-lookup"><span data-stu-id="613a9-942">**FF02::1**</span></span> |<span data-ttu-id="613a9-943">Tutti gli host nella rete locale</span><span class="sxs-lookup"><span data-stu-id="613a9-943">All hosts on the local network</span></span>|
|<span data-ttu-id="613a9-944">Gruppo tutti i router</span><span class="sxs-lookup"><span data-stu-id="613a9-944">All routers group</span></span> |<span data-ttu-id="613a9-945">**FF02:: 2**</span><span class="sxs-lookup"><span data-stu-id="613a9-945">**FF02::2**</span></span> |<span data-ttu-id="613a9-946">Tutti i router nella rete locale</span><span class="sxs-lookup"><span data-stu-id="613a9-946">All routers on the local network</span></span>|
|<span data-ttu-id="613a9-947">Nodo sollecitato</span><span class="sxs-lookup"><span data-stu-id="613a9-947">Solicited-node</span></span> |<span data-ttu-id="613a9-948">**FF02:: 1: FF00:0/104**</span><span class="sxs-lookup"><span data-stu-id="613a9-948">**FF02::1:FF00:0/104**</span></span> |<span data-ttu-id="613a9-949">Illustrato di seguito</span><span class="sxs-lookup"><span data-stu-id="613a9-949">Explained below</span></span>|

<span data-ttu-id="613a9-950">Un indirizzo multicast del nodo richiesto è destinato a host specifici nel collegamento locale anziché a tutti gli host IPv6.</span><span class="sxs-lookup"><span data-stu-id="613a9-950">A solicited-node multicast address targets specific hosts on the local link rather than all the IPv6 hosts.</span></span> <span data-ttu-id="613a9-951">È costituito dal prefisso **FF02:: 1: FF00:0/104**, che corrisponde a 104 bit e agli ultimi 24 bit dell'indirizzo IPv6 di destinazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-951">It consists of the prefix **FF02::1:FF00:0/104**, which is 104 bits and the last 24-bits of the target IPv6 address.</span></span> <span data-ttu-id="613a9-952">Ad esempio, un indirizzo IPv6 **205B: 209D: D028:: F058: D1C8:1024** ha un indirizzo multicast Solicitednode indirizzo **FF02:: 1: FFC8:1024**.</span><span class="sxs-lookup"><span data-stu-id="613a9-952">For example, an IPv6 address **205B:209D:D028::F058:D1C8:1024** has a solicitednode multicast address of address **FF02::1:FFC8:1024**.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="613a9-953">*La notazione con due punti e virgola indica che i bit intermedi sono tutti zeri. **FF02:: 1: FF00:0/104** completamente espanso* , ad esempio **FF02:0000:0000:0000:0000:0001: FF00:0000**</span><span class="sxs-lookup"><span data-stu-id="613a9-953">*The double colon notation indicates the intervening bits are all zeroes. **FF02::1:FF00:0/104** fully expanded looks like* **FF02:0000:0000:0000:0000:0001:FF00:0000**</span></span>

### <a name="global-addresses"></a><span data-ttu-id="613a9-954">Indirizzi globali</span><span class="sxs-lookup"><span data-stu-id="613a9-954">Global Addresses</span></span>    
<span data-ttu-id="613a9-955">Un esempio di indirizzo globale IPv6 è **2001:0123:4567:89AB: CDEF:: 1** NETX Duo archivia gli indirizzi IPv6 nella struttura NXD_ADDRESS.</span><span class="sxs-lookup"><span data-stu-id="613a9-955">An example of an IPv6 global address is **2001:0123:4567:89AB:CDEF::1** NetX Duo stores IPv6 addresses in the NXD_ADDRESS structure.</span></span> <span data-ttu-id="613a9-956">Nell'esempio seguente, la variabile NXD_ADDRESS **global_ipv6_address** contiene un indirizzo IPv6 unicast.</span><span class="sxs-lookup"><span data-stu-id="613a9-956">In the example below, the NXD_ADDRESS variable **global_ipv6_address** contains a unicast IPv6 address.</span></span> <span data-ttu-id="613a9-957">Nell'esempio seguente viene illustrato un dispositivo NetX Duo per la creazione di un indirizzo globale IPv6 specifico per il dispositivo primario:</span><span class="sxs-lookup"><span data-stu-id="613a9-957">The following example demonstrates a NetX Duo device creating a specific IPv6 global address for its primary device:</span></span>

```c
NXD_ADDRESS global_ipv6_address;
UINT        primary_interface_index = 0;

global_ipv6_address.nxd_ip_version = NX_IP_VERSION_V6;
global_ipv6_address.nxd_ip_address.v6[0] = 0x20010123;
global_ipv6_address.nxd_ip_address.v6[1] = 0x456789AB;
global_ipv6_address.nxd_ip_address.v6[2] = 0xCDEF0000;
global_ipv6_address.nxd_ip_address.v6[3] = 0x00000001;

status = nxd_ipv6_address_set(
            &ip_0,
            primary_interface_index,
            &global_ipv6_address,
            64,
            NX_NULL);
```
<span data-ttu-id="613a9-958">Si noti che il prefisso di questo indirizzo IPv6 è **2001:0123:4567:89AB**, che è lunga 64 bit ed è una lunghezza del prefisso comune per gli indirizzi IPv6 unicast globali su Ethernet.</span><span class="sxs-lookup"><span data-stu-id="613a9-958">Note that the prefix of this IPv6 address is **2001:0123:4567:89AB**, which is 64 bits long and is a common prefix length for global unicast IPv6 addresses on Ethernet.</span></span>

<span data-ttu-id="613a9-959">La struttura NXD_ADDRESS include anche indirizzi IPv4.</span><span class="sxs-lookup"><span data-stu-id="613a9-959">The NXD_ADDRESS structure also holds IPv4 addresses.</span></span> <span data-ttu-id="613a9-960">Un indirizzo IP di **192.1.168.10** (**0xC001A80A**) archiviato in global_ipv4_address avrà il layout di memoria seguente:</span><span class="sxs-lookup"><span data-stu-id="613a9-960">An IP address of **192.1.168.10** (**0xC001A80A**) stored in global_ipv4_address would have the following memory layout:</span></span>

|<span data-ttu-id="613a9-961">Campo</span><span class="sxs-lookup"><span data-stu-id="613a9-961">Field</span></span> |<span data-ttu-id="613a9-962">Valore</span><span class="sxs-lookup"><span data-stu-id="613a9-962">Value</span></span> |
|---|---|
|<span data-ttu-id="613a9-963">global_ipv4_address global_ipv4_address.nxd_ip_version</span><span class="sxs-lookup"><span data-stu-id="613a9-963">global_ipv4_address.nxd_ip_version</span></span> |<span data-ttu-id="613a9-964">NX_IP_VERSION_V4</span><span class="sxs-lookup"><span data-stu-id="613a9-964">NX_IP_VERSION_V4</span></span>|
|<span data-ttu-id="613a9-965">global_ipv4_address global_ipv4_address.nxd_ip_address. v4</span><span class="sxs-lookup"><span data-stu-id="613a9-965">global_ipv4_address.nxd_ip_address.v4</span></span> |<span data-ttu-id="613a9-966">0xC001A80A</span><span class="sxs-lookup"><span data-stu-id="613a9-966">0xC001A80A</span></span>|

<span data-ttu-id="613a9-967">Quando un'applicazione passa un indirizzo ai servizi NetX Duo, il campo *nxd_ip_version* deve specificare la versione IP corretta per la gestione dei pacchetti corretta.</span><span class="sxs-lookup"><span data-stu-id="613a9-967">When an application passes an address to NetX Duo services, the *nxd_ip_version* field must specify the correct IP version for proper packet handling.</span></span>

<span data-ttu-id="613a9-968">Per garantire la compatibilità con le applicazioni NetX esistenti, NetX Duo supporta tutti i servizi NetX.</span><span class="sxs-lookup"><span data-stu-id="613a9-968">To be backward compatible with existing NetX applications, NetX Duo supports all NetX services.</span></span> <span data-ttu-id="613a9-969">Internamente, NetX Duo converte il tipo di indirizzo IPv4 ULONG in un tipo di dati NXD_ADDRESS prima di inviarlo al servizio NetX Duo effettivo.</span><span class="sxs-lookup"><span data-stu-id="613a9-969">Internally, NetX Duo converts the IPv4 address type ULONG to an NXD_ADDRESS data type before forwarding it to the actual NetX Duo service.</span></span>

<span data-ttu-id="613a9-970">Nell'esempio seguente viene illustrata la somiglianza e le differenze tra i servizi in NetX e NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="613a9-970">The following example illustrates the similarity and the differences between services in NetX and NetX Duo.</span></span>

```c
/* Make a connection to the destination IPv4 address
   192.1.168.12 through an already created TCP socket bound
   to the well known HTTP port number 80. */

global_ipv4_address.nxd_ip_version = NX_IP_VERSION_V4;
global_ipv4_address.nxd_ip_address.v4 = 0xC001A80C;

nxd_tcp_client_socket_connect(&tcp_socket,
                              &global_ipv4_address,
                              port_number,
                              NX_WAIT_FOREVER);
```

<span data-ttu-id="613a9-971">L'API NetX equivalente è la seguente:</span><span class="sxs-lookup"><span data-stu-id="613a9-971">The following is the equivalent NetX API:</span></span>

```c
ULONG         server_ip = 0xC001A80C;
NX_TCP_SOCKET tcp_socket;
UINT          port_number = 80;

nx_tcp_client_socket_connect(&tcp_socket,
                             server_ip,
                             port_number,
                             NX_WAIT_FOREVER); 
```

> [!IMPORTANT]
> <span data-ttu-id="613a9-972">*Gli sviluppatori di applicazioni sono invitati a usare la versione NXD di queste API*.</span><span class="sxs-lookup"><span data-stu-id="613a9-972">*Application developers are encouraged to use the nxd version of these APIs*.</span></span>

### <a name="ipv6-default-routers"></a><span data-ttu-id="613a9-973">Router predefiniti IPv6</span><span class="sxs-lookup"><span data-stu-id="613a9-973">IPv6 Default Routers</span></span>    
<span data-ttu-id="613a9-974">IPv6 usa un router predefinito per inoltrare i pacchetti alle destinazioni offlink.</span><span class="sxs-lookup"><span data-stu-id="613a9-974">IPv6 uses a default router to forward packets to offlink destinations.</span></span> <span data-ttu-id="613a9-975">Il servizio NetX Duo ***nxd_ipv6_default_router_add*** consente a un'applicazione di aggiungere un router IPv6 alla tabella dei router predefiniti.</span><span class="sxs-lookup"><span data-stu-id="613a9-975">The NetX Duo service ***nxd_ipv6_default_router_add*** enables an application to add an IPv6 router to the default router table.</span></span> <span data-ttu-id="613a9-976">Per altri servizi router predefiniti offerti da NetX Duo, vedere il capitolo 4 "Descrizione dei servizi".</span><span class="sxs-lookup"><span data-stu-id="613a9-976">See Chapter 4 "Description of Services" for more default router services offered by NetX Duo.</span></span>  

<span data-ttu-id="613a9-977">Quando si inoltrano pacchetti IPv6, NetX Duo verifica innanzitutto se la destinazione del pacchetto è on-link.</span><span class="sxs-lookup"><span data-stu-id="613a9-977">When forwarding IPv6 packets, NetX Duo first checks if the packet destination is on-link.</span></span> <span data-ttu-id="613a9-978">In caso contrario, NetX duo controlla la tabella di routing predefinita per un router valido per l'inoltro del pacchetto fuori collegamento a.</span><span class="sxs-lookup"><span data-stu-id="613a9-978">If not, NetX Duo checks the default routing table for a valid router to forward the off-link packet to.</span></span>  

<span data-ttu-id="613a9-979">Per rimuovere un router dalla tabella dei router predefiniti IPv6, l'applicazione deve utilizzare il servizio \***nxd_ipv6_default_router_delete** _.</span><span class="sxs-lookup"><span data-stu-id="613a9-979">To remove a router from the IPv6 default router table, application shall use the service \***nxd_ipv6_default_router_delete** _.</span></span> <span data-ttu-id="613a9-980">Per ottenere le voci della tabella dei router predefiniti IPv6, utilizzare il servizio _ *_nxd_ipv6_default_router_entry_get_* \*.</span><span class="sxs-lookup"><span data-stu-id="613a9-980">To obtain entries of the IPv6 default router table, use the service _\*_nxd_ipv6_default_router_entry_get_\*\*.</span></span>

### <a name="ipv6-header"></a><span data-ttu-id="613a9-981">Intestazione IPv6</span><span class="sxs-lookup"><span data-stu-id="613a9-981">IPv6 Header</span></span>    
<span data-ttu-id="613a9-982">L'intestazione IPv6 è stata modificata dall'intestazione IPv4.</span><span class="sxs-lookup"><span data-stu-id="613a9-982">The IPv6 header has been modified from the IPv4 header.</span></span> <span data-ttu-id="613a9-983">Quando si alloca un pacchetto, il chiamante specifica il protocollo dell'applicazione (ad esempio UDP, TCP), le dimensioni del buffer in byte e il limite di hop.</span><span class="sxs-lookup"><span data-stu-id="613a9-983">When allocating a packet, the caller specifies the application protocol (e.g., UDP, TCP), buffer size in bytes, and hop limit.</span></span>   

<span data-ttu-id="613a9-984">Nella figura 9 è illustrato il formato dell'intestazione IPv6 e la tabella elenca i componenti dell'intestazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-984">Figure 9 shows the format of the IPv6 header and the table lists the header components.</span></span>

![Diagramma del formato dell'intestazione IPv6.](./media/user-guide/image18.png)

<span data-ttu-id="613a9-986">**FIGURA 9. Formato dell'intestazione IPv6**</span><span class="sxs-lookup"><span data-stu-id="613a9-986">**FIGURE 9. IPv6 Header Format**</span></span>

|<span data-ttu-id="613a9-987">Intestazione IP</span><span class="sxs-lookup"><span data-stu-id="613a9-987">IP header</span></span> | <span data-ttu-id="613a9-988">Scopo</span><span class="sxs-lookup"><span data-stu-id="613a9-988">Purpose</span></span> |
|---|---|
|<span data-ttu-id="613a9-989">Versione</span><span class="sxs-lookup"><span data-stu-id="613a9-989">Version</span></span> |<span data-ttu-id="613a9-990">campo a 4 bit per la versione IP.</span><span class="sxs-lookup"><span data-stu-id="613a9-990">4-bit field for IP version.</span></span> <span data-ttu-id="613a9-991">Per le reti IPv6, il valore in questo campo deve essere 6; Per le reti IPv4 deve essere 4.</span><span class="sxs-lookup"><span data-stu-id="613a9-991">For IPv6 networks, the value in this field must be 6; For IPv4 networks it must be 4.</span></span>|
|<span data-ttu-id="613a9-992">Classe di traffico</span><span class="sxs-lookup"><span data-stu-id="613a9-992">Traffic Class</span></span> |<span data-ttu-id="613a9-993">campo a 8 bit in cui sono archiviate le informazioni sulla classe di traffico.</span><span class="sxs-lookup"><span data-stu-id="613a9-993">8-bit field that stores the traffic class information.</span></span> <span data-ttu-id="613a9-994">Questo campo non viene usato da NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="613a9-994">This field is not used by NetX Duo.</span></span>|
|<span data-ttu-id="613a9-995">Etichetta flusso</span><span class="sxs-lookup"><span data-stu-id="613a9-995">Flow Label</span></span> |<span data-ttu-id="613a9-996">campo a 20 bit per identificare in modo univoco il flusso, se presente, a cui è associato un pacchetto.</span><span class="sxs-lookup"><span data-stu-id="613a9-996">20-bit field to uniquely identify the flow, if any, that a packet is associated with.</span></span> <span data-ttu-id="613a9-997">Un valore pari a zero indica che il pacchetto non appartiene a un determinato flusso.</span><span class="sxs-lookup"><span data-stu-id="613a9-997">A value of zero indicates the packet does not belong to a particular flow.</span></span> <span data-ttu-id="613a9-998">Questo campo sostituisce il campo *TOS* in IPv4.</span><span class="sxs-lookup"><span data-stu-id="613a9-998">This field replaces the *TOS* field in IPv4.</span></span>|
|<span data-ttu-id="613a9-999">Lunghezza del payload</span><span class="sxs-lookup"><span data-stu-id="613a9-999">Payload Length</span></span> |<span data-ttu-id="613a9-1000">campo a 16 bit che indica la quantità di dati in byte del pacchetto IPv6 che segue l'intestazione di base IPv6.</span><span class="sxs-lookup"><span data-stu-id="613a9-1000">16-bit field indicating the amount of data in bytes of the IPv6 packet following the IPv6 base header.</span></span> <span data-ttu-id="613a9-1001">Sono inclusi tutti i dati e l'intestazione del protocollo incapsulato.</span><span class="sxs-lookup"><span data-stu-id="613a9-1001">This includes all encapsulated protocol header and data.</span></span>|
|<span data-ttu-id="613a9-1002">Intestazione successiva</span><span class="sxs-lookup"><span data-stu-id="613a9-1002">Next Header</span></span> | <span data-ttu-id="613a9-1003">campo a 8 bit che indica il tipo dell'intestazione dell'estensione che segue l'intestazione di base IPv6.</span><span class="sxs-lookup"><span data-stu-id="613a9-1003">8-bit field indicating the type of the extension header that follows the IPv6 base header.</span></span> <span data-ttu-id="613a9-1004">Questo campo sostituisce il campo *protocollo* in IPv4.</span><span class="sxs-lookup"><span data-stu-id="613a9-1004">This field replaces the *Protocol* field in IPv4.</span></span>|
|<span data-ttu-id="613a9-1005">Limite hop</span><span class="sxs-lookup"><span data-stu-id="613a9-1005">Hop Limit</span></span> |<span data-ttu-id="613a9-1006">campo a 8 bit che limita il numero di router a cui il pacchetto può passare.</span><span class="sxs-lookup"><span data-stu-id="613a9-1006">8-bit field that limits the number of routers the packet is allowed to go through.</span></span> <span data-ttu-id="613a9-1007">Questo campo sostituisce il campo *TTL* in IPv4.</span><span class="sxs-lookup"><span data-stu-id="613a9-1007">This field replaces the *TTL* field in IPv4.</span></span>|
|<span data-ttu-id="613a9-1008">Indirizzo di origine</span><span class="sxs-lookup"><span data-stu-id="613a9-1008">Source Address</span></span> |<span data-ttu-id="613a9-1009">campo a 128 bit che archivia l'indirizzo IPv6 del mittente.</span><span class="sxs-lookup"><span data-stu-id="613a9-1009">128-bit field that stores the IPv6 address of the sender.</span></span>|
|<span data-ttu-id="613a9-1010">Indirizzo di destinazione</span><span class="sxs-lookup"><span data-stu-id="613a9-1010">Destination Address</span></span> |<span data-ttu-id="613a9-1011">campo a 128 bit che piaghe l'indirizzo IPv6 della destinazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-1011">128-bit field that sores the IPv6 address of the destination.</span></span>|

### <a name="enabling-ipv6-in-netx-duo"></a><span data-ttu-id="613a9-1012">Abilitazione di IPv6 in NetX Duo</span><span class="sxs-lookup"><span data-stu-id="613a9-1012">Enabling IPv6 in NetX Duo</span></span>    
<span data-ttu-id="613a9-1013">Per impostazione predefinita, IPv6 è abilitato in NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="613a9-1013">By default IPv6 is enabled in NetX Duo.</span></span> <span data-ttu-id="613a9-1014">I servizi IPv6 sono abilitati in NetX Duo Se l'opzione configurabile \***NX_DISABLE_IPV6** _ in _nx_user. h \* non è definita.</span><span class="sxs-lookup"><span data-stu-id="613a9-1014">IPv6 services are enabled in NetX Duo if the configurable option ***NX_DISABLE_IPV6** _ in _nx_user.h* is not defined.</span></span> <span data-ttu-id="613a9-1015">Se ***NX_DISABLE_IPV6*** è stato definito, NETX Duo offrirà solo servizi IPv4 e tutti i moduli e i servizi relativi a IPv6 non saranno incorporati nella libreria NETX Duo.</span><span class="sxs-lookup"><span data-stu-id="613a9-1015">If ***NX_DISABLE_IPV6*** is defined, NetX Duo will only offer IPv4 services, and all the IPv6-related modules and services are not built into NetX Duo library.</span></span>

<span data-ttu-id="613a9-1016">Il servizio seguente viene fornito per le applicazioni per la configurazione dell'indirizzo IPv6 del dispositivo: ***nxd_ipv6_address_set***</span><span class="sxs-lookup"><span data-stu-id="613a9-1016">The following service is provided for applications to configure the device IPv6 address: ***nxd_ipv6_address_set***</span></span>

<span data-ttu-id="613a9-1017">Oltre a impostare manualmente gli indirizzi IPv6 del dispositivo, il sistema può usare anche la configurazione automatica degli indirizzi senza stato.</span><span class="sxs-lookup"><span data-stu-id="613a9-1017">In addition to manually setting the device's IPv6 addresses, the system may also use Stateless Address Autoconfiguration.</span></span> <span data-ttu-id="613a9-1018">Per usare questa opzione, l'applicazione deve chiamare \***nxd_ipv6_enable** _ per avviare i servizi IPv6 nel dispositivo.</span><span class="sxs-lookup"><span data-stu-id="613a9-1018">To use this option, the application must call \***nxd_ipv6_enable** _ to start IPv6 services on the device.</span></span> <span data-ttu-id="613a9-1019">Inoltre, è necessario avviare i servizi ICMPv6 chiamando _*_nxd_icmp_enable_*_, che consente a NETX duo di eseguire servizi quali la richiesta di router, l'individuazione dei router adiacenti e il rilevamento di indirizzi duplicati.</span><span class="sxs-lookup"><span data-stu-id="613a9-1019">In addition, ICMPv6 services must be started by calling _*_nxd_icmp_enable_*_, which enables NetX Duo to perform services such as Router Solicitation, Neighbor Discovery, and Duplicate Address Detection.</span></span> <span data-ttu-id="613a9-1020">Si noti che _*_nx_icmp_enable_*_ avvia solo ICMP per i servizi IPv4.</span><span class="sxs-lookup"><span data-stu-id="613a9-1020">Note that _*_nx_icmp_enable_*_ only starts ICMP for IPv4 services.</span></span> <span data-ttu-id="613a9-1021">_*_nxd_icmp_enable_*_ avvia i servizi ICMP sia per IPv4 che per IPv6.</span><span class="sxs-lookup"><span data-stu-id="613a9-1021">_*_nxd_icmp_enable_*_ starts ICMP services for both IPv4 and IPv6.</span></span> <span data-ttu-id="613a9-1022">Se il sistema non necessita di servizi ICMPv6, è possibile usare _ \*_nx_icmp_enable_\*\*, in modo che il modulo ICMPv6 non sia collegato al sistema.</span><span class="sxs-lookup"><span data-stu-id="613a9-1022">If the system does not need ICMPv6 services, then _ *_nx_icmp_enable_*\* can be used so the ICMPv6 module is not linked into the system.</span></span>

<span data-ttu-id="613a9-1023">Nell'esempio seguente viene illustrata una tipica procedura di inizializzazione IPv6 di NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="613a9-1023">The following example shows a typical NetX Duo IPv6 initialization procedure.</span></span>

```c
/* Assume ip_0 has been created and IPv4 services (such as ARP,
   ICMP, have been enabled. */
#define SECONDARY_INTERFACE 1

/* Enable IPv6 */
status = nxd_ipv6_enable(&ip_0);

if(status != NX_SUCCESS)
{
    /* nxd_ipv6_enable failed. */
}

/* Enable ICMPv6 */
status = nxd_icmp_enable(&ip_0);
if(status != NX_SUCCESS)
{
    /* nxd_icmp_enable failed. */
}

/* Configure the link local address on the primary interface. */
status = nxd_ipv6_address_set(&ip_0, 0, NX_NULL, 10, NX_NULL);

/* Configure ip_0 primary interface global address. */
ip_address.nxd_ip_version = NX_IP_VERSION_V6
ip_address.nxd_ip_address.v6[0] = 0x20010db8;
ip_address.nxd_ip_address.v6[1] = 0x0000f101;
ip_address.nxd_ip_address.v6[2] = 0;
ip_address.nxd_ip_address.v6[3] = 0x202;

/* Configure global address of the primary interface. */
status = nxd_ipv6_address_set(&ip_0, SECONDARY_INTERFACE,
                              &ip_address, 64, NX_NULL);
```                              

<span data-ttu-id="613a9-1024">I protocolli di livello superiore (ad esempio TCP e UDP) possono essere abilitati prima o dopo l'avvio di IPv6.</span><span class="sxs-lookup"><span data-stu-id="613a9-1024">Upper layer protocols (such as TCP and UDP) can be enabled either before or after IPv6 starts.</span></span>

> [!IMPORTANT]  
> <span data-ttu-id="613a9-1025">*I servizi IPv6 sono disponibili solo dopo l'inizializzazione del thread IP e l'abilitazione del dispositivo.*</span><span class="sxs-lookup"><span data-stu-id="613a9-1025">*IPv6 services are available only after IP thread is initialized and the device is enabled.*</span></span>

<span data-ttu-id="613a9-1026">Una volta abilitata l'interfaccia (ad esempio, il driver di dispositivo dell'interfaccia è pronto per l'invio e la ricezione dei dati ed è stato ottenuto un indirizzo locale di collegamento valido), il dispositivo può ottenere indirizzi IPv6 globali con uno dei metodi seguenti:</span><span class="sxs-lookup"><span data-stu-id="613a9-1026">After the interface is enabled (i.e.,the interface device driver is ready to send and receive data, and a valid link local address has been obtained), the device may obtain global IPv6 addresses by one of the these methods:</span></span>

- <span data-ttu-id="613a9-1027">Configurazione automatica degli indirizzi senza stato;</span><span class="sxs-lookup"><span data-stu-id="613a9-1027">Stateless Address Auto Configuration;</span></span>  
- <span data-ttu-id="613a9-1028">Configurazione manuale degli indirizzi IPv6;</span><span class="sxs-lookup"><span data-stu-id="613a9-1028">Manual IPv6 address configuration;</span></span>  
- <span data-ttu-id="613a9-1029">Configurazione degli indirizzi tramite DHCPv6 (con pacchetto DHCPv6 facoltativo)</span><span class="sxs-lookup"><span data-stu-id="613a9-1029">Address configuration via DHCPv6 (with optional DHCPv6 package)</span></span>

<span data-ttu-id="613a9-1030">I primi due metodi sono descritti di seguito.</span><span class="sxs-lookup"><span data-stu-id="613a9-1030">The first two methods are described below.</span></span> <span data-ttu-id="613a9-1031">Il terzo metodo (DHCPv6) viene descritto nel pacchetto DHCP.</span><span class="sxs-lookup"><span data-stu-id="613a9-1031">The 3rd method (DHCPv6) is described in the DHCP package.</span></span>

### <a name="stateless-address-autoconfiguration-using-router-solicitation"></a><span data-ttu-id="613a9-1032">Configurazione automatica degli indirizzi senza stato con richiesta router</span><span class="sxs-lookup"><span data-stu-id="613a9-1032">Stateless Address Autoconfiguration Using Router Solicitation</span></span>      
<span data-ttu-id="613a9-1033">I dispositivi NetX Duo possono configurare automaticamente le interfacce quando si è connessi a una rete IPv6 con un router che fornisce informazioni sul prefisso.</span><span class="sxs-lookup"><span data-stu-id="613a9-1033">NetX Duo devices can configure their interfaces automatically when connected to an IPv6 network with a router that supplies prefix information.</span></span> <span data-ttu-id="613a9-1034">I dispositivi che richiedono la configurazione automatica degli indirizzi senza stato inviano messaggi di richiesta router (RS).</span><span class="sxs-lookup"><span data-stu-id="613a9-1034">Devices that require Stateless Address Autoconfiguration send out router solicitation (RS) messages.</span></span> <span data-ttu-id="613a9-1035">I router nella rete rispondono ai messaggi di annuncio router (RA) richiesti.</span><span class="sxs-lookup"><span data-stu-id="613a9-1035">Routers on the network respond with solicited router advertisement (RA) messages.</span></span> <span data-ttu-id="613a9-1036">I messaggi RA pubblicizzano i prefissi che identificano gli indirizzi di rete associati a un collegamento.</span><span class="sxs-lookup"><span data-stu-id="613a9-1036">RA messages advertise prefixes that identify the network addresses associated with a link.</span></span> <span data-ttu-id="613a9-1037">I dispositivi generano quindi un identificatore univoco per la rete a cui è collegato il dispositivo.</span><span class="sxs-lookup"><span data-stu-id="613a9-1037">Devices then generate a unique identifier for the network the device is attached to.</span></span> <span data-ttu-id="613a9-1038">L'indirizzo viene formato combinando il prefisso e il relativo identificatore univoco.</span><span class="sxs-lookup"><span data-stu-id="613a9-1038">The address is formed by combining the prefix and its unique identifier.</span></span> <span data-ttu-id="613a9-1039">In questo modo, sulla ricezione dei messaggi RA, gli host generano il proprio indirizzo IP.</span><span class="sxs-lookup"><span data-stu-id="613a9-1039">In this manner on receiving the RA messages, hosts generate their IP address.</span></span> <span data-ttu-id="613a9-1040">I router possono anche inviare messaggi RA non richiesti periodici.</span><span class="sxs-lookup"><span data-stu-id="613a9-1040">Routers may also send periodic unsolicited RA messages.</span></span> 

> [!WARNING]
> <span data-ttu-id="613a9-1041">*NETX Duo consente a un'applicazione di abilitare o disabilitare la configurazione automatica degli indirizzi senza stato in fase di esecuzione. Per abilitare questa funzionalità, è necessario compilare la libreria NetX Duo con **NX_IPV6_STATELESS_AUTOCONFIG_CONTROL** definito. Quando questa funzionalità è abilitata, le applicazioni possono usare **nxd_ipv6_stateless_address_autoconfigure_enable** e **nxd_ipv6_stateless_address_autocofigure_disable** per abilitare o disabilitare la configurazione automatica degli indirizzi* senza stato IPv6.</span><span class="sxs-lookup"><span data-stu-id="613a9-1041">*NetX Duo allows an application to enable or disable Stateless Address Autoconfiguration at run time. To enable this feature, NetX Duo library must be compiled with **NX_IPV6_STATELESS_AUTOCONFIG_CONTROL** defined. Once this feature is enabled, applications may use **nxd_ipv6_stateless_address_autoconfigure_enable** and **nxd_ipv6_stateless_address_autocofigure_disable** to enable or disable IPv6 stateless address autoconfiguration*.</span></span>

### <a name="manual-ipv6-address-configuration"></a><span data-ttu-id="613a9-1042">Configurazione manuale degli indirizzi IPv6</span><span class="sxs-lookup"><span data-stu-id="613a9-1042">Manual IPv6 Address Configuration</span></span>     
<span data-ttu-id="613a9-1043">Se è necessario un indirizzo IPv6 specifico, è possibile che l'applicazione utilizzi ***nxd_ipv6_address_set*** per configurare manualmente un indirizzo IPv6.</span><span class="sxs-lookup"><span data-stu-id="613a9-1043">If a specific IPv6 address is needed, the application may use ***nxd_ipv6_address_set*** to manually configure an IPv6 address.</span></span> <span data-ttu-id="613a9-1044">Un'interfaccia di rete può avere più indirizzi IPv6.</span><span class="sxs-lookup"><span data-stu-id="613a9-1044">A network interface may have multiple IPv6 addresses.</span></span> <span data-ttu-id="613a9-1045">Tuttavia, tenere presente che il numero totale di indirizzi IPv6 in un sistema, ottenuti tramite la configurazione automatica degli indirizzi senza stato o tramite la configurazione manuale, non può superare ***NX_MAX_IPV6_ADDRESSES***.</span><span class="sxs-lookup"><span data-stu-id="613a9-1045">However keep in mind that the total number of IPv6 addresses in a system, either obtained through Stateless Address Autoconfiguration, or through the Manual Configuration, cannot exceed ***NX_MAX_IPV6_ADDRESSES***.</span></span>

<span data-ttu-id="613a9-1046">Nell'esempio seguente viene illustrato come configurare manualmente un indirizzo globale nell'interfaccia principale (dispositivo 0) in ip_0:</span><span class="sxs-lookup"><span data-stu-id="613a9-1046">The following example illustrates how to manually configure a global address on the primary interface (device 0) in ip_0:</span></span>

```c
NXD_ADDRESS global_address;
global_address.nxd_ip_version = NX_IP_VERSION_V6;
global_address.nxd_ip_address.v6[0] = 0x20010000;
global_address.nxd_ip_address.v6[1] = 0x00000000;
global_address.nxd_ip_address.v6[2] = 0x00000000;
global_address.nxd_ip_address.v6[3] = 0x0000ABCD;
```

<span data-ttu-id="613a9-1047">L'host chiama quindi il servizio NetX Duo seguente per assegnare questo indirizzo come indirizzo IP globale:</span><span class="sxs-lookup"><span data-stu-id="613a9-1047">The host then calls the following NetX Duo service to assign this address as its global IP address:</span></span>

```c
status = nxd_ipv6_address_set(&ip_0, 0,  
                              &global_address, 64
                              NX_NULL);
```

### <a name="duplicate-address-detection-dad"></a><span data-ttu-id="613a9-1048">Rilevamento degli indirizzi duplicati (DAD)</span><span class="sxs-lookup"><span data-stu-id="613a9-1048">Duplicate Address Detection (DAD)</span></span>    
<span data-ttu-id="613a9-1049">Dopo la configurazione dell'indirizzo IPv6 da parte di un sistema, l'indirizzo viene contrassegnato come *provvisorio*.</span><span class="sxs-lookup"><span data-stu-id="613a9-1049">After a system configures its IPv6 address, the address is marked as *TENTATIVE*.</span></span> <span data-ttu-id="613a9-1050">Se il rilevamento degli indirizzi duplicati (DAD), descritto nella specifica RFC 4862, è abilitato, NetX Duo invia automaticamente i messaggi di richiesta router adiacente (NS) con questo indirizzo provvisorio come destinazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-1050">If Duplicate Address Detection (DAD), described in RFC 4862, is enabled, NetX Duo automatically sends neighbor solicitation (NS) messages with this tentative address as the destination.</span></span> <span data-ttu-id="613a9-1051">Se nessun host nella rete risponde a questi messaggi NS entro un determinato periodo di tempo, si presuppone che l'indirizzo sia univoco nel collegamento locale e che il relativo stato sia transito allo stato valido.</span><span class="sxs-lookup"><span data-stu-id="613a9-1051">If no hosts on the network respond to these NS messages within a given period of time, the address is assumed to be unique on the local link, and its state transits to the VALID state.</span></span> <span data-ttu-id="613a9-1052">A questo punto, l'applicazione può iniziare a usare questo indirizzo IP per la comunicazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-1052">At this point the application may start using this IP address for communication.</span></span>  

<span data-ttu-id="613a9-1053">La funzionalità DAD fa parte del modulo ICMPv6.</span><span class="sxs-lookup"><span data-stu-id="613a9-1053">The DAD functionality is part of the ICMPv6 module.</span></span> <span data-ttu-id="613a9-1054">Pertanto, l'applicazione deve abilitare i servizi ICMPv6 prima che un indirizzo appena configurato possa passare attraverso il processo padre.</span><span class="sxs-lookup"><span data-stu-id="613a9-1054">Therefore, the application must enable ICMPv6 services before a newly configured address can go through the DAD process.</span></span> <span data-ttu-id="613a9-1055">In alternativa, è possibile disattivare il processo padre definendo l'opzione ***NX_DISABLE_IPV6_DAD** _ nell'ambiente di compilazione della libreria NETX Duo (definito come _*_nx_user. h_\*_).</span><span class="sxs-lookup"><span data-stu-id="613a9-1055">Alternatively, the DAD process may be turned off by defining ***NX_DISABLE_IPV6_DAD** _ option in the NetX Duo library build environment (defined as _*_nx_user.h_\*_).</span></span> <span data-ttu-id="613a9-1056">Durante il processo padre, il parametro _*_NX_IPV6_DAD_TRANSMITS_*_ determina il numero di messaggi NS inviati da NETX duo senza ricevere una risposta per determinare se l'indirizzo è univoco.</span><span class="sxs-lookup"><span data-stu-id="613a9-1056">During the DAD process, the _*_NX_IPV6_DAD_TRANSMITS_*_ parameter determines the number of NS messages sent by NetX Duo without receiving a response to determine that the address is unique.</span></span> <span data-ttu-id="613a9-1057">Per impostazione predefinita, e consigliato da RFC 4862, _ *_NX_IPV6_DAD_TRANSMITS_*\* è impostato su 3.</span><span class="sxs-lookup"><span data-stu-id="613a9-1057">By default and recommended by RFC 4862, _ *_NX_IPV6_DAD_TRANSMITS_*\* is set at 3.</span></span> <span data-ttu-id="613a9-1058">Se si imposta questo simbolo su zero, il padre viene disabilitato in modo efficace.</span><span class="sxs-lookup"><span data-stu-id="613a9-1058">Setting this symbol to zero effectively disables DAD.</span></span>

<span data-ttu-id="613a9-1059">Se ICMPv6 o DAD non è abilitato nel momento in cui l'applicazione assegna un indirizzo IPv6, il padre non viene eseguito e NetX Duo imposta lo stato dell'indirizzo IPv6 su valido immediatamente.</span><span class="sxs-lookup"><span data-stu-id="613a9-1059">If ICMPv6 or DAD is not enabled at the time the application assigns an IPv6 address, DAD is not performed and NetX Duo sets the state of the IPv6 address to VALID immediately.</span></span>

<span data-ttu-id="613a9-1060">NetX Duo non è in grado di comunicare sulla rete IPv6 finché il relativo collegamento locale e/o indirizzo globale non è valido.</span><span class="sxs-lookup"><span data-stu-id="613a9-1060">NetX Duo cannot communicate on the IPv6 network until its link local and/or global address is valid.</span></span> <span data-ttu-id="613a9-1061">Una volta ottenuto un indirizzo valido, NetX Duo tenta di trovare una corrispondenza tra l'indirizzo di destinazione di un pacchetto in ingresso e uno degli indirizzi IPv6 configurati o un indirizzo multicast abilitato.</span><span class="sxs-lookup"><span data-stu-id="613a9-1061">After a valid address is obtained, NetX Duo attempts to match the destination address of an incoming packet against one of its configured IPv6 address or an enabled multicast address.</span></span> <span data-ttu-id="613a9-1062">Se non viene trovata alcuna corrispondenza, il pacchetto viene eliminato.</span><span class="sxs-lookup"><span data-stu-id="613a9-1062">If no matches are found, the packet is dropped.</span></span> 

> [!WARNING]  
> <span data-ttu-id="613a9-1063">\* Durante il processo di DAD, il numero di pacchetti NS di DAD da trasmettere viene definito da \***NX_IPV6_DAD_TRANSMITS**_, che per impostazione predefinita è 3, e per impostazione predefinita esiste un ritardo di un secondo tra ogni messaggio NS di dad inviato. Pertanto, in un sistema con DAD abilitato, dopo l'assegnazione di un indirizzo IPv6 (e presumendo che non si tratta di un indirizzo duplicato), si verifica un ritardo di circa 3 secondi prima che l'indirizzo IP sia in uno stato valido ed è pronto per la comunicazione._</span><span class="sxs-lookup"><span data-stu-id="613a9-1063">\*During the DAD process, the number of DAD NS packets to be transmitted is defined by \***NX_IPV6_DAD_TRANSMITS**_, which defaults to 3, and by default there is a one second delay between each DAD NS message is sent. Therefore, in a system with DAD enabled, after an IPv6 address is assigned (and assuming this is not a duplicated address), there is approximately 3 seconds delay before the IP address is in a VALID state and is ready for communication._</span></span>

<span data-ttu-id="613a9-1064">Le applicazioni potrebbero voler ricevere notifiche quando vengono modificati gli indirizzi IPv6 nel sistema.</span><span class="sxs-lookup"><span data-stu-id="613a9-1064">Applications may want to receive notifications when IPv6 addresses in the system are changed.</span></span> <span data-ttu-id="613a9-1065">Per abilitare la funzionalità di notifica delle modifiche degli indirizzi IPv6, è necessario compilare la libreria NetX Duo con il simbolo **NX_ENABLE_IPV6_ADDRESS_CHANGE_NOTIFY** definito.</span><span class="sxs-lookup"><span data-stu-id="613a9-1065">To enable the IPv6 address change notification feature, the NetX Duo library must be built with the symbol **NX_ENABLE_IPV6_ADDRESS_CHANGE_NOTIFY** defined.</span></span> <span data-ttu-id="613a9-1066">Una volta abilitata la funzionalità, le applicazioni possono installare la funzione di callback usando il servizio **_nxd_ipv6_address_change_notify_** .</span><span class="sxs-lookup"><span data-stu-id="613a9-1066">Once the feature is enabled, applications may install the callback function by using the **_nxd_ipv6_address_change_notify_** service.</span></span>

<span data-ttu-id="613a9-1067">Quando viene modificato un indirizzo IPv6 o diventa non valido, viene richiamata la funzione di callback fornita dall'utente con le informazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="613a9-1067">Once an IPv6 address is changed, or becomes invalid, the user-supplied callback function is invoked with the following information:</span></span>

| <span data-ttu-id="613a9-1068">Funzione</span><span class="sxs-lookup"><span data-stu-id="613a9-1068">Function</span></span>  | <span data-ttu-id="613a9-1069">Descrizione</span><span class="sxs-lookup"><span data-stu-id="613a9-1069">Description</span></span>  |
|---|---|
|<span data-ttu-id="613a9-1070">ip_ptr</span><span class="sxs-lookup"><span data-stu-id="613a9-1070">ip_ptr</span></span> |<span data-ttu-id="613a9-1071">Puntatore all'istanza IP</span><span class="sxs-lookup"><span data-stu-id="613a9-1071">Pointer to the IP instance</span></span>|
|<span data-ttu-id="613a9-1072">interface_index</span><span class="sxs-lookup"><span data-stu-id="613a9-1072">interface_index</span></span> |<span data-ttu-id="613a9-1073">Indice dell'interfaccia di rete a cui è associato l'indirizzo IPv6</span><span class="sxs-lookup"><span data-stu-id="613a9-1073">Index to the network interface that this IPv6 address is associated with</span></span>
|<span data-ttu-id="613a9-1074">ipv6_addr_index</span><span class="sxs-lookup"><span data-stu-id="613a9-1074">ipv6_addr_index</span></span> |<span data-ttu-id="613a9-1075">Indice della tabella degli indirizzi IPv6</span><span class="sxs-lookup"><span data-stu-id="613a9-1075">Index to the IPv6 address table</span></span>|
|<span data-ttu-id="613a9-1076">ipv6_address</span><span class="sxs-lookup"><span data-stu-id="613a9-1076">ipv6_address</span></span> |<span data-ttu-id="613a9-1077">Puntatore all'indirizzo IPv6, sotto forma di matrice di quattro Integer ULONG.</span><span class="sxs-lookup"><span data-stu-id="613a9-1077">Pointer to the IPv6 address, in the form of an array of four ULONG integers.</span></span> <span data-ttu-id="613a9-1078">Gli indirizzi Pv6 vengono presentati in ordine byte host.</span><span class="sxs-lookup"><span data-stu-id="613a9-1078">Pv6 addresses are presented in host byte order.</span></span>|

### <a name="ipv6-multicast-support-in-netx-duo"></a><span data-ttu-id="613a9-1079">Supporto multicast IPv6 in NetX Duo</span><span class="sxs-lookup"><span data-stu-id="613a9-1079">IPv6 Multicast Support In NetX Duo</span></span>      
<span data-ttu-id="613a9-1080">Indirizzi multicast specificare un gruppo dinamico di host su Internet.</span><span class="sxs-lookup"><span data-stu-id="613a9-1080">Multicast addresses specify a dynamic group of hosts on the Internet.</span></span> <span data-ttu-id="613a9-1081">I membri del gruppo multicast possono partecipare e lasciare ogni volta che desiderano.</span><span class="sxs-lookup"><span data-stu-id="613a9-1081">Members of the multicast group may join and leave whenever they wish.</span></span> <span data-ttu-id="613a9-1082">NetX Duo implementa diversi protocolli ICMPv6, tra cui il rilevamento degli indirizzi duplicati, l'individuazione dei router adiacenti e l'individuazione dei router, che richiedono la funzionalità multicast IP.</span><span class="sxs-lookup"><span data-stu-id="613a9-1082">NetX Duo implements several ICMPv6 protocols, including Duplicate Address Detection, Neighbor Discovery, and Router Discovery, which require IP multicast capability.</span></span> <span data-ttu-id="613a9-1083">NetX duo prevede pertanto che il driver di dispositivo sottostante supporti le operazioni multicast.</span><span class="sxs-lookup"><span data-stu-id="613a9-1083">Therefore, NetX Duo expects the underlying device driver to support multicast operations.</span></span>

<span data-ttu-id="613a9-1084">Quando NetX Duo deve partecipare o lasciare un gruppo multicast, ad esempio l'indirizzo multicast a tutti i nodi e l'indirizzo multicast del *nodo richiesto* , emette un comando driver per il driver di dispositivo per partecipare o lasciare un indirizzo MAC multicast.</span><span class="sxs-lookup"><span data-stu-id="613a9-1084">When NetX Duo needs to join or leave a multicast group (such as the all-node multicast address, and the *solicited-node* multicast address), it issues a driver command to the device driver to join or leave a multicast MAC address.</span></span> <span data-ttu-id="613a9-1085">Il comando del driver per l'aggiunta dell'indirizzo multicast è \***NX_LINK_MULTICAST_JOIN** _.</span><span class="sxs-lookup"><span data-stu-id="613a9-1085">The driver command for joining the multicast address is \***NX_LINK_MULTICAST_JOIN** _.</span></span> <span data-ttu-id="613a9-1086">Per lasciare un indirizzo multicast, NetX Duo emette il comando driver _ *_NX_LINK_MULTICAST_LEAVE_* \*.</span><span class="sxs-lookup"><span data-stu-id="613a9-1086">To leave a multicast address, NetX Duo issues the driver command _\*_NX_LINK_MULTICAST_LEAVE_\*\*.</span></span> <span data-ttu-id="613a9-1087">Per il corretto funzionamento dei protocolli ICMPv6, il driver di dispositivo deve implementare i due comandi seguenti.</span><span class="sxs-lookup"><span data-stu-id="613a9-1087">The device driver must implement these two commands for ICMPv6 protocols to work properly.</span></span>

<span data-ttu-id="613a9-1088">Le applicazioni possono partecipare a un gruppo multicast IPv6 utilizzando il servizio \*\**nxd_ipv6_multicast_interface_join *.**</span><span class="sxs-lookup"><span data-stu-id="613a9-1088">Applications may join an IPv6 multicast group by using the service \***nxd_ipv6_multicast_interface_join\*.**</span></span> <span data-ttu-id="613a9-1089">Questo servizio registra l'indirizzo multicast con lo stack IP, quindi notifica al driver di dispositivo specificato l'indirizzo multicast IPv6.</span><span class="sxs-lookup"><span data-stu-id="613a9-1089">This service registers the multicast address with the IP stack, and then notifies the specified device driver of the IPv6 multicast address.</span></span> <span data-ttu-id="613a9-1090">Per lasciare un gruppo multicast, le applicazioni usano il servizio ***nxd_ipv6_multicast_interface_leave.***</span><span class="sxs-lookup"><span data-stu-id="613a9-1090">To leave a multicast group, applications use the service ***nxd_ipv6_multicast_interface_leave.***</span></span>

### <a name="neighbor-discovery-nd"></a><span data-ttu-id="613a9-1091">Individuazione router adiacenti (ND)</span><span class="sxs-lookup"><span data-stu-id="613a9-1091">Neighbor Discovery (ND)</span></span>    
<span data-ttu-id="613a9-1092">Individuazione router adiacenti è un protocollo nelle reti IPv6 per il mapping degli indirizzi fisici agli indirizzi IPv6 (indirizzo globale o indirizzo locale del collegamento).</span><span class="sxs-lookup"><span data-stu-id="613a9-1092">Neighbor Discovery is a protocol in IPv6 networks for mapping physical addresses to the IPv6 addresses (global address or link-local address).</span></span> <span data-ttu-id="613a9-1093">Questo mapping viene mantenuto nella cache di individuazione Neighbor (cache ND).</span><span class="sxs-lookup"><span data-stu-id="613a9-1093">This mapping is maintained in the Neighbor Discovery Cache (ND Cache).</span></span> <span data-ttu-id="613a9-1094">Il processo ND è l'equivalente del processo ARP in IPv4 e la cache ND è simile alla tabella ARP.</span><span class="sxs-lookup"><span data-stu-id="613a9-1094">The ND process is the equivalent of the ARP process in IPv4, and the ND Cache is similar to the ARP table.</span></span> <span data-ttu-id="613a9-1095">Un nodo IPv6 può ottenere l'indirizzo MAC adiacente usando il protocollo di individuazione Neighbor (ND).</span><span class="sxs-lookup"><span data-stu-id="613a9-1095">An IPv6 node can obtain its neighbor's MAC address using the Neighbor Discovery (ND) protocol.</span></span> <span data-ttu-id="613a9-1096">Invia un messaggio di richiesta (NS) adiacente all'indirizzo multicast del nodo con richiesta all-node e attende un messaggio di annuncio adiacente corrispondente (NA).</span><span class="sxs-lookup"><span data-stu-id="613a9-1096">It sends out a neighbor solicitation (NS) message to the all-node solicited node multicast address, and waits for a corresponding neighbor advertisement (NA) message.</span></span> <span data-ttu-id="613a9-1097">L'indirizzo MAC ottenuto tramite questo processo viene archiviato nella cache ND.</span><span class="sxs-lookup"><span data-stu-id="613a9-1097">The MAC address obtained through this process is stored in the ND Cache.</span></span>

<span data-ttu-id="613a9-1098">Ogni istanza IP ha una cache ND.</span><span class="sxs-lookup"><span data-stu-id="613a9-1098">Each IP instance has one ND cache.</span></span> <span data-ttu-id="613a9-1099">La cache ND viene mantenuta come una matrice di voci.</span><span class="sxs-lookup"><span data-stu-id="613a9-1099">The ND Cache is maintained as an array of entries.</span></span> <span data-ttu-id="613a9-1100">La dimensione della matrice viene definita in fase di compilazione impostando l'opzione \***NX_IPV6_NEIGHBOR_CACHE_SIZE** _ che in _ *_nx_user. h_* \*.</span><span class="sxs-lookup"><span data-stu-id="613a9-1100">The size of the array is defined at compilation time by setting the option ***NX_IPV6_NEIGHBOR_CACHE_SIZE** _ which in _*_nx_user.h_\*\*.</span></span> <span data-ttu-id="613a9-1101">Si noti che tutte le interfacce collegate a un'istanza IP condividono la stessa cache ND.</span><span class="sxs-lookup"><span data-stu-id="613a9-1101">Note that all interfaces attached to an IP instance share the same ND cache.</span></span>

<span data-ttu-id="613a9-1102">All'avvio di NetX Duo, l'intera cache ND è vuota.</span><span class="sxs-lookup"><span data-stu-id="613a9-1102">The entire ND Cache is empty when NetX Duo starts up.</span></span> <span data-ttu-id="613a9-1103">Durante l'esecuzione del sistema, NetX Duo aggiorna automaticamente la cache ND, aggiungendo ed eliminando le voci in base al protocollo ND.</span><span class="sxs-lookup"><span data-stu-id="613a9-1103">As the system runs, NetX Duo automatically updates the ND Cache, adding and deleting entries as per ND protocol.</span></span> <span data-ttu-id="613a9-1104">Tuttavia, un'applicazione può aggiornare anche la cache ND aggiungendo ed eliminando manualmente le voci della cache usando i servizi NetX Duo seguenti:</span><span class="sxs-lookup"><span data-stu-id="613a9-1104">However, an application may also update the ND Cache by manually adding and deleting cache entries using the following NetX Duo services:</span></span>

- <span data-ttu-id="613a9-1105">***nxd_nd_cache_entry_delete***</span><span class="sxs-lookup"><span data-stu-id="613a9-1105">***nxd_nd_cache_entry_delete***</span></span>  
- <span data-ttu-id="613a9-1106">***nxd_nd_cache_entry_set***</span><span class="sxs-lookup"><span data-stu-id="613a9-1106">***nxd_nd_cache_entry_set***</span></span>   
- <span data-ttu-id="613a9-1107">***nxd_nd_cache_invalidate***</span><span class="sxs-lookup"><span data-stu-id="613a9-1107">***nxd_nd_cache_invalidate***</span></span>

<span data-ttu-id="613a9-1108">Quando si inviano e ricevono pacchetti IPv6, NetX Duo aggiorna automaticamente la tabella della cache ND.</span><span class="sxs-lookup"><span data-stu-id="613a9-1108">When sending and receiving IPv6 packets, NetX Duo automatically updates the ND Cache table.</span></span>

## <a name="internet-control-message-protocol-in-ipv6-icmpv6"></a><span data-ttu-id="613a9-1109">Internet Control Message Protocol in IPv6 (ICMPv6)</span><span class="sxs-lookup"><span data-stu-id="613a9-1109">Internet Control Message Protocol in IPv6 (ICMPv6)</span></span>  

<span data-ttu-id="613a9-1110">Il ruolo di ICMPv6 in IPv6 è stato notevolmente esteso per supportare il mapping degli indirizzi IPv6 e l'individuazione dei router.</span><span class="sxs-lookup"><span data-stu-id="613a9-1110">The role of ICMPv6 in IPv6 has been greatly expanded to support IPv6 address mapping and router discovery.</span></span> <span data-ttu-id="613a9-1111">Inoltre, NetX Duo ICMPv6 supporta la richiesta e la risposta echo, le segnalazioni errori ICMPv6 e i messaggi di reindirizzamento ICMPv6.</span><span class="sxs-lookup"><span data-stu-id="613a9-1111">In addition, NetX Duo ICMPv6 supports echo request and response, ICMPv6 error reports, and ICMPv6 redirect messages.</span></span>

### <a name="icmpv6-enable"></a><span data-ttu-id="613a9-1112">Abilita ICMPv6</span><span class="sxs-lookup"><span data-stu-id="613a9-1112">ICMPv6 Enable</span></span>    
<span data-ttu-id="613a9-1113">Prima che i messaggi ICMPv6 possano essere elaborati da NetX Duo, l'applicazione deve chiamare il servizio ***nxd_icmp_enable*** per abilitare l'elaborazione ICMPv6 come descritto in precedenza.</span><span class="sxs-lookup"><span data-stu-id="613a9-1113">Before ICMPv6 messages can be processed by NetX Duo, the application must call the ***nxd_icmp_enable*** service to enable ICMPv6 processing as explained previously.</span></span> 

### <a name="icmpv6-messages"></a><span data-ttu-id="613a9-1114">Messaggi ICMPv6</span><span class="sxs-lookup"><span data-stu-id="613a9-1114">ICMPv6 Messages</span></span>     
<span data-ttu-id="613a9-1115">La struttura dell'intestazione ICMPv6 è simile alla struttura dell'intestazione ICMPv4.</span><span class="sxs-lookup"><span data-stu-id="613a9-1115">The ICMPv6 header structure is similar to the ICMPv4 header structure.</span></span> <span data-ttu-id="613a9-1116">Come illustrato di seguito, l'intestazione ICMPv6 di base contiene i tre campi, tipo, codice e checksum, oltre alla lunghezza variabile dei dati delle opzioni ICMPv6.</span><span class="sxs-lookup"><span data-stu-id="613a9-1116">As shown below, the basic ICMPv6 header contains the three fields, type, code, and checksum, plus variable length of ICMPv6 option data.</span></span> 

![Diagramma di un'intestazione ICMPv6 di base.](./media/user-guide/image19.png)

<span data-ttu-id="613a9-1118">**FIGURA 10. Intestazione ICMPv6 di base**</span><span class="sxs-lookup"><span data-stu-id="613a9-1118">**FIGURE 10. Basic ICMPv6 Header**</span></span>

|<span data-ttu-id="613a9-1119">Campo</span><span class="sxs-lookup"><span data-stu-id="613a9-1119">Field</span></span> |<span data-ttu-id="613a9-1120">Dimensioni (byte)</span><span class="sxs-lookup"><span data-stu-id="613a9-1120">Size(bytes)</span></span> |<span data-ttu-id="613a9-1121">Descrizione</span><span class="sxs-lookup"><span data-stu-id="613a9-1121">Description</span></span> |
|-----|-----|-----|
|     | <span data-ttu-id="613a9-1122">1</span><span class="sxs-lookup"><span data-stu-id="613a9-1122">1</span></span>   |<span data-ttu-id="613a9-1123">Identifica il tipo di messaggio ICMPv6;</span><span class="sxs-lookup"><span data-stu-id="613a9-1123">Identifies the ICMPv6 message type;</span></span> |
|     |     |<span data-ttu-id="613a9-1124">1 destinazione non raggiungibile</span><span class="sxs-lookup"><span data-stu-id="613a9-1124">1 Destination Unreachable</span></span> |
|     |     |<span data-ttu-id="613a9-1125">2 pacchetti troppo grandi</span><span class="sxs-lookup"><span data-stu-id="613a9-1125">2 Packet Too Big</span></span> |
|     |     |<span data-ttu-id="613a9-1126">3 volte superato</span><span class="sxs-lookup"><span data-stu-id="613a9-1126">3 Time Exceeded</span></span> |
|     |     |<span data-ttu-id="613a9-1127">4 problema di parametro</span><span class="sxs-lookup"><span data-stu-id="613a9-1127">4 Parameter Problem</span></span> |
|     |     |<span data-ttu-id="613a9-1128">128 richiesta echo</span><span class="sxs-lookup"><span data-stu-id="613a9-1128">128 Echo Request</span></span> |
|     |     |<span data-ttu-id="613a9-1129">129 risposta echo</span><span class="sxs-lookup"><span data-stu-id="613a9-1129">129 Echo Reply</span></span> |
|     |     |<span data-ttu-id="613a9-1130">133 richiesta router</span><span class="sxs-lookup"><span data-stu-id="613a9-1130">133 Router Solicitation</span></span> |
|     |     |<span data-ttu-id="613a9-1131">Annuncio router 134</span><span class="sxs-lookup"><span data-stu-id="613a9-1131">134 Router Advertisement</span></span> |
|     |     |<span data-ttu-id="613a9-1132">135 richiesta Neighbor</span><span class="sxs-lookup"><span data-stu-id="613a9-1132">135 Neighbor Solicitation</span></span> |
|     |     |<span data-ttu-id="613a9-1133">136 annuncio adiacente</span><span class="sxs-lookup"><span data-stu-id="613a9-1133">136 Neighbor Advertisement</span></span> |
|     |     |<span data-ttu-id="613a9-1134">Messaggio di reindirizzamento 137</span><span class="sxs-lookup"><span data-stu-id="613a9-1134">137 Redirect Message</span></span> |
|<span data-ttu-id="613a9-1135">Codice</span><span class="sxs-lookup"><span data-stu-id="613a9-1135">Code</span></span> | <span data-ttu-id="613a9-1136">1</span><span class="sxs-lookup"><span data-stu-id="613a9-1136">1</span></span>   |<span data-ttu-id="613a9-1137">Qualifica ulteriormente il tipo di messaggio ICMPv6.</span><span class="sxs-lookup"><span data-stu-id="613a9-1137">Further qualifies the ICMPv6 message type.</span></span> <span data-ttu-id="613a9-1138">Utilizzato generalmente con i messaggi di errore.</span><span class="sxs-lookup"><span data-stu-id="613a9-1138">Generally used with error messages.</span></span> <span data-ttu-id="613a9-1139">Se non viene usato, viene impostato su zero.</span><span class="sxs-lookup"><span data-stu-id="613a9-1139">If not used, it is set to zero.</span></span> <span data-ttu-id="613a9-1140">I messaggi di richiesta/risposta echo e NS non lo usano.</span><span class="sxs-lookup"><span data-stu-id="613a9-1140">Echo request/reply and NS messages do not use it.</span></span>|
|<span data-ttu-id="613a9-1141">Checksum</span><span class="sxs-lookup"><span data-stu-id="613a9-1141">Checksum</span></span> | <span data-ttu-id="613a9-1142">2</span><span class="sxs-lookup"><span data-stu-id="613a9-1142">2</span></span> |<span data-ttu-id="613a9-1143">campo checksum a 16 bit per l'intestazione ICMP.</span><span class="sxs-lookup"><span data-stu-id="613a9-1143">16-bit checksum field for the ICMP Header.</span></span> <span data-ttu-id="613a9-1144">Si tratta di un complemento a 16 bit dell'intero messaggio ICMPv6, inclusa l'intestazione ICMPv6.</span><span class="sxs-lookup"><span data-stu-id="613a9-1144">This is a 16-bit complement of the entire ICMPv6 message, including the ICMPv6 header.</span></span> <span data-ttu-id="613a9-1145">Include anche una pseudo-intestazione dell'indirizzo di origine IPv6, l'indirizzo di destinazione e la lunghezza del payload del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="613a9-1145">It also includes a pseudo-header of the IPv6 source address, destination address, and packet payload length.</span></span> |

<span data-ttu-id="613a9-1146">Di seguito è riportato un esempio di intestazione di richiesta Neighbor.</span><span class="sxs-lookup"><span data-stu-id="613a9-1146">An example Neighbor Solicitation header is shown below.</span></span>

![Diagramma di un'intestazione di richiesta Neighbor di esempio.](./media/user-guide/image20.jpg)

<span data-ttu-id="613a9-1148">**FIGURA 11. Intestazione ICMPv6 per un messaggio di richiesta router adiacente**</span><span class="sxs-lookup"><span data-stu-id="613a9-1148">**FIGURE 11. ICMPv6 Header for a Neighbor Solicitation Message**</span></span>

|<span data-ttu-id="613a9-1149">Campo</span><span class="sxs-lookup"><span data-stu-id="613a9-1149">Field</span></span> |<span data-ttu-id="613a9-1150">Dimensioni (byte)</span><span class="sxs-lookup"><span data-stu-id="613a9-1150">Size(bytes)</span></span> |<span data-ttu-id="613a9-1151">Descrizione</span><span class="sxs-lookup"><span data-stu-id="613a9-1151">Description</span></span> |
|-----|-----|-----|
|<span data-ttu-id="613a9-1152">Type</span><span class="sxs-lookup"><span data-stu-id="613a9-1152">Type</span></span> | <span data-ttu-id="613a9-1153">1</span><span class="sxs-lookup"><span data-stu-id="613a9-1153">1</span></span>   |<span data-ttu-id="613a9-1154">Identifica il tipo di messaggio ICMPv6 per i messaggi di richiesta adiacenti.</span><span class="sxs-lookup"><span data-stu-id="613a9-1154">Identifies the ICMPv6 message type for neighbor solicitation messages.</span></span> <span data-ttu-id="613a9-1155">Il valore è 135.</span><span class="sxs-lookup"><span data-stu-id="613a9-1155">Value is 135.</span></span> |
|<span data-ttu-id="613a9-1156">Codice</span><span class="sxs-lookup"><span data-stu-id="613a9-1156">Code</span></span> | <span data-ttu-id="613a9-1157">1</span><span class="sxs-lookup"><span data-stu-id="613a9-1157">1</span></span>   |<span data-ttu-id="613a9-1158">Non usato.</span><span class="sxs-lookup"><span data-stu-id="613a9-1158">Not used.</span></span> <span data-ttu-id="613a9-1159">Impostare su 0.</span><span class="sxs-lookup"><span data-stu-id="613a9-1159">Set to 0.</span></span> |
|<span data-ttu-id="613a9-1160">Checksum</span><span class="sxs-lookup"><span data-stu-id="613a9-1160">Checksum</span></span> | <span data-ttu-id="613a9-1161">2</span><span class="sxs-lookup"><span data-stu-id="613a9-1161">2</span></span>  |<span data-ttu-id="613a9-1162">campo checksum a 16 bit per l'intestazione ICMPv6.</span><span class="sxs-lookup"><span data-stu-id="613a9-1162">16-bit checksum field for the ICMPv6 header.</span></span> |
|<span data-ttu-id="613a9-1163">Riservato</span><span class="sxs-lookup"><span data-stu-id="613a9-1163">Reserved</span></span> | <span data-ttu-id="613a9-1164">4</span><span class="sxs-lookup"><span data-stu-id="613a9-1164">4</span></span>  |<span data-ttu-id="613a9-1165">4 byte riservati impostati su 0.</span><span class="sxs-lookup"><span data-stu-id="613a9-1165">4 reserved bytes set to 0.</span></span> |
|<span data-ttu-id="613a9-1166">Indirizzo di destinazione</span><span class="sxs-lookup"><span data-stu-id="613a9-1166">Target Address</span></span> | <span data-ttu-id="613a9-1167">16</span><span class="sxs-lookup"><span data-stu-id="613a9-1167">16</span></span>  |<span data-ttu-id="613a9-1168">Indirizzo IPv6 della destinazione della richiesta.</span><span class="sxs-lookup"><span data-stu-id="613a9-1168">IPv6 address of target of the solicitation.</span></span> <span data-ttu-id="613a9-1169">Per la risoluzione degli indirizzi IPv6, questo è l'indirizzo IP unicast effettivo del dispositivo il cui indirizzo del livello di collegamento deve essere risolto.</span><span class="sxs-lookup"><span data-stu-id="613a9-1169">For IPv6 address resolution, this is the actual unicast IP address of the device whose link layer address needs to be resolved.</span></span> |
|<span data-ttu-id="613a9-1170">Opzioni</span><span class="sxs-lookup"><span data-stu-id="613a9-1170">Options</span></span> | <span data-ttu-id="613a9-1171">Variabile</span><span class="sxs-lookup"><span data-stu-id="613a9-1171">Variable</span></span> |<span data-ttu-id="613a9-1172">Informazioni facoltative specificate dal protocollo di individuazione Neighbor.</span><span class="sxs-lookup"><span data-stu-id="613a9-1172">Optional information specified by the Neighbor Discovery Protocol.</span></span> |

### <a name="icmpv6-ping-request"></a><span data-ttu-id="613a9-1173">Richiesta ping ICMPv6</span><span class="sxs-lookup"><span data-stu-id="613a9-1173">ICMPv6 Ping Request</span></span>
<span data-ttu-id="613a9-1174">Nelle applicazioni NetX Duo utilizzare ***nxd_icmp_ping*** per emettere richieste ping IPv6 o IPv4, in base all'indirizzo IP di destinazione specificato nei parametri.</span><span class="sxs-lookup"><span data-stu-id="613a9-1174">In NetX Duo applications use ***nxd_icmp_ping*** to issue either IPv6 or IPv4 ping requests, based on the destination IP address specified in the parameters.</span></span>  

### <a name="icmpv6-ping-response"></a><span data-ttu-id="613a9-1175">Risposta ping ICMPv6</span><span class="sxs-lookup"><span data-stu-id="613a9-1175">ICMPv6 Ping Response</span></span>
<span data-ttu-id="613a9-1176">Una risposta del ping ICMPv6 è un altro tipo di messaggio ICMPv6 generato internamente dal componente ICMPv6 in risposta a una richiesta di ping ICMPv6 esterna.</span><span class="sxs-lookup"><span data-stu-id="613a9-1176">An ICMPv6 ping response is another type of ICMPv6 message that is generated internally by the ICMPv6 component in response to an external ICMPv6 ping request.</span></span> <span data-ttu-id="613a9-1177">In aggiunta al riconoscimento, la risposta al ping ICMPv6 contiene anche una copia dei dati utente specificati nella richiesta ping ICMPv6.</span><span class="sxs-lookup"><span data-stu-id="613a9-1177">In additional to acknowledgement, the ICMPv6 ping response also contains a copy of the user data supplied in the ICMPv6 ping request.</span></span>  

### <a name="thread-suspension"></a><span data-ttu-id="613a9-1178">Sospensione thread</span><span class="sxs-lookup"><span data-stu-id="613a9-1178">Thread Suspension</span></span>
<span data-ttu-id="613a9-1179">I thread dell'applicazione possono sospendere durante il tentativo di effettuare il ping di un altro membro di rete.</span><span class="sxs-lookup"><span data-stu-id="613a9-1179">Application threads can suspend while attempting to ping another network member.</span></span> <span data-ttu-id="613a9-1180">Dopo la ricezione di una risposta ping, il messaggio di risposta ping viene assegnato al primo thread sospeso e il thread viene ripreso.</span><span class="sxs-lookup"><span data-stu-id="613a9-1180">After a ping response is received, the ping response message is given to the first thread suspended and that thread is resumed.</span></span> <span data-ttu-id="613a9-1181">Come tutti i servizi NetX Duo, la sospensione su una richiesta ping presenta un timeout facoltativo.</span><span class="sxs-lookup"><span data-stu-id="613a9-1181">Like all NetX Duo services, suspending on a ping request has an optional timeout.</span></span>  

### <a name="other-icmpv6-messages"></a><span data-ttu-id="613a9-1182">Altri messaggi ICMPv6</span><span class="sxs-lookup"><span data-stu-id="613a9-1182">Other ICMPv6 Messages</span></span>
<span data-ttu-id="613a9-1183">I messaggi ICMPv6 sono necessari per le seguenti funzionalità:</span><span class="sxs-lookup"><span data-stu-id="613a9-1183">ICMPv6 messages are required for the following features:</span></span>  

- <span data-ttu-id="613a9-1184">Individuazione router adiacenti</span><span class="sxs-lookup"><span data-stu-id="613a9-1184">Neighbor Discovery</span></span>  
- <span data-ttu-id="613a9-1185">Configurazione automatica degli indirizzi senza stato</span><span class="sxs-lookup"><span data-stu-id="613a9-1185">Stateless Address Autoconfiguration</span></span> 
- <span data-ttu-id="613a9-1186">Individuazione router</span><span class="sxs-lookup"><span data-stu-id="613a9-1186">Router Discovery</span></span> 
- <span data-ttu-id="613a9-1187">Rilevamento non raggiungibilità adiacente</span><span class="sxs-lookup"><span data-stu-id="613a9-1187">Neighbor Unreachability Detection</span></span>  

### <a name="neighbor-unreachability-router-and-prefix-discovery"></a><span data-ttu-id="613a9-1188">Individuazione router e prefisso Neighbor</span><span class="sxs-lookup"><span data-stu-id="613a9-1188">Neighbor Unreachability, Router and Prefix Discovery</span></span>    
<span data-ttu-id="613a9-1189">Il rilevamento di non raggiungibilità adiacente, l'individuazione dei router e l'individuazione del prefisso sono basati sul protocollo di individuazione adiacente e sono descritti di seguito.</span><span class="sxs-lookup"><span data-stu-id="613a9-1189">Neighbor Unreachability Detection, Router Discovery, and Prefix Discovery are based on the Neighbor Discovery protocol and are described below.</span></span> 

<span data-ttu-id="613a9-1190">***Rilevamento non raggiungibilità neighbor:*** Un dispositivo IPv6 cerca nell'indirizzo del livello di collegamento di destinazione la cache di individuazione vicina (ND) per l'invio di un pacchetto.</span><span class="sxs-lookup"><span data-stu-id="613a9-1190">***Neighbor Unreachability Detection:*** An IPv6 device searches its Neighbor Discovery (ND) Cache for the destination link layer address when it wishes to send a packet.</span></span> <span data-ttu-id="613a9-1191">La destinazione immediata, a volte definita "hop successivo", può essere la destinazione effettiva sullo stesso collegamento o un router se la destinazione è off.</span><span class="sxs-lookup"><span data-stu-id="613a9-1191">The immediate destination, sometimes referred to as the 'next hop,' may be the actual destination on the same link or it may be a router if the destination is off link.</span></span> <span data-ttu-id="613a9-1192">Una voce della cache ND contiene lo stato della raggiungibilità di un router adiacente.</span><span class="sxs-lookup"><span data-stu-id="613a9-1192">An ND cache entry contains the status on a neighbor's reachability.</span></span>

<span data-ttu-id="613a9-1193">Uno stato raggiungibile indica che il router adiacente è considerato raggiungibile.</span><span class="sxs-lookup"><span data-stu-id="613a9-1193">A REACHABLE status indicates the neighbor is considered reachable.</span></span> <span data-ttu-id="613a9-1194">Un router adiacente è raggiungibile se ha ricevuto recentemente la conferma della ricezione dei pacchetti inviati al router adiacente.</span><span class="sxs-lookup"><span data-stu-id="613a9-1194">A neighbor is reachable if it has recently received confirmation that packets sent to the neighbor have been received.</span></span> <span data-ttu-id="613a9-1195">La conferma in NetX duo ha la forma di ricevere un messaggio NA dal router adiacente in risposta a un messaggio NS inviato dal dispositivo NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="613a9-1195">Confirmation in NetX Duo take the form of receiving an NA message from the neighbor in response to an NS message sent by the NetX Duo device.</span></span> <span data-ttu-id="613a9-1196">NetX Duo cambierà anche lo stato dello stato Neighbor in REACHable se l'applicazione chiama il servizio NetX Duo ***nxd_nd_cache_entry_set*** per immettere manualmente un record della cache.</span><span class="sxs-lookup"><span data-stu-id="613a9-1196">NetX Duo will also change the state of the neighbor status to REACHABLE if the application calls the NetX Duo service ***nxd_nd_cache_entry_set*** to manually enter a cache record.</span></span>

<span data-ttu-id="613a9-1197">***Individuazione router:*** Un dispositivo IPv6 usa un router per inoltrare tutti i pacchetti destinati a destinazioni di collegamento off.</span><span class="sxs-lookup"><span data-stu-id="613a9-1197">***Router Discovery:*** An IPv6 device uses a router to forward all packets intended for off link destinations.</span></span> <span data-ttu-id="613a9-1198">Può inoltre utilizzare le informazioni inviate dal router, ad esempio i messaggi di annuncio router (RA), per configurare gli indirizzi IPv6 globali.</span><span class="sxs-lookup"><span data-stu-id="613a9-1198">It may also use information sent by the router, such as router advertisement (RA) messages, to configure its global IPv6 addresses.</span></span>

<span data-ttu-id="613a9-1199">Un dispositivo nella rete può avviare il processo di individuazione del router inviando un messaggio di richiesta router (RS) all'indirizzo multicast All-router (FF01:: 2).</span><span class="sxs-lookup"><span data-stu-id="613a9-1199">A device on the network may initiate the Router Discovery process by sending a router solicitation (RS) message to the all-router multicast address (FF01::2).</span></span> <span data-ttu-id="613a9-1200">In alternativa, è possibile attendere l'indirizzo multicast a tutti i nodi (FF:: 1) per un RA periodico dai router.</span><span class="sxs-lookup"><span data-stu-id="613a9-1200">Or it can wait on the all-node multicast address (FF::1) for a periodic RA from the routers.</span></span>

<span data-ttu-id="613a9-1201">Un messaggio RA contiene le informazioni sul prefisso per la configurazione di un indirizzo IPv6 per la rete.</span><span class="sxs-lookup"><span data-stu-id="613a9-1201">An RA message contains the prefix information for configuring an IPv6 address for that network.</span></span> <span data-ttu-id="613a9-1202">In NetX Duo, la richiesta del router è abilitata per impostazione predefinita e può essere disabilitata impostando l'opzione di configurazione \***NX_DISABLE_ICMPV6_ROUTER_SOLICITATION** _ in _ *_nx_user. h_* \*.</span><span class="sxs-lookup"><span data-stu-id="613a9-1202">In NetX Duo, router solicitation is by default enabled and can be disabled by setting the configuration option ***NX_DISABLE_ICMPV6_ROUTER_SOLICITATION** _ in _*_nx_user.h_\*\*.</span></span> <span data-ttu-id="613a9-1203">Vedere le opzioni di configurazione nel capitolo "installazione e uso di NetX Duo" per altre informazioni sull'impostazione dei parametri di richiesta router.</span><span class="sxs-lookup"><span data-stu-id="613a9-1203">See Configuration Options in the "Installation and Use of NetX Duo" chapter for more details on setting Router Solicitation parameters.</span></span> 

<span data-ttu-id="613a9-1204">***Individuazione prefisso***: un dispositivo IPv6 usa l'individuazione del prefisso per scoprire quali host di destinazione sono accessibili direttamente senza passare attraverso un router.</span><span class="sxs-lookup"><span data-stu-id="613a9-1204">***Prefix Discovery***: An IPv6 device uses prefix discovery to learn which target hosts are accessible directly without going through a router.</span></span> <span data-ttu-id="613a9-1205">Queste informazioni vengono rese disponibili per il dispositivo IPv6 da messaggi RA dal router.</span><span class="sxs-lookup"><span data-stu-id="613a9-1205">This information is made available to the IPv6 device from RA messages from the router.</span></span> <span data-ttu-id="613a9-1206">Il dispositivo IPv6 archivia le informazioni sul prefisso in una tabella dei prefissi.</span><span class="sxs-lookup"><span data-stu-id="613a9-1206">The IPv6 device stores the prefix information in a prefix table.</span></span> <span data-ttu-id="613a9-1207">L'individuazione dei prefissi corrisponde a un prefisso della tabella dei prefissi di dispositivo IPv6 a un indirizzo di destinazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-1207">Prefix discovery is matching a prefix from the IPv6 device prefix table to a target address.</span></span> <span data-ttu-id="613a9-1208">Un prefisso corrisponde a un indirizzo di destinazione se tutti i bit nel prefisso corrispondono ai bit più significativi dell'indirizzo di destinazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-1208">A prefix matches a target address if all the bits in the prefix match the most significant bits of the target address.</span></span> <span data-ttu-id="613a9-1209">Se più di un prefisso copre un indirizzo, viene selezionato il prefisso più lungo.</span><span class="sxs-lookup"><span data-stu-id="613a9-1209">If more than one prefix covers an address, the longest prefix is selected.</span></span>

### <a name="icmpv6-error-messages"></a><span data-ttu-id="613a9-1210">Messaggi di errore ICMPv6</span><span class="sxs-lookup"><span data-stu-id="613a9-1210">ICMPv6 Error Messages</span></span>    
<span data-ttu-id="613a9-1211">In NetX Duo sono supportati i messaggi di errore ICMPv6 seguenti:</span><span class="sxs-lookup"><span data-stu-id="613a9-1211">The following ICMPv6 error messages are supported in NetX Duo:</span></span>  

- <span data-ttu-id="613a9-1212">Destinazione non raggiungibile</span><span class="sxs-lookup"><span data-stu-id="613a9-1212">Destination Unreachable</span></span>  
- <span data-ttu-id="613a9-1213">Pacchetto troppo grande</span><span class="sxs-lookup"><span data-stu-id="613a9-1213">Packet Too Big</span></span>  
- <span data-ttu-id="613a9-1214">Tempo massimo</span><span class="sxs-lookup"><span data-stu-id="613a9-1214">Time Exceed</span></span>  
- <span data-ttu-id="613a9-1215">Problema di parametro</span><span class="sxs-lookup"><span data-stu-id="613a9-1215">Parameter Problem</span></span>  

## <a name="user-datagram-protocol-udp"></a><span data-ttu-id="613a9-1216">UDP (User Datagram Protocol)</span><span class="sxs-lookup"><span data-stu-id="613a9-1216">User Datagram Protocol (UDP)</span></span>

<span data-ttu-id="613a9-1217">Il protocollo UDP (User Datagram Protocol) fornisce la forma più semplice di trasferimento dei dati tra i membri di rete (RFC 768).</span><span class="sxs-lookup"><span data-stu-id="613a9-1217">The User Datagram Protocol (UDP) provides the simplest form of data transfer between network members (RFC 768).</span></span> <span data-ttu-id="613a9-1218">I pacchetti di dati UDP vengono inviati da un membro di rete a un altro nel modo migliore possibile. ovvero, non esiste alcun meccanismo incorporato per il riconoscimento da parte del destinatario del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="613a9-1218">UDP data packets are sent from one network member to another in a best effort fashion; i.e., there is no built-in mechanism for acknowledgement by the packet recipient.</span></span> <span data-ttu-id="613a9-1219">Inoltre, per l'invio di un pacchetto UDP non è necessario stabilire alcuna connessione in anticipo.</span><span class="sxs-lookup"><span data-stu-id="613a9-1219">In addition, sending a UDP packet does not require any connection to be established in advance.</span></span> <span data-ttu-id="613a9-1220">Per questo motivo, la trasmissione dei pacchetti UDP è molto efficiente.</span><span class="sxs-lookup"><span data-stu-id="613a9-1220">Because of this, UDP packet transmission is very efficient.</span></span>

<span data-ttu-id="613a9-1221">Per gli sviluppatori che eseguono la migrazione delle applicazioni NetX a NetX Duo sono disponibili solo alcune modifiche di base della funzionalità UDP tra NetX e NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="613a9-1221">For developers migrating their NetX applications to NetX Duo there are only a few basic changes in UDP functionality between NetX and NetX Duo.</span></span> <span data-ttu-id="613a9-1222">Questo è dovuto al fatto che IPv6 riguarda principalmente il livello IP sottostante.</span><span class="sxs-lookup"><span data-stu-id="613a9-1222">This is because IPv6 is primarily concerned with the underlying IP layer.</span></span> <span data-ttu-id="613a9-1223">Tutti i servizi UDP NetX Duo possono essere utilizzati per la connettività IPv4 o IPv6.</span><span class="sxs-lookup"><span data-stu-id="613a9-1223">All NetX Duo UDP services can be used for either IPv4 or IPv6 connectivity.</span></span>

### <a name="udp-header"></a><span data-ttu-id="613a9-1224">Intestazione UDP</span><span class="sxs-lookup"><span data-stu-id="613a9-1224">UDP Header</span></span>       
<span data-ttu-id="613a9-1225">UDP posiziona una semplice intestazione del pacchetto davanti ai dati dell'applicazione durante la trasmissione e rimuove un'intestazione UDP simile dal pacchetto alla ricezione prima di consegnare un pacchetto UDP ricevuto all'applicazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-1225">UDP places a simple packet header in front of the application's data on transmission, and removes a similar UDP header from the packet on reception before delivering a received UDP packet to the application.</span></span> <span data-ttu-id="613a9-1226">UDP usa il protocollo IP per l'invio e la ricezione di pacchetti, ovvero è presente un'intestazione IP davanti all'intestazione UDP quando il pacchetto si trova nella rete.</span><span class="sxs-lookup"><span data-stu-id="613a9-1226">UDP utilizes the IP protocol for sending and receiving packets, which means there is an IP header in front of the UDP header when the packet is on the network.</span></span> <span data-ttu-id="613a9-1227">Nella figura 12 viene illustrato il formato dell'intestazione UDP.</span><span class="sxs-lookup"><span data-stu-id="613a9-1227">Figure 12 shows the format of the UDP header.</span></span>

![Diagramma del formato di intestazione UDP.](./media/user-guide/image21.png)

### <a name="figure-12-udp-header"></a><span data-ttu-id="613a9-1229">FIGURA 12.</span><span class="sxs-lookup"><span data-stu-id="613a9-1229">FIGURE 12.</span></span> <span data-ttu-id="613a9-1230">Intestazione UDP</span><span class="sxs-lookup"><span data-stu-id="613a9-1230">UDP Header</span></span>

> [!NOTE]
> <span data-ttu-id="613a9-1231">*È previsto che tutte le intestazioni nell'implementazione di UDP/IP siano in formato **Big Endian** . In questo formato, il byte più significativo della parola risiede nell'indirizzo di byte più basso.*</span><span class="sxs-lookup"><span data-stu-id="613a9-1231">*All headers in the UDP/IP implementation are expected to be in **big endian** format. In this format, the most significant byte of the word resides at the lowest byte address.*</span></span>

<span data-ttu-id="613a9-1232">Di seguito viene descritto il formato dell'intestazione UDP:</span><span class="sxs-lookup"><span data-stu-id="613a9-1232">The following describes the UDP header format:</span></span>

|<span data-ttu-id="613a9-1233">Campo di intestazione</span><span class="sxs-lookup"><span data-stu-id="613a9-1233">Header Field</span></span> |<span data-ttu-id="613a9-1234">Scopo</span><span class="sxs-lookup"><span data-stu-id="613a9-1234">Purpose</span></span> |
|---|---|
|<span data-ttu-id="613a9-1235">**numero di porta di origine a 16 bit**</span><span class="sxs-lookup"><span data-stu-id="613a9-1235">**16-bit source port number**</span></span> |<span data-ttu-id="613a9-1236">Questo campo contiene la porta da cui viene inviato il pacchetto UDP.</span><span class="sxs-lookup"><span data-stu-id="613a9-1236">This field contains the port on which the UDP packet is being sent from.</span></span> <span data-ttu-id="613a9-1237">Le porte UDP valide sono comprese tra 1 e 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="613a9-1237">Valid UDP ports range from 1 through 0xFFFF.</span></span> |
|<span data-ttu-id="613a9-1238">**numero porta di destinazione a 16 bit**</span><span class="sxs-lookup"><span data-stu-id="613a9-1238">**16-bit destination port number**</span></span> |<span data-ttu-id="613a9-1239">Questo campo contiene la porta UDP a cui viene inviato il pacchetto.</span><span class="sxs-lookup"><span data-stu-id="613a9-1239">This field contains the UDP port to which the packet is being sent to.</span></span> <span data-ttu-id="613a9-1240">Le porte UDP valide sono comprese tra 1 e 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="613a9-1240">Valid UDP ports range from 1 through 0xFFFF.</span></span> |
|<span data-ttu-id="613a9-1241">**lunghezza UDP a 16 bit**</span><span class="sxs-lookup"><span data-stu-id="613a9-1241">**16-bit UDP length**</span></span> |<span data-ttu-id="613a9-1242">Questo campo contiene il numero di byte nel pacchetto UDP, incluse le dimensioni dell'intestazione UDP.</span><span class="sxs-lookup"><span data-stu-id="613a9-1242">This field contains the number of bytes in the UDP packet, including the size of the UDP header.</span></span> |
|<span data-ttu-id="613a9-1243">**checksum UDP a 16 bit**</span><span class="sxs-lookup"><span data-stu-id="613a9-1243">**16-bit UDP checksum**</span></span> |<span data-ttu-id="613a9-1244">Questo campo contiene il checksum a 16 bit per il pacchetto, tra cui l'intestazione UDP, l'area dati del pacchetto e l'intestazione pseudo-IP.</span><span class="sxs-lookup"><span data-stu-id="613a9-1244">This field contains the 16-bit checksum for the packet, including the UDP header, the packet data area, and the pseudo IP header.</span></span> |

### <a name="udp-enable"></a><span data-ttu-id="613a9-1245">Abilita UDP</span><span class="sxs-lookup"><span data-stu-id="613a9-1245">UDP Enable</span></span>   
<span data-ttu-id="613a9-1246">Prima che sia possibile la trasmissione di pacchetti UDP, l'applicazione deve prima abilitare UDP chiamando il servizio ***nx_udp_enable*** .</span><span class="sxs-lookup"><span data-stu-id="613a9-1246">Before UDP packet transmission is possible, the application must first enable UDP by calling the ***nx_udp_enable*** service.</span></span> <span data-ttu-id="613a9-1247">Dopo l'abilitazione, l'applicazione è gratuita per inviare e ricevere pacchetti UDP.</span><span class="sxs-lookup"><span data-stu-id="613a9-1247">After enabled, the application is free to send and receive UDP packets.</span></span>  

### <a name="udp-socket-create"></a><span data-ttu-id="613a9-1248">Creazione socket UDP</span><span class="sxs-lookup"><span data-stu-id="613a9-1248">UDP Socket Create</span></span>    
<span data-ttu-id="613a9-1249">I socket UDP vengono creati durante l'inizializzazione o durante la fase di esecuzione dai thread dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-1249">UDP sockets are created either during initialization or during runtime by application threads.</span></span> <span data-ttu-id="613a9-1250">Il tipo di servizio, la durata (TTL) e la profondità della coda di ricezione specificati sono definiti dal servizio ***nx_udp_socket_create*** .</span><span class="sxs-lookup"><span data-stu-id="613a9-1250">The initial type of service, time to live, and receive queue depth are defined by the ***nx_udp_socket_create*** service.</span></span> <span data-ttu-id="613a9-1251">Non sono previsti limiti per il numero di socket UDP in un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-1251">There are no limits on the number of UDP sockets in an application.</span></span>

### <a name="udp-checksum"></a><span data-ttu-id="613a9-1252">Checksum UDP</span><span class="sxs-lookup"><span data-stu-id="613a9-1252">UDP Checksum</span></span>   
<span data-ttu-id="613a9-1253">Il protocollo IPv6 richiede un calcolo del checksum dell'intestazione UDP sui dati dei pacchetti, mentre nel protocollo IPv4 è facoltativo.</span><span class="sxs-lookup"><span data-stu-id="613a9-1253">IPv6 protocol requires a UDP header checksum computation on packet data, whereas in the IPv4 protocol it is optional.</span></span>  

<span data-ttu-id="613a9-1254">UDP specifica un checksum a 16 bit a complemento di uno che copre la pseudo intestazione IP (costituita dall'indirizzo IP di origine, indirizzo IP di destinazione e la parola IP di protocollo/lunghezza), l'intestazione UDP e i dati del pacchetto UDP.</span><span class="sxs-lookup"><span data-stu-id="613a9-1254">UDP specifies a one's complement 16-bit checksum that covers the IP pseudo header (consisting of the source IP address, destination IP address, and the protocol/length IP word), the UDP header, and the UDP packet data.</span></span> <span data-ttu-id="613a9-1255">Le uniche differenze tra i checksum dei pacchetti UDP IPv4 e IPv6 sono rappresentati dal fatto che gli indirizzi IP di origine e di destinazione sono 32 bit in IPv4 mentre in IPv6 sono di 128 bit.</span><span class="sxs-lookup"><span data-stu-id="613a9-1255">The only differences between IPv4 and IPv6 UDP packet header checksums is that the source and destination IP addresses are 32 bit in IPv4 while in IPv6 they are 128 bit.</span></span> <span data-ttu-id="613a9-1256">Se il checksum UDP calcolato è 0, viene archiviato come tutti i valori (0xFFFF).</span><span class="sxs-lookup"><span data-stu-id="613a9-1256">If the calculated UDP checksum is 0, it is stored as all ones (0xFFFF).</span></span> <span data-ttu-id="613a9-1257">Se per il socket di invio è disabilitata la logica di checksum UDP, nel campo checksum UDP viene inserito uno zero per indicare che il checksum non è stato calcolato.</span><span class="sxs-lookup"><span data-stu-id="613a9-1257">If the sending socket has the UDP checksum logic disabled, a zero is placed in the UDP checksum field to indicate the checksum was not calculated.</span></span>

<span data-ttu-id="613a9-1258">Se il checksum UDP non corrisponde al checksum calcolato dal ricevitore, il pacchetto UDP viene semplicemente ignorato.</span><span class="sxs-lookup"><span data-stu-id="613a9-1258">If the UDP checksum does not match the computed checksum by the receiver, the UDP packet is simply discarded.</span></span>

<span data-ttu-id="613a9-1259">Nella rete IPv4 il checksum UDP è facoltativo.</span><span class="sxs-lookup"><span data-stu-id="613a9-1259">On the IPv4 network, UDP checksum is optional.</span></span> <span data-ttu-id="613a9-1260">NetX Duo consente a un'applicazione di abilitare o disabilitare il calcolo del checksum UDP in base al socket.</span><span class="sxs-lookup"><span data-stu-id="613a9-1260">NetX Duo allows an application to enable or disable UDP checksum calculation on a per-socket basis.</span></span> <span data-ttu-id="613a9-1261">Per impostazione predefinita, la logica di checksum del socket UDP è abilitata.</span><span class="sxs-lookup"><span data-stu-id="613a9-1261">By default, the UDP socket checksum logic is enabled.</span></span> <span data-ttu-id="613a9-1262">L'applicazione può disabilitare la logica di checksum per un particolare socket UDP chiamando il servizio \***nx_udp_socket_checksum_disable** _.</span><span class="sxs-lookup"><span data-stu-id="613a9-1262">The application can disable checksum logic for a particular UDP socket by calling the \***nx_udp_socket_checksum_disable** _ service.</span></span> <span data-ttu-id="613a9-1263">Nella rete IPv6, tuttavia, il checksum UDP è obbligatorio.</span><span class="sxs-lookup"><span data-stu-id="613a9-1263">On the IPv6 network, however, UDP checksum is mandatory.</span></span> <span data-ttu-id="613a9-1264">Pertanto, il servizio _ *_nx_udp_socket_checksum_disable_*\* non disabilita la logica di checksum UDP durante l'invio di un pacchetto tramite la rete IPv6.</span><span class="sxs-lookup"><span data-stu-id="613a9-1264">Therefore, the service _ *_nx_udp_socket_checksum_disable_*\* would not disable UDP checksum logic when sending a packet through the IPv6 network.</span></span>

<span data-ttu-id="613a9-1265">Alcuni controller Ethernet sono in grado di generare rapidamente il checksum UDP.</span><span class="sxs-lookup"><span data-stu-id="613a9-1265">Certain Ethernet controllers are able to generate the UDP checksum on the fly.</span></span> <span data-ttu-id="613a9-1266">Se il sistema è in grado di utilizzare la funzionalità di calcolo di checksum hardware, la libreria NetX Duo può essere compilata senza la logica di checksum.</span><span class="sxs-lookup"><span data-stu-id="613a9-1266">If the system is able to use hardware checksum computation feature, the NetX Duo library can be built without the checksum logic.</span></span> <span data-ttu-id="613a9-1267">Per disabilitare il checksum del software UDP, è necessario compilare la libreria NetX Duo con i simboli seguenti definiti: ***NX_DISABLE_UDP_TX_CHECKSUM** _ e _*_NX_DISABLE_UDP_RX_CHECKSUM_\*_ (descritto nel capitolo due).</span><span class="sxs-lookup"><span data-stu-id="613a9-1267">To disable UDP software checksum, the NetX Duo library must be built with the following symbols defined: ***NX_DISABLE_UDP_TX_CHECKSUM** _ and _*_NX_DISABLE_UDP_RX_CHECKSUM_\*_ (described in Chapter two).</span></span> <span data-ttu-id="613a9-1268">Le opzioni di configurazione eliminano completamente la logica di checksum UDP da NetX Duo, mentre la chiamata al servizio _ *_nx_udp_socket_checksum_disable_*\* consente all'applicazione di disabilitare l'elaborazione del checksum UDP IPv4 per ogni socket.</span><span class="sxs-lookup"><span data-stu-id="613a9-1268">The configuration options remove UDP checksum logic from NetX Duo entirely, while calling the _ *_nx_udp_socket_checksum_disable_*\* service allows the application to disable IPv4 UDP checksum processing on a per socket basis.</span></span>

### <a name="udp-ports-and-binding"></a><span data-ttu-id="613a9-1269">Porte e binding UDP</span><span class="sxs-lookup"><span data-stu-id="613a9-1269">UDP Ports and Binding</span></span>      
<span data-ttu-id="613a9-1270">Una porta UDP è un endpoint logico nel protocollo UDP.</span><span class="sxs-lookup"><span data-stu-id="613a9-1270">A UDP port is a logical end point in the UDP protocol.</span></span> <span data-ttu-id="613a9-1271">Nel componente UDP di NetX Duo sono presenti 65.535 porte valide, comprese tra 1 e 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="613a9-1271">There are 65,535 valid ports in the UDP component of NetX Duo, ranging from 1 through 0xFFFF.</span></span> <span data-ttu-id="613a9-1272">Per inviare o ricevere dati UDP, l'applicazione deve prima creare un socket UDP, quindi associarlo a una porta desiderata.</span><span class="sxs-lookup"><span data-stu-id="613a9-1272">To send or receive UDP data, the application must first create a UDP socket, then bind it to a desired port.</span></span> <span data-ttu-id="613a9-1273">Dopo aver associato un socket UDP a una porta, l'applicazione può inviare e ricevere dati su tale socket.</span><span class="sxs-lookup"><span data-stu-id="613a9-1273">After binding a UDP socket to a port, the application may send and receive data on that socket.</span></span>

### <a name="udp-fast-pathtrade"></a><span data-ttu-id="613a9-1274">Percorso veloce UDP&trade;</span><span class="sxs-lookup"><span data-stu-id="613a9-1274">UDP Fast Path&trade;</span></span>   
<span data-ttu-id="613a9-1275">Il percorso veloce UDP &trade; è il nome di un percorso di overhead dei pacchetti basso tramite l'implementazione UDP di NETX Duo.</span><span class="sxs-lookup"><span data-stu-id="613a9-1275">The UDP Fast Path&trade; is the name for a low packet overhead path through the NetX Duo UDP implementation.</span></span> <span data-ttu-id="613a9-1276">L'invio di un pacchetto UDP richiede solo alcune chiamate di funzione: ***nx_udp_socket_send** _, _*_nx_ip_packet_send_\*_ e la chiamata finale al driver di rete.</span><span class="sxs-lookup"><span data-stu-id="613a9-1276">Sending a UDP packet requires just a few function calls: ***nx_udp_socket_send** _, _*_nx_ip_packet_send_\*_, and the eventual call to the network driver.</span></span> <span data-ttu-id="613a9-1277">_*_nx_udp_socket_send_*_ è disponibile in NETX Duo per le applicazioni NETX esistenti ed è applicabile solo ai pacchetti IPv4.</span><span class="sxs-lookup"><span data-stu-id="613a9-1277">_*_nx_udp_socket_send_*_ is available in NetX Duo for existing NetX applications and is only applicable for IPv4 packets.</span></span> <span data-ttu-id="613a9-1278">Il metodo preferito, tuttavia, consiste nell'usare _ *_nxd_udp_socket_send_*\* servizio descritto di seguito.</span><span class="sxs-lookup"><span data-stu-id="613a9-1278">The preferred method, however, is to use _ *_nxd_udp_socket_send_*\* service discussed below.</span></span> <span data-ttu-id="613a9-1279">Nella ricezione di pacchetti UDP, il pacchetto UDP viene inserito nella coda di ricezione socket UDP appropriata o recapitato a un thread dell'applicazione sospesa in una singola chiamata di funzione dall'elaborazione dell'interrupt di ricezione del driver di rete.</span><span class="sxs-lookup"><span data-stu-id="613a9-1279">On UDP packet reception, the UDP packet is either placed on the appropriate UDP socket receive queue or delivered to a suspended application thread in a single function call from the network driver's receive interrupt processing.</span></span> <span data-ttu-id="613a9-1280">Questa logica altamente ottimizzata per l'invio e la ricezione di pacchetti UDP è l'essenza della tecnologia di percorso veloce UDP.</span><span class="sxs-lookup"><span data-stu-id="613a9-1280">This highly optimized logic for sending and receiving UDP packets is the essence of UDP Fast Path technology.</span></span>  

### <a name="udp-packet-send"></a><span data-ttu-id="613a9-1281">Invio pacchetti UDP</span><span class="sxs-lookup"><span data-stu-id="613a9-1281">UDP Packet Send</span></span>    
<span data-ttu-id="613a9-1282">L'invio di dati UDP su reti IPv6 o IPv4 viene eseguito facilmente chiamando la funzione \***nxd_udp_socket_send** _.</span><span class="sxs-lookup"><span data-stu-id="613a9-1282">Sending UDP data over IPv6 or IPv4 networks is easily accomplished by calling the \***nxd_udp_socket_send** _ function.</span></span> <span data-ttu-id="613a9-1283">Il chiamante deve impostare la versione IP nel campo _nx_ip_version \* del parametro del puntatore NXD_ADDRESS.</span><span class="sxs-lookup"><span data-stu-id="613a9-1283">The caller must set the IP version in the _nx_ip_version\* field of the NXD_ADDRESS pointer parameter.</span></span> <span data-ttu-id="613a9-1284">NetX Duo determinerà l'indirizzo di origine migliore per i pacchetti UDP trasmessi in base all'indirizzo IPv4/IPv6 di destinazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-1284">NetX Duo will determine the best source address for transmitted UDP packets based on the destination IPv4/IPv6 address.</span></span> <span data-ttu-id="613a9-1285">Questo servizio posiziona un'intestazione UDP davanti ai dati del pacchetto e la invia alla rete usando una routine di invio IP interna.</span><span class="sxs-lookup"><span data-stu-id="613a9-1285">This service places a UDP header in front of the packet data and sends it out onto the network using an internal IP send routine.</span></span> <span data-ttu-id="613a9-1286">Non vi è alcuna sospensione di thread per l'invio di pacchetti UDP perché tutte le trasmissioni di pacchetti UDP vengono elaborate immediatamente.</span><span class="sxs-lookup"><span data-stu-id="613a9-1286">There is no thread suspension on sending UDP packets because all UDP packet transmissions are processed immediately.</span></span> 

<span data-ttu-id="613a9-1287">Per le destinazioni multicast o broadcast, l'applicazione deve specificare l'indirizzo IP di origine da usare se il dispositivo NetX duo ha più indirizzi IP tra cui scegliere.</span><span class="sxs-lookup"><span data-stu-id="613a9-1287">For multicast or broadcast destinations, the application should specify the source IP address to use if the NetX Duo device has multiple IP addresses to choose from.</span></span> <span data-ttu-id="613a9-1288">Questa operazione può essere eseguita con i servizi ***nxd_udp_socket_source_send.***</span><span class="sxs-lookup"><span data-stu-id="613a9-1288">This can be done with the services ***nxd_udp_socket_source_send.***</span></span>

> [!IMPORTANT]    
> <span data-ttu-id="613a9-1289">*Se **nx_udp_socket_send** viene usato per la trasmissione di pacchetti broadcast o multicast, l'indirizzo IP della prima interfaccia abilitata viene usato come indirizzo di origine*.</span><span class="sxs-lookup"><span data-stu-id="613a9-1289">*If **nx_udp_socket_send** is used for transmitting multicast or broadcast packets, the IP address of the first enabled interface is used as source address*.</span></span>

> [!NOTE] 
> <span data-ttu-id="613a9-1290">*Se per questo socket è abilitata la logica di checksum UDP, l'operazione di checksum viene eseguita nel contesto del thread chiamante, senza bloccare l'accesso alle strutture di dati UDP o IP*.</span><span class="sxs-lookup"><span data-stu-id="613a9-1290">*If UDP checksum logic is enabled for this socket, the checksum operation is performed in the context of the calling thread, without blocking access to the UDP or IP data structures*.</span></span> 

> [!WARNING]    
> <span data-ttu-id="613a9-1291">*I dati di payload UDP che risiedono nella struttura di NX_PACKET devono trovarsi su un confine di parola lungo. L'applicazione deve lasciare spazio sufficiente tra il puntatore Prepend e il puntatore di avvio dati per NetX Duo per inserire le intestazioni UDP, IP e supporti fisici*.</span><span class="sxs-lookup"><span data-stu-id="613a9-1291">*The UDP payload data residing in the NX_PACKET structure should reside on a long-word boundary. The application needs to leave sufficient space between the prepend pointer and the data start pointer for NetX Duo to place the UDP, IP, and physical media headers*.</span></span>

### <a name="udp-packet-receive"></a><span data-ttu-id="613a9-1292">Ricezione pacchetti UDP</span><span class="sxs-lookup"><span data-stu-id="613a9-1292">UDP Packet Receive</span></span>    
<span data-ttu-id="613a9-1293">I thread dell'applicazione possono ricevere pacchetti UDP da un socket particolare chiamando ***nx_udp_socket_receive***.</span><span class="sxs-lookup"><span data-stu-id="613a9-1293">Application threads may receive UDP packets from a particular socket by calling ***nx_udp_socket_receive***.</span></span> <span data-ttu-id="613a9-1294">La funzione di ricezione socket recapita il pacchetto meno recente nella coda di ricezione del socket.</span><span class="sxs-lookup"><span data-stu-id="613a9-1294">The socket receive function delivers the oldest packet on the socket's receive queue.</span></span> <span data-ttu-id="613a9-1295">Se non sono presenti pacchetti nella coda di ricezione, il thread chiamante può sospendere (con un timeout facoltativo) finché non arriva un pacchetto.</span><span class="sxs-lookup"><span data-stu-id="613a9-1295">If there are no packets on the receive queue, the calling thread can suspend (with an optional timeout) until a packet arrives.</span></span>

<span data-ttu-id="613a9-1296">L'elaborazione dei pacchetti di ricezione UDP (in genere chiamata dal gestore di interrupt di ricezione del driver di rete) è responsabile del posizionamento del pacchetto nella coda di ricezione del socket UDP o del recapito al primo thread sospeso in attesa di un pacchetto.</span><span class="sxs-lookup"><span data-stu-id="613a9-1296">The UDP receive packet processing (usually called from the network driver's receive interrupt handler) is responsible for either placing the packet on the UDP socket's receive queue or delivering it to the first suspended thread waiting for a packet.</span></span> <span data-ttu-id="613a9-1297">Se il pacchetto viene accodato, l'elaborazione della ricezione controlla anche la profondità massima della coda di ricezione associata al socket.</span><span class="sxs-lookup"><span data-stu-id="613a9-1297">If the packet is queued, the receive processing also checks the maximum receive queue depth associated with the socket.</span></span> <span data-ttu-id="613a9-1298">Se il pacchetto appena accodato supera la profondità della coda, il pacchetto meno recente nella coda viene eliminato.</span><span class="sxs-lookup"><span data-stu-id="613a9-1298">If this newly queued packet exceeds the queue depth, the oldest packet in the queue is discarded.</span></span>

### <a name="udp-receive-notify"></a><span data-ttu-id="613a9-1299">Ricezione notifica UDP</span><span class="sxs-lookup"><span data-stu-id="613a9-1299">UDP Receive Notify</span></span>   
<span data-ttu-id="613a9-1300">Se il thread dell'applicazione deve elaborare i dati ricevuti da più di un socket, è necessario usare la funzione ***nx_udp_socket_receive_notify*** .</span><span class="sxs-lookup"><span data-stu-id="613a9-1300">If the application thread needs to process received data from more than one socket, the ***nx_udp_socket_receive_notify*** function should be used.</span></span> <span data-ttu-id="613a9-1301">Questa funzione registra una funzione di callback del pacchetto di ricezione per il socket.</span><span class="sxs-lookup"><span data-stu-id="613a9-1301">This function registers a receive packet callback function for the socket.</span></span> <span data-ttu-id="613a9-1302">Ogni volta che viene ricevuto un pacchetto nel socket, viene eseguita la funzione di callback.</span><span class="sxs-lookup"><span data-stu-id="613a9-1302">Whenever a packet is received on the socket, the callback function is executed.</span></span>

<span data-ttu-id="613a9-1303">Il contenuto della funzione di callback è applicationspecific; Tuttavia, sarebbe più probabile che contengano la logica per informare il thread di elaborazione che un pacchetto è ora disponibile nel socket corrispondente.</span><span class="sxs-lookup"><span data-stu-id="613a9-1303">The contents of the callback function is applicationspecific; however, it would most likely contain logic to inform the processing thread that a packet is now available on the corresponding socket.</span></span>

### <a name="peer-address-and-port"></a><span data-ttu-id="613a9-1304">Indirizzo e porta peer</span><span class="sxs-lookup"><span data-stu-id="613a9-1304">Peer Address and Port</span></span>   
<span data-ttu-id="613a9-1305">Alla ricezione di un pacchetto UDP, l'applicazione può trovare l'indirizzo IP e il numero di porta del mittente usando il ***nx_udp_packet_info_extract*** del servizio.</span><span class="sxs-lookup"><span data-stu-id="613a9-1305">On receiving a UDP packet, application may find the sender's IP address and port number by using the service ***nx_udp_packet_info_extract***.</span></span> <span data-ttu-id="613a9-1306">In seguito all'esito positivo, questo servizio fornisce informazioni sull'indirizzo IP del mittente, sul numero di porta del mittente e sull'interfaccia locale tramite cui è stato ricevuto il pacchetto.</span><span class="sxs-lookup"><span data-stu-id="613a9-1306">On successful return, this service provides information on the sender's IP address, sender's port number, and the local interface through which the packet was received.</span></span>  

### <a name="thread-suspension"></a><span data-ttu-id="613a9-1307">Sospensione thread</span><span class="sxs-lookup"><span data-stu-id="613a9-1307">Thread Suspension</span></span>   
<span data-ttu-id="613a9-1308">Come indicato in precedenza, i thread dell'applicazione possono sospendere il tentativo di ricezione di un pacchetto UDP su una determinata porta UDP.</span><span class="sxs-lookup"><span data-stu-id="613a9-1308">As mentioned previously, application threads can suspend while attempting to receive a UDP packet on a particular UDP port.</span></span> <span data-ttu-id="613a9-1309">Dopo la ricezione di un pacchetto su tale porta, questo viene assegnato al primo thread sospeso e il thread viene quindi ripreso.</span><span class="sxs-lookup"><span data-stu-id="613a9-1309">After a packet is received on that port, it is given to the first thread suspended and that thread is then resumed.</span></span> <span data-ttu-id="613a9-1310">Un timeout facoltativo è disponibile quando si sospende un pacchetto di ricezione UDP, una funzionalità disponibile per la maggior parte dei servizi NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="613a9-1310">An optional timeout is available when suspending on a UDP receive packet, a feature available for most NetX Duo services.</span></span>  

### <a name="udp-socket-statistics-and-errors"></a><span data-ttu-id="613a9-1311">Statistiche ed errori di socket UDP</span><span class="sxs-lookup"><span data-stu-id="613a9-1311">UDP Socket Statistics and Errors</span></span>     
<span data-ttu-id="613a9-1312">Se abilitata, il software socket UDP NetX Duo tiene traccia di diverse statistiche ed errori che possono risultare utili per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-1312">If enabled, the NetX Duo UDP socket software keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="613a9-1313">Per ogni istanza IP/UDP vengono mantenute le statistiche e i report degli errori seguenti:</span><span class="sxs-lookup"><span data-stu-id="613a9-1313">The following statistics and error reports are maintained for each IP/UDP instance:</span></span>

- <span data-ttu-id="613a9-1314">Totale pacchetti UDP inviati</span><span class="sxs-lookup"><span data-stu-id="613a9-1314">Total UDP Packets Sent</span></span>  
- <span data-ttu-id="613a9-1315">Totale byte UDP inviati</span><span class="sxs-lookup"><span data-stu-id="613a9-1315">Total UDP Bytes Sent</span></span>  
- <span data-ttu-id="613a9-1316">Totale pacchetti UDP ricevuti</span><span class="sxs-lookup"><span data-stu-id="613a9-1316">Total UDP Packets Received</span></span>   
- <span data-ttu-id="613a9-1317">Totale byte UDP ricevuti</span><span class="sxs-lookup"><span data-stu-id="613a9-1317">Total UDP Bytes Received</span></span>  
- <span data-ttu-id="613a9-1318">Totale pacchetti UDP non validi</span><span class="sxs-lookup"><span data-stu-id="613a9-1318">Total UDP Invalid Packets</span></span>  
- <span data-ttu-id="613a9-1319">Totale pacchetti di ricezione UDP eliminati</span><span class="sxs-lookup"><span data-stu-id="613a9-1319">Total UDP Receive Packets Dropped</span></span>  
- <span data-ttu-id="613a9-1320">Totale errori di checksum di ricezione UDP</span><span class="sxs-lookup"><span data-stu-id="613a9-1320">Total UDP Receive Checksum Errors</span></span>  
- <span data-ttu-id="613a9-1321">Pacchetti socket UDP inviati</span><span class="sxs-lookup"><span data-stu-id="613a9-1321">UDP Socket Packets Sent</span></span>  
- <span data-ttu-id="613a9-1322">Byte socket UDP inviati</span><span class="sxs-lookup"><span data-stu-id="613a9-1322">UDP Socket Bytes Sent</span></span>  
- <span data-ttu-id="613a9-1323">Pacchetti socket UDP ricevuti</span><span class="sxs-lookup"><span data-stu-id="613a9-1323">UDP Socket Packets Received</span></span>   
- <span data-ttu-id="613a9-1324">Byte socket UDP ricevuti</span><span class="sxs-lookup"><span data-stu-id="613a9-1324">UDP Socket Bytes Received</span></span>  
- <span data-ttu-id="613a9-1325">Pacchetti socket UDP in coda</span><span class="sxs-lookup"><span data-stu-id="613a9-1325">UDP Socket Packets Queued</span></span>  
- <span data-ttu-id="613a9-1326">Pacchetti di ricezione socket UDP eliminati</span><span class="sxs-lookup"><span data-stu-id="613a9-1326">UDP Socket Receive Packets Dropped</span></span>  
- <span data-ttu-id="613a9-1327">Errori di checksum del socket UDP</span><span class="sxs-lookup"><span data-stu-id="613a9-1327">UDP Socket Checksum Errors</span></span>  

<span data-ttu-id="613a9-1328">Tutte le statistiche e i report degli errori sono disponibili per l'applicazione con il servizio ***nx_udp_info_get** _ per le statistiche UDP raccolte su tutti i socket UDP e il servizio _ *_nx_udp_socket_info_get_** per le statistiche UDP sul socket UDP specificato.</span><span class="sxs-lookup"><span data-stu-id="613a9-1328">All these statistics and error reports are available to the application with the ***nx_udp_info_get** _ service for UDP statistics amassed over all UDP sockets, and the _ *_nx_udp_socket_info_get_** service for UDP statistics on the specified UDP socket.</span></span>

### <a name="udp-socket-control-block-nx_udp_socket"></a><span data-ttu-id="613a9-1329">NX_UDP_SOCKET blocco di controllo socket UDP</span><span class="sxs-lookup"><span data-stu-id="613a9-1329">UDP Socket Control Block NX_UDP_SOCKET</span></span>
<span data-ttu-id="613a9-1330">Le caratteristiche di ogni socket UDP si trovano nel blocco di controllo NX_UDP_SOCKET associato.</span><span class="sxs-lookup"><span data-stu-id="613a9-1330">The characteristics of each UDP socket are found in the associated NX_UDP_SOCKET control block.</span></span> <span data-ttu-id="613a9-1331">Contiene informazioni utili, ad esempio il collegamento alla struttura dei dati IP, l'interfaccia di rete per i percorsi di invio e ricezione, la porta associata e la coda dei pacchetti di ricezione.</span><span class="sxs-lookup"><span data-stu-id="613a9-1331">It contains useful information such as the link to the IP data structure, the network interface for the sending and receiving paths, the bound port, and the receive packet queue.</span></span> <span data-ttu-id="613a9-1332">Questa struttura viene definita nel file ***nx_api. h*** .</span><span class="sxs-lookup"><span data-stu-id="613a9-1332">This structure is defined in the ***nx_api.h*** file.</span></span>

## <a name="transmission-control-protocol-tcp"></a><span data-ttu-id="613a9-1333">Transmission Control Protocol (TCP)</span><span class="sxs-lookup"><span data-stu-id="613a9-1333">Transmission Control Protocol (TCP)</span></span>

<span data-ttu-id="613a9-1334">Il Transmission Control Protocol (TCP) fornisce un trasferimento dei dati di flusso affidabile tra due membri di rete (RFC 793).</span><span class="sxs-lookup"><span data-stu-id="613a9-1334">The Transmission Control Protocol (TCP) provides reliable stream data transfer between two network members (RFC 793).</span></span> <span data-ttu-id="613a9-1335">Tutti i dati inviati da un membro della rete vengono verificati e riconosciuti dal membro di destinazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-1335">All data sent from one network member are verified and acknowledged by the receiving member.</span></span> <span data-ttu-id="613a9-1336">Inoltre, i due membri devono avere stabilito una connessione prima del trasferimento dei dati.</span><span class="sxs-lookup"><span data-stu-id="613a9-1336">In addition, the two members must have established a connection prior to any data transfer.</span></span> <span data-ttu-id="613a9-1337">Il risultato è il trasferimento affidabile dei dati; Tuttavia, richiede un sovraccarico sostanziale rispetto al trasferimento dei dati UDP descritto in precedenza.</span><span class="sxs-lookup"><span data-stu-id="613a9-1337">All this results in reliable data transfer; however, it does require substantially more overhead than the previously described UDP data transfer.</span></span>

<span data-ttu-id="613a9-1338">Ad eccezione di quanto indicato, non sono presenti modifiche nei servizi API del protocollo TCP tra NetX e NetX Duo, perché IPv6 riguarda principalmente il livello IP sottostante.</span><span class="sxs-lookup"><span data-stu-id="613a9-1338">Except where noted, there are no changes in TCP protocol API services between NetX and NetX Duo because IPv6 is primarily concerned with the underlying IP layer.</span></span> <span data-ttu-id="613a9-1339">Tutti i servizi TCP NetX Duo possono essere utilizzati per le connessioni IPv4 o IPv6.</span><span class="sxs-lookup"><span data-stu-id="613a9-1339">All NetX Duo TCP services can be used for either IPv4 or IPv6 connections.</span></span>

### <a name="tcp-header"></a><span data-ttu-id="613a9-1340">Intestazione TCP</span><span class="sxs-lookup"><span data-stu-id="613a9-1340">TCP Header</span></span>   
<span data-ttu-id="613a9-1341">Sulla trasmissione, l'intestazione TCP viene posizionata davanti ai dati dell'utente.</span><span class="sxs-lookup"><span data-stu-id="613a9-1341">On transmission, TCP header is placed in front of the data from the user.</span></span> <span data-ttu-id="613a9-1342">Alla ricezione, l'intestazione TCP viene rimossa dal pacchetto in ingresso, lasciando solo i dati utente disponibili per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-1342">On reception, TCP header is removed from the incoming packet, leaving only the user data available to the application.</span></span> <span data-ttu-id="613a9-1343">TCP utilizza il protocollo IP per inviare e ricevere pacchetti, ovvero è presente un'intestazione IP davanti all'intestazione TCP quando il pacchetto si trova nella rete.</span><span class="sxs-lookup"><span data-stu-id="613a9-1343">TCP utilizes the IP protocol to send and receive packets, which means there is an IP header in front of the TCP header when the packet is on the network.</span></span> <span data-ttu-id="613a9-1344">Nella figura 13 viene illustrato il formato dell'intestazione TCP.</span><span class="sxs-lookup"><span data-stu-id="613a9-1344">Figure 13 shows the format of the TCP header.</span></span>

![Diagramma del formato dell'intestazione TCP.](./media/user-guide/image22.png)

### <a name="figure-13-tcp-header"></a><span data-ttu-id="613a9-1346">FIGURA 13.</span><span class="sxs-lookup"><span data-stu-id="613a9-1346">FIGURE 13.</span></span> <span data-ttu-id="613a9-1347">Intestazione TCP</span><span class="sxs-lookup"><span data-stu-id="613a9-1347">TCP Header</span></span>

<span data-ttu-id="613a9-1348">Di seguito viene descritto il formato dell'intestazione TCP:</span><span class="sxs-lookup"><span data-stu-id="613a9-1348">The following describes the TCP header format:</span></span>

|<span data-ttu-id="613a9-1349">Campo di intestazione &nbsp;</span><span class="sxs-lookup"><span data-stu-id="613a9-1349">Header&nbsp;Field</span></span> |<span data-ttu-id="613a9-1350">Scopo</span><span class="sxs-lookup"><span data-stu-id="613a9-1350">Purpose</span></span> |
|------|------|
| <span data-ttu-id="613a9-1351">**numero di porta di origine a 16 bit**</span><span class="sxs-lookup"><span data-stu-id="613a9-1351">**16-bit source port number**</span></span> | <span data-ttu-id="613a9-1352">Questo campo contiene la porta a cui viene inviato il pacchetto TCP.</span><span class="sxs-lookup"><span data-stu-id="613a9-1352">This field contains the port the TCP packet is being sent out on.</span></span> <span data-ttu-id="613a9-1353">Le porte TCP valide sono comprese tra 1 e 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="613a9-1353">Valid TCP ports range from 1 through 0xFFFF.</span></span> |
| <span data-ttu-id="613a9-1354">**porta di destinazione a 16 bit**</span><span class="sxs-lookup"><span data-stu-id="613a9-1354">**16-bit destination port**</span></span> | <span data-ttu-id="613a9-1355">Questo campo contiene la porta TCP a cui viene inviato il pacchetto.</span><span class="sxs-lookup"><span data-stu-id="613a9-1355">This field contains the TCP port the packet is being sent to.</span></span> <span data-ttu-id="613a9-1356">Le porte TCP valide sono comprese tra 1 e 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="613a9-1356">Valid TCP ports range from 1 through 0xFFFF.</span></span> |
| <span data-ttu-id="613a9-1357">**numero di sequenza a 32 bit**</span><span class="sxs-lookup"><span data-stu-id="613a9-1357">**32-bit sequence number**</span></span> | <span data-ttu-id="613a9-1358">Questo campo contiene il numero di sequenza per i dati inviati da questa entità finale della connessione.</span><span class="sxs-lookup"><span data-stu-id="613a9-1358">This field contains the sequence number for data sent from this end of the connection.</span></span> <span data-ttu-id="613a9-1359">La sequenza originale viene stabilita durante la sequenza di connessione iniziale tra due nodi TCP.</span><span class="sxs-lookup"><span data-stu-id="613a9-1359">The original sequence is established during the initial connection sequence between two TCP nodes.</span></span> <span data-ttu-id="613a9-1360">Ogni trasferimento di dati da tale punto genera un incremento del numero di sequenza in base alla quantità di byte inviati.</span><span class="sxs-lookup"><span data-stu-id="613a9-1360">Every data transfer from that point results in an increment of the sequence number by the amount bytes sent.</span></span> |
| <span data-ttu-id="613a9-1361">**numero di riconoscimento a 32 bit**</span><span class="sxs-lookup"><span data-stu-id="613a9-1361">**32-bit acknowledgement number**</span></span> | <span data-ttu-id="613a9-1362">Questo campo contiene il numero di sequenza corrispondente all'ultimo byte ricevuto da questo lato della connessione.</span><span class="sxs-lookup"><span data-stu-id="613a9-1362">This field contains the sequence number corresponding to the last byte received by this side of the connection.</span></span> <span data-ttu-id="613a9-1363">Viene utilizzato per determinare se i dati inviati in precedenza sono stati ricevuti correttamente dall'altra entità finale della connessione.</span><span class="sxs-lookup"><span data-stu-id="613a9-1363">This is used to determine whether or not data previously sent has successfully been received by the other end of the connection.</span></span> |
| <span data-ttu-id="613a9-1364">**lunghezza intestazione a 4 bit**</span><span class="sxs-lookup"><span data-stu-id="613a9-1364">**4-bit header length**</span></span> | <span data-ttu-id="613a9-1365">Questo campo contiene il numero di parole a 32 bit nell'intestazione TCP.</span><span class="sxs-lookup"><span data-stu-id="613a9-1365">This field contains the number of 32-bit words in the TCP header.</span></span> <span data-ttu-id="613a9-1366">Se nell'intestazione TCP non è presente alcuna opzione, il campo è 5.</span><span class="sxs-lookup"><span data-stu-id="613a9-1366">If no options are present in the TCP header, this field is 5.</span></span> |
| <span data-ttu-id="613a9-1367">**bit di codice a 6 bit**</span><span class="sxs-lookup"><span data-stu-id="613a9-1367">**6-bit code bits**</span></span> |<span data-ttu-id="613a9-1368">Questo campo contiene i sei bit di codice diversi usati per indicare le varie informazioni di controllo associate alla connessione.</span><span class="sxs-lookup"><span data-stu-id="613a9-1368">This field contains the six different code bits used to indicate various control information associated with the connection.</span></span> <span data-ttu-id="613a9-1369">I bit di controllo sono definiti nel modo seguente: <BR \> -Urg (21): data presen<BR \> -ACK (20): il numero di riconoscimento è valido<BR \> -PSH (19): gestire immediatamente questi dati<BR \> -RST (18): reimpostare la connessione<BR \> -SYN (17): sincronizzare i numeri di sequenza (usati per stabilire la connessione) <BR \> -pinna (16): il mittente è terminato con la trasmissione (usato per chiudere la</span><span class="sxs-lookup"><span data-stu-id="613a9-1369">The control bits are defined as follows:<br \> - URG (21): Urgent data presen<br \> - ACK (20): Acknowledgement number is valid<br \> - PSH (19): Handle this data immediately<br \> - RST (18): Reset the connection<br \> - SYN (17): Synchronize sequence numbers (used to establish connection)<br \> - FIN (16): Sender is finished with transmit (used to close connection)</span></span> |
|<span data-ttu-id="613a9-1370">**finestra a 16 bit**</span><span class="sxs-lookup"><span data-stu-id="613a9-1370">**16-bit window**</span></span> |<span data-ttu-id="613a9-1371">Questo campo viene usato per il controllo di flusso.</span><span class="sxs-lookup"><span data-stu-id="613a9-1371">This field is used for flow control.</span></span> <span data-ttu-id="613a9-1372">Contiene la quantità di byte che il socket può attualmente ricevere.</span><span class="sxs-lookup"><span data-stu-id="613a9-1372">It contains the amount of bytes the socket can currently receive.</span></span> <span data-ttu-id="613a9-1373">Questo viene essenzialmente usato per il controllo di flusso.</span><span class="sxs-lookup"><span data-stu-id="613a9-1373">This basically is used for flow control.</span></span> <span data-ttu-id="613a9-1374">Il mittente è responsabile di assicurarsi che i dati da inviare vengano inseriti nella finestra annunciata del destinatario.</span><span class="sxs-lookup"><span data-stu-id="613a9-1374">The sender is responsible for making sure the data to send will fit into the receiver's advertised window.</span></span> |
|<span data-ttu-id="613a9-1375">**checksum TCP a 16 bit**</span><span class="sxs-lookup"><span data-stu-id="613a9-1375">**16-bit TCP checksum**</span></span> |<span data-ttu-id="613a9-1376">Questo campo contiene il checksum a 16 bit per il pacchetto, tra cui l'intestazione TCP, l'area dati del pacchetto e l'intestazione pseudo-IP.</span><span class="sxs-lookup"><span data-stu-id="613a9-1376">This field contains the 16-bit checksum for the packet including the TCP header, the packet data area, and the pseudo IP header.</span></span> |
|<span data-ttu-id="613a9-1377">**Puntatore urgente a 16 bit**</span><span class="sxs-lookup"><span data-stu-id="613a9-1377">**16-bit urgent pointer**</span></span> |<span data-ttu-id="613a9-1378">Questo campo contiene l'offset positivo dell'ultimo byte dei dati urgenti.</span><span class="sxs-lookup"><span data-stu-id="613a9-1378">This field contains the positive offset of the last byte of the urgent data.</span></span> <span data-ttu-id="613a9-1379">Questo campo è valido solo se il bit di codice URG è impostato nell'intestazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-1379">This field is only valid if the URG code bit is set in the header.</span></span> |

> [!NOTE]  
> <span data-ttu-id="613a9-1380">*È previsto che tutte le intestazioni nell'implementazione TCP/IP siano in formato **Big Endian** . In questo formato, il byte più significativo della parola risiede nell'indirizzo di byte più basso*.</span><span class="sxs-lookup"><span data-stu-id="613a9-1380">*All headers in the TCP/IP implementation are expected to be in **big endian** format. In this format, the most significant byte of the word resides at the lowest byte address*.</span></span>

### <a name="tcp-enable"></a><span data-ttu-id="613a9-1381">Abilitazione TCP</span><span class="sxs-lookup"><span data-stu-id="613a9-1381">TCP Enable</span></span>       
<span data-ttu-id="613a9-1382">Prima che le connessioni TCP e le trasmissioni di pacchetti siano possibili, l'applicazione deve prima abilitare TCP chiamando il servizio ***nx_tcp_enable*** .</span><span class="sxs-lookup"><span data-stu-id="613a9-1382">Before TCP connections and packet transmissions are possible, the application must first enable TCP by calling the ***nx_tcp_enable*** service.</span></span> <span data-ttu-id="613a9-1383">Dopo l'abilitazione, l'applicazione è gratuita per accedere a tutti i servizi TCP.</span><span class="sxs-lookup"><span data-stu-id="613a9-1383">After enabled, the application is free to access all TCP services.</span></span>  

### <a name="tcp-socket-create"></a><span data-ttu-id="613a9-1384">Creazione socket TCP</span><span class="sxs-lookup"><span data-stu-id="613a9-1384">TCP Socket Create</span></span>    
<span data-ttu-id="613a9-1385">I socket TCP vengono creati durante l'inizializzazione o durante la fase di esecuzione dai thread dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-1385">TCP sockets are created either during initialization or during runtime by application threads.</span></span> <span data-ttu-id="613a9-1386">Il tipo di servizio, la durata (TTL) e le dimensioni della finestra sono definiti dal servizio ***nx_tcp_socket_create*** .</span><span class="sxs-lookup"><span data-stu-id="613a9-1386">The initial type of service, time to live, and window size are defined by the ***nx_tcp_socket_create*** service.</span></span> <span data-ttu-id="613a9-1387">Non sono previsti limiti per il numero di socket TCP in un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-1387">There are no limits on the number of TCP sockets in an application.</span></span>  

### <a name="tcp-checksum"></a><span data-ttu-id="613a9-1388">Checksum TCP</span><span class="sxs-lookup"><span data-stu-id="613a9-1388">TCP Checksum</span></span>     
<span data-ttu-id="613a9-1389">TCP specifica un checksum a 16 bit a complemento di uno che copre la pseudo intestazione IP, costituita dall'indirizzo IP di origine, dall'indirizzo IP di destinazione e dalla parola IP di protocollo/lunghezza, l'intestazione TCP e i dati del pacchetto TCP.</span><span class="sxs-lookup"><span data-stu-id="613a9-1389">TCP specifies a one's complement 16-bit checksum that covers the IP pseudo header, (consisting of the source IP address, destination IP address, and the protocol/length IP word), the TCP header, and the TCP packet data.</span></span> <span data-ttu-id="613a9-1390">L'unica differenza tra i checksum dell'intestazione dei pacchetti TCP IPv4 e IPv6 è che gli indirizzi IP di origine e di destinazione sono 32 bit in IPv4 e 128 bit in IPv6.</span><span class="sxs-lookup"><span data-stu-id="613a9-1390">The only difference between IPv4 and IPv6 TCP packet header checksums is that the source and destination IP addresses are 32 bit in IPv4 and 128 bit in IPv6.</span></span> 

<span data-ttu-id="613a9-1391">Alcuni controller di rete sono in grado di eseguire il calcolo e la convalida del checksum TCP nell'hardware.</span><span class="sxs-lookup"><span data-stu-id="613a9-1391">Certain network controllers are able to perform TCP checksum computation and validation in hardware.</span></span> <span data-ttu-id="613a9-1392">Per tali sistemi, le applicazioni potrebbero voler usare la logica di checksum hardware il più possibile per ridurre il sovraccarico di Runtime.</span><span class="sxs-lookup"><span data-stu-id="613a9-1392">For such systems, applications may want to use hardware checksum logic as much as possible to reduce runtime overhead.</span></span> <span data-ttu-id="613a9-1393">Le applicazioni possono disabilitare la logica di calcolo del checksum TCP dalla libreria NetX Duo in fase di compilazione definendo \***NX_DISABLE_TCP_TX_CHECKSUM** _ e _ *_NX_DISABLE_TCP_RX_CHECKSUM_* \*.</span><span class="sxs-lookup"><span data-stu-id="613a9-1393">Applications may disable TCP checksum computation logic from the NetX Duo library altogether at build time by defining ***NX_DISABLE_TCP_TX_CHECKSUM** _ and _*_NX_DISABLE_TCP_RX_CHECKSUM_\*\*.</span></span> <span data-ttu-id="613a9-1394">In questo modo, il codice di checksum TCP non viene compilato in.</span><span class="sxs-lookup"><span data-stu-id="613a9-1394">This way, the TCP checksum code is not compiled in.</span></span> <span data-ttu-id="613a9-1395">Tuttavia, è necessario prestare attenzione se il pacchetto NetX Duo IPsec facoltativo è installato e la connessione TCP potrebbe dover attraversare un canale sicuro.</span><span class="sxs-lookup"><span data-stu-id="613a9-1395">However one should exercise caution if the optional NetX Duo IPsec package is installed, and the TCP connection may need to traverse through a secure channel.</span></span> <span data-ttu-id="613a9-1396">In questo caso, i dati nei pacchetti appartenenti alla connessione TCP sono già crittografati e la maggior parte dei moduli di checksum TCP hardware presenti nel driver di rete non è in grado di generare un valore di checksum corretto dal payload TCP crittografato.</span><span class="sxs-lookup"><span data-stu-id="613a9-1396">In this case, data in packets belonging to the TCP connection is already encrypted, and most hardware TCP checksum modules present in the network driver are unable to generate correct checksum value from the encrypted TCP payload.</span></span>

<span data-ttu-id="613a9-1397">Per risolvere questo problema, l'applicazione mantiene la logica di checksum TCP disponibile nella libreria e utilizza la funzionalità di interfaccia.</span><span class="sxs-lookup"><span data-stu-id="613a9-1397">To address this issue, application shall keep the TCP checksum logic available in the library and use the interface capability feature.</span></span> <span data-ttu-id="613a9-1398">Con la funzionalità di funzionalità dell'interfaccia abilitata, il modulo TCP sa come gestire correttamente il checksum TCP se il driver è anche in grado di calcolare il valore di checksum:</span><span class="sxs-lookup"><span data-stu-id="613a9-1398">With interface capability feature enabled, the TCP module knows how to properly handle the TCP checksum if the driver is also able to compute the checksum value:</span></span>

1) <span data-ttu-id="613a9-1399">Se il pacchetto TCP non è soggetto a un processo IPsec, l'hardware dell'interfaccia di rete è in grado di calcolare il checksum.</span><span class="sxs-lookup"><span data-stu-id="613a9-1399">If the TCP packet is not subject to IPsec process, the network interface hardware is able to compute the checksum.</span></span> <span data-ttu-id="613a9-1400">Il modulo TCP non tenta pertanto di calcolare il checksum.</span><span class="sxs-lookup"><span data-stu-id="613a9-1400">Therefore the TCP module does not attempt to compute the checksum;</span></span>

2) <span data-ttu-id="613a9-1401">Se il pacchetto IPsec è installato e il pacchetto TCP è soggetto a un processo IPsec, il modulo TCP calcola il checksum nel software prima di inviare il pacchetto al livello IPsec.</span><span class="sxs-lookup"><span data-stu-id="613a9-1401">If IPsec package is installed, and the TCP packet is subject to IPsec process, the TCP module computes checksum in software before sending the packet to IPsec layer.</span></span>

### <a name="tcp-port"></a><span data-ttu-id="613a9-1402">Porta TCP</span><span class="sxs-lookup"><span data-stu-id="613a9-1402">TCP Port</span></span>     
<span data-ttu-id="613a9-1403">Una porta TCP è un punto di connessione logico nel protocollo TCP.</span><span class="sxs-lookup"><span data-stu-id="613a9-1403">A TCP port is a logical connection point in the TCP protocol.</span></span> <span data-ttu-id="613a9-1404">Nel componente TCP di NetX Duo sono presenti 65.535 porte valide, comprese tra 1 e 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="613a9-1404">There are 65,535 valid ports in the TCP component of NetX Duo, ranging from 1 through 0xFFFF.</span></span> <span data-ttu-id="613a9-1405">Diversamente da UDP, in cui i dati di una porta possono essere inviati a qualsiasi altra porta di destinazione, una porta TCP è connessa a un'altra porta TCP specifica e solo quando viene stabilita la connessione può essere effettuato il trasferimento dei dati, e solo tra le due porte che costituiscono la connessione.</span><span class="sxs-lookup"><span data-stu-id="613a9-1405">Unlike UDP in which data from one port can be sent to any other destination port, a TCP port is connected to another specific TCP port, and only when this connection is established can any data transfer take place—and only between the two ports making up the connection.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="613a9-1406">Le *porte TCP sono completamente separate dalle porte UDP. ad esempio, la porta UDP numero 1 non ha alcuna relazione con la porta TCP numero 1*.</span><span class="sxs-lookup"><span data-stu-id="613a9-1406">*TCP ports are completely separate from UDP ports; e.g., UDP port number 1 has no relation to TCP port number 1*.</span></span>

### <a name="client-server-model"></a><span data-ttu-id="613a9-1407">Modello di Client-Server</span><span class="sxs-lookup"><span data-stu-id="613a9-1407">Client-Server Model</span></span>     
<span data-ttu-id="613a9-1408">Per usare TCP per il trasferimento dei dati, è prima necessario stabilire una connessione tra i due socket TCP.</span><span class="sxs-lookup"><span data-stu-id="613a9-1408">To use TCP for data transfer, a connection must first be established between the two TCP sockets.</span></span> <span data-ttu-id="613a9-1409">La creazione della connessione viene eseguita in modalità client-server.</span><span class="sxs-lookup"><span data-stu-id="613a9-1409">The establishment of the connection is done in a client-server fashion.</span></span> <span data-ttu-id="613a9-1410">Il lato client della connessione è il lato che avvia la connessione, mentre il lato server è semplicemente in attesa delle richieste di connessione client prima che venga eseguita qualsiasi elaborazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-1410">The client side of the connection is the side that initiates the connection, while the server side simply waits for client connection requests before any processing is done.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="613a9-1411">*Per i dispositivi multihome, NETX Duo determina automaticamente l'indirizzo di origine da usare per la connessione e l'indirizzo hop successivo in base all'indirizzo IP di destinazione della connessione. Poiché il protocollo TCP è limitato all'invio di pacchetti a indirizzi di destinazione unicast (ad esempio, non broadcast), NetX Duo non richiede un "hint" per la scelta dell'indirizzo IPv6 di origine*.</span><span class="sxs-lookup"><span data-stu-id="613a9-1411">*For multihome devices, NetX Duo automatically determines the source address to use for the connection, and the next hop address based on the destination IP address of the connection. Because TCP is limited to sending packets to unicast (e.g.nonbroadcast) destination addresses, NetX Duo does not require a "hint" for choosing the source IPv6 address*.</span></span>

### <a name="tcp-socket-state-machine"></a><span data-ttu-id="613a9-1412">Macchina a stati socket TCP</span><span class="sxs-lookup"><span data-stu-id="613a9-1412">TCP Socket State Machine</span></span>      
<span data-ttu-id="613a9-1413">La connessione tra due socket TCP (un client e un server) è complessa e viene gestita in modo analogo a una macchina a Stati.</span><span class="sxs-lookup"><span data-stu-id="613a9-1413">The connection between two TCP sockets (one client and one server) is complex and is managed in a state machine manner.</span></span> <span data-ttu-id="613a9-1414">Ogni socket TCP viene avviato in uno stato chiuso.</span><span class="sxs-lookup"><span data-stu-id="613a9-1414">Each TCP socket starts in a CLOSED state.</span></span> <span data-ttu-id="613a9-1415">Tramite gli eventi di connessione viene eseguita la migrazione della macchina a stati di ogni socket nello stato stabilito, ovvero la posizione in cui viene eseguita la maggior parte del trasferimento dei dati in TCP.</span><span class="sxs-lookup"><span data-stu-id="613a9-1415">Through connection events each socket's state machine migrates into the ESTABLISHED state, which is where the bulk of the data transfer in TCP takes place.</span></span> <span data-ttu-id="613a9-1416">Quando un lato della connessione non desidera più inviare dati, si disconnette.</span><span class="sxs-lookup"><span data-stu-id="613a9-1416">When one side of the connection no longer wishes to send data, it disconnects.</span></span> <span data-ttu-id="613a9-1417">Dopo la disconnessione dell'altro lato, il socket TCP torna allo stato CLOSED.</span><span class="sxs-lookup"><span data-stu-id="613a9-1417">After the other side disconnects, eventually the TCP socket returns to the CLOSED state.</span></span> <span data-ttu-id="613a9-1418">Questo processo viene ripetuto ogni volta che un client e un server TCP stabiliscono e chiudono una connessione.</span><span class="sxs-lookup"><span data-stu-id="613a9-1418">This process repeats each time a TCP client and server establish and close a connection.</span></span> <span data-ttu-id="613a9-1419">La figura 14 Mostra i vari Stati della macchina a stati TCP.</span><span class="sxs-lookup"><span data-stu-id="613a9-1419">Figure 14 shows the various states of the TCP state machine.</span></span>

### <a name="tcp-client-connection"></a><span data-ttu-id="613a9-1420">Connessione client TCP</span><span class="sxs-lookup"><span data-stu-id="613a9-1420">TCP Client Connection</span></span>       
<span data-ttu-id="613a9-1421">Come indicato in precedenza, il lato client della connessione TCP avvia una richiesta di connessione a un server TCP.</span><span class="sxs-lookup"><span data-stu-id="613a9-1421">As mentioned previously, the client side of the TCP connection initiates a connection request to a TCP server.</span></span> <span data-ttu-id="613a9-1422">Prima di poter effettuare una richiesta di connessione, è necessario abilitare il protocollo TCP nell'istanza IP del client.</span><span class="sxs-lookup"><span data-stu-id="613a9-1422">Before a connection request can be made, TCP must be enabled on the client IP instance.</span></span> <span data-ttu-id="613a9-1423">Inoltre, il socket TCP del client deve essere creato successivamente con il servizio \***nx_tcp_socket_create** _ e associato a una porta tramite il servizio _ \*_nx_tcp_client_socket_bind_\*\*.</span><span class="sxs-lookup"><span data-stu-id="613a9-1423">In addition, the client TCP socket must next be created with the ***nx_tcp_socket_create** _ service and bound to a port via the _ *_nx_tcp_client_socket_bind_** service.</span></span>

<span data-ttu-id="613a9-1424">Quando il socket client viene associato, il servizio ***nxd_tcp_client_socket_connect*** viene usato per stabilire una connessione con un server TCP.</span><span class="sxs-lookup"><span data-stu-id="613a9-1424">After the client socket is bound, the ***nxd_tcp_client_socket_connect*** service is used to establish a connection with a TCP server.</span></span> <span data-ttu-id="613a9-1425">Si noti che il socket deve trovarsi in uno stato chiuso per avviare un tentativo di connessione.</span><span class="sxs-lookup"><span data-stu-id="613a9-1425">Note the socket must be in a CLOSED state to initiate a connection attempt.</span></span> <span data-ttu-id="613a9-1426">Stabilire la connessione inizia con NetX duo che emette un pacchetto SYN e quindi attende un pacchetto SYN ACK dal server, che indica l'accettazione della richiesta di connessione.</span><span class="sxs-lookup"><span data-stu-id="613a9-1426">Establishing the connection starts with NetX Duo issuing a SYN packet and then waiting for a SYN ACK packet back from the server, which signifies acceptance of the connection request.</span></span> <span data-ttu-id="613a9-1427">Dopo la ricezione dell'ACK SYN, NetX Duo risponde con un pacchetto ACK e promuove lo stato stabilito del socket client.</span><span class="sxs-lookup"><span data-stu-id="613a9-1427">After the SYN ACK is received, NetX Duo responds with an ACK packet and promotes the client socket to the ESTABLISHED state.</span></span>

![Diagramma degli Stati della macchina a stati TCP.](./media/user-guide/image24.png)   

<span data-ttu-id="613a9-1429">**FIGURA 14. Stati della macchina a stati TCP**</span><span class="sxs-lookup"><span data-stu-id="613a9-1429">**FIGURE 14. States of the TCP State Machine**</span></span>


> [!WARNING]
> <span data-ttu-id="613a9-1430">*Le applicazioni devono utilizzare **Nxd_tcp_client_socket_connect** per le connessioni TCP IPv4 e IPv6. Le applicazioni possono comunque usare **nx_tcp_client_socket_connect** per le connessioni TCP IPv4, ma gli sviluppatori sono invitati a usare **nxd_tcp_client_socket_connect** perché **nx_tcp_client_socket_connect** alla fine saranno deprecate*.</span><span class="sxs-lookup"><span data-stu-id="613a9-1430">*Applications should use **nxd_tcp_client_socket_connect** for either IPv4 and IPv6 TCP connections. Applications can still use **nx_tcp_client_socket_connect** for IPv4 TCP connections, but developers are encouraged to use **nxd_tcp_client_socket_connect** since **nx_tcp_client_socket_connect** will eventually be deprecated*.</span></span>

<span data-ttu-id="613a9-1431">*Analogamente, **nxd_tcp_socket_peer_info_get** funziona con connessioni TCP IPv4 o IPv6. Tuttavia, **nx_tcp_socket_peer_info_get** è ancora disponibile per le applicazioni legacy. Gli sviluppatori sono invitati a usare **nxd_tcp_socket_peer_info_get** in futuro*.</span><span class="sxs-lookup"><span data-stu-id="613a9-1431">*Similarly, **nxd_tcp_socket_peer_info_get** works with either IPv4 or IPv6 TCP connections. However, **nx_tcp_socket_peer_info_get** is still available for legacy applications. Developers are encouraged to use **nxd_tcp_socket_peer_info_get** going forward*.</span></span>

### <a name="tcp-client-disconnection"></a><span data-ttu-id="613a9-1432">Disconnessione del client TCP</span><span class="sxs-lookup"><span data-stu-id="613a9-1432">TCP Client Disconnection</span></span>    
<span data-ttu-id="613a9-1433">La chiusura della connessione viene eseguita chiamando ***nx_tcp_socket_disconnect***.</span><span class="sxs-lookup"><span data-stu-id="613a9-1433">Closing the connection is accomplished by calling ***nx_tcp_socket_disconnect***.</span></span> <span data-ttu-id="613a9-1434">Se non viene specificata alcuna sospensione, il socket client invia un pacchetto RST al socket del server e posiziona il socket nello stato CLOSED.</span><span class="sxs-lookup"><span data-stu-id="613a9-1434">If no suspension is specified, the client socket sends a RST packet to the server socket and places the socket in the CLOSED state.</span></span> <span data-ttu-id="613a9-1435">In caso contrario, se viene richiesta una sospensione, viene eseguito il protocollo di disconnessione TCP completo, come indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="613a9-1435">Otherwise, if a suspension is requested, the full TCP disconnect protocol is performed, as follows:</span></span> 

- <span data-ttu-id="613a9-1436">Se il server ha avviato in precedenza una richiesta di disconnessione (il socket client ha già ricevuto un pacchetto FIN, ha risposto con un ACK ed è nello stato di attesa di chiusura), NetX duo promuove lo stato del socket TCP del client allo stato dell'ultimo ACK e invia un pacchetto FIN.</span><span class="sxs-lookup"><span data-stu-id="613a9-1436">If the server previously initiated a disconnect request (the client socket has already received a FIN packet, responded with an ACK, and is in the CLOSE WAIT state), NetX Duo promotes the client TCP socket state to the LAST ACK state and sends a FIN packet.</span></span> <span data-ttu-id="613a9-1437">Attende quindi un ACK dal server prima di completare la disconnessione e di entrare nello stato CLOSED.</span><span class="sxs-lookup"><span data-stu-id="613a9-1437">It then waits for an ACK from the server before completing the disconnect and entering the CLOSED state.</span></span>

- <span data-ttu-id="613a9-1438">Se invece il client è il primo ad avviare una richiesta di disconnessione (il server non si è disconnesso e il socket si trova ancora nello stato stabilito), NetX Duo Invia un pacchetto FIN per avviare la disconnessione e attende la ricezione di una pinna e di un ACK dal server prima di completare la disconnessione e di collocare il socket in uno stato chiuso.</span><span class="sxs-lookup"><span data-stu-id="613a9-1438">If on the other hand, the client is the first to initiate a disconnect request (the server has not disconnected and the socket is still in the ESTABLISHED state), NetX Duo sends a FIN packet to initiate the disconnect and waits to receive a FIN and an ACK from the server before completing the disconnect and placing the socket in a CLOSED state.</span></span>

<span data-ttu-id="613a9-1439">Se nella coda di trasmissione socket sono ancora presenti pacchetti, NetX Duo sospende il timeout specificato per consentire la conferma dei pacchetti.</span><span class="sxs-lookup"><span data-stu-id="613a9-1439">If there are still packets on the socket transmit queue, NetX Duo suspends for the specified timeout to allow the packets to be acknowledged.</span></span> <span data-ttu-id="613a9-1440">Se il timeout scade, NetX Duo svuota la coda di trasmissione del socket client.</span><span class="sxs-lookup"><span data-stu-id="613a9-1440">If the timeout expires, NetX Duo empties the transmit queue of the client socket.</span></span> 

<span data-ttu-id="613a9-1441">Per disassociare la porta dal socket client, l'applicazione chiama ***nx_tcp_client_socket_unbind***.</span><span class="sxs-lookup"><span data-stu-id="613a9-1441">To unbind the port from the client socket, the application calls ***nx_tcp_client_socket_unbind***.</span></span> <span data-ttu-id="613a9-1442">Il socket deve trovarsi in uno stato chiuso o nel processo di disconnessione (ad esempio, lo stato di attesa programmato) prima che la porta venga rilasciata; in caso contrario, viene restituito un errore.</span><span class="sxs-lookup"><span data-stu-id="613a9-1442">The socket must be in a CLOSED state or in the process of disconnecting (i.e., TIMED WAIT state) before the port is released; otherwise, an error is returned.</span></span>

<span data-ttu-id="613a9-1443">Infine, se l'applicazione non necessita più del socket client, chiama ***nx_tcp_socket_delete*** per eliminare il socket.</span><span class="sxs-lookup"><span data-stu-id="613a9-1443">Finally, if the application no longer needs the client socket, it calls ***nx_tcp_socket_delete*** to delete the socket.</span></span>

### <a name="tcp-server-connection"></a><span data-ttu-id="613a9-1444">Connessione al server TCP</span><span class="sxs-lookup"><span data-stu-id="613a9-1444">TCP Server Connection</span></span>      
<span data-ttu-id="613a9-1445">Il lato server di una connessione TCP è passivo; ovvero, il server attende che un client avvii una richiesta di connessione.</span><span class="sxs-lookup"><span data-stu-id="613a9-1445">The server side of a TCP connection is passive; i.e., the server waits for a client to initiate connection request.</span></span> <span data-ttu-id="613a9-1446">Per accettare una connessione client, è prima necessario abilitare TCP sull'istanza IP chiamando il servizio \***nx_tcp_enable** _.</span><span class="sxs-lookup"><span data-stu-id="613a9-1446">To accept a client connection, TCP must first be enabled on the IP instance by calling the service \***nx_tcp_enable** _.</span></span> <span data-ttu-id="613a9-1447">Successivamente, l'applicazione deve creare un socket TCP usando il servizio _ \*_nx_tcp_socket_create_\*\*.</span><span class="sxs-lookup"><span data-stu-id="613a9-1447">Next, the application must create a TCP socket using the _ *_nx_tcp_socket_create_*\* service.</span></span>  

<span data-ttu-id="613a9-1448">Il socket del server deve essere configurato anche per l'ascolto delle richieste di connessione.</span><span class="sxs-lookup"><span data-stu-id="613a9-1448">The server socket must also be set up for listening for connection requests.</span></span> <span data-ttu-id="613a9-1449">Questa operazione viene eseguita tramite il servizio ***nx_tcp_server_socket_listen*** .</span><span class="sxs-lookup"><span data-stu-id="613a9-1449">This is achieved by using the ***nx_tcp_server_socket_listen*** service.</span></span> <span data-ttu-id="613a9-1450">Questo servizio posiziona il socket del server nello stato di ascolto e associa la porta del server specificata al socket.</span><span class="sxs-lookup"><span data-stu-id="613a9-1450">This service places the server socket in the LISTEN state and binds the specified server port to the socket.</span></span>

> [!NOTE] 
> <span data-ttu-id="613a9-1451">*Per impostare una routine di callback di ascolto del socket, l'applicazione specifica la funzione di callback appropriata per l'argomento tcp_listen_callback del servizio di **nx_tcp_server_socket_listen** . Questa funzione di callback dell'applicazione viene quindi eseguita da NetX Duo ogni volta che viene richiesta una nuova connessione sulla porta del server. L'elaborazione nel callback è sotto il controllo dell'applicazione.*</span><span class="sxs-lookup"><span data-stu-id="613a9-1451">*To set a socket listen callback routine the application specifies the appropriate callback function for the tcp_listen_callback argument of the **nx_tcp_server_socket_listen** service. This application callback function is then executed by NetX Duo whenever a new connection is requested on this server port. The processing in the callback is under application control.*</span></span>

<span data-ttu-id="613a9-1452">Per accettare le richieste di connessione client, l'applicazione chiama il servizio \***nx_tcp_server_socket_accept** _.</span><span class="sxs-lookup"><span data-stu-id="613a9-1452">To accept client connection requests, the application calls the \***nx_tcp_server_socket_accept** _ service.</span></span> <span data-ttu-id="613a9-1453">Il socket del server deve essere in uno stato di attesa o in uno stato SYN ricevuto (ovvero, il server è in stato di ascolto e ha ricevuto un pacchetto SYN da un client che ha richiesto una connessione) per chiamare il servizio Accept.</span><span class="sxs-lookup"><span data-stu-id="613a9-1453">The server socket must either be in a LISTEN state or a SYN RECEIVED state (i.e., the server is in the LISTEN state and has received a SYN packet from a client requesting a connection) to call the accept service.</span></span> <span data-ttu-id="613a9-1454">Uno stato restituito correttamente da _ *_nx_tcp_server_socket_accept_*\* indica che la connessione è stata configurata e che il socket del server si trova nello stato stabilita.</span><span class="sxs-lookup"><span data-stu-id="613a9-1454">A successful return status from _ *_nx_tcp_server_socket_accept_*\* indicates the connection has been set up and the server socket is in the ESTABLISHED state.</span></span>

<span data-ttu-id="613a9-1455">Dopo che il socket del server dispone di una connessione valida, le richieste di connessione client aggiuntive vengono accodate fino alla profondità specificata dal *listen_queue_size, passate* al  \* servizio **nx_tcp_server_socket_listen** _.</span><span class="sxs-lookup"><span data-stu-id="613a9-1455">After the server socket has a valid connection, additional client connection requests are queued up to the depth specified by the *listen_queue_size, passed into the* \***nx_tcp_server_socket_listen** _ service.</span></span> <span data-ttu-id="613a9-1456">Per elaborare le connessioni successive su una porta del server, l'applicazione deve chiamare _ *_nx_tcp_server_socket_relisten_*\* con un socket disponibile, ovvero un socket in uno stato chiuso.</span><span class="sxs-lookup"><span data-stu-id="613a9-1456">In order to process subsequent connections on a server port, the application must call _ *_nx_tcp_server_socket_relisten_*\* with an available socket (i.e., a socket in a CLOSED state).</span></span> <span data-ttu-id="613a9-1457">Si noti che è possibile usare lo stesso socket del server se la connessione precedente associata al socket è terminata e lo stato del socket è CLOSED.</span><span class="sxs-lookup"><span data-stu-id="613a9-1457">Note that the same server socket could be used if the previous connection associated with the socket is now finished and the socket is in the CLOSED state.</span></span>

### <a name="tcp-server-disconnection"></a><span data-ttu-id="613a9-1458">Disconnessione del server TCP</span><span class="sxs-lookup"><span data-stu-id="613a9-1458">TCP Server Disconnection</span></span>     
<span data-ttu-id="613a9-1459">La chiusura della connessione viene eseguita chiamando ***nx_tcp_socket_disconnect***.</span><span class="sxs-lookup"><span data-stu-id="613a9-1459">Closing the connection is accomplished by calling ***nx_tcp_socket_disconnect***.</span></span> <span data-ttu-id="613a9-1460">Se non viene specificata alcuna sospensione, il socket del server invia un pacchetto RST al socket client e posiziona il socket nello stato CLOSED.</span><span class="sxs-lookup"><span data-stu-id="613a9-1460">If no suspension is specified, the server socket sends a RST packet to the client socket and places the socket in the CLOSED state.</span></span> <span data-ttu-id="613a9-1461">In caso contrario, se viene richiesta una sospensione, viene eseguito il protocollo di disconnessione TCP completo, come indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="613a9-1461">Otherwise, if a suspension is requested, the full TCP disconnect protocol is performed, as follows:</span></span>

- <span data-ttu-id="613a9-1462">Se il client ha avviato in precedenza una richiesta di disconnessione (il socket del server ha già ricevuto un pacchetto FIN, ha risposto con un ACK ed è nello stato di attesa di chiusura), NetX duo promuove lo stato del socket TCP per l'ultimo stato ACK e invia un pacchetto FIN.</span><span class="sxs-lookup"><span data-stu-id="613a9-1462">If the client previously initiated a disconnect request (the server socket has already received a FIN packet, responded with an ACK, and is in the CLOSE WAIT state), NetX Duo promotes the TCP socket state to the LAST ACK state and sends a FIN packet.</span></span> <span data-ttu-id="613a9-1463">Attende quindi un ACK dal client prima di completare la disconnessione e di entrare nello stato CLOSED.</span><span class="sxs-lookup"><span data-stu-id="613a9-1463">It then waits for an ACK from the client before  completing the disconnect and entering the CLOSED state.</span></span>

- <span data-ttu-id="613a9-1464">Se invece il server è il primo ad avviare una richiesta di disconnessione (il client non si è disconnesso e il socket si trova ancora nello stato stabilito), NetX Duo Invia un pacchetto FIN per avviare la disconnessione e attende la ricezione di una pinna e di un ACK dal client prima di completare la disconnessione e di collocare il socket in uno stato chiuso.</span><span class="sxs-lookup"><span data-stu-id="613a9-1464">If on the other hand, the server is the first to initiate a disconnect request (the client has not disconnected and the socket is still in the ESTABLISHED state), NetX Duo sends a FIN packet to initiate the disconnect and waits to receive a FIN and an ACK from the client before completing the disconnect and placing the socket in a CLOSED state.</span></span>

<span data-ttu-id="613a9-1465">Se nella coda di trasmissione socket sono ancora presenti pacchetti, NetX Duo sospende il timeout specificato per consentire la conferma di tali pacchetti.</span><span class="sxs-lookup"><span data-stu-id="613a9-1465">If there are still packets on the socket transmit queue, NetX Duo suspends for the specified timeout to allow those packets to be acknowledged.</span></span> <span data-ttu-id="613a9-1466">Se il timeout scade, NetX Duo Scarica la coda di trasmissione del socket del server.</span><span class="sxs-lookup"><span data-stu-id="613a9-1466">If the timeout expires, NetX Duo flushes the transmit queue of the server socket.</span></span>

<span data-ttu-id="613a9-1467">Una volta completata l'elaborazione della disconnessione e il socket del server si trova nello stato CLOSED, l'applicazione deve chiamare il servizio \***nx_tcp_server_socket_unaccept** _ per terminare l'associazione di questo socket con la porta del server.</span><span class="sxs-lookup"><span data-stu-id="613a9-1467">After the disconnect processing is complete and the server socket is in the CLOSED state, the application must call the \***nx_tcp_server_socket_unaccept** _ service to end the association of this socket with the server port.</span></span> <span data-ttu-id="613a9-1468">Si noti che questo servizio deve essere chiamato dall'applicazione anche se _*_nx_tcp_socket_disconnect_*_ o _*_nx_tcp_server_socket_accept_*_ restituiscono uno stato di errore.</span><span class="sxs-lookup"><span data-stu-id="613a9-1468">Note this service must be called by the application even if _*_nx_tcp_socket_disconnect_*_ or _*_nx_tcp_server_socket_accept_*_ return an error status.</span></span> <span data-ttu-id="613a9-1469">Una volta restituito il _*_nx_tcp_server_socket_unaccept_*_ , il socket può essere utilizzato come un socket client o server o anche eliminato se non è più necessario.</span><span class="sxs-lookup"><span data-stu-id="613a9-1469">After the _*_nx_tcp_server_socket_unaccept_*_ returns, the socket can be used as a client or server socket, or even deleted if it is no longer needed.</span></span> <span data-ttu-id="613a9-1470">Se si desidera accettare un'altra connessione client sulla stessa porta del server, è necessario chiamare il servizio _ *_nx_tcp_server_socket_relisten_*\* su questo socket.</span><span class="sxs-lookup"><span data-stu-id="613a9-1470">If accepting another client connection on the same server port is desired, the _ *_nx_tcp_server_socket_relisten_*\* service should be called on this socket.</span></span>

<span data-ttu-id="613a9-1471">Nel segmento di codice seguente viene illustrata la sequenza di chiamate utilizzate da un server TCP tipico:</span><span class="sxs-lookup"><span data-stu-id="613a9-1471">The following code segment illustrates the sequence of calls a typical TCP server uses:</span></span>

```c
/* Set up a previously created TCP socket to
   listen on port 12 */
nx_tcp_server_socket_listen()

/* Loop to make a (another) connection. */
while(1)
{
    /* Wait for a client socket connection request
       for 100 ticks. */
    nx_tcp_server_socket_accept();

    /* (Send and receive TCP messages with the TCP
       client) */

    /* Disconnect the server socket. */
    nx_tcp_socket_disconnect();

    /* Remove this server socket from listening on
       the port. */
    nx_tcp_server_socket_unaccept(&server_socket);
    /* Set up server socket to relisten on the
       same port for the next client. */
    nx_tcp_server_socket_relisten();
}
```

### <a name="mss-validation"></a><span data-ttu-id="613a9-1472">Convalida MSS</span><span class="sxs-lookup"><span data-stu-id="613a9-1472">MSS Validation</span></span>      
<span data-ttu-id="613a9-1473">La dimensione massima del segmento (MSS) è la quantità massima di byte che un host TCP può ricevere senza essere frammentato dal livello IP sottostante.</span><span class="sxs-lookup"><span data-stu-id="613a9-1473">The Maximum Segment Size (MSS) is the maximum amount of bytes a TCP host can receive without being fragmented by the underlying IP layer.</span></span> <span data-ttu-id="613a9-1474">Durante la fase di creazione della connessione TCP, entrambe le terminazioni scambiano il proprio valore TCP MSS, in modo che il mittente non invii un segmento di dati TCP maggiore della MSS del destinatario.</span><span class="sxs-lookup"><span data-stu-id="613a9-1474">During TCP connection establishment phase, both ends exchanges its own TCP MSS value, so that the sender does not send a TCP data segment that is larger than the receiver's MSS.</span></span> <span data-ttu-id="613a9-1475">Il modulo NetX Duo TCP convaliderà facoltativamente il valore MSS annunciato del peer prima di stabilire una connessione.</span><span class="sxs-lookup"><span data-stu-id="613a9-1475">NetX Duo TCP module will optionally validate its peer's advertised MSS value before establishing a connection.</span></span> <span data-ttu-id="613a9-1476">Per impostazione predefinita, NetX Duo non abilita tale controllo.</span><span class="sxs-lookup"><span data-stu-id="613a9-1476">By default NetX Duo does not enable such a check.</span></span> <span data-ttu-id="613a9-1477">Le applicazioni che desiderano eseguire la convalida MSS definiranno ***NX_ENABLE_TCP_MSS_CHECK** _ quando compilano la libreria NETX Duo e il valore minimo sarà definito in _*_NX_TCP_MSS_MINIMUM_\*_.</span><span class="sxs-lookup"><span data-stu-id="613a9-1477">Applications wishing to perform MSS validation shall define ***NX_ENABLE_TCP_MSS_CHECK** _ when building the NetX Duo library, and the minimum value shall be defined in _*_NX_TCP_MSS_MINIMUM_\*_.</span></span> <span data-ttu-id="613a9-1478">Le connessioni TCP in ingresso con valori MSS inferiori a _ *_NX_TCP_MSS_MINIMUM_*\* verranno eliminate.</span><span class="sxs-lookup"><span data-stu-id="613a9-1478">Incoming TCP connections with MSS values below _ *_NX_TCP_MSS_MINIMUM_*\* are dropped.</span></span>

### <a name="stop-listening-on-a-server-port"></a><span data-ttu-id="613a9-1479">Interrompi ascolto su una porta del server</span><span class="sxs-lookup"><span data-stu-id="613a9-1479">Stop Listening on a Server Port</span></span>    
<span data-ttu-id="613a9-1480">Se l'applicazione non desidera più restare in ascolto delle richieste di connessione client su una porta del server specificata in precedenza da una chiamata al servizio \***nx_tcp_server_socket_listen** _, l'applicazione chiama semplicemente il servizio _ \*_nx_tcp_server_socket_unlisten_\*\*.</span><span class="sxs-lookup"><span data-stu-id="613a9-1480">If the application no longer wishes to listen for client connection requests on a server port that was previously specified by a call to the ***nx_tcp_server_socket_listen** _ service, the application simply calls the _ *_nx_tcp_server_socket_unlisten_** service.</span></span> <span data-ttu-id="613a9-1481">Questo servizio posiziona tutti i socket in attesa di una connessione nello stato CLOSED e rilascia tutti i pacchetti di richieste di connessione client in coda.</span><span class="sxs-lookup"><span data-stu-id="613a9-1481">This service places any socket waiting for a connection back in the CLOSED state and releases any queued client connection request packets.</span></span> 

### <a name="tcp-window-size"></a><span data-ttu-id="613a9-1482">Dimensioni finestra TCP</span><span class="sxs-lookup"><span data-stu-id="613a9-1482">TCP Window Size</span></span>   
<span data-ttu-id="613a9-1483">Durante le fasi di installazione e trasferimento dei dati della connessione, ogni porta segnala la quantità di dati che è in grado di gestire, denominata dimensione della finestra.</span><span class="sxs-lookup"><span data-stu-id="613a9-1483">During both the setup and data transfer phases of the connection, each port reports the amount of data it can handle, which is called its window size.</span></span> <span data-ttu-id="613a9-1484">Quando i dati vengono ricevuti ed elaborati, questa dimensione della finestra viene regolata dinamicamente.</span><span class="sxs-lookup"><span data-stu-id="613a9-1484">As data are received and processed, this window size is adjusted dynamically.</span></span> <span data-ttu-id="613a9-1485">In TCP un mittente può inviare solo una quantità di dati che si inserisce nella finestra del destinatario.</span><span class="sxs-lookup"><span data-stu-id="613a9-1485">In TCP, a sender can only send an amount of data that fits into the receiver's window.</span></span> <span data-ttu-id="613a9-1486">In sostanza, le dimensioni della finestra forniscono il controllo di flusso per il trasferimento dei dati in ogni direzione della connessione.</span><span class="sxs-lookup"><span data-stu-id="613a9-1486">In essence, the window size provides flow control for data transfer in each direction of the connection.</span></span>   

### <a name="tcp-packet-send"></a><span data-ttu-id="613a9-1487">Invio di pacchetti TCP</span><span class="sxs-lookup"><span data-stu-id="613a9-1487">TCP Packet Send</span></span>     
<span data-ttu-id="613a9-1488">L'invio di dati TCP viene eseguito facilmente chiamando la funzione ***nx_tcp_socket_send*** .</span><span class="sxs-lookup"><span data-stu-id="613a9-1488">Sending TCP data is easily accomplished by calling the ***nx_tcp_socket_send*** function.</span></span> <span data-ttu-id="613a9-1489">Se le dimensioni dei dati trasmessi sono maggiori del valore MSS del socket o della dimensione della finestra di ricezione peer corrente, a seconda del valore più piccolo, la logica interna TCP suddivide i dati che rientrano in min (MSS, finestra di ricezione peer) per la trasmissione.</span><span class="sxs-lookup"><span data-stu-id="613a9-1489">If the size of the data being transmitted is larger than the MSS value of the socket or the current peer receive window size, whichever is smaller, TCP internal logic carves off the data that fits into min (MSS, peer receive Window) for transmission.</span></span> <span data-ttu-id="613a9-1490">Questo servizio compila quindi un'intestazione TCP davanti al pacchetto (incluso il calcolo del checksum).</span><span class="sxs-lookup"><span data-stu-id="613a9-1490">This service then builds a TCP header in front of the packet (including the checksum calculation).</span></span> <span data-ttu-id="613a9-1491">Se le dimensioni della finestra del ricevitore non sono pari a zero, il chiamante invierà il maggior numero di dati possibile per riempire le dimensioni della finestra del ricevitore.</span><span class="sxs-lookup"><span data-stu-id="613a9-1491">If the receiver's window size is not zero, the caller will send as much data as it can to fill up the receiver window size.</span></span> <span data-ttu-id="613a9-1492">Se la finestra di ricezione diventa zero, il chiamante potrebbe sospendere e attendere che le dimensioni della finestra del destinatario aumentino sufficiente per l'invio del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="613a9-1492">If the receive window becomes zero, the caller may suspend and wait for the receiver's window size to increase enough for this packet to be sent.</span></span> <span data-ttu-id="613a9-1493">In qualsiasi momento, più thread possono sospendere durante il tentativo di invio di dati tramite lo stesso socket.</span><span class="sxs-lookup"><span data-stu-id="613a9-1493">At any given time, multiple threads may suspend while trying to send data through the same socket.</span></span> 

> [!WARNING]  
> <span data-ttu-id="613a9-1494">*I dati TCP che risiedono nella struttura di NX_PACKET devono trovarsi su un limite di parole lunghe. Inoltre, è necessario disporre di spazio sufficiente tra il puntatore anteposto e il puntatore di avvio dati per inserire le intestazioni TCP, IP e supporti fisici*.</span><span class="sxs-lookup"><span data-stu-id="613a9-1494">*The TCP data residing in the NX_PACKET structure should reside on a long-word boundary. In addition, there needs to be sufficient space between the prepend pointer and the data start pointer to place the TCP, IP, and physical media headers*.</span></span>

### <a name="tcp-packet-retransmit"></a><span data-ttu-id="613a9-1495">Ritrasmissione del pacchetto TCP</span><span class="sxs-lookup"><span data-stu-id="613a9-1495">TCP Packet Retransmit</span></span>      
<span data-ttu-id="613a9-1496">I pacchetti TCP trasmessi in precedenza venivano effettivamente archiviati internamente fino a quando non viene restituito un ACK dall'altro lato della connessione.</span><span class="sxs-lookup"><span data-stu-id="613a9-1496">Previously transmitted TCP packets sent actually stored internally until an ACK is returned from the other side of the connection.</span></span> <span data-ttu-id="613a9-1497">Se i dati trasmessi non vengono riconosciuti entro il periodo di timeout, il pacchetto archiviato viene inviato nuovamente e viene impostato il periodo di timeout successivo.</span><span class="sxs-lookup"><span data-stu-id="613a9-1497">If transmitted data is not acknowledged within the timeout period, the stored packet is re-sent and the next timeout period is set.</span></span> <span data-ttu-id="613a9-1498">Quando viene ricevuto un ACK, vengono infine rilasciati tutti i pacchetti analizzati dal numero di riconoscimento nella coda di trasmissione interna.</span><span class="sxs-lookup"><span data-stu-id="613a9-1498">When an ACK is received, all packets covered by the acknowledgement number in the internal transmit queue are finally released.</span></span>  

> [!WARNING]   
> <span data-ttu-id="613a9-1499">*L'applicazione non deve riutilizzare il pacchetto o modificare il contenuto del pacchetto dopo che nx_tcp_socket_send () restituisce con NX_SUCCESS. Il pacchetto trasmesso viene infine rilasciato dall'elaborazione interna di NetX Duo dopo che i dati sono stati riconosciuti dall'altra entità finale*.</span><span class="sxs-lookup"><span data-stu-id="613a9-1499">*Application shall not reuse the packet or alter the contents of the packet after nx_tcp_socket_send() returns with NX_SUCCESS. The transmitted packet is eventually released by NetX Duo internal processing after the data is acknowledged by the other end*.</span></span>

### <a name="tcp-keepalive"></a><span data-ttu-id="613a9-1500">Keepalive TCP</span><span class="sxs-lookup"><span data-stu-id="613a9-1500">TCP Keepalive</span></span>     
<span data-ttu-id="613a9-1501">La funzionalità TCP keepalive consente a un socket di rilevare se il peer si disconnette o meno senza terminazione corretta, ad esempio se il peer si è arrestato in modo anomalo, oppure per impedire a determinate funzionalità di monitoraggio della rete di terminare una connessione per lunghi periodi di inattività.</span><span class="sxs-lookup"><span data-stu-id="613a9-1501">TCP Keepalive feature allows a socket to detect whether or not its peer disconnects without proper termination (for example, the peer crashed), or to prevent certain network monitoring facilities to terminate a connection for long periods of idle.</span></span> <span data-ttu-id="613a9-1502">Il protocollo keepalive TCP funziona inviando periodicamente un frame TCP senza dati e il numero di sequenza impostato su uno inferiore al numero di sequenza corrente.</span><span class="sxs-lookup"><span data-stu-id="613a9-1502">TCP Keepalive works by periodically sending a TCP frame with no data, and the sequence number set to one less than the current sequence number.</span></span> <span data-ttu-id="613a9-1503">Alla ricezione di tale frame TCP keepalive, il destinatario, se ancora attivo, risponde con un ACK per il numero di sequenza corrente.</span><span class="sxs-lookup"><span data-stu-id="613a9-1503">On receiving such TCP Keepalive frame, the recipient, if still alive, responses with an ACK for its current sequence number.</span></span> <span data-ttu-id="613a9-1504">Questa operazione completa la transazione KeepAlive.</span><span class="sxs-lookup"><span data-stu-id="613a9-1504">This completes the keepalive transaction.</span></span>  

<span data-ttu-id="613a9-1505">Per impostazione predefinita, la funzionalità KeepAlive non è abilitata.</span><span class="sxs-lookup"><span data-stu-id="613a9-1505">By default the keepalive feature is not enabled.</span></span> <span data-ttu-id="613a9-1506">Per usare questa funzionalità, è necessario compilare la libreria NetX Duo con \***NX_ENABLE_TCP_KEEPALIVE** _ defined.</span><span class="sxs-lookup"><span data-stu-id="613a9-1506">To use this feature, NetX Duo library must be built with \***NX_ENABLE_TCP_KEEPALIVE** _ defined.</span></span> <span data-ttu-id="613a9-1507">Il simbolo _ *_NX_TCP_KEEPALIVE_INITIAL_*\* specifica il numero di secondi di inattività prima dell'avvio del frame KeepAlive.</span><span class="sxs-lookup"><span data-stu-id="613a9-1507">The symbol _ *_NX_TCP_KEEPALIVE_INITIAL_*\* specifies the number of seconds of inactivity before the keepalive frame is initiated.</span></span>  

### <a name="tcp-packet-receive"></a><span data-ttu-id="613a9-1508">Ricezione di pacchetti TCP</span><span class="sxs-lookup"><span data-stu-id="613a9-1508">TCP Packet Receive</span></span>   
<span data-ttu-id="613a9-1509">L'elaborazione dei pacchetti di ricezione TCP (chiamata dal thread helper IP) è responsabile della gestione di varie azioni di connessione e disconnessione, oltre che dell'elaborazione di riconoscimento della trasmissione.</span><span class="sxs-lookup"><span data-stu-id="613a9-1509">The TCP receive packet processing (called from the IP helper thread) is responsible for handling various connection and disconnection actions as well as transmit acknowledge processing.</span></span> <span data-ttu-id="613a9-1510">Inoltre, l'elaborazione dei pacchetti TCP receive è responsabile dell'inserimento dei pacchetti con i dati di ricezione nella coda di ricezione del socket TCP appropriato o del recapito del pacchetto al primo thread sospeso in attesa di un pacchetto.</span><span class="sxs-lookup"><span data-stu-id="613a9-1510">In addition, the TCP receive packet processing is responsible for placing packets with receive data on the appropriate TCP socket's receive queue or delivering the packet to the first suspended thread waiting for a packet.</span></span>

### <a name="tcp-receive-notify"></a><span data-ttu-id="613a9-1511">Notifica di ricezione TCP</span><span class="sxs-lookup"><span data-stu-id="613a9-1511">TCP Receive Notify</span></span>     
<span data-ttu-id="613a9-1512">Se il thread dell'applicazione deve elaborare i dati ricevuti da più di un socket, è necessario usare la funzione ***nx_tcp_socket_receive_notify*** .</span><span class="sxs-lookup"><span data-stu-id="613a9-1512">If the application thread needs to process received data from more than one socket, the ***nx_tcp_socket_receive_notify*** function should be used.</span></span> <span data-ttu-id="613a9-1513">Questa funzione registra una funzione di callback del pacchetto di ricezione per il socket.</span><span class="sxs-lookup"><span data-stu-id="613a9-1513">This function registers a receive packet callback function for the socket.</span></span> <span data-ttu-id="613a9-1514">Ogni volta che viene ricevuto un pacchetto nel socket, viene eseguita la funzione di callback.</span><span class="sxs-lookup"><span data-stu-id="613a9-1514">Whenever a packet is received on the socket, the callback function is executed.</span></span>  

<span data-ttu-id="613a9-1515">Il contenuto della funzione di callback è applicationspecific; Tuttavia, la funzione conterrebbe probabilmente la logica per informare il thread di elaborazione che un pacchetto è disponibile nel socket corrispondente.</span><span class="sxs-lookup"><span data-stu-id="613a9-1515">The contents of the callback function are applicationspecific; however, the function would most likely contain logic to inform the processing thread that a packet is available on the corresponding socket.</span></span> 

### <a name="thread-suspension"></a><span data-ttu-id="613a9-1516">Sospensione thread</span><span class="sxs-lookup"><span data-stu-id="613a9-1516">Thread Suspension</span></span>      
<span data-ttu-id="613a9-1517">Come indicato in precedenza, i thread dell'applicazione possono sospendere il tentativo di ricevere dati da una determinata porta TCP.</span><span class="sxs-lookup"><span data-stu-id="613a9-1517">As mentioned previously, application threads can suspend while attempting to receive data from a particular TCP port.</span></span> <span data-ttu-id="613a9-1518">Dopo la ricezione di un pacchetto su tale porta, questo viene assegnato al primo thread sospeso e il thread viene quindi ripreso.</span><span class="sxs-lookup"><span data-stu-id="613a9-1518">After a packet is received on that port, it is given to the first thread suspended and that thread is then resumed.</span></span> <span data-ttu-id="613a9-1519">Un timeout facoltativo è disponibile quando si sospende un pacchetto di ricezione TCP, una funzionalità disponibile per la maggior parte dei servizi NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="613a9-1519">An optional timeout is available when suspending on a TCP receive packet, a feature available for most NetX Duo services.</span></span>  

<span data-ttu-id="613a9-1520">La sospensione dei thread è disponibile anche per la connessione (client e server), l'associazione client e i servizi di disconnessione.</span><span class="sxs-lookup"><span data-stu-id="613a9-1520">Thread suspension is also available for connection (both client and server), client binding, and disconnection services.</span></span>  

### <a name="tcp-socket-statistics-and-errors"></a><span data-ttu-id="613a9-1521">Statistiche ed errori del socket TCP</span><span class="sxs-lookup"><span data-stu-id="613a9-1521">TCP Socket Statistics and Errors</span></span>     
<span data-ttu-id="613a9-1522">Se abilitata, il software socket TCP NetX Duo tiene traccia di diverse statistiche ed errori che possono risultare utili per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="613a9-1522">If enabled, the NetX Duo TCP socket software keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="613a9-1523">Per ogni istanza IP/TCP vengono mantenute le statistiche e i report degli errori seguenti:</span><span class="sxs-lookup"><span data-stu-id="613a9-1523">The following statistics and error reports are maintained for each IP/TCP instance:</span></span>   

- <span data-ttu-id="613a9-1524">Totale pacchetti TCP inviati</span><span class="sxs-lookup"><span data-stu-id="613a9-1524">Total TCP Packets Sent</span></span>  
- <span data-ttu-id="613a9-1525">Totale byte TCP inviati</span><span class="sxs-lookup"><span data-stu-id="613a9-1525">Total TCP Bytes Sent</span></span>  
- <span data-ttu-id="613a9-1526">Totale pacchetti TCP ricevuti</span><span class="sxs-lookup"><span data-stu-id="613a9-1526">Total TCP Packets Received</span></span>   
- <span data-ttu-id="613a9-1527">Totale byte TCP ricevuti</span><span class="sxs-lookup"><span data-stu-id="613a9-1527">Total TCP Bytes Received</span></span>   
- <span data-ttu-id="613a9-1528">Totale pacchetti TCP non validi</span><span class="sxs-lookup"><span data-stu-id="613a9-1528">Total TCP Invalid Packets</span></span>   
- <span data-ttu-id="613a9-1529">Totale pacchetti di ricezione TCP eliminati</span><span class="sxs-lookup"><span data-stu-id="613a9-1529">Total TCP Receive Packets Dropped</span></span>    
- <span data-ttu-id="613a9-1530">Totale errori di checksum di ricezione TCP</span><span class="sxs-lookup"><span data-stu-id="613a9-1530">Total TCP Receive Checksum Errors</span></span>   
- <span data-ttu-id="613a9-1531">Totale connessioni TCP</span><span class="sxs-lookup"><span data-stu-id="613a9-1531">Total TCP Connections</span></span>   
- <span data-ttu-id="613a9-1532">Totale disconnessioni TCP</span><span class="sxs-lookup"><span data-stu-id="613a9-1532">Total TCP Disconnections</span></span>   
- <span data-ttu-id="613a9-1533">Totale connessioni TCP eliminate</span><span class="sxs-lookup"><span data-stu-id="613a9-1533">Total TCP Connections Dropped</span></span>    
- <span data-ttu-id="613a9-1534">Totale ritrasmissioni dei pacchetti TCP</span><span class="sxs-lookup"><span data-stu-id="613a9-1534">Total TCP Packet Retransmits</span></span>   
- <span data-ttu-id="613a9-1535">Pacchetti socket TCP inviati</span><span class="sxs-lookup"><span data-stu-id="613a9-1535">TCP Socket Packets Sent</span></span>   
- <span data-ttu-id="613a9-1536">Byte socket TCP inviati</span><span class="sxs-lookup"><span data-stu-id="613a9-1536">TCP Socket Bytes Sent</span></span>   
- <span data-ttu-id="613a9-1537">Pacchetti socket TCP ricevuti</span><span class="sxs-lookup"><span data-stu-id="613a9-1537">TCP Socket Packets Received</span></span>   
- <span data-ttu-id="613a9-1538">Byte socket TCP ricevuti</span><span class="sxs-lookup"><span data-stu-id="613a9-1538">TCP Socket Bytes Received</span></span>   
- <span data-ttu-id="613a9-1539">Ritrasmette i pacchetti socket TCP</span><span class="sxs-lookup"><span data-stu-id="613a9-1539">TCP Socket Packet Retransmits</span></span>    
- <span data-ttu-id="613a9-1540">Pacchetti socket TCP in coda</span><span class="sxs-lookup"><span data-stu-id="613a9-1540">TCP Socket Packets Queued</span></span>    
- <span data-ttu-id="613a9-1541">Errori di checksum del socket TCP</span><span class="sxs-lookup"><span data-stu-id="613a9-1541">TCP Socket Checksum Errors</span></span>    
- <span data-ttu-id="613a9-1542">Stato socket TCP</span><span class="sxs-lookup"><span data-stu-id="613a9-1542">TCP Socket State</span></span>    
- <span data-ttu-id="613a9-1543">Profondità coda di trasmissione socket TCP</span><span class="sxs-lookup"><span data-stu-id="613a9-1543">TCP Socket Transmit Queue Depth</span></span>    
- <span data-ttu-id="613a9-1544">Dimensioni finestra di trasmissione socket TCP</span><span class="sxs-lookup"><span data-stu-id="613a9-1544">TCP Socket Transmit Window Size</span></span>    
- <span data-ttu-id="613a9-1545">Dimensioni della finestra di ricezione socket TCP</span><span class="sxs-lookup"><span data-stu-id="613a9-1545">TCP Socket Receive Window Size</span></span>    

<span data-ttu-id="613a9-1546">Tutte le statistiche e i report degli errori sono disponibili per l'applicazione con il servizio ***nx_tcp_info_get** _ per le statistiche TCP totali e il servizio _ *_nx_tcp_socket_info_get_** per le statistiche TCP per socket.</span><span class="sxs-lookup"><span data-stu-id="613a9-1546">All these statistics and error reports are available to the application with the ***nx_tcp_info_get** _ service for total TCP statistics and the _ *_nx_tcp_socket_info_get_** service for TCP statistics per socket.</span></span>

### <a name="tcp-socket-control-block-nx_tcp_socket"></a><span data-ttu-id="613a9-1547">NX_TCP_SOCKET blocco di controllo socket TCP</span><span class="sxs-lookup"><span data-stu-id="613a9-1547">TCP Socket Control Block NX_TCP_SOCKET</span></span>      
<span data-ttu-id="613a9-1548">Le caratteristiche di ogni socket TCP si trovano nel blocco di controllo *NX_TCP_SOCKET* associato, che contiene informazioni utili, ad esempio il collegamento alla struttura dei dati IP, l'interfaccia di connessione di rete, la porta associata e la coda dei pacchetti di ricezione.</span><span class="sxs-lookup"><span data-stu-id="613a9-1548">The characteristics of each TCP socket are found in the associated *NX_TCP_SOCKET* control block, which contains useful information such as the link to the IP data structure, the network connection interface, the bound port, and the receive packet queue.</span></span> <span data-ttu-id="613a9-1549">Questa struttura viene definita nel file ***nx_api. h*** .</span><span class="sxs-lookup"><span data-stu-id="613a9-1549">This structure is defined in the ***nx_api.h*** file.</span></span>